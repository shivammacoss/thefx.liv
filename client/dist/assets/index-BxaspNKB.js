function ly(t,e){for(var s=0;s<e.length;s++){const r=e[s];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(r,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function s(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=s(i);fetch(i.href,a)}})();function oy(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var mx={exports:{}},uo={},px={exports:{}},be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ba=Symbol.for("react.element"),cy=Symbol.for("react.portal"),dy=Symbol.for("react.fragment"),uy=Symbol.for("react.strict_mode"),hy=Symbol.for("react.profiler"),my=Symbol.for("react.provider"),py=Symbol.for("react.context"),xy=Symbol.for("react.forward_ref"),fy=Symbol.for("react.suspense"),gy=Symbol.for("react.memo"),yy=Symbol.for("react.lazy"),Ch=Symbol.iterator;function by(t){return t===null||typeof t!="object"?null:(t=Ch&&t[Ch]||t["@@iterator"],typeof t=="function"?t:null)}var xx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},fx=Object.assign,gx={};function $r(t,e,s){this.props=t,this.context=e,this.refs=gx,this.updater=s||xx}$r.prototype.isReactComponent={};$r.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};$r.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function yx(){}yx.prototype=$r.prototype;function tu(t,e,s){this.props=t,this.context=e,this.refs=gx,this.updater=s||xx}var su=tu.prototype=new yx;su.constructor=tu;fx(su,$r.prototype);su.isPureReactComponent=!0;var Eh=Array.isArray,bx=Object.prototype.hasOwnProperty,nu={current:null},vx={key:!0,ref:!0,__self:!0,__source:!0};function Nx(t,e,s){var r,i={},a=null,l=null;if(e!=null)for(r in e.ref!==void 0&&(l=e.ref),e.key!==void 0&&(a=""+e.key),e)bx.call(e,r)&&!vx.hasOwnProperty(r)&&(i[r]=e[r]);var o=arguments.length-2;if(o===1)i.children=s;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];i.children=c}if(t&&t.defaultProps)for(r in o=t.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:ba,type:t,key:a,ref:l,props:i,_owner:nu.current}}function vy(t,e){return{$$typeof:ba,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ru(t){return typeof t=="object"&&t!==null&&t.$$typeof===ba}function Ny(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(s){return e[s]})}var Th=/\/+/g;function Fo(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Ny(""+t.key):e.toString(36)}function cl(t,e,s,r,i){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var l=!1;if(t===null)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case ba:case cy:l=!0}}if(l)return l=t,i=i(l),t=r===""?"."+Fo(l,0):r,Eh(i)?(s="",t!=null&&(s=t.replace(Th,"$&/")+"/"),cl(i,e,s,"",function(d){return d})):i!=null&&(ru(i)&&(i=vy(i,s+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(Th,"$&/")+"/")+t)),e.push(i)),1;if(l=0,r=r===""?".":r+":",Eh(t))for(var o=0;o<t.length;o++){a=t[o];var c=r+Fo(a,o);l+=cl(a,e,s,c,i)}else if(c=by(t),typeof c=="function")for(t=c.call(t),o=0;!(a=t.next()).done;)a=a.value,c=r+Fo(a,o++),l+=cl(a,e,s,c,i);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function Ma(t,e,s){if(t==null)return t;var r=[],i=0;return cl(t,r,"","",function(a){return e.call(s,a,i++)}),r}function jy(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(s){(t._status===0||t._status===-1)&&(t._status=1,t._result=s)},function(s){(t._status===0||t._status===-1)&&(t._status=2,t._result=s)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var bt={current:null},dl={transition:null},wy={ReactCurrentDispatcher:bt,ReactCurrentBatchConfig:dl,ReactCurrentOwner:nu};function jx(){throw Error("act(...) is not supported in production builds of React.")}be.Children={map:Ma,forEach:function(t,e,s){Ma(t,function(){e.apply(this,arguments)},s)},count:function(t){var e=0;return Ma(t,function(){e++}),e},toArray:function(t){return Ma(t,function(e){return e})||[]},only:function(t){if(!ru(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};be.Component=$r;be.Fragment=dy;be.Profiler=hy;be.PureComponent=tu;be.StrictMode=uy;be.Suspense=fy;be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wy;be.act=jx;be.cloneElement=function(t,e,s){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=fx({},t.props),i=t.key,a=t.ref,l=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,l=nu.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(c in e)bx.call(e,c)&&!vx.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&o!==void 0?o[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=s;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];r.children=o}return{$$typeof:ba,type:t.type,key:i,ref:a,props:r,_owner:l}};be.createContext=function(t){return t={$$typeof:py,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:my,_context:t},t.Consumer=t};be.createElement=Nx;be.createFactory=function(t){var e=Nx.bind(null,t);return e.type=t,e};be.createRef=function(){return{current:null}};be.forwardRef=function(t){return{$$typeof:xy,render:t}};be.isValidElement=ru;be.lazy=function(t){return{$$typeof:yy,_payload:{_status:-1,_result:t},_init:jy}};be.memo=function(t,e){return{$$typeof:gy,type:t,compare:e===void 0?null:e}};be.startTransition=function(t){var e=dl.transition;dl.transition={};try{t()}finally{dl.transition=e}};be.unstable_act=jx;be.useCallback=function(t,e){return bt.current.useCallback(t,e)};be.useContext=function(t){return bt.current.useContext(t)};be.useDebugValue=function(){};be.useDeferredValue=function(t){return bt.current.useDeferredValue(t)};be.useEffect=function(t,e){return bt.current.useEffect(t,e)};be.useId=function(){return bt.current.useId()};be.useImperativeHandle=function(t,e,s){return bt.current.useImperativeHandle(t,e,s)};be.useInsertionEffect=function(t,e){return bt.current.useInsertionEffect(t,e)};be.useLayoutEffect=function(t,e){return bt.current.useLayoutEffect(t,e)};be.useMemo=function(t,e){return bt.current.useMemo(t,e)};be.useReducer=function(t,e,s){return bt.current.useReducer(t,e,s)};be.useRef=function(t){return bt.current.useRef(t)};be.useState=function(t){return bt.current.useState(t)};be.useSyncExternalStore=function(t,e,s){return bt.current.useSyncExternalStore(t,e,s)};be.useTransition=function(){return bt.current.useTransition()};be.version="18.3.1";px.exports=be;var g=px.exports;const iu=oy(g),ky=ly({__proto__:null,default:iu},[g]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sy=g,Cy=Symbol.for("react.element"),Ey=Symbol.for("react.fragment"),Ty=Object.prototype.hasOwnProperty,Py=Sy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ly={key:!0,ref:!0,__self:!0,__source:!0};function wx(t,e,s){var r,i={},a=null,l=null;s!==void 0&&(a=""+s),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(l=e.ref);for(r in e)Ty.call(e,r)&&!Ly.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:Cy,type:t,key:a,ref:l,props:i,_owner:Py.current}}uo.Fragment=Ey;uo.jsx=wx;uo.jsxs=wx;mx.exports=uo;var n=mx.exports,Dc={},kx={exports:{}},At={},Sx={exports:{}},Cx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(T,L){var F=T.length;T.push(L);e:for(;0<F;){var C=F-1>>>1,H=T[C];if(0<i(H,L))T[C]=L,T[F]=H,F=C;else break e}}function s(T){return T.length===0?null:T[0]}function r(T){if(T.length===0)return null;var L=T[0],F=T.pop();if(F!==L){T[0]=F;e:for(var C=0,H=T.length,J=H>>>1;C<J;){var ce=2*(C+1)-1,U=T[ce],le=ce+1,G=T[le];if(0>i(U,F))le<H&&0>i(G,U)?(T[C]=G,T[le]=F,C=le):(T[C]=U,T[ce]=F,C=ce);else if(le<H&&0>i(G,F))T[C]=G,T[le]=F,C=le;else break e}}return L}function i(T,L){var F=T.sortIndex-L.sortIndex;return F!==0?F:T.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var l=Date,o=l.now();t.unstable_now=function(){return l.now()-o}}var c=[],d=[],m=1,u=null,h=3,x=!1,y=!1,f=!1,w=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(T){for(var L=s(d);L!==null;){if(L.callback===null)r(d);else if(L.startTime<=T)r(d),L.sortIndex=L.expirationTime,e(c,L);else break;L=s(d)}}function S(T){if(f=!1,v(T),!y)if(s(c)!==null)y=!0,W(N);else{var L=s(d);L!==null&&D(S,L.startTime-T)}}function N(T,L){y=!1,f&&(f=!1,p(E),E=-1),x=!0;var F=h;try{for(v(L),u=s(c);u!==null&&(!(u.expirationTime>L)||T&&!V());){var C=u.callback;if(typeof C=="function"){u.callback=null,h=u.priorityLevel;var H=C(u.expirationTime<=L);L=t.unstable_now(),typeof H=="function"?u.callback=H:u===s(c)&&r(c),v(L)}else r(c);u=s(c)}if(u!==null)var J=!0;else{var ce=s(d);ce!==null&&D(S,ce.startTime-L),J=!1}return J}finally{u=null,h=F,x=!1}}var k=!1,j=null,E=-1,_=5,M=-1;function V(){return!(t.unstable_now()-M<_)}function B(){if(j!==null){var T=t.unstable_now();M=T;var L=!0;try{L=j(!0,T)}finally{L?R():(k=!1,j=null)}}else k=!1}var R;if(typeof b=="function")R=function(){b(B)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,P=O.port2;O.port1.onmessage=B,R=function(){P.postMessage(null)}}else R=function(){w(B,0)};function W(T){j=T,k||(k=!0,R())}function D(T,L){E=w(function(){T(t.unstable_now())},L)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(T){T.callback=null},t.unstable_continueExecution=function(){y||x||(y=!0,W(N))},t.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<T?Math.floor(1e3/T):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return s(c)},t.unstable_next=function(T){switch(h){case 1:case 2:case 3:var L=3;break;default:L=h}var F=h;h=L;try{return T()}finally{h=F}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(T,L){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var F=h;h=T;try{return L()}finally{h=F}},t.unstable_scheduleCallback=function(T,L,F){var C=t.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?C+F:C):F=C,T){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=F+H,T={id:m++,callback:L,priorityLevel:T,startTime:F,expirationTime:H,sortIndex:-1},F>C?(T.sortIndex=F,e(d,T),s(c)===null&&T===s(d)&&(f?(p(E),E=-1):f=!0,D(S,F-C))):(T.sortIndex=H,e(c,T),y||x||(y=!0,W(N))),T},t.unstable_shouldYield=V,t.unstable_wrapCallback=function(T){var L=h;return function(){var F=h;h=L;try{return T.apply(this,arguments)}finally{h=F}}}})(Cx);Sx.exports=Cx;var _y=Sx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var My=g,Rt=_y;function te(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,s=1;s<arguments.length;s++)e+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ex=new Set,Yi={};function Qn(t,e){kr(t,e),kr(t+"Capture",e)}function kr(t,e){for(Yi[t]=e,t=0;t<e.length;t++)Ex.add(e[t])}var Cs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Fc=Object.prototype.hasOwnProperty,Ry=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ph={},Lh={};function Ay(t){return Fc.call(Lh,t)?!0:Fc.call(Ph,t)?!1:Ry.test(t)?Lh[t]=!0:(Ph[t]=!0,!1)}function zy(t,e,s,r){if(s!==null&&s.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:s!==null?!s.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Oy(t,e,s,r){if(e===null||typeof e>"u"||zy(t,e,s,r))return!0;if(r)return!1;if(s!==null)switch(s.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function vt(t,e,s,r,i,a,l){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=s,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=l}var at={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){at[t]=new vt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];at[e]=new vt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){at[t]=new vt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){at[t]=new vt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){at[t]=new vt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){at[t]=new vt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){at[t]=new vt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){at[t]=new vt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){at[t]=new vt(t,5,!1,t.toLowerCase(),null,!1,!1)});var au=/[\-:]([a-z])/g;function lu(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(au,lu);at[e]=new vt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(au,lu);at[e]=new vt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(au,lu);at[e]=new vt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){at[t]=new vt(t,1,!1,t.toLowerCase(),null,!1,!1)});at.xlinkHref=new vt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){at[t]=new vt(t,1,!1,t.toLowerCase(),null,!0,!0)});function ou(t,e,s,r){var i=at.hasOwnProperty(e)?at[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Oy(e,s,i,r)&&(s=null),r||i===null?Ay(e)&&(s===null?t.removeAttribute(e):t.setAttribute(e,""+s)):i.mustUseProperty?t[i.propertyName]=s===null?i.type===3?!1:"":s:(e=i.attributeName,r=i.attributeNamespace,s===null?t.removeAttribute(e):(i=i.type,s=i===3||i===4&&s===!0?"":""+s,r?t.setAttributeNS(r,e,s):t.setAttribute(e,s))))}var _s=My.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ra=Symbol.for("react.element"),tr=Symbol.for("react.portal"),sr=Symbol.for("react.fragment"),cu=Symbol.for("react.strict_mode"),Uc=Symbol.for("react.profiler"),Tx=Symbol.for("react.provider"),Px=Symbol.for("react.context"),du=Symbol.for("react.forward_ref"),Wc=Symbol.for("react.suspense"),Vc=Symbol.for("react.suspense_list"),uu=Symbol.for("react.memo"),Ys=Symbol.for("react.lazy"),Lx=Symbol.for("react.offscreen"),_h=Symbol.iterator;function bi(t){return t===null||typeof t!="object"?null:(t=_h&&t[_h]||t["@@iterator"],typeof t=="function"?t:null)}var Be=Object.assign,Uo;function Li(t){if(Uo===void 0)try{throw Error()}catch(s){var e=s.stack.trim().match(/\n( *(at )?)/);Uo=e&&e[1]||""}return`
`+Uo+t}var Wo=!1;function Vo(t,e){if(!t||Wo)return"";Wo=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),a=r.stack.split(`
`),l=i.length-1,o=a.length-1;1<=l&&0<=o&&i[l]!==a[o];)o--;for(;1<=l&&0<=o;l--,o--)if(i[l]!==a[o]){if(l!==1||o!==1)do if(l--,o--,0>o||i[l]!==a[o]){var c=`
`+i[l].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=l&&0<=o);break}}}finally{Wo=!1,Error.prepareStackTrace=s}return(t=t?t.displayName||t.name:"")?Li(t):""}function Iy(t){switch(t.tag){case 5:return Li(t.type);case 16:return Li("Lazy");case 13:return Li("Suspense");case 19:return Li("SuspenseList");case 0:case 2:case 15:return t=Vo(t.type,!1),t;case 11:return t=Vo(t.type.render,!1),t;case 1:return t=Vo(t.type,!0),t;default:return""}}function qc(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case sr:return"Fragment";case tr:return"Portal";case Uc:return"Profiler";case cu:return"StrictMode";case Wc:return"Suspense";case Vc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Px:return(t.displayName||"Context")+".Consumer";case Tx:return(t._context.displayName||"Context")+".Provider";case du:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case uu:return e=t.displayName||null,e!==null?e:qc(t.type)||"Memo";case Ys:e=t._payload,t=t._init;try{return qc(t(e))}catch{}}return null}function $y(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return qc(e);case 8:return e===cu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function pn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function _x(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function By(t){var e=_x(t)?"checked":"value",s=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var i=s.get,a=s.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(l){r=""+l,a.call(this,l)}}),Object.defineProperty(t,e,{enumerable:s.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Aa(t){t._valueTracker||(t._valueTracker=By(t))}function Mx(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var s=e.getValue(),r="";return t&&(r=_x(t)?t.checked?"true":"false":t.value),t=r,t!==s?(e.setValue(t),!0):!1}function Pl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Hc(t,e){var s=e.checked;return Be({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??t._wrapperState.initialChecked})}function Mh(t,e){var s=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;s=pn(e.value!=null?e.value:s),t._wrapperState={initialChecked:r,initialValue:s,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Rx(t,e){e=e.checked,e!=null&&ou(t,"checked",e,!1)}function Kc(t,e){Rx(t,e);var s=pn(e.value),r=e.type;if(s!=null)r==="number"?(s===0&&t.value===""||t.value!=s)&&(t.value=""+s):t.value!==""+s&&(t.value=""+s);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Yc(t,e.type,s):e.hasOwnProperty("defaultValue")&&Yc(t,e.type,pn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Rh(t,e,s){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,s||e===t.value||(t.value=e),t.defaultValue=e}s=t.name,s!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,s!==""&&(t.name=s)}function Yc(t,e,s){(e!=="number"||Pl(t.ownerDocument)!==t)&&(s==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+s&&(t.defaultValue=""+s))}var _i=Array.isArray;function xr(t,e,s,r){if(t=t.options,e){e={};for(var i=0;i<s.length;i++)e["$"+s[i]]=!0;for(s=0;s<t.length;s++)i=e.hasOwnProperty("$"+t[s].value),t[s].selected!==i&&(t[s].selected=i),i&&r&&(t[s].defaultSelected=!0)}else{for(s=""+pn(s),e=null,i=0;i<t.length;i++){if(t[i].value===s){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Qc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(te(91));return Be({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ah(t,e){var s=e.value;if(s==null){if(s=e.children,e=e.defaultValue,s!=null){if(e!=null)throw Error(te(92));if(_i(s)){if(1<s.length)throw Error(te(93));s=s[0]}e=s}e==null&&(e=""),s=e}t._wrapperState={initialValue:pn(s)}}function Ax(t,e){var s=pn(e.value),r=pn(e.defaultValue);s!=null&&(s=""+s,s!==t.value&&(t.value=s),e.defaultValue==null&&t.defaultValue!==s&&(t.defaultValue=s)),r!=null&&(t.defaultValue=""+r)}function zh(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function zx(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Xc(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?zx(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var za,Ox=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,s,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,s,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(za=za||document.createElement("div"),za.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=za.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Qi(t,e){if(e){var s=t.firstChild;if(s&&s===t.lastChild&&s.nodeType===3){s.nodeValue=e;return}}t.textContent=e}var zi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Dy=["Webkit","ms","Moz","O"];Object.keys(zi).forEach(function(t){Dy.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),zi[e]=zi[t]})});function Ix(t,e,s){return e==null||typeof e=="boolean"||e===""?"":s||typeof e!="number"||e===0||zi.hasOwnProperty(t)&&zi[t]?(""+e).trim():e+"px"}function $x(t,e){t=t.style;for(var s in e)if(e.hasOwnProperty(s)){var r=s.indexOf("--")===0,i=Ix(s,e[s],r);s==="float"&&(s="cssFloat"),r?t.setProperty(s,i):t[s]=i}}var Fy=Be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gc(t,e){if(e){if(Fy[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(te(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(te(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(te(61))}if(e.style!=null&&typeof e.style!="object")throw Error(te(62))}}function Jc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zc=null;function hu(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ed=null,fr=null,gr=null;function Oh(t){if(t=ja(t)){if(typeof ed!="function")throw Error(te(280));var e=t.stateNode;e&&(e=fo(e),ed(t.stateNode,t.type,e))}}function Bx(t){fr?gr?gr.push(t):gr=[t]:fr=t}function Dx(){if(fr){var t=fr,e=gr;if(gr=fr=null,Oh(t),e)for(t=0;t<e.length;t++)Oh(e[t])}}function Fx(t,e){return t(e)}function Ux(){}var qo=!1;function Wx(t,e,s){if(qo)return t(e,s);qo=!0;try{return Fx(t,e,s)}finally{qo=!1,(fr!==null||gr!==null)&&(Ux(),Dx())}}function Xi(t,e){var s=t.stateNode;if(s===null)return null;var r=fo(s);if(r===null)return null;s=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(s&&typeof s!="function")throw Error(te(231,e,typeof s));return s}var td=!1;if(Cs)try{var vi={};Object.defineProperty(vi,"passive",{get:function(){td=!0}}),window.addEventListener("test",vi,vi),window.removeEventListener("test",vi,vi)}catch{td=!1}function Uy(t,e,s,r,i,a,l,o,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(s,d)}catch(m){this.onError(m)}}var Oi=!1,Ll=null,_l=!1,sd=null,Wy={onError:function(t){Oi=!0,Ll=t}};function Vy(t,e,s,r,i,a,l,o,c){Oi=!1,Ll=null,Uy.apply(Wy,arguments)}function qy(t,e,s,r,i,a,l,o,c){if(Vy.apply(this,arguments),Oi){if(Oi){var d=Ll;Oi=!1,Ll=null}else throw Error(te(198));_l||(_l=!0,sd=d)}}function Xn(t){var e=t,s=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(s=e.return),t=e.return;while(t)}return e.tag===3?s:null}function Vx(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Ih(t){if(Xn(t)!==t)throw Error(te(188))}function Hy(t){var e=t.alternate;if(!e){if(e=Xn(t),e===null)throw Error(te(188));return e!==t?null:t}for(var s=t,r=e;;){var i=s.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){s=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===s)return Ih(i),t;if(a===r)return Ih(i),e;a=a.sibling}throw Error(te(188))}if(s.return!==r.return)s=i,r=a;else{for(var l=!1,o=i.child;o;){if(o===s){l=!0,s=i,r=a;break}if(o===r){l=!0,r=i,s=a;break}o=o.sibling}if(!l){for(o=a.child;o;){if(o===s){l=!0,s=a,r=i;break}if(o===r){l=!0,r=a,s=i;break}o=o.sibling}if(!l)throw Error(te(189))}}if(s.alternate!==r)throw Error(te(190))}if(s.tag!==3)throw Error(te(188));return s.stateNode.current===s?t:e}function qx(t){return t=Hy(t),t!==null?Hx(t):null}function Hx(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Hx(t);if(e!==null)return e;t=t.sibling}return null}var Kx=Rt.unstable_scheduleCallback,$h=Rt.unstable_cancelCallback,Ky=Rt.unstable_shouldYield,Yy=Rt.unstable_requestPaint,Ue=Rt.unstable_now,Qy=Rt.unstable_getCurrentPriorityLevel,mu=Rt.unstable_ImmediatePriority,Yx=Rt.unstable_UserBlockingPriority,Ml=Rt.unstable_NormalPriority,Xy=Rt.unstable_LowPriority,Qx=Rt.unstable_IdlePriority,ho=null,ps=null;function Gy(t){if(ps&&typeof ps.onCommitFiberRoot=="function")try{ps.onCommitFiberRoot(ho,t,void 0,(t.current.flags&128)===128)}catch{}}var Zt=Math.clz32?Math.clz32:eb,Jy=Math.log,Zy=Math.LN2;function eb(t){return t>>>=0,t===0?32:31-(Jy(t)/Zy|0)|0}var Oa=64,Ia=4194304;function Mi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Rl(t,e){var s=t.pendingLanes;if(s===0)return 0;var r=0,i=t.suspendedLanes,a=t.pingedLanes,l=s&268435455;if(l!==0){var o=l&~i;o!==0?r=Mi(o):(a&=l,a!==0&&(r=Mi(a)))}else l=s&~i,l!==0?r=Mi(l):a!==0&&(r=Mi(a));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,a=e&-e,i>=a||i===16&&(a&4194240)!==0))return e;if(r&4&&(r|=s&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)s=31-Zt(e),i=1<<s,r|=t[s],e&=~i;return r}function tb(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sb(t,e){for(var s=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var l=31-Zt(a),o=1<<l,c=i[l];c===-1?(!(o&s)||o&r)&&(i[l]=tb(o,e)):c<=e&&(t.expiredLanes|=o),a&=~o}}function nd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Xx(){var t=Oa;return Oa<<=1,!(Oa&4194240)&&(Oa=64),t}function Ho(t){for(var e=[],s=0;31>s;s++)e.push(t);return e}function va(t,e,s){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Zt(e),t[e]=s}function nb(t,e){var s=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<s;){var i=31-Zt(s),a=1<<i;e[i]=0,r[i]=-1,t[i]=-1,s&=~a}}function pu(t,e){var s=t.entangledLanes|=e;for(t=t.entanglements;s;){var r=31-Zt(s),i=1<<r;i&e|t[r]&e&&(t[r]|=e),s&=~i}}var Se=0;function Gx(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Jx,xu,Zx,ef,tf,rd=!1,$a=[],sn=null,nn=null,rn=null,Gi=new Map,Ji=new Map,Xs=[],rb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Bh(t,e){switch(t){case"focusin":case"focusout":sn=null;break;case"dragenter":case"dragleave":nn=null;break;case"mouseover":case"mouseout":rn=null;break;case"pointerover":case"pointerout":Gi.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ji.delete(e.pointerId)}}function Ni(t,e,s,r,i,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:s,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},e!==null&&(e=ja(e),e!==null&&xu(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function ib(t,e,s,r,i){switch(e){case"focusin":return sn=Ni(sn,t,e,s,r,i),!0;case"dragenter":return nn=Ni(nn,t,e,s,r,i),!0;case"mouseover":return rn=Ni(rn,t,e,s,r,i),!0;case"pointerover":var a=i.pointerId;return Gi.set(a,Ni(Gi.get(a)||null,t,e,s,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Ji.set(a,Ni(Ji.get(a)||null,t,e,s,r,i)),!0}return!1}function sf(t){var e=Pn(t.target);if(e!==null){var s=Xn(e);if(s!==null){if(e=s.tag,e===13){if(e=Vx(s),e!==null){t.blockedOn=e,tf(t.priority,function(){Zx(s)});return}}else if(e===3&&s.stateNode.current.memoizedState.isDehydrated){t.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ul(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var s=id(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(s===null){s=t.nativeEvent;var r=new s.constructor(s.type,s);Zc=r,s.target.dispatchEvent(r),Zc=null}else return e=ja(s),e!==null&&xu(e),t.blockedOn=s,!1;e.shift()}return!0}function Dh(t,e,s){ul(t)&&s.delete(e)}function ab(){rd=!1,sn!==null&&ul(sn)&&(sn=null),nn!==null&&ul(nn)&&(nn=null),rn!==null&&ul(rn)&&(rn=null),Gi.forEach(Dh),Ji.forEach(Dh)}function ji(t,e){t.blockedOn===e&&(t.blockedOn=null,rd||(rd=!0,Rt.unstable_scheduleCallback(Rt.unstable_NormalPriority,ab)))}function Zi(t){function e(i){return ji(i,t)}if(0<$a.length){ji($a[0],t);for(var s=1;s<$a.length;s++){var r=$a[s];r.blockedOn===t&&(r.blockedOn=null)}}for(sn!==null&&ji(sn,t),nn!==null&&ji(nn,t),rn!==null&&ji(rn,t),Gi.forEach(e),Ji.forEach(e),s=0;s<Xs.length;s++)r=Xs[s],r.blockedOn===t&&(r.blockedOn=null);for(;0<Xs.length&&(s=Xs[0],s.blockedOn===null);)sf(s),s.blockedOn===null&&Xs.shift()}var yr=_s.ReactCurrentBatchConfig,Al=!0;function lb(t,e,s,r){var i=Se,a=yr.transition;yr.transition=null;try{Se=1,fu(t,e,s,r)}finally{Se=i,yr.transition=a}}function ob(t,e,s,r){var i=Se,a=yr.transition;yr.transition=null;try{Se=4,fu(t,e,s,r)}finally{Se=i,yr.transition=a}}function fu(t,e,s,r){if(Al){var i=id(t,e,s,r);if(i===null)sc(t,e,r,zl,s),Bh(t,r);else if(ib(i,t,e,s,r))r.stopPropagation();else if(Bh(t,r),e&4&&-1<rb.indexOf(t)){for(;i!==null;){var a=ja(i);if(a!==null&&Jx(a),a=id(t,e,s,r),a===null&&sc(t,e,r,zl,s),a===i)break;i=a}i!==null&&r.stopPropagation()}else sc(t,e,r,null,s)}}var zl=null;function id(t,e,s,r){if(zl=null,t=hu(r),t=Pn(t),t!==null)if(e=Xn(t),e===null)t=null;else if(s=e.tag,s===13){if(t=Vx(e),t!==null)return t;t=null}else if(s===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return zl=t,null}function nf(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qy()){case mu:return 1;case Yx:return 4;case Ml:case Xy:return 16;case Qx:return 536870912;default:return 16}default:return 16}}var Js=null,gu=null,hl=null;function rf(){if(hl)return hl;var t,e=gu,s=e.length,r,i="value"in Js?Js.value:Js.textContent,a=i.length;for(t=0;t<s&&e[t]===i[t];t++);var l=s-t;for(r=1;r<=l&&e[s-r]===i[a-r];r++);return hl=i.slice(t,1<r?1-r:void 0)}function ml(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ba(){return!0}function Fh(){return!1}function zt(t){function e(s,r,i,a,l){this._reactName=s,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=l,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(s=t[o],this[o]=s?s(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Ba:Fh,this.isPropagationStopped=Fh,this}return Be(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=Ba)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=Ba)},persist:function(){},isPersistent:Ba}),e}var Br={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yu=zt(Br),Na=Be({},Br,{view:0,detail:0}),cb=zt(Na),Ko,Yo,wi,mo=Be({},Na,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bu,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==wi&&(wi&&t.type==="mousemove"?(Ko=t.screenX-wi.screenX,Yo=t.screenY-wi.screenY):Yo=Ko=0,wi=t),Ko)},movementY:function(t){return"movementY"in t?t.movementY:Yo}}),Uh=zt(mo),db=Be({},mo,{dataTransfer:0}),ub=zt(db),hb=Be({},Na,{relatedTarget:0}),Qo=zt(hb),mb=Be({},Br,{animationName:0,elapsedTime:0,pseudoElement:0}),pb=zt(mb),xb=Be({},Br,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),fb=zt(xb),gb=Be({},Br,{data:0}),Wh=zt(gb),yb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nb(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=vb[t])?!!e[t]:!1}function bu(){return Nb}var jb=Be({},Na,{key:function(t){if(t.key){var e=yb[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ml(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?bb[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bu,charCode:function(t){return t.type==="keypress"?ml(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ml(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),wb=zt(jb),kb=Be({},mo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vh=zt(kb),Sb=Be({},Na,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bu}),Cb=zt(Sb),Eb=Be({},Br,{propertyName:0,elapsedTime:0,pseudoElement:0}),Tb=zt(Eb),Pb=Be({},mo,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Lb=zt(Pb),_b=[9,13,27,32],vu=Cs&&"CompositionEvent"in window,Ii=null;Cs&&"documentMode"in document&&(Ii=document.documentMode);var Mb=Cs&&"TextEvent"in window&&!Ii,af=Cs&&(!vu||Ii&&8<Ii&&11>=Ii),qh=" ",Hh=!1;function lf(t,e){switch(t){case"keyup":return _b.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function of(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var nr=!1;function Rb(t,e){switch(t){case"compositionend":return of(e);case"keypress":return e.which!==32?null:(Hh=!0,qh);case"textInput":return t=e.data,t===qh&&Hh?null:t;default:return null}}function Ab(t,e){if(nr)return t==="compositionend"||!vu&&lf(t,e)?(t=rf(),hl=gu=Js=null,nr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return af&&e.locale!=="ko"?null:e.data;default:return null}}var zb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kh(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!zb[t.type]:e==="textarea"}function cf(t,e,s,r){Bx(r),e=Ol(e,"onChange"),0<e.length&&(s=new yu("onChange","change",null,s,r),t.push({event:s,listeners:e}))}var $i=null,ea=null;function Ob(t){vf(t,0)}function po(t){var e=ar(t);if(Mx(e))return t}function Ib(t,e){if(t==="change")return e}var df=!1;if(Cs){var Xo;if(Cs){var Go="oninput"in document;if(!Go){var Yh=document.createElement("div");Yh.setAttribute("oninput","return;"),Go=typeof Yh.oninput=="function"}Xo=Go}else Xo=!1;df=Xo&&(!document.documentMode||9<document.documentMode)}function Qh(){$i&&($i.detachEvent("onpropertychange",uf),ea=$i=null)}function uf(t){if(t.propertyName==="value"&&po(ea)){var e=[];cf(e,ea,t,hu(t)),Wx(Ob,e)}}function $b(t,e,s){t==="focusin"?(Qh(),$i=e,ea=s,$i.attachEvent("onpropertychange",uf)):t==="focusout"&&Qh()}function Bb(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return po(ea)}function Db(t,e){if(t==="click")return po(e)}function Fb(t,e){if(t==="input"||t==="change")return po(e)}function Ub(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ss=typeof Object.is=="function"?Object.is:Ub;function ta(t,e){if(ss(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var s=Object.keys(t),r=Object.keys(e);if(s.length!==r.length)return!1;for(r=0;r<s.length;r++){var i=s[r];if(!Fc.call(e,i)||!ss(t[i],e[i]))return!1}return!0}function Xh(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Gh(t,e){var s=Xh(t);t=0;for(var r;s;){if(s.nodeType===3){if(r=t+s.textContent.length,t<=e&&r>=e)return{node:s,offset:e-t};t=r}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Xh(s)}}function hf(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?hf(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function mf(){for(var t=window,e=Pl();e instanceof t.HTMLIFrameElement;){try{var s=typeof e.contentWindow.location.href=="string"}catch{s=!1}if(s)t=e.contentWindow;else break;e=Pl(t.document)}return e}function Nu(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Wb(t){var e=mf(),s=t.focusedElem,r=t.selectionRange;if(e!==s&&s&&s.ownerDocument&&hf(s.ownerDocument.documentElement,s)){if(r!==null&&Nu(s)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in s)s.selectionStart=e,s.selectionEnd=Math.min(t,s.value.length);else if(t=(e=s.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=s.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!t.extend&&a>r&&(i=r,r=a,a=i),i=Gh(s,a);var l=Gh(s,r);i&&l&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==l.node||t.focusOffset!==l.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),a>r?(t.addRange(e),t.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),t.addRange(e)))}}for(e=[],t=s;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<e.length;s++)t=e[s],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Vb=Cs&&"documentMode"in document&&11>=document.documentMode,rr=null,ad=null,Bi=null,ld=!1;function Jh(t,e,s){var r=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;ld||rr==null||rr!==Pl(r)||(r=rr,"selectionStart"in r&&Nu(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Bi&&ta(Bi,r)||(Bi=r,r=Ol(ad,"onSelect"),0<r.length&&(e=new yu("onSelect","select",null,e,s),t.push({event:e,listeners:r}),e.target=rr)))}function Da(t,e){var s={};return s[t.toLowerCase()]=e.toLowerCase(),s["Webkit"+t]="webkit"+e,s["Moz"+t]="moz"+e,s}var ir={animationend:Da("Animation","AnimationEnd"),animationiteration:Da("Animation","AnimationIteration"),animationstart:Da("Animation","AnimationStart"),transitionend:Da("Transition","TransitionEnd")},Jo={},pf={};Cs&&(pf=document.createElement("div").style,"AnimationEvent"in window||(delete ir.animationend.animation,delete ir.animationiteration.animation,delete ir.animationstart.animation),"TransitionEvent"in window||delete ir.transitionend.transition);function xo(t){if(Jo[t])return Jo[t];if(!ir[t])return t;var e=ir[t],s;for(s in e)if(e.hasOwnProperty(s)&&s in pf)return Jo[t]=e[s];return t}var xf=xo("animationend"),ff=xo("animationiteration"),gf=xo("animationstart"),yf=xo("transitionend"),bf=new Map,Zh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function gn(t,e){bf.set(t,e),Qn(e,[t])}for(var Zo=0;Zo<Zh.length;Zo++){var ec=Zh[Zo],qb=ec.toLowerCase(),Hb=ec[0].toUpperCase()+ec.slice(1);gn(qb,"on"+Hb)}gn(xf,"onAnimationEnd");gn(ff,"onAnimationIteration");gn(gf,"onAnimationStart");gn("dblclick","onDoubleClick");gn("focusin","onFocus");gn("focusout","onBlur");gn(yf,"onTransitionEnd");kr("onMouseEnter",["mouseout","mouseover"]);kr("onMouseLeave",["mouseout","mouseover"]);kr("onPointerEnter",["pointerout","pointerover"]);kr("onPointerLeave",["pointerout","pointerover"]);Qn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Qn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Qn("onBeforeInput",["compositionend","keypress","textInput","paste"]);Qn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Qn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Qn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ri="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Kb=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ri));function em(t,e,s){var r=t.type||"unknown-event";t.currentTarget=s,qy(r,e,void 0,t),t.currentTarget=null}function vf(t,e){e=(e&4)!==0;for(var s=0;s<t.length;s++){var r=t[s],i=r.event;r=r.listeners;e:{var a=void 0;if(e)for(var l=r.length-1;0<=l;l--){var o=r[l],c=o.instance,d=o.currentTarget;if(o=o.listener,c!==a&&i.isPropagationStopped())break e;em(i,o,d),a=c}else for(l=0;l<r.length;l++){if(o=r[l],c=o.instance,d=o.currentTarget,o=o.listener,c!==a&&i.isPropagationStopped())break e;em(i,o,d),a=c}}}if(_l)throw t=sd,_l=!1,sd=null,t}function Me(t,e){var s=e[hd];s===void 0&&(s=e[hd]=new Set);var r=t+"__bubble";s.has(r)||(Nf(e,t,2,!1),s.add(r))}function tc(t,e,s){var r=0;e&&(r|=4),Nf(s,t,r,e)}var Fa="_reactListening"+Math.random().toString(36).slice(2);function sa(t){if(!t[Fa]){t[Fa]=!0,Ex.forEach(function(s){s!=="selectionchange"&&(Kb.has(s)||tc(s,!1,t),tc(s,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Fa]||(e[Fa]=!0,tc("selectionchange",!1,e))}}function Nf(t,e,s,r){switch(nf(e)){case 1:var i=lb;break;case 4:i=ob;break;default:i=fu}s=i.bind(null,e,s,t),i=void 0,!td||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,s,{capture:!0,passive:i}):t.addEventListener(e,s,!0):i!==void 0?t.addEventListener(e,s,{passive:i}):t.addEventListener(e,s,!1)}function sc(t,e,s,r,i){var a=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(l===4)for(l=r.return;l!==null;){var c=l.tag;if((c===3||c===4)&&(c=l.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;l=l.return}for(;o!==null;){if(l=Pn(o),l===null)return;if(c=l.tag,c===5||c===6){r=a=l;continue e}o=o.parentNode}}r=r.return}Wx(function(){var d=a,m=hu(s),u=[];e:{var h=bf.get(t);if(h!==void 0){var x=yu,y=t;switch(t){case"keypress":if(ml(s)===0)break e;case"keydown":case"keyup":x=wb;break;case"focusin":y="focus",x=Qo;break;case"focusout":y="blur",x=Qo;break;case"beforeblur":case"afterblur":x=Qo;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=Uh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=ub;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=Cb;break;case xf:case ff:case gf:x=pb;break;case yf:x=Tb;break;case"scroll":x=cb;break;case"wheel":x=Lb;break;case"copy":case"cut":case"paste":x=fb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=Vh}var f=(e&4)!==0,w=!f&&t==="scroll",p=f?h!==null?h+"Capture":null:h;f=[];for(var b=d,v;b!==null;){v=b;var S=v.stateNode;if(v.tag===5&&S!==null&&(v=S,p!==null&&(S=Xi(b,p),S!=null&&f.push(na(b,S,v)))),w)break;b=b.return}0<f.length&&(h=new x(h,y,null,s,m),u.push({event:h,listeners:f}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",h&&s!==Zc&&(y=s.relatedTarget||s.fromElement)&&(Pn(y)||y[Es]))break e;if((x||h)&&(h=m.window===m?m:(h=m.ownerDocument)?h.defaultView||h.parentWindow:window,x?(y=s.relatedTarget||s.toElement,x=d,y=y?Pn(y):null,y!==null&&(w=Xn(y),y!==w||y.tag!==5&&y.tag!==6)&&(y=null)):(x=null,y=d),x!==y)){if(f=Uh,S="onMouseLeave",p="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(f=Vh,S="onPointerLeave",p="onPointerEnter",b="pointer"),w=x==null?h:ar(x),v=y==null?h:ar(y),h=new f(S,b+"leave",x,s,m),h.target=w,h.relatedTarget=v,S=null,Pn(m)===d&&(f=new f(p,b+"enter",y,s,m),f.target=v,f.relatedTarget=w,S=f),w=S,x&&y)t:{for(f=x,p=y,b=0,v=f;v;v=Zn(v))b++;for(v=0,S=p;S;S=Zn(S))v++;for(;0<b-v;)f=Zn(f),b--;for(;0<v-b;)p=Zn(p),v--;for(;b--;){if(f===p||p!==null&&f===p.alternate)break t;f=Zn(f),p=Zn(p)}f=null}else f=null;x!==null&&tm(u,h,x,f,!1),y!==null&&w!==null&&tm(u,w,y,f,!0)}}e:{if(h=d?ar(d):window,x=h.nodeName&&h.nodeName.toLowerCase(),x==="select"||x==="input"&&h.type==="file")var N=Ib;else if(Kh(h))if(df)N=Fb;else{N=Bb;var k=$b}else(x=h.nodeName)&&x.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(N=Db);if(N&&(N=N(t,d))){cf(u,N,s,m);break e}k&&k(t,h,d),t==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&Yc(h,"number",h.value)}switch(k=d?ar(d):window,t){case"focusin":(Kh(k)||k.contentEditable==="true")&&(rr=k,ad=d,Bi=null);break;case"focusout":Bi=ad=rr=null;break;case"mousedown":ld=!0;break;case"contextmenu":case"mouseup":case"dragend":ld=!1,Jh(u,s,m);break;case"selectionchange":if(Vb)break;case"keydown":case"keyup":Jh(u,s,m)}var j;if(vu)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else nr?lf(t,s)&&(E="onCompositionEnd"):t==="keydown"&&s.keyCode===229&&(E="onCompositionStart");E&&(af&&s.locale!=="ko"&&(nr||E!=="onCompositionStart"?E==="onCompositionEnd"&&nr&&(j=rf()):(Js=m,gu="value"in Js?Js.value:Js.textContent,nr=!0)),k=Ol(d,E),0<k.length&&(E=new Wh(E,t,null,s,m),u.push({event:E,listeners:k}),j?E.data=j:(j=of(s),j!==null&&(E.data=j)))),(j=Mb?Rb(t,s):Ab(t,s))&&(d=Ol(d,"onBeforeInput"),0<d.length&&(m=new Wh("onBeforeInput","beforeinput",null,s,m),u.push({event:m,listeners:d}),m.data=j))}vf(u,e)})}function na(t,e,s){return{instance:t,listener:e,currentTarget:s}}function Ol(t,e){for(var s=e+"Capture",r=[];t!==null;){var i=t,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Xi(t,s),a!=null&&r.unshift(na(t,a,i)),a=Xi(t,e),a!=null&&r.push(na(t,a,i))),t=t.return}return r}function Zn(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function tm(t,e,s,r,i){for(var a=e._reactName,l=[];s!==null&&s!==r;){var o=s,c=o.alternate,d=o.stateNode;if(c!==null&&c===r)break;o.tag===5&&d!==null&&(o=d,i?(c=Xi(s,a),c!=null&&l.unshift(na(s,c,o))):i||(c=Xi(s,a),c!=null&&l.push(na(s,c,o)))),s=s.return}l.length!==0&&t.push({event:e,listeners:l})}var Yb=/\r\n?/g,Qb=/\u0000|\uFFFD/g;function sm(t){return(typeof t=="string"?t:""+t).replace(Yb,`
`).replace(Qb,"")}function Ua(t,e,s){if(e=sm(e),sm(t)!==e&&s)throw Error(te(425))}function Il(){}var od=null,cd=null;function dd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ud=typeof setTimeout=="function"?setTimeout:void 0,Xb=typeof clearTimeout=="function"?clearTimeout:void 0,nm=typeof Promise=="function"?Promise:void 0,Gb=typeof queueMicrotask=="function"?queueMicrotask:typeof nm<"u"?function(t){return nm.resolve(null).then(t).catch(Jb)}:ud;function Jb(t){setTimeout(function(){throw t})}function nc(t,e){var s=e,r=0;do{var i=s.nextSibling;if(t.removeChild(s),i&&i.nodeType===8)if(s=i.data,s==="/$"){if(r===0){t.removeChild(i),Zi(e);return}r--}else s!=="$"&&s!=="$?"&&s!=="$!"||r++;s=i}while(s);Zi(e)}function an(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function rm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var s=t.data;if(s==="$"||s==="$!"||s==="$?"){if(e===0)return t;e--}else s==="/$"&&e++}t=t.previousSibling}return null}var Dr=Math.random().toString(36).slice(2),hs="__reactFiber$"+Dr,ra="__reactProps$"+Dr,Es="__reactContainer$"+Dr,hd="__reactEvents$"+Dr,Zb="__reactListeners$"+Dr,ev="__reactHandles$"+Dr;function Pn(t){var e=t[hs];if(e)return e;for(var s=t.parentNode;s;){if(e=s[Es]||s[hs]){if(s=e.alternate,e.child!==null||s!==null&&s.child!==null)for(t=rm(t);t!==null;){if(s=t[hs])return s;t=rm(t)}return e}t=s,s=t.parentNode}return null}function ja(t){return t=t[hs]||t[Es],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ar(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(te(33))}function fo(t){return t[ra]||null}var md=[],lr=-1;function yn(t){return{current:t}}function Ae(t){0>lr||(t.current=md[lr],md[lr]=null,lr--)}function Pe(t,e){lr++,md[lr]=t.current,t.current=e}var xn={},pt=yn(xn),kt=yn(!1),In=xn;function Sr(t,e){var s=t.type.contextTypes;if(!s)return xn;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in s)i[a]=e[a];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function St(t){return t=t.childContextTypes,t!=null}function $l(){Ae(kt),Ae(pt)}function im(t,e,s){if(pt.current!==xn)throw Error(te(168));Pe(pt,e),Pe(kt,s)}function jf(t,e,s){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return s;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(te(108,$y(t)||"Unknown",i));return Be({},s,r)}function Bl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||xn,In=pt.current,Pe(pt,t),Pe(kt,kt.current),!0}function am(t,e,s){var r=t.stateNode;if(!r)throw Error(te(169));s?(t=jf(t,e,In),r.__reactInternalMemoizedMergedChildContext=t,Ae(kt),Ae(pt),Pe(pt,t)):Ae(kt),Pe(kt,s)}var vs=null,go=!1,rc=!1;function wf(t){vs===null?vs=[t]:vs.push(t)}function tv(t){go=!0,wf(t)}function bn(){if(!rc&&vs!==null){rc=!0;var t=0,e=Se;try{var s=vs;for(Se=1;t<s.length;t++){var r=s[t];do r=r(!0);while(r!==null)}vs=null,go=!1}catch(i){throw vs!==null&&(vs=vs.slice(t+1)),Kx(mu,bn),i}finally{Se=e,rc=!1}}return null}var or=[],cr=0,Dl=null,Fl=0,$t=[],Bt=0,$n=null,Ns=1,js="";function Cn(t,e){or[cr++]=Fl,or[cr++]=Dl,Dl=t,Fl=e}function kf(t,e,s){$t[Bt++]=Ns,$t[Bt++]=js,$t[Bt++]=$n,$n=t;var r=Ns;t=js;var i=32-Zt(r)-1;r&=~(1<<i),s+=1;var a=32-Zt(e)+i;if(30<a){var l=i-i%5;a=(r&(1<<l)-1).toString(32),r>>=l,i-=l,Ns=1<<32-Zt(e)+i|s<<i|r,js=a+t}else Ns=1<<a|s<<i|r,js=t}function ju(t){t.return!==null&&(Cn(t,1),kf(t,1,0))}function wu(t){for(;t===Dl;)Dl=or[--cr],or[cr]=null,Fl=or[--cr],or[cr]=null;for(;t===$n;)$n=$t[--Bt],$t[Bt]=null,js=$t[--Bt],$t[Bt]=null,Ns=$t[--Bt],$t[Bt]=null}var Mt=null,_t=null,Oe=!1,Jt=null;function Sf(t,e){var s=Ft(5,null,null,0);s.elementType="DELETED",s.stateNode=e,s.return=t,e=t.deletions,e===null?(t.deletions=[s],t.flags|=16):e.push(s)}function lm(t,e){switch(t.tag){case 5:var s=t.type;return e=e.nodeType!==1||s.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Mt=t,_t=an(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Mt=t,_t=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(s=$n!==null?{id:Ns,overflow:js}:null,t.memoizedState={dehydrated:e,treeContext:s,retryLane:1073741824},s=Ft(18,null,null,0),s.stateNode=e,s.return=t,t.child=s,Mt=t,_t=null,!0):!1;default:return!1}}function pd(t){return(t.mode&1)!==0&&(t.flags&128)===0}function xd(t){if(Oe){var e=_t;if(e){var s=e;if(!lm(t,e)){if(pd(t))throw Error(te(418));e=an(s.nextSibling);var r=Mt;e&&lm(t,e)?Sf(r,s):(t.flags=t.flags&-4097|2,Oe=!1,Mt=t)}}else{if(pd(t))throw Error(te(418));t.flags=t.flags&-4097|2,Oe=!1,Mt=t}}}function om(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Mt=t}function Wa(t){if(t!==Mt)return!1;if(!Oe)return om(t),Oe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!dd(t.type,t.memoizedProps)),e&&(e=_t)){if(pd(t))throw Cf(),Error(te(418));for(;e;)Sf(t,e),e=an(e.nextSibling)}if(om(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(te(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var s=t.data;if(s==="/$"){if(e===0){_t=an(t.nextSibling);break e}e--}else s!=="$"&&s!=="$!"&&s!=="$?"||e++}t=t.nextSibling}_t=null}}else _t=Mt?an(t.stateNode.nextSibling):null;return!0}function Cf(){for(var t=_t;t;)t=an(t.nextSibling)}function Cr(){_t=Mt=null,Oe=!1}function ku(t){Jt===null?Jt=[t]:Jt.push(t)}var sv=_s.ReactCurrentBatchConfig;function ki(t,e,s){if(t=s.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(te(309));var r=s.stateNode}if(!r)throw Error(te(147,t));var i=r,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(l){var o=i.refs;l===null?delete o[a]:o[a]=l},e._stringRef=a,e)}if(typeof t!="string")throw Error(te(284));if(!s._owner)throw Error(te(290,t))}return t}function Va(t,e){throw t=Object.prototype.toString.call(e),Error(te(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function cm(t){var e=t._init;return e(t._payload)}function Ef(t){function e(p,b){if(t){var v=p.deletions;v===null?(p.deletions=[b],p.flags|=16):v.push(b)}}function s(p,b){if(!t)return null;for(;b!==null;)e(p,b),b=b.sibling;return null}function r(p,b){for(p=new Map;b!==null;)b.key!==null?p.set(b.key,b):p.set(b.index,b),b=b.sibling;return p}function i(p,b){return p=dn(p,b),p.index=0,p.sibling=null,p}function a(p,b,v){return p.index=v,t?(v=p.alternate,v!==null?(v=v.index,v<b?(p.flags|=2,b):v):(p.flags|=2,b)):(p.flags|=1048576,b)}function l(p){return t&&p.alternate===null&&(p.flags|=2),p}function o(p,b,v,S){return b===null||b.tag!==6?(b=uc(v,p.mode,S),b.return=p,b):(b=i(b,v),b.return=p,b)}function c(p,b,v,S){var N=v.type;return N===sr?m(p,b,v.props.children,S,v.key):b!==null&&(b.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Ys&&cm(N)===b.type)?(S=i(b,v.props),S.ref=ki(p,b,v),S.return=p,S):(S=vl(v.type,v.key,v.props,null,p.mode,S),S.ref=ki(p,b,v),S.return=p,S)}function d(p,b,v,S){return b===null||b.tag!==4||b.stateNode.containerInfo!==v.containerInfo||b.stateNode.implementation!==v.implementation?(b=hc(v,p.mode,S),b.return=p,b):(b=i(b,v.children||[]),b.return=p,b)}function m(p,b,v,S,N){return b===null||b.tag!==7?(b=An(v,p.mode,S,N),b.return=p,b):(b=i(b,v),b.return=p,b)}function u(p,b,v){if(typeof b=="string"&&b!==""||typeof b=="number")return b=uc(""+b,p.mode,v),b.return=p,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ra:return v=vl(b.type,b.key,b.props,null,p.mode,v),v.ref=ki(p,null,b),v.return=p,v;case tr:return b=hc(b,p.mode,v),b.return=p,b;case Ys:var S=b._init;return u(p,S(b._payload),v)}if(_i(b)||bi(b))return b=An(b,p.mode,v,null),b.return=p,b;Va(p,b)}return null}function h(p,b,v,S){var N=b!==null?b.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return N!==null?null:o(p,b,""+v,S);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Ra:return v.key===N?c(p,b,v,S):null;case tr:return v.key===N?d(p,b,v,S):null;case Ys:return N=v._init,h(p,b,N(v._payload),S)}if(_i(v)||bi(v))return N!==null?null:m(p,b,v,S,null);Va(p,v)}return null}function x(p,b,v,S,N){if(typeof S=="string"&&S!==""||typeof S=="number")return p=p.get(v)||null,o(b,p,""+S,N);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Ra:return p=p.get(S.key===null?v:S.key)||null,c(b,p,S,N);case tr:return p=p.get(S.key===null?v:S.key)||null,d(b,p,S,N);case Ys:var k=S._init;return x(p,b,v,k(S._payload),N)}if(_i(S)||bi(S))return p=p.get(v)||null,m(b,p,S,N,null);Va(b,S)}return null}function y(p,b,v,S){for(var N=null,k=null,j=b,E=b=0,_=null;j!==null&&E<v.length;E++){j.index>E?(_=j,j=null):_=j.sibling;var M=h(p,j,v[E],S);if(M===null){j===null&&(j=_);break}t&&j&&M.alternate===null&&e(p,j),b=a(M,b,E),k===null?N=M:k.sibling=M,k=M,j=_}if(E===v.length)return s(p,j),Oe&&Cn(p,E),N;if(j===null){for(;E<v.length;E++)j=u(p,v[E],S),j!==null&&(b=a(j,b,E),k===null?N=j:k.sibling=j,k=j);return Oe&&Cn(p,E),N}for(j=r(p,j);E<v.length;E++)_=x(j,p,E,v[E],S),_!==null&&(t&&_.alternate!==null&&j.delete(_.key===null?E:_.key),b=a(_,b,E),k===null?N=_:k.sibling=_,k=_);return t&&j.forEach(function(V){return e(p,V)}),Oe&&Cn(p,E),N}function f(p,b,v,S){var N=bi(v);if(typeof N!="function")throw Error(te(150));if(v=N.call(v),v==null)throw Error(te(151));for(var k=N=null,j=b,E=b=0,_=null,M=v.next();j!==null&&!M.done;E++,M=v.next()){j.index>E?(_=j,j=null):_=j.sibling;var V=h(p,j,M.value,S);if(V===null){j===null&&(j=_);break}t&&j&&V.alternate===null&&e(p,j),b=a(V,b,E),k===null?N=V:k.sibling=V,k=V,j=_}if(M.done)return s(p,j),Oe&&Cn(p,E),N;if(j===null){for(;!M.done;E++,M=v.next())M=u(p,M.value,S),M!==null&&(b=a(M,b,E),k===null?N=M:k.sibling=M,k=M);return Oe&&Cn(p,E),N}for(j=r(p,j);!M.done;E++,M=v.next())M=x(j,p,E,M.value,S),M!==null&&(t&&M.alternate!==null&&j.delete(M.key===null?E:M.key),b=a(M,b,E),k===null?N=M:k.sibling=M,k=M);return t&&j.forEach(function(B){return e(p,B)}),Oe&&Cn(p,E),N}function w(p,b,v,S){if(typeof v=="object"&&v!==null&&v.type===sr&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Ra:e:{for(var N=v.key,k=b;k!==null;){if(k.key===N){if(N=v.type,N===sr){if(k.tag===7){s(p,k.sibling),b=i(k,v.props.children),b.return=p,p=b;break e}}else if(k.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Ys&&cm(N)===k.type){s(p,k.sibling),b=i(k,v.props),b.ref=ki(p,k,v),b.return=p,p=b;break e}s(p,k);break}else e(p,k);k=k.sibling}v.type===sr?(b=An(v.props.children,p.mode,S,v.key),b.return=p,p=b):(S=vl(v.type,v.key,v.props,null,p.mode,S),S.ref=ki(p,b,v),S.return=p,p=S)}return l(p);case tr:e:{for(k=v.key;b!==null;){if(b.key===k)if(b.tag===4&&b.stateNode.containerInfo===v.containerInfo&&b.stateNode.implementation===v.implementation){s(p,b.sibling),b=i(b,v.children||[]),b.return=p,p=b;break e}else{s(p,b);break}else e(p,b);b=b.sibling}b=hc(v,p.mode,S),b.return=p,p=b}return l(p);case Ys:return k=v._init,w(p,b,k(v._payload),S)}if(_i(v))return y(p,b,v,S);if(bi(v))return f(p,b,v,S);Va(p,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,b!==null&&b.tag===6?(s(p,b.sibling),b=i(b,v),b.return=p,p=b):(s(p,b),b=uc(v,p.mode,S),b.return=p,p=b),l(p)):s(p,b)}return w}var Er=Ef(!0),Tf=Ef(!1),Ul=yn(null),Wl=null,dr=null,Su=null;function Cu(){Su=dr=Wl=null}function Eu(t){var e=Ul.current;Ae(Ul),t._currentValue=e}function fd(t,e,s){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===s)break;t=t.return}}function br(t,e){Wl=t,Su=dr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(wt=!0),t.firstContext=null)}function Wt(t){var e=t._currentValue;if(Su!==t)if(t={context:t,memoizedValue:e,next:null},dr===null){if(Wl===null)throw Error(te(308));dr=t,Wl.dependencies={lanes:0,firstContext:t}}else dr=dr.next=t;return e}var Ln=null;function Tu(t){Ln===null?Ln=[t]:Ln.push(t)}function Pf(t,e,s,r){var i=e.interleaved;return i===null?(s.next=s,Tu(e)):(s.next=i.next,i.next=s),e.interleaved=s,Ts(t,r)}function Ts(t,e){t.lanes|=e;var s=t.alternate;for(s!==null&&(s.lanes|=e),s=t,t=t.return;t!==null;)t.childLanes|=e,s=t.alternate,s!==null&&(s.childLanes|=e),s=t,t=t.return;return s.tag===3?s.stateNode:null}var Qs=!1;function Pu(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Lf(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ss(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ln(t,e,s){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,je&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ts(t,s)}return i=r.interleaved,i===null?(e.next=e,Tu(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ts(t,s)}function pl(t,e,s){if(e=e.updateQueue,e!==null&&(e=e.shared,(s&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,s|=r,e.lanes=s,pu(t,s)}}function dm(t,e){var s=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,s===r)){var i=null,a=null;if(s=s.firstBaseUpdate,s!==null){do{var l={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};a===null?i=a=l:a=a.next=l,s=s.next}while(s!==null);a===null?i=a=e:a=a.next=e}else i=a=e;s={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},t.updateQueue=s;return}t=s.lastBaseUpdate,t===null?s.firstBaseUpdate=e:t.next=e,s.lastBaseUpdate=e}function Vl(t,e,s,r){var i=t.updateQueue;Qs=!1;var a=i.firstBaseUpdate,l=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var c=o,d=c.next;c.next=null,l===null?a=d:l.next=d,l=c;var m=t.alternate;m!==null&&(m=m.updateQueue,o=m.lastBaseUpdate,o!==l&&(o===null?m.firstBaseUpdate=d:o.next=d,m.lastBaseUpdate=c))}if(a!==null){var u=i.baseState;l=0,m=d=c=null,o=a;do{var h=o.lane,x=o.eventTime;if((r&h)===h){m!==null&&(m=m.next={eventTime:x,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=t,f=o;switch(h=e,x=s,f.tag){case 1:if(y=f.payload,typeof y=="function"){u=y.call(x,u,h);break e}u=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=f.payload,h=typeof y=="function"?y.call(x,u,h):y,h==null)break e;u=Be({},u,h);break e;case 2:Qs=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[o]:h.push(o))}else x={eventTime:x,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},m===null?(d=m=x,c=u):m=m.next=x,l|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;h=o,o=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(m===null&&(c=u),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=m,e=i.shared.interleaved,e!==null){i=e;do l|=i.lane,i=i.next;while(i!==e)}else a===null&&(i.shared.lanes=0);Dn|=l,t.lanes=l,t.memoizedState=u}}function um(t,e,s){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=s,typeof i!="function")throw Error(te(191,i));i.call(r)}}}var wa={},xs=yn(wa),ia=yn(wa),aa=yn(wa);function _n(t){if(t===wa)throw Error(te(174));return t}function Lu(t,e){switch(Pe(aa,e),Pe(ia,t),Pe(xs,wa),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Xc(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Xc(e,t)}Ae(xs),Pe(xs,e)}function Tr(){Ae(xs),Ae(ia),Ae(aa)}function _f(t){_n(aa.current);var e=_n(xs.current),s=Xc(e,t.type);e!==s&&(Pe(ia,t),Pe(xs,s))}function _u(t){ia.current===t&&(Ae(xs),Ae(ia))}var Ie=yn(0);function ql(t){for(var e=t;e!==null;){if(e.tag===13){var s=e.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ic=[];function Mu(){for(var t=0;t<ic.length;t++)ic[t]._workInProgressVersionPrimary=null;ic.length=0}var xl=_s.ReactCurrentDispatcher,ac=_s.ReactCurrentBatchConfig,Bn=0,$e=null,Qe=null,Ze=null,Hl=!1,Di=!1,la=0,nv=0;function dt(){throw Error(te(321))}function Ru(t,e){if(e===null)return!1;for(var s=0;s<e.length&&s<t.length;s++)if(!ss(t[s],e[s]))return!1;return!0}function Au(t,e,s,r,i,a){if(Bn=a,$e=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,xl.current=t===null||t.memoizedState===null?lv:ov,t=s(r,i),Di){a=0;do{if(Di=!1,la=0,25<=a)throw Error(te(301));a+=1,Ze=Qe=null,e.updateQueue=null,xl.current=cv,t=s(r,i)}while(Di)}if(xl.current=Kl,e=Qe!==null&&Qe.next!==null,Bn=0,Ze=Qe=$e=null,Hl=!1,e)throw Error(te(300));return t}function zu(){var t=la!==0;return la=0,t}function us(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ze===null?$e.memoizedState=Ze=t:Ze=Ze.next=t,Ze}function Vt(){if(Qe===null){var t=$e.alternate;t=t!==null?t.memoizedState:null}else t=Qe.next;var e=Ze===null?$e.memoizedState:Ze.next;if(e!==null)Ze=e,Qe=t;else{if(t===null)throw Error(te(310));Qe=t,t={memoizedState:Qe.memoizedState,baseState:Qe.baseState,baseQueue:Qe.baseQueue,queue:Qe.queue,next:null},Ze===null?$e.memoizedState=Ze=t:Ze=Ze.next=t}return Ze}function oa(t,e){return typeof e=="function"?e(t):e}function lc(t){var e=Vt(),s=e.queue;if(s===null)throw Error(te(311));s.lastRenderedReducer=t;var r=Qe,i=r.baseQueue,a=s.pending;if(a!==null){if(i!==null){var l=i.next;i.next=a.next,a.next=l}r.baseQueue=i=a,s.pending=null}if(i!==null){a=i.next,r=r.baseState;var o=l=null,c=null,d=a;do{var m=d.lane;if((Bn&m)===m)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var u={lane:m,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(o=c=u,l=r):c=c.next=u,$e.lanes|=m,Dn|=m}d=d.next}while(d!==null&&d!==a);c===null?l=r:c.next=o,ss(r,e.memoizedState)||(wt=!0),e.memoizedState=r,e.baseState=l,e.baseQueue=c,s.lastRenderedState=r}if(t=s.interleaved,t!==null){i=t;do a=i.lane,$e.lanes|=a,Dn|=a,i=i.next;while(i!==t)}else i===null&&(s.lanes=0);return[e.memoizedState,s.dispatch]}function oc(t){var e=Vt(),s=e.queue;if(s===null)throw Error(te(311));s.lastRenderedReducer=t;var r=s.dispatch,i=s.pending,a=e.memoizedState;if(i!==null){s.pending=null;var l=i=i.next;do a=t(a,l.action),l=l.next;while(l!==i);ss(a,e.memoizedState)||(wt=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),s.lastRenderedState=a}return[a,r]}function Mf(){}function Rf(t,e){var s=$e,r=Vt(),i=e(),a=!ss(r.memoizedState,i);if(a&&(r.memoizedState=i,wt=!0),r=r.queue,Ou(Of.bind(null,s,r,t),[t]),r.getSnapshot!==e||a||Ze!==null&&Ze.memoizedState.tag&1){if(s.flags|=2048,ca(9,zf.bind(null,s,r,i,e),void 0,null),et===null)throw Error(te(349));Bn&30||Af(s,e,i)}return i}function Af(t,e,s){t.flags|=16384,t={getSnapshot:e,value:s},e=$e.updateQueue,e===null?(e={lastEffect:null,stores:null},$e.updateQueue=e,e.stores=[t]):(s=e.stores,s===null?e.stores=[t]:s.push(t))}function zf(t,e,s,r){e.value=s,e.getSnapshot=r,If(e)&&$f(t)}function Of(t,e,s){return s(function(){If(e)&&$f(t)})}function If(t){var e=t.getSnapshot;t=t.value;try{var s=e();return!ss(t,s)}catch{return!0}}function $f(t){var e=Ts(t,1);e!==null&&es(e,t,1,-1)}function hm(t){var e=us();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:oa,lastRenderedState:t},e.queue=t,t=t.dispatch=av.bind(null,$e,t),[e.memoizedState,t]}function ca(t,e,s,r){return t={tag:t,create:e,destroy:s,deps:r,next:null},e=$e.updateQueue,e===null?(e={lastEffect:null,stores:null},$e.updateQueue=e,e.lastEffect=t.next=t):(s=e.lastEffect,s===null?e.lastEffect=t.next=t:(r=s.next,s.next=t,t.next=r,e.lastEffect=t)),t}function Bf(){return Vt().memoizedState}function fl(t,e,s,r){var i=us();$e.flags|=t,i.memoizedState=ca(1|e,s,void 0,r===void 0?null:r)}function yo(t,e,s,r){var i=Vt();r=r===void 0?null:r;var a=void 0;if(Qe!==null){var l=Qe.memoizedState;if(a=l.destroy,r!==null&&Ru(r,l.deps)){i.memoizedState=ca(e,s,a,r);return}}$e.flags|=t,i.memoizedState=ca(1|e,s,a,r)}function mm(t,e){return fl(8390656,8,t,e)}function Ou(t,e){return yo(2048,8,t,e)}function Df(t,e){return yo(4,2,t,e)}function Ff(t,e){return yo(4,4,t,e)}function Uf(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Wf(t,e,s){return s=s!=null?s.concat([t]):null,yo(4,4,Uf.bind(null,e,t),s)}function Iu(){}function Vf(t,e){var s=Vt();e=e===void 0?null:e;var r=s.memoizedState;return r!==null&&e!==null&&Ru(e,r[1])?r[0]:(s.memoizedState=[t,e],t)}function qf(t,e){var s=Vt();e=e===void 0?null:e;var r=s.memoizedState;return r!==null&&e!==null&&Ru(e,r[1])?r[0]:(t=t(),s.memoizedState=[t,e],t)}function Hf(t,e,s){return Bn&21?(ss(s,e)||(s=Xx(),$e.lanes|=s,Dn|=s,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,wt=!0),t.memoizedState=s)}function rv(t,e){var s=Se;Se=s!==0&&4>s?s:4,t(!0);var r=ac.transition;ac.transition={};try{t(!1),e()}finally{Se=s,ac.transition=r}}function Kf(){return Vt().memoizedState}function iv(t,e,s){var r=cn(t);if(s={lane:r,action:s,hasEagerState:!1,eagerState:null,next:null},Yf(t))Qf(e,s);else if(s=Pf(t,e,s,r),s!==null){var i=gt();es(s,t,r,i),Xf(s,e,r)}}function av(t,e,s){var r=cn(t),i={lane:r,action:s,hasEagerState:!1,eagerState:null,next:null};if(Yf(t))Qf(e,i);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var l=e.lastRenderedState,o=a(l,s);if(i.hasEagerState=!0,i.eagerState=o,ss(o,l)){var c=e.interleaved;c===null?(i.next=i,Tu(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}s=Pf(t,e,i,r),s!==null&&(i=gt(),es(s,t,r,i),Xf(s,e,r))}}function Yf(t){var e=t.alternate;return t===$e||e!==null&&e===$e}function Qf(t,e){Di=Hl=!0;var s=t.pending;s===null?e.next=e:(e.next=s.next,s.next=e),t.pending=e}function Xf(t,e,s){if(s&4194240){var r=e.lanes;r&=t.pendingLanes,s|=r,e.lanes=s,pu(t,s)}}var Kl={readContext:Wt,useCallback:dt,useContext:dt,useEffect:dt,useImperativeHandle:dt,useInsertionEffect:dt,useLayoutEffect:dt,useMemo:dt,useReducer:dt,useRef:dt,useState:dt,useDebugValue:dt,useDeferredValue:dt,useTransition:dt,useMutableSource:dt,useSyncExternalStore:dt,useId:dt,unstable_isNewReconciler:!1},lv={readContext:Wt,useCallback:function(t,e){return us().memoizedState=[t,e===void 0?null:e],t},useContext:Wt,useEffect:mm,useImperativeHandle:function(t,e,s){return s=s!=null?s.concat([t]):null,fl(4194308,4,Uf.bind(null,e,t),s)},useLayoutEffect:function(t,e){return fl(4194308,4,t,e)},useInsertionEffect:function(t,e){return fl(4,2,t,e)},useMemo:function(t,e){var s=us();return e=e===void 0?null:e,t=t(),s.memoizedState=[t,e],t},useReducer:function(t,e,s){var r=us();return e=s!==void 0?s(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=iv.bind(null,$e,t),[r.memoizedState,t]},useRef:function(t){var e=us();return t={current:t},e.memoizedState=t},useState:hm,useDebugValue:Iu,useDeferredValue:function(t){return us().memoizedState=t},useTransition:function(){var t=hm(!1),e=t[0];return t=rv.bind(null,t[1]),us().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,s){var r=$e,i=us();if(Oe){if(s===void 0)throw Error(te(407));s=s()}else{if(s=e(),et===null)throw Error(te(349));Bn&30||Af(r,e,s)}i.memoizedState=s;var a={value:s,getSnapshot:e};return i.queue=a,mm(Of.bind(null,r,a,t),[t]),r.flags|=2048,ca(9,zf.bind(null,r,a,s,e),void 0,null),s},useId:function(){var t=us(),e=et.identifierPrefix;if(Oe){var s=js,r=Ns;s=(r&~(1<<32-Zt(r)-1)).toString(32)+s,e=":"+e+"R"+s,s=la++,0<s&&(e+="H"+s.toString(32)),e+=":"}else s=nv++,e=":"+e+"r"+s.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ov={readContext:Wt,useCallback:Vf,useContext:Wt,useEffect:Ou,useImperativeHandle:Wf,useInsertionEffect:Df,useLayoutEffect:Ff,useMemo:qf,useReducer:lc,useRef:Bf,useState:function(){return lc(oa)},useDebugValue:Iu,useDeferredValue:function(t){var e=Vt();return Hf(e,Qe.memoizedState,t)},useTransition:function(){var t=lc(oa)[0],e=Vt().memoizedState;return[t,e]},useMutableSource:Mf,useSyncExternalStore:Rf,useId:Kf,unstable_isNewReconciler:!1},cv={readContext:Wt,useCallback:Vf,useContext:Wt,useEffect:Ou,useImperativeHandle:Wf,useInsertionEffect:Df,useLayoutEffect:Ff,useMemo:qf,useReducer:oc,useRef:Bf,useState:function(){return oc(oa)},useDebugValue:Iu,useDeferredValue:function(t){var e=Vt();return Qe===null?e.memoizedState=t:Hf(e,Qe.memoizedState,t)},useTransition:function(){var t=oc(oa)[0],e=Vt().memoizedState;return[t,e]},useMutableSource:Mf,useSyncExternalStore:Rf,useId:Kf,unstable_isNewReconciler:!1};function Qt(t,e){if(t&&t.defaultProps){e=Be({},e),t=t.defaultProps;for(var s in t)e[s]===void 0&&(e[s]=t[s]);return e}return e}function gd(t,e,s,r){e=t.memoizedState,s=s(r,e),s=s==null?e:Be({},e,s),t.memoizedState=s,t.lanes===0&&(t.updateQueue.baseState=s)}var bo={isMounted:function(t){return(t=t._reactInternals)?Xn(t)===t:!1},enqueueSetState:function(t,e,s){t=t._reactInternals;var r=gt(),i=cn(t),a=Ss(r,i);a.payload=e,s!=null&&(a.callback=s),e=ln(t,a,i),e!==null&&(es(e,t,i,r),pl(e,t,i))},enqueueReplaceState:function(t,e,s){t=t._reactInternals;var r=gt(),i=cn(t),a=Ss(r,i);a.tag=1,a.payload=e,s!=null&&(a.callback=s),e=ln(t,a,i),e!==null&&(es(e,t,i,r),pl(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var s=gt(),r=cn(t),i=Ss(s,r);i.tag=2,e!=null&&(i.callback=e),e=ln(t,i,r),e!==null&&(es(e,t,r,s),pl(e,t,r))}};function pm(t,e,s,r,i,a,l){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,a,l):e.prototype&&e.prototype.isPureReactComponent?!ta(s,r)||!ta(i,a):!0}function Gf(t,e,s){var r=!1,i=xn,a=e.contextType;return typeof a=="object"&&a!==null?a=Wt(a):(i=St(e)?In:pt.current,r=e.contextTypes,a=(r=r!=null)?Sr(t,i):xn),e=new e(s,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=bo,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function xm(t,e,s,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(s,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(s,r),e.state!==t&&bo.enqueueReplaceState(e,e.state,null)}function yd(t,e,s,r){var i=t.stateNode;i.props=s,i.state=t.memoizedState,i.refs={},Pu(t);var a=e.contextType;typeof a=="object"&&a!==null?i.context=Wt(a):(a=St(e)?In:pt.current,i.context=Sr(t,a)),i.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(gd(t,e,a,s),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&bo.enqueueReplaceState(i,i.state,null),Vl(t,s,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Pr(t,e){try{var s="",r=e;do s+=Iy(r),r=r.return;while(r);var i=s}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:i,digest:null}}function cc(t,e,s){return{value:t,source:null,stack:s??null,digest:e??null}}function bd(t,e){try{console.error(e.value)}catch(s){setTimeout(function(){throw s})}}var dv=typeof WeakMap=="function"?WeakMap:Map;function Jf(t,e,s){s=Ss(-1,s),s.tag=3,s.payload={element:null};var r=e.value;return s.callback=function(){Ql||(Ql=!0,Pd=r),bd(t,e)},s}function Zf(t,e,s){s=Ss(-1,s),s.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;s.payload=function(){return r(i)},s.callback=function(){bd(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(s.callback=function(){bd(t,e),typeof r!="function"&&(on===null?on=new Set([this]):on.add(this));var l=e.stack;this.componentDidCatch(e.value,{componentStack:l!==null?l:""})}),s}function fm(t,e,s){var r=t.pingCache;if(r===null){r=t.pingCache=new dv;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(s)||(i.add(s),t=kv.bind(null,t,e,s),e.then(t,t))}function gm(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ym(t,e,s,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(e=Ss(-1,1),e.tag=2,ln(s,e,1))),s.lanes|=1),t)}var uv=_s.ReactCurrentOwner,wt=!1;function ft(t,e,s,r){e.child=t===null?Tf(e,null,s,r):Er(e,t.child,s,r)}function bm(t,e,s,r,i){s=s.render;var a=e.ref;return br(e,i),r=Au(t,e,s,r,a,i),s=zu(),t!==null&&!wt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ps(t,e,i)):(Oe&&s&&ju(e),e.flags|=1,ft(t,e,r,i),e.child)}function vm(t,e,s,r,i){if(t===null){var a=s.type;return typeof a=="function"&&!qu(a)&&a.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(e.tag=15,e.type=a,e0(t,e,a,r,i)):(t=vl(s.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&i)){var l=a.memoizedProps;if(s=s.compare,s=s!==null?s:ta,s(l,r)&&t.ref===e.ref)return Ps(t,e,i)}return e.flags|=1,t=dn(a,r),t.ref=e.ref,t.return=e,e.child=t}function e0(t,e,s,r,i){if(t!==null){var a=t.memoizedProps;if(ta(a,r)&&t.ref===e.ref)if(wt=!1,e.pendingProps=r=a,(t.lanes&i)!==0)t.flags&131072&&(wt=!0);else return e.lanes=t.lanes,Ps(t,e,i)}return vd(t,e,s,r,i)}function t0(t,e,s){var r=e.pendingProps,i=r.children,a=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pe(hr,Lt),Lt|=s;else{if(!(s&1073741824))return t=a!==null?a.baseLanes|s:s,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Pe(hr,Lt),Lt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:s,Pe(hr,Lt),Lt|=r}else a!==null?(r=a.baseLanes|s,e.memoizedState=null):r=s,Pe(hr,Lt),Lt|=r;return ft(t,e,i,s),e.child}function s0(t,e){var s=e.ref;(t===null&&s!==null||t!==null&&t.ref!==s)&&(e.flags|=512,e.flags|=2097152)}function vd(t,e,s,r,i){var a=St(s)?In:pt.current;return a=Sr(e,a),br(e,i),s=Au(t,e,s,r,a,i),r=zu(),t!==null&&!wt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ps(t,e,i)):(Oe&&r&&ju(e),e.flags|=1,ft(t,e,s,i),e.child)}function Nm(t,e,s,r,i){if(St(s)){var a=!0;Bl(e)}else a=!1;if(br(e,i),e.stateNode===null)gl(t,e),Gf(e,s,r),yd(e,s,r,i),r=!0;else if(t===null){var l=e.stateNode,o=e.memoizedProps;l.props=o;var c=l.context,d=s.contextType;typeof d=="object"&&d!==null?d=Wt(d):(d=St(s)?In:pt.current,d=Sr(e,d));var m=s.getDerivedStateFromProps,u=typeof m=="function"||typeof l.getSnapshotBeforeUpdate=="function";u||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==r||c!==d)&&xm(e,l,r,d),Qs=!1;var h=e.memoizedState;l.state=h,Vl(e,r,l,i),c=e.memoizedState,o!==r||h!==c||kt.current||Qs?(typeof m=="function"&&(gd(e,s,m,r),c=e.memoizedState),(o=Qs||pm(e,s,o,r,h,c,d))?(u||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(e.flags|=4194308)):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),l.props=r,l.state=c,l.context=d,r=o):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{l=e.stateNode,Lf(t,e),o=e.memoizedProps,d=e.type===e.elementType?o:Qt(e.type,o),l.props=d,u=e.pendingProps,h=l.context,c=s.contextType,typeof c=="object"&&c!==null?c=Wt(c):(c=St(s)?In:pt.current,c=Sr(e,c));var x=s.getDerivedStateFromProps;(m=typeof x=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==u||h!==c)&&xm(e,l,r,c),Qs=!1,h=e.memoizedState,l.state=h,Vl(e,r,l,i);var y=e.memoizedState;o!==u||h!==y||kt.current||Qs?(typeof x=="function"&&(gd(e,s,x,r),y=e.memoizedState),(d=Qs||pm(e,s,d,r,h,y,c)||!1)?(m||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,y,c),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,y,c)),typeof l.componentDidUpdate=="function"&&(e.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),l.props=r,l.state=y,l.context=c,r=d):(typeof l.componentDidUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return Nd(t,e,s,r,a,i)}function Nd(t,e,s,r,i,a){s0(t,e);var l=(e.flags&128)!==0;if(!r&&!l)return i&&am(e,s,!1),Ps(t,e,a);r=e.stateNode,uv.current=e;var o=l&&typeof s.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&l?(e.child=Er(e,t.child,null,a),e.child=Er(e,null,o,a)):ft(t,e,o,a),e.memoizedState=r.state,i&&am(e,s,!0),e.child}function n0(t){var e=t.stateNode;e.pendingContext?im(t,e.pendingContext,e.pendingContext!==e.context):e.context&&im(t,e.context,!1),Lu(t,e.containerInfo)}function jm(t,e,s,r,i){return Cr(),ku(i),e.flags|=256,ft(t,e,s,r),e.child}var jd={dehydrated:null,treeContext:null,retryLane:0};function wd(t){return{baseLanes:t,cachePool:null,transitions:null}}function r0(t,e,s){var r=e.pendingProps,i=Ie.current,a=!1,l=(e.flags&128)!==0,o;if((o=l)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Pe(Ie,i&1),t===null)return xd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=r.children,t=r.fallback,a?(r=e.mode,a=e.child,l={mode:"hidden",children:l},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=l):a=jo(l,r,0,null),t=An(t,r,s,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=wd(s),e.memoizedState=jd,t):$u(e,l));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return hv(t,e,l,r,o,i,s);if(a){a=r.fallback,l=e.mode,i=t.child,o=i.sibling;var c={mode:"hidden",children:r.children};return!(l&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=dn(i,c),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?a=dn(o,a):(a=An(a,l,s,null),a.flags|=2),a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,l=t.child.memoizedState,l=l===null?wd(s):{baseLanes:l.baseLanes|s,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=t.childLanes&~s,e.memoizedState=jd,r}return a=t.child,t=a.sibling,r=dn(a,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=s),r.return=e,r.sibling=null,t!==null&&(s=e.deletions,s===null?(e.deletions=[t],e.flags|=16):s.push(t)),e.child=r,e.memoizedState=null,r}function $u(t,e){return e=jo({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function qa(t,e,s,r){return r!==null&&ku(r),Er(e,t.child,null,s),t=$u(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function hv(t,e,s,r,i,a,l){if(s)return e.flags&256?(e.flags&=-257,r=cc(Error(te(422))),qa(t,e,l,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=r.fallback,i=e.mode,r=jo({mode:"visible",children:r.children},i,0,null),a=An(a,i,l,null),a.flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,e.mode&1&&Er(e,t.child,null,l),e.child.memoizedState=wd(l),e.memoizedState=jd,a);if(!(e.mode&1))return qa(t,e,l,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,a=Error(te(419)),r=cc(a,r,void 0),qa(t,e,l,r)}if(o=(l&t.childLanes)!==0,wt||o){if(r=et,r!==null){switch(l&-l){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|l)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,Ts(t,i),es(r,t,i,-1))}return Vu(),r=cc(Error(te(421))),qa(t,e,l,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=Sv.bind(null,t),i._reactRetry=e,null):(t=a.treeContext,_t=an(i.nextSibling),Mt=e,Oe=!0,Jt=null,t!==null&&($t[Bt++]=Ns,$t[Bt++]=js,$t[Bt++]=$n,Ns=t.id,js=t.overflow,$n=e),e=$u(e,r.children),e.flags|=4096,e)}function wm(t,e,s){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),fd(t.return,e,s)}function dc(t,e,s,r,i){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:s,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=s,a.tailMode=i)}function i0(t,e,s){var r=e.pendingProps,i=r.revealOrder,a=r.tail;if(ft(t,e,r.children,s),r=Ie.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&wm(t,s,e);else if(t.tag===19)wm(t,s,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Pe(Ie,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(s=e.child,i=null;s!==null;)t=s.alternate,t!==null&&ql(t)===null&&(i=s),s=s.sibling;s=i,s===null?(i=e.child,e.child=null):(i=s.sibling,s.sibling=null),dc(e,!1,i,s,a);break;case"backwards":for(s=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&ql(t)===null){e.child=i;break}t=i.sibling,i.sibling=s,s=i,i=t}dc(e,!0,s,null,a);break;case"together":dc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function gl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ps(t,e,s){if(t!==null&&(e.dependencies=t.dependencies),Dn|=e.lanes,!(s&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(te(153));if(e.child!==null){for(t=e.child,s=dn(t,t.pendingProps),e.child=s,s.return=e;t.sibling!==null;)t=t.sibling,s=s.sibling=dn(t,t.pendingProps),s.return=e;s.sibling=null}return e.child}function mv(t,e,s){switch(e.tag){case 3:n0(e),Cr();break;case 5:_f(e);break;case 1:St(e.type)&&Bl(e);break;case 4:Lu(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Pe(Ul,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Pe(Ie,Ie.current&1),e.flags|=128,null):s&e.child.childLanes?r0(t,e,s):(Pe(Ie,Ie.current&1),t=Ps(t,e,s),t!==null?t.sibling:null);Pe(Ie,Ie.current&1);break;case 19:if(r=(s&e.childLanes)!==0,t.flags&128){if(r)return i0(t,e,s);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Pe(Ie,Ie.current),r)break;return null;case 22:case 23:return e.lanes=0,t0(t,e,s)}return Ps(t,e,s)}var a0,kd,l0,o0;a0=function(t,e){for(var s=e.child;s!==null;){if(s.tag===5||s.tag===6)t.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};kd=function(){};l0=function(t,e,s,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,_n(xs.current);var a=null;switch(s){case"input":i=Hc(t,i),r=Hc(t,r),a=[];break;case"select":i=Be({},i,{value:void 0}),r=Be({},r,{value:void 0}),a=[];break;case"textarea":i=Qc(t,i),r=Qc(t,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Il)}Gc(s,r);var l;s=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var o=i[d];for(l in o)o.hasOwnProperty(l)&&(s||(s={}),s[l]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Yi.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in r){var c=r[d];if(o=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&c!==o&&(c!=null||o!=null))if(d==="style")if(o){for(l in o)!o.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(s||(s={}),s[l]="");for(l in c)c.hasOwnProperty(l)&&o[l]!==c[l]&&(s||(s={}),s[l]=c[l])}else s||(a||(a=[]),a.push(d,s)),s=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(a=a||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Yi.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Me("scroll",t),a||o===c||(a=[])):(a=a||[]).push(d,c))}s&&(a=a||[]).push("style",s);var d=a;(e.updateQueue=d)&&(e.flags|=4)}};o0=function(t,e,s,r){s!==r&&(e.flags|=4)};function Si(t,e){if(!Oe)switch(t.tailMode){case"hidden":e=t.tail;for(var s=null;e!==null;)e.alternate!==null&&(s=e),e=e.sibling;s===null?t.tail=null:s.sibling=null;break;case"collapsed":s=t.tail;for(var r=null;s!==null;)s.alternate!==null&&(r=s),s=s.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ut(t){var e=t.alternate!==null&&t.alternate.child===t.child,s=0,r=0;if(e)for(var i=t.child;i!==null;)s|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)s|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=s,e}function pv(t,e,s){var r=e.pendingProps;switch(wu(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ut(e),null;case 1:return St(e.type)&&$l(),ut(e),null;case 3:return r=e.stateNode,Tr(),Ae(kt),Ae(pt),Mu(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Wa(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Jt!==null&&(Md(Jt),Jt=null))),kd(t,e),ut(e),null;case 5:_u(e);var i=_n(aa.current);if(s=e.type,t!==null&&e.stateNode!=null)l0(t,e,s,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(te(166));return ut(e),null}if(t=_n(xs.current),Wa(e)){r=e.stateNode,s=e.type;var a=e.memoizedProps;switch(r[hs]=e,r[ra]=a,t=(e.mode&1)!==0,s){case"dialog":Me("cancel",r),Me("close",r);break;case"iframe":case"object":case"embed":Me("load",r);break;case"video":case"audio":for(i=0;i<Ri.length;i++)Me(Ri[i],r);break;case"source":Me("error",r);break;case"img":case"image":case"link":Me("error",r),Me("load",r);break;case"details":Me("toggle",r);break;case"input":Mh(r,a),Me("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Me("invalid",r);break;case"textarea":Ah(r,a),Me("invalid",r)}Gc(s,a),i=null;for(var l in a)if(a.hasOwnProperty(l)){var o=a[l];l==="children"?typeof o=="string"?r.textContent!==o&&(a.suppressHydrationWarning!==!0&&Ua(r.textContent,o,t),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Ua(r.textContent,o,t),i=["children",""+o]):Yi.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&Me("scroll",r)}switch(s){case"input":Aa(r),Rh(r,a,!0);break;case"textarea":Aa(r),zh(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=Il)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{l=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=zx(s)),t==="http://www.w3.org/1999/xhtml"?s==="script"?(t=l.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=l.createElement(s,{is:r.is}):(t=l.createElement(s),s==="select"&&(l=t,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):t=l.createElementNS(t,s),t[hs]=e,t[ra]=r,a0(t,e,!1,!1),e.stateNode=t;e:{switch(l=Jc(s,r),s){case"dialog":Me("cancel",t),Me("close",t),i=r;break;case"iframe":case"object":case"embed":Me("load",t),i=r;break;case"video":case"audio":for(i=0;i<Ri.length;i++)Me(Ri[i],t);i=r;break;case"source":Me("error",t),i=r;break;case"img":case"image":case"link":Me("error",t),Me("load",t),i=r;break;case"details":Me("toggle",t),i=r;break;case"input":Mh(t,r),i=Hc(t,r),Me("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Be({},r,{value:void 0}),Me("invalid",t);break;case"textarea":Ah(t,r),i=Qc(t,r),Me("invalid",t);break;default:i=r}Gc(s,i),o=i;for(a in o)if(o.hasOwnProperty(a)){var c=o[a];a==="style"?$x(t,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Ox(t,c)):a==="children"?typeof c=="string"?(s!=="textarea"||c!=="")&&Qi(t,c):typeof c=="number"&&Qi(t,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Yi.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Me("scroll",t):c!=null&&ou(t,a,c,l))}switch(s){case"input":Aa(t),Rh(t,r,!1);break;case"textarea":Aa(t),zh(t);break;case"option":r.value!=null&&t.setAttribute("value",""+pn(r.value));break;case"select":t.multiple=!!r.multiple,a=r.value,a!=null?xr(t,!!r.multiple,a,!1):r.defaultValue!=null&&xr(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Il)}switch(s){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ut(e),null;case 6:if(t&&e.stateNode!=null)o0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(te(166));if(s=_n(aa.current),_n(xs.current),Wa(e)){if(r=e.stateNode,s=e.memoizedProps,r[hs]=e,(a=r.nodeValue!==s)&&(t=Mt,t!==null))switch(t.tag){case 3:Ua(r.nodeValue,s,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ua(r.nodeValue,s,(t.mode&1)!==0)}a&&(e.flags|=4)}else r=(s.nodeType===9?s:s.ownerDocument).createTextNode(r),r[hs]=e,e.stateNode=r}return ut(e),null;case 13:if(Ae(Ie),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Oe&&_t!==null&&e.mode&1&&!(e.flags&128))Cf(),Cr(),e.flags|=98560,a=!1;else if(a=Wa(e),r!==null&&r.dehydrated!==null){if(t===null){if(!a)throw Error(te(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(te(317));a[hs]=e}else Cr(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ut(e),a=!1}else Jt!==null&&(Md(Jt),Jt=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=s,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ie.current&1?Xe===0&&(Xe=3):Vu())),e.updateQueue!==null&&(e.flags|=4),ut(e),null);case 4:return Tr(),kd(t,e),t===null&&sa(e.stateNode.containerInfo),ut(e),null;case 10:return Eu(e.type._context),ut(e),null;case 17:return St(e.type)&&$l(),ut(e),null;case 19:if(Ae(Ie),a=e.memoizedState,a===null)return ut(e),null;if(r=(e.flags&128)!==0,l=a.rendering,l===null)if(r)Si(a,!1);else{if(Xe!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(l=ql(t),l!==null){for(e.flags|=128,Si(a,!1),r=l.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=s,s=e.child;s!==null;)a=s,t=r,a.flags&=14680066,l=a.alternate,l===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,t=l.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),s=s.sibling;return Pe(Ie,Ie.current&1|2),e.child}t=t.sibling}a.tail!==null&&Ue()>Lr&&(e.flags|=128,r=!0,Si(a,!1),e.lanes=4194304)}else{if(!r)if(t=ql(l),t!==null){if(e.flags|=128,r=!0,s=t.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),Si(a,!0),a.tail===null&&a.tailMode==="hidden"&&!l.alternate&&!Oe)return ut(e),null}else 2*Ue()-a.renderingStartTime>Lr&&s!==1073741824&&(e.flags|=128,r=!0,Si(a,!1),e.lanes=4194304);a.isBackwards?(l.sibling=e.child,e.child=l):(s=a.last,s!==null?s.sibling=l:e.child=l,a.last=l)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Ue(),e.sibling=null,s=Ie.current,Pe(Ie,r?s&1|2:s&1),e):(ut(e),null);case 22:case 23:return Wu(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Lt&1073741824&&(ut(e),e.subtreeFlags&6&&(e.flags|=8192)):ut(e),null;case 24:return null;case 25:return null}throw Error(te(156,e.tag))}function xv(t,e){switch(wu(e),e.tag){case 1:return St(e.type)&&$l(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Tr(),Ae(kt),Ae(pt),Mu(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return _u(e),null;case 13:if(Ae(Ie),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(te(340));Cr()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ae(Ie),null;case 4:return Tr(),null;case 10:return Eu(e.type._context),null;case 22:case 23:return Wu(),null;case 24:return null;default:return null}}var Ha=!1,ht=!1,fv=typeof WeakSet=="function"?WeakSet:Set,re=null;function ur(t,e){var s=t.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(r){Fe(t,e,r)}else s.current=null}function Sd(t,e,s){try{s()}catch(r){Fe(t,e,r)}}var km=!1;function gv(t,e){if(od=Al,t=mf(),Nu(t)){if("selectionStart"in t)var s={start:t.selectionStart,end:t.selectionEnd};else e:{s=(s=t.ownerDocument)&&s.defaultView||window;var r=s.getSelection&&s.getSelection();if(r&&r.rangeCount!==0){s=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{s.nodeType,a.nodeType}catch{s=null;break e}var l=0,o=-1,c=-1,d=0,m=0,u=t,h=null;t:for(;;){for(var x;u!==s||i!==0&&u.nodeType!==3||(o=l+i),u!==a||r!==0&&u.nodeType!==3||(c=l+r),u.nodeType===3&&(l+=u.nodeValue.length),(x=u.firstChild)!==null;)h=u,u=x;for(;;){if(u===t)break t;if(h===s&&++d===i&&(o=l),h===a&&++m===r&&(c=l),(x=u.nextSibling)!==null)break;u=h,h=u.parentNode}u=x}s=o===-1||c===-1?null:{start:o,end:c}}else s=null}s=s||{start:0,end:0}}else s=null;for(cd={focusedElem:t,selectionRange:s},Al=!1,re=e;re!==null;)if(e=re,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,re=t;else for(;re!==null;){e=re;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var f=y.memoizedProps,w=y.memoizedState,p=e.stateNode,b=p.getSnapshotBeforeUpdate(e.elementType===e.type?f:Qt(e.type,f),w);p.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(te(163))}}catch(S){Fe(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,re=t;break}re=e.return}return y=km,km=!1,y}function Fi(t,e,s){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var a=i.destroy;i.destroy=void 0,a!==void 0&&Sd(e,s,a)}i=i.next}while(i!==r)}}function vo(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var s=e=e.next;do{if((s.tag&t)===t){var r=s.create;s.destroy=r()}s=s.next}while(s!==e)}}function Cd(t){var e=t.ref;if(e!==null){var s=t.stateNode;switch(t.tag){case 5:t=s;break;default:t=s}typeof e=="function"?e(t):e.current=t}}function c0(t){var e=t.alternate;e!==null&&(t.alternate=null,c0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[hs],delete e[ra],delete e[hd],delete e[Zb],delete e[ev])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function d0(t){return t.tag===5||t.tag===3||t.tag===4}function Sm(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||d0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ed(t,e,s){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?s.nodeType===8?s.parentNode.insertBefore(t,e):s.insertBefore(t,e):(s.nodeType===8?(e=s.parentNode,e.insertBefore(t,s)):(e=s,e.appendChild(t)),s=s._reactRootContainer,s!=null||e.onclick!==null||(e.onclick=Il));else if(r!==4&&(t=t.child,t!==null))for(Ed(t,e,s),t=t.sibling;t!==null;)Ed(t,e,s),t=t.sibling}function Td(t,e,s){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?s.insertBefore(t,e):s.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Td(t,e,s),t=t.sibling;t!==null;)Td(t,e,s),t=t.sibling}var nt=null,Xt=!1;function Hs(t,e,s){for(s=s.child;s!==null;)u0(t,e,s),s=s.sibling}function u0(t,e,s){if(ps&&typeof ps.onCommitFiberUnmount=="function")try{ps.onCommitFiberUnmount(ho,s)}catch{}switch(s.tag){case 5:ht||ur(s,e);case 6:var r=nt,i=Xt;nt=null,Hs(t,e,s),nt=r,Xt=i,nt!==null&&(Xt?(t=nt,s=s.stateNode,t.nodeType===8?t.parentNode.removeChild(s):t.removeChild(s)):nt.removeChild(s.stateNode));break;case 18:nt!==null&&(Xt?(t=nt,s=s.stateNode,t.nodeType===8?nc(t.parentNode,s):t.nodeType===1&&nc(t,s),Zi(t)):nc(nt,s.stateNode));break;case 4:r=nt,i=Xt,nt=s.stateNode.containerInfo,Xt=!0,Hs(t,e,s),nt=r,Xt=i;break;case 0:case 11:case 14:case 15:if(!ht&&(r=s.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,l=a.destroy;a=a.tag,l!==void 0&&(a&2||a&4)&&Sd(s,e,l),i=i.next}while(i!==r)}Hs(t,e,s);break;case 1:if(!ht&&(ur(s,e),r=s.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=s.memoizedProps,r.state=s.memoizedState,r.componentWillUnmount()}catch(o){Fe(s,e,o)}Hs(t,e,s);break;case 21:Hs(t,e,s);break;case 22:s.mode&1?(ht=(r=ht)||s.memoizedState!==null,Hs(t,e,s),ht=r):Hs(t,e,s);break;default:Hs(t,e,s)}}function Cm(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var s=t.stateNode;s===null&&(s=t.stateNode=new fv),e.forEach(function(r){var i=Cv.bind(null,t,r);s.has(r)||(s.add(r),r.then(i,i))})}}function Yt(t,e){var s=e.deletions;if(s!==null)for(var r=0;r<s.length;r++){var i=s[r];try{var a=t,l=e,o=l;e:for(;o!==null;){switch(o.tag){case 5:nt=o.stateNode,Xt=!1;break e;case 3:nt=o.stateNode.containerInfo,Xt=!0;break e;case 4:nt=o.stateNode.containerInfo,Xt=!0;break e}o=o.return}if(nt===null)throw Error(te(160));u0(a,l,i),nt=null,Xt=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){Fe(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)h0(e,t),e=e.sibling}function h0(t,e){var s=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Yt(e,t),os(t),r&4){try{Fi(3,t,t.return),vo(3,t)}catch(f){Fe(t,t.return,f)}try{Fi(5,t,t.return)}catch(f){Fe(t,t.return,f)}}break;case 1:Yt(e,t),os(t),r&512&&s!==null&&ur(s,s.return);break;case 5:if(Yt(e,t),os(t),r&512&&s!==null&&ur(s,s.return),t.flags&32){var i=t.stateNode;try{Qi(i,"")}catch(f){Fe(t,t.return,f)}}if(r&4&&(i=t.stateNode,i!=null)){var a=t.memoizedProps,l=s!==null?s.memoizedProps:a,o=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&Rx(i,a),Jc(o,l);var d=Jc(o,a);for(l=0;l<c.length;l+=2){var m=c[l],u=c[l+1];m==="style"?$x(i,u):m==="dangerouslySetInnerHTML"?Ox(i,u):m==="children"?Qi(i,u):ou(i,m,u,d)}switch(o){case"input":Kc(i,a);break;case"textarea":Ax(i,a);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var x=a.value;x!=null?xr(i,!!a.multiple,x,!1):h!==!!a.multiple&&(a.defaultValue!=null?xr(i,!!a.multiple,a.defaultValue,!0):xr(i,!!a.multiple,a.multiple?[]:"",!1))}i[ra]=a}catch(f){Fe(t,t.return,f)}}break;case 6:if(Yt(e,t),os(t),r&4){if(t.stateNode===null)throw Error(te(162));i=t.stateNode,a=t.memoizedProps;try{i.nodeValue=a}catch(f){Fe(t,t.return,f)}}break;case 3:if(Yt(e,t),os(t),r&4&&s!==null&&s.memoizedState.isDehydrated)try{Zi(e.containerInfo)}catch(f){Fe(t,t.return,f)}break;case 4:Yt(e,t),os(t);break;case 13:Yt(e,t),os(t),i=t.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(Fu=Ue())),r&4&&Cm(t);break;case 22:if(m=s!==null&&s.memoizedState!==null,t.mode&1?(ht=(d=ht)||m,Yt(e,t),ht=d):Yt(e,t),os(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!m&&t.mode&1)for(re=t,m=t.child;m!==null;){for(u=re=m;re!==null;){switch(h=re,x=h.child,h.tag){case 0:case 11:case 14:case 15:Fi(4,h,h.return);break;case 1:ur(h,h.return);var y=h.stateNode;if(typeof y.componentWillUnmount=="function"){r=h,s=h.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(f){Fe(r,s,f)}}break;case 5:ur(h,h.return);break;case 22:if(h.memoizedState!==null){Tm(u);continue}}x!==null?(x.return=h,re=x):Tm(u)}m=m.sibling}e:for(m=null,u=t;;){if(u.tag===5){if(m===null){m=u;try{i=u.stateNode,d?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=u.stateNode,c=u.memoizedProps.style,l=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=Ix("display",l))}catch(f){Fe(t,t.return,f)}}}else if(u.tag===6){if(m===null)try{u.stateNode.nodeValue=d?"":u.memoizedProps}catch(f){Fe(t,t.return,f)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===t)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===t)break e;for(;u.sibling===null;){if(u.return===null||u.return===t)break e;m===u&&(m=null),u=u.return}m===u&&(m=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:Yt(e,t),os(t),r&4&&Cm(t);break;case 21:break;default:Yt(e,t),os(t)}}function os(t){var e=t.flags;if(e&2){try{e:{for(var s=t.return;s!==null;){if(d0(s)){var r=s;break e}s=s.return}throw Error(te(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Qi(i,""),r.flags&=-33);var a=Sm(t);Td(t,a,i);break;case 3:case 4:var l=r.stateNode.containerInfo,o=Sm(t);Ed(t,o,l);break;default:throw Error(te(161))}}catch(c){Fe(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function yv(t,e,s){re=t,m0(t)}function m0(t,e,s){for(var r=(t.mode&1)!==0;re!==null;){var i=re,a=i.child;if(i.tag===22&&r){var l=i.memoizedState!==null||Ha;if(!l){var o=i.alternate,c=o!==null&&o.memoizedState!==null||ht;o=Ha;var d=ht;if(Ha=l,(ht=c)&&!d)for(re=i;re!==null;)l=re,c=l.child,l.tag===22&&l.memoizedState!==null?Pm(i):c!==null?(c.return=l,re=c):Pm(i);for(;a!==null;)re=a,m0(a),a=a.sibling;re=i,Ha=o,ht=d}Em(t)}else i.subtreeFlags&8772&&a!==null?(a.return=i,re=a):Em(t)}}function Em(t){for(;re!==null;){var e=re;if(e.flags&8772){var s=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ht||vo(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ht)if(s===null)r.componentDidMount();else{var i=e.elementType===e.type?s.memoizedProps:Qt(e.type,s.memoizedProps);r.componentDidUpdate(i,s.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&um(e,a,r);break;case 3:var l=e.updateQueue;if(l!==null){if(s=null,e.child!==null)switch(e.child.tag){case 5:s=e.child.stateNode;break;case 1:s=e.child.stateNode}um(e,l,s)}break;case 5:var o=e.stateNode;if(s===null&&e.flags&4){s=o;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&s.focus();break;case"img":c.src&&(s.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var m=d.memoizedState;if(m!==null){var u=m.dehydrated;u!==null&&Zi(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(te(163))}ht||e.flags&512&&Cd(e)}catch(h){Fe(e,e.return,h)}}if(e===t){re=null;break}if(s=e.sibling,s!==null){s.return=e.return,re=s;break}re=e.return}}function Tm(t){for(;re!==null;){var e=re;if(e===t){re=null;break}var s=e.sibling;if(s!==null){s.return=e.return,re=s;break}re=e.return}}function Pm(t){for(;re!==null;){var e=re;try{switch(e.tag){case 0:case 11:case 15:var s=e.return;try{vo(4,e)}catch(c){Fe(e,s,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){Fe(e,i,c)}}var a=e.return;try{Cd(e)}catch(c){Fe(e,a,c)}break;case 5:var l=e.return;try{Cd(e)}catch(c){Fe(e,l,c)}}}catch(c){Fe(e,e.return,c)}if(e===t){re=null;break}var o=e.sibling;if(o!==null){o.return=e.return,re=o;break}re=e.return}}var bv=Math.ceil,Yl=_s.ReactCurrentDispatcher,Bu=_s.ReactCurrentOwner,Ut=_s.ReactCurrentBatchConfig,je=0,et=null,He=null,it=0,Lt=0,hr=yn(0),Xe=0,da=null,Dn=0,No=0,Du=0,Ui=null,jt=null,Fu=0,Lr=1/0,bs=null,Ql=!1,Pd=null,on=null,Ka=!1,Zs=null,Xl=0,Wi=0,Ld=null,yl=-1,bl=0;function gt(){return je&6?Ue():yl!==-1?yl:yl=Ue()}function cn(t){return t.mode&1?je&2&&it!==0?it&-it:sv.transition!==null?(bl===0&&(bl=Xx()),bl):(t=Se,t!==0||(t=window.event,t=t===void 0?16:nf(t.type)),t):1}function es(t,e,s,r){if(50<Wi)throw Wi=0,Ld=null,Error(te(185));va(t,s,r),(!(je&2)||t!==et)&&(t===et&&(!(je&2)&&(No|=s),Xe===4&&Gs(t,it)),Ct(t,r),s===1&&je===0&&!(e.mode&1)&&(Lr=Ue()+500,go&&bn()))}function Ct(t,e){var s=t.callbackNode;sb(t,e);var r=Rl(t,t===et?it:0);if(r===0)s!==null&&$h(s),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(s!=null&&$h(s),e===1)t.tag===0?tv(Lm.bind(null,t)):wf(Lm.bind(null,t)),Gb(function(){!(je&6)&&bn()}),s=null;else{switch(Gx(r)){case 1:s=mu;break;case 4:s=Yx;break;case 16:s=Ml;break;case 536870912:s=Qx;break;default:s=Ml}s=N0(s,p0.bind(null,t))}t.callbackPriority=e,t.callbackNode=s}}function p0(t,e){if(yl=-1,bl=0,je&6)throw Error(te(327));var s=t.callbackNode;if(vr()&&t.callbackNode!==s)return null;var r=Rl(t,t===et?it:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Gl(t,r);else{e=r;var i=je;je|=2;var a=f0();(et!==t||it!==e)&&(bs=null,Lr=Ue()+500,Rn(t,e));do try{jv();break}catch(o){x0(t,o)}while(!0);Cu(),Yl.current=a,je=i,He!==null?e=0:(et=null,it=0,e=Xe)}if(e!==0){if(e===2&&(i=nd(t),i!==0&&(r=i,e=_d(t,i))),e===1)throw s=da,Rn(t,0),Gs(t,r),Ct(t,Ue()),s;if(e===6)Gs(t,r);else{if(i=t.current.alternate,!(r&30)&&!vv(i)&&(e=Gl(t,r),e===2&&(a=nd(t),a!==0&&(r=a,e=_d(t,a))),e===1))throw s=da,Rn(t,0),Gs(t,r),Ct(t,Ue()),s;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(te(345));case 2:En(t,jt,bs);break;case 3:if(Gs(t,r),(r&130023424)===r&&(e=Fu+500-Ue(),10<e)){if(Rl(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){gt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=ud(En.bind(null,t,jt,bs),e);break}En(t,jt,bs);break;case 4:if(Gs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var l=31-Zt(r);a=1<<l,l=e[l],l>i&&(i=l),r&=~a}if(r=i,r=Ue()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*bv(r/1960))-r,10<r){t.timeoutHandle=ud(En.bind(null,t,jt,bs),r);break}En(t,jt,bs);break;case 5:En(t,jt,bs);break;default:throw Error(te(329))}}}return Ct(t,Ue()),t.callbackNode===s?p0.bind(null,t):null}function _d(t,e){var s=Ui;return t.current.memoizedState.isDehydrated&&(Rn(t,e).flags|=256),t=Gl(t,e),t!==2&&(e=jt,jt=s,e!==null&&Md(e)),t}function Md(t){jt===null?jt=t:jt.push.apply(jt,t)}function vv(t){for(var e=t;;){if(e.flags&16384){var s=e.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var r=0;r<s.length;r++){var i=s[r],a=i.getSnapshot;i=i.value;try{if(!ss(a(),i))return!1}catch{return!1}}}if(s=e.child,e.subtreeFlags&16384&&s!==null)s.return=e,e=s;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Gs(t,e){for(e&=~Du,e&=~No,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var s=31-Zt(e),r=1<<s;t[s]=-1,e&=~r}}function Lm(t){if(je&6)throw Error(te(327));vr();var e=Rl(t,0);if(!(e&1))return Ct(t,Ue()),null;var s=Gl(t,e);if(t.tag!==0&&s===2){var r=nd(t);r!==0&&(e=r,s=_d(t,r))}if(s===1)throw s=da,Rn(t,0),Gs(t,e),Ct(t,Ue()),s;if(s===6)throw Error(te(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,En(t,jt,bs),Ct(t,Ue()),null}function Uu(t,e){var s=je;je|=1;try{return t(e)}finally{je=s,je===0&&(Lr=Ue()+500,go&&bn())}}function Fn(t){Zs!==null&&Zs.tag===0&&!(je&6)&&vr();var e=je;je|=1;var s=Ut.transition,r=Se;try{if(Ut.transition=null,Se=1,t)return t()}finally{Se=r,Ut.transition=s,je=e,!(je&6)&&bn()}}function Wu(){Lt=hr.current,Ae(hr)}function Rn(t,e){t.finishedWork=null,t.finishedLanes=0;var s=t.timeoutHandle;if(s!==-1&&(t.timeoutHandle=-1,Xb(s)),He!==null)for(s=He.return;s!==null;){var r=s;switch(wu(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&$l();break;case 3:Tr(),Ae(kt),Ae(pt),Mu();break;case 5:_u(r);break;case 4:Tr();break;case 13:Ae(Ie);break;case 19:Ae(Ie);break;case 10:Eu(r.type._context);break;case 22:case 23:Wu()}s=s.return}if(et=t,He=t=dn(t.current,null),it=Lt=e,Xe=0,da=null,Du=No=Dn=0,jt=Ui=null,Ln!==null){for(e=0;e<Ln.length;e++)if(s=Ln[e],r=s.interleaved,r!==null){s.interleaved=null;var i=r.next,a=s.pending;if(a!==null){var l=a.next;a.next=i,r.next=l}s.pending=r}Ln=null}return t}function x0(t,e){do{var s=He;try{if(Cu(),xl.current=Kl,Hl){for(var r=$e.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Hl=!1}if(Bn=0,Ze=Qe=$e=null,Di=!1,la=0,Bu.current=null,s===null||s.return===null){Xe=1,da=e,He=null;break}e:{var a=t,l=s.return,o=s,c=e;if(e=it,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,m=o,u=m.tag;if(!(m.mode&1)&&(u===0||u===11||u===15)){var h=m.alternate;h?(m.updateQueue=h.updateQueue,m.memoizedState=h.memoizedState,m.lanes=h.lanes):(m.updateQueue=null,m.memoizedState=null)}var x=gm(l);if(x!==null){x.flags&=-257,ym(x,l,o,a,e),x.mode&1&&fm(a,d,e),e=x,c=d;var y=e.updateQueue;if(y===null){var f=new Set;f.add(c),e.updateQueue=f}else y.add(c);break e}else{if(!(e&1)){fm(a,d,e),Vu();break e}c=Error(te(426))}}else if(Oe&&o.mode&1){var w=gm(l);if(w!==null){!(w.flags&65536)&&(w.flags|=256),ym(w,l,o,a,e),ku(Pr(c,o));break e}}a=c=Pr(c,o),Xe!==4&&(Xe=2),Ui===null?Ui=[a]:Ui.push(a),a=l;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var p=Jf(a,c,e);dm(a,p);break e;case 1:o=c;var b=a.type,v=a.stateNode;if(!(a.flags&128)&&(typeof b.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(on===null||!on.has(v)))){a.flags|=65536,e&=-e,a.lanes|=e;var S=Zf(a,o,e);dm(a,S);break e}}a=a.return}while(a!==null)}y0(s)}catch(N){e=N,He===s&&s!==null&&(He=s=s.return);continue}break}while(!0)}function f0(){var t=Yl.current;return Yl.current=Kl,t===null?Kl:t}function Vu(){(Xe===0||Xe===3||Xe===2)&&(Xe=4),et===null||!(Dn&268435455)&&!(No&268435455)||Gs(et,it)}function Gl(t,e){var s=je;je|=2;var r=f0();(et!==t||it!==e)&&(bs=null,Rn(t,e));do try{Nv();break}catch(i){x0(t,i)}while(!0);if(Cu(),je=s,Yl.current=r,He!==null)throw Error(te(261));return et=null,it=0,Xe}function Nv(){for(;He!==null;)g0(He)}function jv(){for(;He!==null&&!Ky();)g0(He)}function g0(t){var e=v0(t.alternate,t,Lt);t.memoizedProps=t.pendingProps,e===null?y0(t):He=e,Bu.current=null}function y0(t){var e=t;do{var s=e.alternate;if(t=e.return,e.flags&32768){if(s=xv(s,e),s!==null){s.flags&=32767,He=s;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Xe=6,He=null;return}}else if(s=pv(s,e,Lt),s!==null){He=s;return}if(e=e.sibling,e!==null){He=e;return}He=e=t}while(e!==null);Xe===0&&(Xe=5)}function En(t,e,s){var r=Se,i=Ut.transition;try{Ut.transition=null,Se=1,wv(t,e,s,r)}finally{Ut.transition=i,Se=r}return null}function wv(t,e,s,r){do vr();while(Zs!==null);if(je&6)throw Error(te(327));s=t.finishedWork;var i=t.finishedLanes;if(s===null)return null;if(t.finishedWork=null,t.finishedLanes=0,s===t.current)throw Error(te(177));t.callbackNode=null,t.callbackPriority=0;var a=s.lanes|s.childLanes;if(nb(t,a),t===et&&(He=et=null,it=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||Ka||(Ka=!0,N0(Ml,function(){return vr(),null})),a=(s.flags&15990)!==0,s.subtreeFlags&15990||a){a=Ut.transition,Ut.transition=null;var l=Se;Se=1;var o=je;je|=4,Bu.current=null,gv(t,s),h0(s,t),Wb(cd),Al=!!od,cd=od=null,t.current=s,yv(s),Yy(),je=o,Se=l,Ut.transition=a}else t.current=s;if(Ka&&(Ka=!1,Zs=t,Xl=i),a=t.pendingLanes,a===0&&(on=null),Gy(s.stateNode),Ct(t,Ue()),e!==null)for(r=t.onRecoverableError,s=0;s<e.length;s++)i=e[s],r(i.value,{componentStack:i.stack,digest:i.digest});if(Ql)throw Ql=!1,t=Pd,Pd=null,t;return Xl&1&&t.tag!==0&&vr(),a=t.pendingLanes,a&1?t===Ld?Wi++:(Wi=0,Ld=t):Wi=0,bn(),null}function vr(){if(Zs!==null){var t=Gx(Xl),e=Ut.transition,s=Se;try{if(Ut.transition=null,Se=16>t?16:t,Zs===null)var r=!1;else{if(t=Zs,Zs=null,Xl=0,je&6)throw Error(te(331));var i=je;for(je|=4,re=t.current;re!==null;){var a=re,l=a.child;if(re.flags&16){var o=a.deletions;if(o!==null){for(var c=0;c<o.length;c++){var d=o[c];for(re=d;re!==null;){var m=re;switch(m.tag){case 0:case 11:case 15:Fi(8,m,a)}var u=m.child;if(u!==null)u.return=m,re=u;else for(;re!==null;){m=re;var h=m.sibling,x=m.return;if(c0(m),m===d){re=null;break}if(h!==null){h.return=x,re=h;break}re=x}}}var y=a.alternate;if(y!==null){var f=y.child;if(f!==null){y.child=null;do{var w=f.sibling;f.sibling=null,f=w}while(f!==null)}}re=a}}if(a.subtreeFlags&2064&&l!==null)l.return=a,re=l;else e:for(;re!==null;){if(a=re,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Fi(9,a,a.return)}var p=a.sibling;if(p!==null){p.return=a.return,re=p;break e}re=a.return}}var b=t.current;for(re=b;re!==null;){l=re;var v=l.child;if(l.subtreeFlags&2064&&v!==null)v.return=l,re=v;else e:for(l=b;re!==null;){if(o=re,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:vo(9,o)}}catch(N){Fe(o,o.return,N)}if(o===l){re=null;break e}var S=o.sibling;if(S!==null){S.return=o.return,re=S;break e}re=o.return}}if(je=i,bn(),ps&&typeof ps.onPostCommitFiberRoot=="function")try{ps.onPostCommitFiberRoot(ho,t)}catch{}r=!0}return r}finally{Se=s,Ut.transition=e}}return!1}function _m(t,e,s){e=Pr(s,e),e=Jf(t,e,1),t=ln(t,e,1),e=gt(),t!==null&&(va(t,1,e),Ct(t,e))}function Fe(t,e,s){if(t.tag===3)_m(t,t,s);else for(;e!==null;){if(e.tag===3){_m(e,t,s);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(on===null||!on.has(r))){t=Pr(s,t),t=Zf(e,t,1),e=ln(e,t,1),t=gt(),e!==null&&(va(e,1,t),Ct(e,t));break}}e=e.return}}function kv(t,e,s){var r=t.pingCache;r!==null&&r.delete(e),e=gt(),t.pingedLanes|=t.suspendedLanes&s,et===t&&(it&s)===s&&(Xe===4||Xe===3&&(it&130023424)===it&&500>Ue()-Fu?Rn(t,0):Du|=s),Ct(t,e)}function b0(t,e){e===0&&(t.mode&1?(e=Ia,Ia<<=1,!(Ia&130023424)&&(Ia=4194304)):e=1);var s=gt();t=Ts(t,e),t!==null&&(va(t,e,s),Ct(t,s))}function Sv(t){var e=t.memoizedState,s=0;e!==null&&(s=e.retryLane),b0(t,s)}function Cv(t,e){var s=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(s=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(te(314))}r!==null&&r.delete(e),b0(t,s)}var v0;v0=function(t,e,s){if(t!==null)if(t.memoizedProps!==e.pendingProps||kt.current)wt=!0;else{if(!(t.lanes&s)&&!(e.flags&128))return wt=!1,mv(t,e,s);wt=!!(t.flags&131072)}else wt=!1,Oe&&e.flags&1048576&&kf(e,Fl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;gl(t,e),t=e.pendingProps;var i=Sr(e,pt.current);br(e,s),i=Au(null,e,r,t,i,s);var a=zu();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,St(r)?(a=!0,Bl(e)):a=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Pu(e),i.updater=bo,e.stateNode=i,i._reactInternals=e,yd(e,r,t,s),e=Nd(null,e,r,!0,a,s)):(e.tag=0,Oe&&a&&ju(e),ft(null,e,i,s),e=e.child),e;case 16:r=e.elementType;e:{switch(gl(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=Tv(r),t=Qt(r,t),i){case 0:e=vd(null,e,r,t,s);break e;case 1:e=Nm(null,e,r,t,s);break e;case 11:e=bm(null,e,r,t,s);break e;case 14:e=vm(null,e,r,Qt(r.type,t),s);break e}throw Error(te(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qt(r,i),vd(t,e,r,i,s);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qt(r,i),Nm(t,e,r,i,s);case 3:e:{if(n0(e),t===null)throw Error(te(387));r=e.pendingProps,a=e.memoizedState,i=a.element,Lf(t,e),Vl(e,r,null,s);var l=e.memoizedState;if(r=l.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){i=Pr(Error(te(423)),e),e=jm(t,e,r,s,i);break e}else if(r!==i){i=Pr(Error(te(424)),e),e=jm(t,e,r,s,i);break e}else for(_t=an(e.stateNode.containerInfo.firstChild),Mt=e,Oe=!0,Jt=null,s=Tf(e,null,r,s),e.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Cr(),r===i){e=Ps(t,e,s);break e}ft(t,e,r,s)}e=e.child}return e;case 5:return _f(e),t===null&&xd(e),r=e.type,i=e.pendingProps,a=t!==null?t.memoizedProps:null,l=i.children,dd(r,i)?l=null:a!==null&&dd(r,a)&&(e.flags|=32),s0(t,e),ft(t,e,l,s),e.child;case 6:return t===null&&xd(e),null;case 13:return r0(t,e,s);case 4:return Lu(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Er(e,null,r,s):ft(t,e,r,s),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qt(r,i),bm(t,e,r,i,s);case 7:return ft(t,e,e.pendingProps,s),e.child;case 8:return ft(t,e,e.pendingProps.children,s),e.child;case 12:return ft(t,e,e.pendingProps.children,s),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,a=e.memoizedProps,l=i.value,Pe(Ul,r._currentValue),r._currentValue=l,a!==null)if(ss(a.value,l)){if(a.children===i.children&&!kt.current){e=Ps(t,e,s);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var o=a.dependencies;if(o!==null){l=a.child;for(var c=o.firstContext;c!==null;){if(c.context===r){if(a.tag===1){c=Ss(-1,s&-s),c.tag=2;var d=a.updateQueue;if(d!==null){d=d.shared;var m=d.pending;m===null?c.next=c:(c.next=m.next,m.next=c),d.pending=c}}a.lanes|=s,c=a.alternate,c!==null&&(c.lanes|=s),fd(a.return,s,e),o.lanes|=s;break}c=c.next}}else if(a.tag===10)l=a.type===e.type?null:a.child;else if(a.tag===18){if(l=a.return,l===null)throw Error(te(341));l.lanes|=s,o=l.alternate,o!==null&&(o.lanes|=s),fd(l,s,e),l=a.sibling}else l=a.child;if(l!==null)l.return=a;else for(l=a;l!==null;){if(l===e){l=null;break}if(a=l.sibling,a!==null){a.return=l.return,l=a;break}l=l.return}a=l}ft(t,e,i.children,s),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,br(e,s),i=Wt(i),r=r(i),e.flags|=1,ft(t,e,r,s),e.child;case 14:return r=e.type,i=Qt(r,e.pendingProps),i=Qt(r.type,i),vm(t,e,r,i,s);case 15:return e0(t,e,e.type,e.pendingProps,s);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qt(r,i),gl(t,e),e.tag=1,St(r)?(t=!0,Bl(e)):t=!1,br(e,s),Gf(e,r,i),yd(e,r,i,s),Nd(null,e,r,!0,t,s);case 19:return i0(t,e,s);case 22:return t0(t,e,s)}throw Error(te(156,e.tag))};function N0(t,e){return Kx(t,e)}function Ev(t,e,s,r){this.tag=t,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ft(t,e,s,r){return new Ev(t,e,s,r)}function qu(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Tv(t){if(typeof t=="function")return qu(t)?1:0;if(t!=null){if(t=t.$$typeof,t===du)return 11;if(t===uu)return 14}return 2}function dn(t,e){var s=t.alternate;return s===null?(s=Ft(t.tag,e,t.key,t.mode),s.elementType=t.elementType,s.type=t.type,s.stateNode=t.stateNode,s.alternate=t,t.alternate=s):(s.pendingProps=e,s.type=t.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=t.flags&14680064,s.childLanes=t.childLanes,s.lanes=t.lanes,s.child=t.child,s.memoizedProps=t.memoizedProps,s.memoizedState=t.memoizedState,s.updateQueue=t.updateQueue,e=t.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},s.sibling=t.sibling,s.index=t.index,s.ref=t.ref,s}function vl(t,e,s,r,i,a){var l=2;if(r=t,typeof t=="function")qu(t)&&(l=1);else if(typeof t=="string")l=5;else e:switch(t){case sr:return An(s.children,i,a,e);case cu:l=8,i|=8;break;case Uc:return t=Ft(12,s,e,i|2),t.elementType=Uc,t.lanes=a,t;case Wc:return t=Ft(13,s,e,i),t.elementType=Wc,t.lanes=a,t;case Vc:return t=Ft(19,s,e,i),t.elementType=Vc,t.lanes=a,t;case Lx:return jo(s,i,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Tx:l=10;break e;case Px:l=9;break e;case du:l=11;break e;case uu:l=14;break e;case Ys:l=16,r=null;break e}throw Error(te(130,t==null?t:typeof t,""))}return e=Ft(l,s,e,i),e.elementType=t,e.type=r,e.lanes=a,e}function An(t,e,s,r){return t=Ft(7,t,r,e),t.lanes=s,t}function jo(t,e,s,r){return t=Ft(22,t,r,e),t.elementType=Lx,t.lanes=s,t.stateNode={isHidden:!1},t}function uc(t,e,s){return t=Ft(6,t,null,e),t.lanes=s,t}function hc(t,e,s){return e=Ft(4,t.children!==null?t.children:[],t.key,e),e.lanes=s,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Pv(t,e,s,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ho(0),this.expirationTimes=Ho(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ho(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Hu(t,e,s,r,i,a,l,o,c){return t=new Pv(t,e,s,o,c),e===1?(e=1,a===!0&&(e|=8)):e=0,a=Ft(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:r,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},Pu(a),t}function Lv(t,e,s){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:tr,key:r==null?null:""+r,children:t,containerInfo:e,implementation:s}}function j0(t){if(!t)return xn;t=t._reactInternals;e:{if(Xn(t)!==t||t.tag!==1)throw Error(te(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(St(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(te(171))}if(t.tag===1){var s=t.type;if(St(s))return jf(t,s,e)}return e}function w0(t,e,s,r,i,a,l,o,c){return t=Hu(s,r,!0,t,i,a,l,o,c),t.context=j0(null),s=t.current,r=gt(),i=cn(s),a=Ss(r,i),a.callback=e??null,ln(s,a,i),t.current.lanes=i,va(t,i,r),Ct(t,r),t}function wo(t,e,s,r){var i=e.current,a=gt(),l=cn(i);return s=j0(s),e.context===null?e.context=s:e.pendingContext=s,e=Ss(a,l),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ln(i,e,l),t!==null&&(es(t,i,l,a),pl(t,i,l)),l}function Jl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Mm(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var s=t.retryLane;t.retryLane=s!==0&&s<e?s:e}}function Ku(t,e){Mm(t,e),(t=t.alternate)&&Mm(t,e)}function _v(){return null}var k0=typeof reportError=="function"?reportError:function(t){console.error(t)};function Yu(t){this._internalRoot=t}ko.prototype.render=Yu.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(te(409));wo(t,e,null,null)};ko.prototype.unmount=Yu.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Fn(function(){wo(null,t,null,null)}),e[Es]=null}};function ko(t){this._internalRoot=t}ko.prototype.unstable_scheduleHydration=function(t){if(t){var e=ef();t={blockedOn:null,target:t,priority:e};for(var s=0;s<Xs.length&&e!==0&&e<Xs[s].priority;s++);Xs.splice(s,0,t),s===0&&sf(t)}};function Qu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function So(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Rm(){}function Mv(t,e,s,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var d=Jl(l);a.call(d)}}var l=w0(e,r,t,0,null,!1,!1,"",Rm);return t._reactRootContainer=l,t[Es]=l.current,sa(t.nodeType===8?t.parentNode:t),Fn(),l}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var d=Jl(c);o.call(d)}}var c=Hu(t,0,!1,null,null,!1,!1,"",Rm);return t._reactRootContainer=c,t[Es]=c.current,sa(t.nodeType===8?t.parentNode:t),Fn(function(){wo(e,c,s,r)}),c}function Co(t,e,s,r,i){var a=s._reactRootContainer;if(a){var l=a;if(typeof i=="function"){var o=i;i=function(){var c=Jl(l);o.call(c)}}wo(e,l,t,i)}else l=Mv(s,e,t,i,r);return Jl(l)}Jx=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var s=Mi(e.pendingLanes);s!==0&&(pu(e,s|1),Ct(e,Ue()),!(je&6)&&(Lr=Ue()+500,bn()))}break;case 13:Fn(function(){var r=Ts(t,1);if(r!==null){var i=gt();es(r,t,1,i)}}),Ku(t,1)}};xu=function(t){if(t.tag===13){var e=Ts(t,134217728);if(e!==null){var s=gt();es(e,t,134217728,s)}Ku(t,134217728)}};Zx=function(t){if(t.tag===13){var e=cn(t),s=Ts(t,e);if(s!==null){var r=gt();es(s,t,e,r)}Ku(t,e)}};ef=function(){return Se};tf=function(t,e){var s=Se;try{return Se=t,e()}finally{Se=s}};ed=function(t,e,s){switch(e){case"input":if(Kc(t,s),e=s.name,s.type==="radio"&&e!=null){for(s=t;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<s.length;e++){var r=s[e];if(r!==t&&r.form===t.form){var i=fo(r);if(!i)throw Error(te(90));Mx(r),Kc(r,i)}}}break;case"textarea":Ax(t,s);break;case"select":e=s.value,e!=null&&xr(t,!!s.multiple,e,!1)}};Fx=Uu;Ux=Fn;var Rv={usingClientEntryPoint:!1,Events:[ja,ar,fo,Bx,Dx,Uu]},Ci={findFiberByHostInstance:Pn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Av={bundleType:Ci.bundleType,version:Ci.version,rendererPackageName:Ci.rendererPackageName,rendererConfig:Ci.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_s.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=qx(t),t===null?null:t.stateNode},findFiberByHostInstance:Ci.findFiberByHostInstance||_v,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ya=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ya.isDisabled&&Ya.supportsFiber)try{ho=Ya.inject(Av),ps=Ya}catch{}}At.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Rv;At.createPortal=function(t,e){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Qu(e))throw Error(te(200));return Lv(t,e,null,s)};At.createRoot=function(t,e){if(!Qu(t))throw Error(te(299));var s=!1,r="",i=k0;return e!=null&&(e.unstable_strictMode===!0&&(s=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Hu(t,1,!1,null,null,s,!1,r,i),t[Es]=e.current,sa(t.nodeType===8?t.parentNode:t),new Yu(e)};At.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(te(188)):(t=Object.keys(t).join(","),Error(te(268,t)));return t=qx(e),t=t===null?null:t.stateNode,t};At.flushSync=function(t){return Fn(t)};At.hydrate=function(t,e,s){if(!So(e))throw Error(te(200));return Co(null,t,e,!0,s)};At.hydrateRoot=function(t,e,s){if(!Qu(t))throw Error(te(405));var r=s!=null&&s.hydratedSources||null,i=!1,a="",l=k0;if(s!=null&&(s.unstable_strictMode===!0&&(i=!0),s.identifierPrefix!==void 0&&(a=s.identifierPrefix),s.onRecoverableError!==void 0&&(l=s.onRecoverableError)),e=w0(e,null,t,1,s??null,i,!1,a,l),t[Es]=e.current,sa(t),r)for(t=0;t<r.length;t++)s=r[t],i=s._getVersion,i=i(s._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[s,i]:e.mutableSourceEagerHydrationData.push(s,i);return new ko(e)};At.render=function(t,e,s){if(!So(e))throw Error(te(200));return Co(null,t,e,!1,s)};At.unmountComponentAtNode=function(t){if(!So(t))throw Error(te(40));return t._reactRootContainer?(Fn(function(){Co(null,null,t,!1,function(){t._reactRootContainer=null,t[Es]=null})}),!0):!1};At.unstable_batchedUpdates=Uu;At.unstable_renderSubtreeIntoContainer=function(t,e,s,r){if(!So(s))throw Error(te(200));if(t==null||t._reactInternals===void 0)throw Error(te(38));return Co(t,e,s,!1,r)};At.version="18.3.1-next-f1338f8080-20240426";function S0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(S0)}catch(t){console.error(t)}}S0(),kx.exports=At;var zv=kx.exports,Am=zv;Dc.createRoot=Am.createRoot,Dc.hydrateRoot=Am.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ua(){return ua=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},ua.apply(this,arguments)}var en;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(en||(en={}));const zm="popstate";function Ov(t){t===void 0&&(t={});function e(r,i){let{pathname:a,search:l,hash:o}=r.location;return Rd("",{pathname:a,search:l,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function s(r,i){return typeof i=="string"?i:Zl(i)}return $v(e,s,null,t)}function We(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Xu(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Iv(){return Math.random().toString(36).substr(2,8)}function Om(t,e){return{usr:t.state,key:t.key,idx:e}}function Rd(t,e,s,r){return s===void 0&&(s=null),ua({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Fr(e):e,{state:s,key:e&&e.key||r||Iv()})}function Zl(t){let{pathname:e="/",search:s="",hash:r=""}=t;return s&&s!=="?"&&(e+=s.charAt(0)==="?"?s:"?"+s),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Fr(t){let e={};if(t){let s=t.indexOf("#");s>=0&&(e.hash=t.substr(s),t=t.substr(0,s));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function $v(t,e,s,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:a=!1}=r,l=i.history,o=en.Pop,c=null,d=m();d==null&&(d=0,l.replaceState(ua({},l.state,{idx:d}),""));function m(){return(l.state||{idx:null}).idx}function u(){o=en.Pop;let w=m(),p=w==null?null:w-d;d=w,c&&c({action:o,location:f.location,delta:p})}function h(w,p){o=en.Push;let b=Rd(f.location,w,p);d=m()+1;let v=Om(b,d),S=f.createHref(b);try{l.pushState(v,"",S)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;i.location.assign(S)}a&&c&&c({action:o,location:f.location,delta:1})}function x(w,p){o=en.Replace;let b=Rd(f.location,w,p);d=m();let v=Om(b,d),S=f.createHref(b);l.replaceState(v,"",S),a&&c&&c({action:o,location:f.location,delta:0})}function y(w){let p=i.location.origin!=="null"?i.location.origin:i.location.href,b=typeof w=="string"?w:Zl(w);return b=b.replace(/ $/,"%20"),We(p,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,p)}let f={get action(){return o},get location(){return t(i,l)},listen(w){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(zm,u),c=w,()=>{i.removeEventListener(zm,u),c=null}},createHref(w){return e(i,w)},createURL:y,encodeLocation(w){let p=y(w);return{pathname:p.pathname,search:p.search,hash:p.hash}},push:h,replace:x,go(w){return l.go(w)}};return f}var Im;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Im||(Im={}));function Bv(t,e,s){return s===void 0&&(s="/"),Dv(t,e,s)}function Dv(t,e,s,r){let i=typeof e=="string"?Fr(e):e,a=Gu(i.pathname||"/",s);if(a==null)return null;let l=C0(t);Fv(l);let o=null;for(let c=0;o==null&&c<l.length;++c){let d=Zv(a);o=Xv(l[c],d)}return o}function C0(t,e,s,r){e===void 0&&(e=[]),s===void 0&&(s=[]),r===void 0&&(r="");let i=(a,l,o)=>{let c={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:l,route:a};c.relativePath.startsWith("/")&&(We(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let d=un([r,c.relativePath]),m=s.concat(c);a.children&&a.children.length>0&&(We(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),C0(a.children,e,m,d)),!(a.path==null&&!a.index)&&e.push({path:d,score:Yv(d,a.index),routesMeta:m})};return t.forEach((a,l)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))i(a,l);else for(let c of E0(a.path))i(a,l,c)}),e}function E0(t){let e=t.split("/");if(e.length===0)return[];let[s,...r]=e,i=s.endsWith("?"),a=s.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let l=E0(r.join("/")),o=[];return o.push(...l.map(c=>c===""?a:[a,c].join("/"))),i&&o.push(...l),o.map(c=>t.startsWith("/")&&c===""?"/":c)}function Fv(t){t.sort((e,s)=>e.score!==s.score?s.score-e.score:Qv(e.routesMeta.map(r=>r.childrenIndex),s.routesMeta.map(r=>r.childrenIndex)))}const Uv=/^:[\w-]+$/,Wv=3,Vv=2,qv=1,Hv=10,Kv=-2,$m=t=>t==="*";function Yv(t,e){let s=t.split("/"),r=s.length;return s.some($m)&&(r+=Kv),e&&(r+=Vv),s.filter(i=>!$m(i)).reduce((i,a)=>i+(Uv.test(a)?Wv:a===""?qv:Hv),r)}function Qv(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function Xv(t,e,s){let{routesMeta:r}=t,i={},a="/",l=[];for(let o=0;o<r.length;++o){let c=r[o],d=o===r.length-1,m=a==="/"?e:e.slice(a.length)||"/",u=Gv({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},m),h=c.route;if(!u)return null;Object.assign(i,u.params),l.push({params:i,pathname:un([a,u.pathname]),pathnameBase:rN(un([a,u.pathnameBase])),route:h}),u.pathnameBase!=="/"&&(a=un([a,u.pathnameBase]))}return l}function Gv(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[s,r]=Jv(t.path,t.caseSensitive,t.end),i=e.match(s);if(!i)return null;let a=i[0],l=a.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:r.reduce((d,m,u)=>{let{paramName:h,isOptional:x}=m;if(h==="*"){let f=o[u]||"";l=a.slice(0,a.length-f.length).replace(/(.)\/+$/,"$1")}const y=o[u];return x&&!y?d[h]=void 0:d[h]=(y||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:l,pattern:t}}function Jv(t,e,s){e===void 0&&(e=!1),s===void 0&&(s=!0),Xu(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,c)=>(r.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function Zv(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Xu(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Gu(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let s=e.endsWith("/")?e.length-1:e.length,r=t.charAt(s);return r&&r!=="/"?null:t.slice(s)||"/"}const eN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,tN=t=>eN.test(t);function sN(t,e){e===void 0&&(e="/");let{pathname:s,search:r="",hash:i=""}=typeof t=="string"?Fr(t):t,a;if(s)if(tN(s))a=s;else{if(s.includes("//")){let l=s;s=s.replace(/\/\/+/g,"/"),Xu(!1,"Pathnames cannot have embedded double slashes - normalizing "+(l+" -> "+s))}s.startsWith("/")?a=Bm(s.substring(1),"/"):a=Bm(s,e)}else a=e;return{pathname:a,search:iN(r),hash:aN(i)}}function Bm(t,e){let s=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?s.length>1&&s.pop():i!=="."&&s.push(i)}),s.length>1?s.join("/"):"/"}function mc(t,e,s,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function nN(t){return t.filter((e,s)=>s===0||e.route.path&&e.route.path.length>0)}function Ju(t,e){let s=nN(t);return e?s.map((r,i)=>i===s.length-1?r.pathname:r.pathnameBase):s.map(r=>r.pathnameBase)}function Zu(t,e,s,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=Fr(t):(i=ua({},t),We(!i.pathname||!i.pathname.includes("?"),mc("?","pathname","search",i)),We(!i.pathname||!i.pathname.includes("#"),mc("#","pathname","hash",i)),We(!i.search||!i.search.includes("#"),mc("#","search","hash",i)));let a=t===""||i.pathname==="",l=a?"/":i.pathname,o;if(l==null)o=s;else{let u=e.length-1;if(!r&&l.startsWith("..")){let h=l.split("/");for(;h[0]==="..";)h.shift(),u-=1;i.pathname=h.join("/")}o=u>=0?e[u]:"/"}let c=sN(i,o),d=l&&l!=="/"&&l.endsWith("/"),m=(a||l===".")&&s.endsWith("/");return!c.pathname.endsWith("/")&&(d||m)&&(c.pathname+="/"),c}const un=t=>t.join("/").replace(/\/\/+/g,"/"),rN=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),iN=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,aN=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function lN(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const T0=["post","put","patch","delete"];new Set(T0);const oN=["get",...T0];new Set(oN);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ha(){return ha=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},ha.apply(this,arguments)}const eh=g.createContext(null),cN=g.createContext(null),vn=g.createContext(null),Eo=g.createContext(null),Nn=g.createContext({outlet:null,matches:[],isDataRoute:!1}),P0=g.createContext(null);function dN(t,e){let{relative:s}=e===void 0?{}:e;Ur()||We(!1);let{basename:r,navigator:i}=g.useContext(vn),{hash:a,pathname:l,search:o}=_0(t,{relative:s}),c=l;return r!=="/"&&(c=l==="/"?r:un([r,l])),i.createHref({pathname:c,search:o,hash:a})}function Ur(){return g.useContext(Eo)!=null}function jn(){return Ur()||We(!1),g.useContext(Eo).location}function L0(t){g.useContext(vn).static||g.useLayoutEffect(t)}function rs(){let{isDataRoute:t}=g.useContext(Nn);return t?wN():uN()}function uN(){Ur()||We(!1);let t=g.useContext(eh),{basename:e,future:s,navigator:r}=g.useContext(vn),{matches:i}=g.useContext(Nn),{pathname:a}=jn(),l=JSON.stringify(Ju(i,s.v7_relativeSplatPath)),o=g.useRef(!1);return L0(()=>{o.current=!0}),g.useCallback(function(d,m){if(m===void 0&&(m={}),!o.current)return;if(typeof d=="number"){r.go(d);return}let u=Zu(d,JSON.parse(l),a,m.relative==="path");t==null&&e!=="/"&&(u.pathname=u.pathname==="/"?e:un([e,u.pathname])),(m.replace?r.replace:r.push)(u,m.state,m)},[e,r,l,a,t])}function _0(t,e){let{relative:s}=e===void 0?{}:e,{future:r}=g.useContext(vn),{matches:i}=g.useContext(Nn),{pathname:a}=jn(),l=JSON.stringify(Ju(i,r.v7_relativeSplatPath));return g.useMemo(()=>Zu(t,JSON.parse(l),a,s==="path"),[t,l,a,s])}function hN(t,e){return mN(t,e)}function mN(t,e,s,r){Ur()||We(!1);let{navigator:i}=g.useContext(vn),{matches:a}=g.useContext(Nn),l=a[a.length-1],o=l?l.params:{};l&&l.pathname;let c=l?l.pathnameBase:"/";l&&l.route;let d=jn(),m;if(e){var u;let w=typeof e=="string"?Fr(e):e;c==="/"||(u=w.pathname)!=null&&u.startsWith(c)||We(!1),m=w}else m=d;let h=m.pathname||"/",x=h;if(c!=="/"){let w=c.replace(/^\//,"").split("/");x="/"+h.replace(/^\//,"").split("/").slice(w.length).join("/")}let y=Bv(t,{pathname:x}),f=yN(y&&y.map(w=>Object.assign({},w,{params:Object.assign({},o,w.params),pathname:un([c,i.encodeLocation?i.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:un([c,i.encodeLocation?i.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),a,s,r);return e&&f?g.createElement(Eo.Provider,{value:{location:ha({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:en.Pop}},f):f}function pN(){let t=jN(),e=lN(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),s=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},e),s?g.createElement("pre",{style:i},s):null,null)}const xN=g.createElement(pN,null);class fN extends g.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,s){return s.location!==e.location||s.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:s.error,location:s.location,revalidation:e.revalidation||s.revalidation}}componentDidCatch(e,s){console.error("React Router caught the following error during render",e,s)}render(){return this.state.error!==void 0?g.createElement(Nn.Provider,{value:this.props.routeContext},g.createElement(P0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function gN(t){let{routeContext:e,match:s,children:r}=t,i=g.useContext(eh);return i&&i.static&&i.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=s.route.id),g.createElement(Nn.Provider,{value:e},r)}function yN(t,e,s,r){var i;if(e===void 0&&(e=[]),s===void 0&&(s=null),r===void 0&&(r=null),t==null){var a;if(!s)return null;if(s.errors)t=s.matches;else if((a=r)!=null&&a.v7_partialHydration&&e.length===0&&!s.initialized&&s.matches.length>0)t=s.matches;else return null}let l=t,o=(i=s)==null?void 0:i.errors;if(o!=null){let m=l.findIndex(u=>u.route.id&&(o==null?void 0:o[u.route.id])!==void 0);m>=0||We(!1),l=l.slice(0,Math.min(l.length,m+1))}let c=!1,d=-1;if(s&&r&&r.v7_partialHydration)for(let m=0;m<l.length;m++){let u=l[m];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(d=m),u.route.id){let{loaderData:h,errors:x}=s,y=u.route.loader&&h[u.route.id]===void 0&&(!x||x[u.route.id]===void 0);if(u.route.lazy||y){c=!0,d>=0?l=l.slice(0,d+1):l=[l[0]];break}}}return l.reduceRight((m,u,h)=>{let x,y=!1,f=null,w=null;s&&(x=o&&u.route.id?o[u.route.id]:void 0,f=u.route.errorElement||xN,c&&(d<0&&h===0?(kN("route-fallback"),y=!0,w=null):d===h&&(y=!0,w=u.route.hydrateFallbackElement||null)));let p=e.concat(l.slice(0,h+1)),b=()=>{let v;return x?v=f:y?v=w:u.route.Component?v=g.createElement(u.route.Component,null):u.route.element?v=u.route.element:v=m,g.createElement(gN,{match:u,routeContext:{outlet:m,matches:p,isDataRoute:s!=null},children:v})};return s&&(u.route.ErrorBoundary||u.route.errorElement||h===0)?g.createElement(fN,{location:s.location,revalidation:s.revalidation,component:f,error:x,children:b(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):b()},null)}var M0=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(M0||{}),R0=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(R0||{});function bN(t){let e=g.useContext(eh);return e||We(!1),e}function vN(t){let e=g.useContext(cN);return e||We(!1),e}function NN(t){let e=g.useContext(Nn);return e||We(!1),e}function A0(t){let e=NN(),s=e.matches[e.matches.length-1];return s.route.id||We(!1),s.route.id}function jN(){var t;let e=g.useContext(P0),s=vN(),r=A0();return e!==void 0?e:(t=s.errors)==null?void 0:t[r]}function wN(){let{router:t}=bN(M0.UseNavigateStable),e=A0(R0.UseNavigateStable),s=g.useRef(!1);return L0(()=>{s.current=!0}),g.useCallback(function(i,a){a===void 0&&(a={}),s.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,ha({fromRouteId:e},a)))},[t,e])}const Dm={};function kN(t,e,s){Dm[t]||(Dm[t]=!0)}function SN(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function eo(t){let{to:e,replace:s,state:r,relative:i}=t;Ur()||We(!1);let{future:a,static:l}=g.useContext(vn),{matches:o}=g.useContext(Nn),{pathname:c}=jn(),d=rs(),m=Zu(e,Ju(o,a.v7_relativeSplatPath),c,i==="path"),u=JSON.stringify(m);return g.useEffect(()=>d(JSON.parse(u),{replace:s,state:r,relative:i}),[d,u,i,s,r]),null}function ye(t){We(!1)}function CN(t){let{basename:e="/",children:s=null,location:r,navigationType:i=en.Pop,navigator:a,static:l=!1,future:o}=t;Ur()&&We(!1);let c=e.replace(/^\/*/,"/"),d=g.useMemo(()=>({basename:c,navigator:a,static:l,future:ha({v7_relativeSplatPath:!1},o)}),[c,o,a,l]);typeof r=="string"&&(r=Fr(r));let{pathname:m="/",search:u="",hash:h="",state:x=null,key:y="default"}=r,f=g.useMemo(()=>{let w=Gu(m,c);return w==null?null:{location:{pathname:w,search:u,hash:h,state:x,key:y},navigationType:i}},[c,m,u,h,x,y,i]);return f==null?null:g.createElement(vn.Provider,{value:d},g.createElement(Eo.Provider,{children:s,value:f}))}function th(t){let{children:e,location:s}=t;return hN(Ad(e),s)}new Promise(()=>{});function Ad(t,e){e===void 0&&(e=[]);let s=[];return g.Children.forEach(t,(r,i)=>{if(!g.isValidElement(r))return;let a=[...e,i];if(r.type===g.Fragment){s.push.apply(s,Ad(r.props.children,a));return}r.type!==ye&&We(!1),!r.props.index||!r.props.children||We(!1);let l={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=Ad(r.props.children,a)),s.push(l)}),s}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zd(){return zd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},zd.apply(this,arguments)}function EN(t,e){if(t==null)return{};var s={},r=Object.keys(t),i,a;for(a=0;a<r.length;a++)i=r[a],!(e.indexOf(i)>=0)&&(s[i]=t[i]);return s}function TN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function PN(t,e){return t.button===0&&(!e||e==="_self")&&!TN(t)}function Od(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,s)=>{let r=t[s];return e.concat(Array.isArray(r)?r.map(i=>[s,i]):[[s,r]])},[]))}function LN(t,e){let s=Od(t);return e&&e.forEach((r,i)=>{s.has(i)||e.getAll(i).forEach(a=>{s.append(i,a)})}),s}const _N=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],MN="6";try{window.__reactRouterVersion=MN}catch{}const RN="startTransition",Fm=ky[RN];function AN(t){let{basename:e,children:s,future:r,window:i}=t,a=g.useRef();a.current==null&&(a.current=Ov({window:i,v5Compat:!0}));let l=a.current,[o,c]=g.useState({action:l.action,location:l.location}),{v7_startTransition:d}=r||{},m=g.useCallback(u=>{d&&Fm?Fm(()=>c(u)):c(u)},[c,d]);return g.useLayoutEffect(()=>l.listen(m),[l,m]),g.useEffect(()=>SN(r),[r]),g.createElement(CN,{basename:e,children:s,location:o.location,navigationType:o.action,navigator:l,future:r})}const zN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ON=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ze=g.forwardRef(function(e,s){let{onClick:r,relative:i,reloadDocument:a,replace:l,state:o,target:c,to:d,preventScrollReset:m,viewTransition:u}=e,h=EN(e,_N),{basename:x}=g.useContext(vn),y,f=!1;if(typeof d=="string"&&ON.test(d)&&(y=d,zN))try{let v=new URL(window.location.href),S=d.startsWith("//")?new URL(v.protocol+d):new URL(d),N=Gu(S.pathname,x);S.origin===v.origin&&N!=null?d=N+S.search+S.hash:f=!0}catch{}let w=dN(d,{relative:i}),p=IN(d,{replace:l,state:o,target:c,preventScrollReset:m,relative:i,viewTransition:u});function b(v){r&&r(v),v.defaultPrevented||p(v)}return g.createElement("a",zd({},h,{href:y||w,onClick:f||a?r:b,ref:s,target:c}))});var Um;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Um||(Um={}));var Wm;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Wm||(Wm={}));function IN(t,e){let{target:s,replace:r,state:i,preventScrollReset:a,relative:l,viewTransition:o}=e===void 0?{}:e,c=rs(),d=jn(),m=_0(t,{relative:l});return g.useCallback(u=>{if(PN(u,s)){u.preventDefault();let h=r!==void 0?r:Zl(d)===Zl(m);c(t,{replace:h,state:i,preventScrollReset:a,relative:l,viewTransition:o})}},[d,c,m,r,i,s,t,a,l,o])}function $N(t){let e=g.useRef(Od(t)),s=g.useRef(!1),r=jn(),i=g.useMemo(()=>LN(r.search,s.current?null:e.current),[r.search]),a=rs(),l=g.useCallback((o,c)=>{const d=Od(typeof o=="function"?o(i):o);s.current=!0,a("?"+d,c)},[a,i]);return[i,l]}function z0(t,e){return function(){return t.apply(e,arguments)}}const{toString:BN}=Object.prototype,{getPrototypeOf:sh}=Object,{iterator:To,toStringTag:O0}=Symbol,Po=(t=>e=>{const s=BN.call(e);return t[s]||(t[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),is=t=>(t=t.toLowerCase(),e=>Po(e)===t),Lo=t=>e=>typeof e===t,{isArray:Wr}=Array,_r=Lo("undefined");function ka(t){return t!==null&&!_r(t)&&t.constructor!==null&&!_r(t.constructor)&&Et(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const I0=is("ArrayBuffer");function DN(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&I0(t.buffer),e}const FN=Lo("string"),Et=Lo("function"),$0=Lo("number"),Sa=t=>t!==null&&typeof t=="object",UN=t=>t===!0||t===!1,Nl=t=>{if(Po(t)!=="object")return!1;const e=sh(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(O0 in t)&&!(To in t)},WN=t=>{if(!Sa(t)||ka(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},VN=is("Date"),qN=is("File"),HN=is("Blob"),KN=is("FileList"),YN=t=>Sa(t)&&Et(t.pipe),QN=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Et(t.append)&&((e=Po(t))==="formdata"||e==="object"&&Et(t.toString)&&t.toString()==="[object FormData]"))},XN=is("URLSearchParams"),[GN,JN,ZN,ej]=["ReadableStream","Request","Response","Headers"].map(is),tj=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ca(t,e,{allOwnKeys:s=!1}={}){if(t===null||typeof t>"u")return;let r,i;if(typeof t!="object"&&(t=[t]),Wr(t))for(r=0,i=t.length;r<i;r++)e.call(null,t[r],r,t);else{if(ka(t))return;const a=s?Object.getOwnPropertyNames(t):Object.keys(t),l=a.length;let o;for(r=0;r<l;r++)o=a[r],e.call(null,t[o],o,t)}}function B0(t,e){if(ka(t))return null;e=e.toLowerCase();const s=Object.keys(t);let r=s.length,i;for(;r-- >0;)if(i=s[r],e===i.toLowerCase())return i;return null}const Mn=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,D0=t=>!_r(t)&&t!==Mn;function Id(){const{caseless:t,skipUndefined:e}=D0(this)&&this||{},s={},r=(i,a)=>{const l=t&&B0(s,a)||a;Nl(s[l])&&Nl(i)?s[l]=Id(s[l],i):Nl(i)?s[l]=Id({},i):Wr(i)?s[l]=i.slice():(!e||!_r(i))&&(s[l]=i)};for(let i=0,a=arguments.length;i<a;i++)arguments[i]&&Ca(arguments[i],r);return s}const sj=(t,e,s,{allOwnKeys:r}={})=>(Ca(e,(i,a)=>{s&&Et(i)?t[a]=z0(i,s):t[a]=i},{allOwnKeys:r}),t),nj=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),rj=(t,e,s,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),s&&Object.assign(t.prototype,s)},ij=(t,e,s,r)=>{let i,a,l;const o={};if(e=e||{},t==null)return e;do{for(i=Object.getOwnPropertyNames(t),a=i.length;a-- >0;)l=i[a],(!r||r(l,t,e))&&!o[l]&&(e[l]=t[l],o[l]=!0);t=s!==!1&&sh(t)}while(t&&(!s||s(t,e))&&t!==Object.prototype);return e},aj=(t,e,s)=>{t=String(t),(s===void 0||s>t.length)&&(s=t.length),s-=e.length;const r=t.indexOf(e,s);return r!==-1&&r===s},lj=t=>{if(!t)return null;if(Wr(t))return t;let e=t.length;if(!$0(e))return null;const s=new Array(e);for(;e-- >0;)s[e]=t[e];return s},oj=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&sh(Uint8Array)),cj=(t,e)=>{const r=(t&&t[To]).call(t);let i;for(;(i=r.next())&&!i.done;){const a=i.value;e.call(t,a[0],a[1])}},dj=(t,e)=>{let s;const r=[];for(;(s=t.exec(e))!==null;)r.push(s);return r},uj=is("HTMLFormElement"),hj=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,r,i){return r.toUpperCase()+i}),Vm=(({hasOwnProperty:t})=>(e,s)=>t.call(e,s))(Object.prototype),mj=is("RegExp"),F0=(t,e)=>{const s=Object.getOwnPropertyDescriptors(t),r={};Ca(s,(i,a)=>{let l;(l=e(i,a,t))!==!1&&(r[a]=l||i)}),Object.defineProperties(t,r)},pj=t=>{F0(t,(e,s)=>{if(Et(t)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const r=t[s];if(Et(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},xj=(t,e)=>{const s={},r=i=>{i.forEach(a=>{s[a]=!0})};return Wr(t)?r(t):r(String(t).split(e)),s},fj=()=>{},gj=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function yj(t){return!!(t&&Et(t.append)&&t[O0]==="FormData"&&t[To])}const bj=t=>{const e=new Array(10),s=(r,i)=>{if(Sa(r)){if(e.indexOf(r)>=0)return;if(ka(r))return r;if(!("toJSON"in r)){e[i]=r;const a=Wr(r)?[]:{};return Ca(r,(l,o)=>{const c=s(l,i+1);!_r(c)&&(a[o]=c)}),e[i]=void 0,a}}return r};return s(t,0)},vj=is("AsyncFunction"),Nj=t=>t&&(Sa(t)||Et(t))&&Et(t.then)&&Et(t.catch),U0=((t,e)=>t?setImmediate:e?((s,r)=>(Mn.addEventListener("message",({source:i,data:a})=>{i===Mn&&a===s&&r.length&&r.shift()()},!1),i=>{r.push(i),Mn.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",Et(Mn.postMessage)),jj=typeof queueMicrotask<"u"?queueMicrotask.bind(Mn):typeof process<"u"&&process.nextTick||U0,wj=t=>t!=null&&Et(t[To]),q={isArray:Wr,isArrayBuffer:I0,isBuffer:ka,isFormData:QN,isArrayBufferView:DN,isString:FN,isNumber:$0,isBoolean:UN,isObject:Sa,isPlainObject:Nl,isEmptyObject:WN,isReadableStream:GN,isRequest:JN,isResponse:ZN,isHeaders:ej,isUndefined:_r,isDate:VN,isFile:qN,isBlob:HN,isRegExp:mj,isFunction:Et,isStream:YN,isURLSearchParams:XN,isTypedArray:oj,isFileList:KN,forEach:Ca,merge:Id,extend:sj,trim:tj,stripBOM:nj,inherits:rj,toFlatObject:ij,kindOf:Po,kindOfTest:is,endsWith:aj,toArray:lj,forEachEntry:cj,matchAll:dj,isHTMLForm:uj,hasOwnProperty:Vm,hasOwnProp:Vm,reduceDescriptors:F0,freezeMethods:pj,toObjectSet:xj,toCamelCase:hj,noop:fj,toFiniteNumber:gj,findKey:B0,global:Mn,isContextDefined:D0,isSpecCompliantForm:yj,toJSONObject:bj,isAsyncFn:vj,isThenable:Nj,setImmediate:U0,asap:jj,isIterable:wj};function me(t,e,s,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),s&&(this.config=s),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}q.inherits(me,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:q.toJSONObject(this.config),code:this.code,status:this.status}}});const W0=me.prototype,V0={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{V0[t]={value:t}});Object.defineProperties(me,V0);Object.defineProperty(W0,"isAxiosError",{value:!0});me.from=(t,e,s,r,i,a)=>{const l=Object.create(W0);q.toFlatObject(t,l,function(m){return m!==Error.prototype},d=>d!=="isAxiosError");const o=t&&t.message?t.message:"Error",c=e==null&&t?t.code:e;return me.call(l,o,c,s,r,i),t&&l.cause==null&&Object.defineProperty(l,"cause",{value:t,configurable:!0}),l.name=t&&t.name||"Error",a&&Object.assign(l,a),l};const kj=null;function $d(t){return q.isPlainObject(t)||q.isArray(t)}function q0(t){return q.endsWith(t,"[]")?t.slice(0,-2):t}function qm(t,e,s){return t?t.concat(e).map(function(i,a){return i=q0(i),!s&&a?"["+i+"]":i}).join(s?".":""):e}function Sj(t){return q.isArray(t)&&!t.some($d)}const Cj=q.toFlatObject(q,{},null,function(e){return/^is[A-Z]/.test(e)});function _o(t,e,s){if(!q.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,s=q.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(f,w){return!q.isUndefined(w[f])});const r=s.metaTokens,i=s.visitor||m,a=s.dots,l=s.indexes,c=(s.Blob||typeof Blob<"u"&&Blob)&&q.isSpecCompliantForm(e);if(!q.isFunction(i))throw new TypeError("visitor must be a function");function d(y){if(y===null)return"";if(q.isDate(y))return y.toISOString();if(q.isBoolean(y))return y.toString();if(!c&&q.isBlob(y))throw new me("Blob is not supported. Use a Buffer instead.");return q.isArrayBuffer(y)||q.isTypedArray(y)?c&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function m(y,f,w){let p=y;if(y&&!w&&typeof y=="object"){if(q.endsWith(f,"{}"))f=r?f:f.slice(0,-2),y=JSON.stringify(y);else if(q.isArray(y)&&Sj(y)||(q.isFileList(y)||q.endsWith(f,"[]"))&&(p=q.toArray(y)))return f=q0(f),p.forEach(function(v,S){!(q.isUndefined(v)||v===null)&&e.append(l===!0?qm([f],S,a):l===null?f:f+"[]",d(v))}),!1}return $d(y)?!0:(e.append(qm(w,f,a),d(y)),!1)}const u=[],h=Object.assign(Cj,{defaultVisitor:m,convertValue:d,isVisitable:$d});function x(y,f){if(!q.isUndefined(y)){if(u.indexOf(y)!==-1)throw Error("Circular reference detected in "+f.join("."));u.push(y),q.forEach(y,function(p,b){(!(q.isUndefined(p)||p===null)&&i.call(e,p,q.isString(b)?b.trim():b,f,h))===!0&&x(p,f?f.concat(b):[b])}),u.pop()}}if(!q.isObject(t))throw new TypeError("data must be an object");return x(t),e}function Hm(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function nh(t,e){this._pairs=[],t&&_o(t,this,e)}const H0=nh.prototype;H0.append=function(e,s){this._pairs.push([e,s])};H0.toString=function(e){const s=e?function(r){return e.call(this,r,Hm)}:Hm;return this._pairs.map(function(i){return s(i[0])+"="+s(i[1])},"").join("&")};function Ej(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function K0(t,e,s){if(!e)return t;const r=s&&s.encode||Ej;q.isFunction(s)&&(s={serialize:s});const i=s&&s.serialize;let a;if(i?a=i(e,s):a=q.isURLSearchParams(e)?e.toString():new nh(e,s).toString(r),a){const l=t.indexOf("#");l!==-1&&(t=t.slice(0,l)),t+=(t.indexOf("?")===-1?"?":"&")+a}return t}class Km{constructor(){this.handlers=[]}use(e,s,r){return this.handlers.push({fulfilled:e,rejected:s,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){q.forEach(this.handlers,function(r){r!==null&&e(r)})}}const Y0={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Tj=typeof URLSearchParams<"u"?URLSearchParams:nh,Pj=typeof FormData<"u"?FormData:null,Lj=typeof Blob<"u"?Blob:null,_j={isBrowser:!0,classes:{URLSearchParams:Tj,FormData:Pj,Blob:Lj},protocols:["http","https","file","blob","url","data"]},rh=typeof window<"u"&&typeof document<"u",Bd=typeof navigator=="object"&&navigator||void 0,Mj=rh&&(!Bd||["ReactNative","NativeScript","NS"].indexOf(Bd.product)<0),Rj=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Aj=rh&&window.location.href||"http://localhost",zj=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:rh,hasStandardBrowserEnv:Mj,hasStandardBrowserWebWorkerEnv:Rj,navigator:Bd,origin:Aj},Symbol.toStringTag,{value:"Module"})),mt={...zj,..._j};function Oj(t,e){return _o(t,new mt.classes.URLSearchParams,{visitor:function(s,r,i,a){return mt.isNode&&q.isBuffer(s)?(this.append(r,s.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...e})}function Ij(t){return q.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function $j(t){const e={},s=Object.keys(t);let r;const i=s.length;let a;for(r=0;r<i;r++)a=s[r],e[a]=t[a];return e}function Q0(t){function e(s,r,i,a){let l=s[a++];if(l==="__proto__")return!0;const o=Number.isFinite(+l),c=a>=s.length;return l=!l&&q.isArray(i)?i.length:l,c?(q.hasOwnProp(i,l)?i[l]=[i[l],r]:i[l]=r,!o):((!i[l]||!q.isObject(i[l]))&&(i[l]=[]),e(s,r,i[l],a)&&q.isArray(i[l])&&(i[l]=$j(i[l])),!o)}if(q.isFormData(t)&&q.isFunction(t.entries)){const s={};return q.forEachEntry(t,(r,i)=>{e(Ij(r),i,s,0)}),s}return null}function Bj(t,e,s){if(q.isString(t))try{return(e||JSON.parse)(t),q.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(s||JSON.stringify)(t)}const Ea={transitional:Y0,adapter:["xhr","http","fetch"],transformRequest:[function(e,s){const r=s.getContentType()||"",i=r.indexOf("application/json")>-1,a=q.isObject(e);if(a&&q.isHTMLForm(e)&&(e=new FormData(e)),q.isFormData(e))return i?JSON.stringify(Q0(e)):e;if(q.isArrayBuffer(e)||q.isBuffer(e)||q.isStream(e)||q.isFile(e)||q.isBlob(e)||q.isReadableStream(e))return e;if(q.isArrayBufferView(e))return e.buffer;if(q.isURLSearchParams(e))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Oj(e,this.formSerializer).toString();if((o=q.isFileList(e))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return _o(o?{"files[]":e}:e,c&&new c,this.formSerializer)}}return a||i?(s.setContentType("application/json",!1),Bj(e)):e}],transformResponse:[function(e){const s=this.transitional||Ea.transitional,r=s&&s.forcedJSONParsing,i=this.responseType==="json";if(q.isResponse(e)||q.isReadableStream(e))return e;if(e&&q.isString(e)&&(r&&!this.responseType||i)){const l=!(s&&s.silentJSONParsing)&&i;try{return JSON.parse(e,this.parseReviver)}catch(o){if(l)throw o.name==="SyntaxError"?me.from(o,me.ERR_BAD_RESPONSE,this,null,this.response):o}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:mt.classes.FormData,Blob:mt.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};q.forEach(["delete","get","head","post","put","patch"],t=>{Ea.headers[t]={}});const Dj=q.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Fj=t=>{const e={};let s,r,i;return t&&t.split(`
`).forEach(function(l){i=l.indexOf(":"),s=l.substring(0,i).trim().toLowerCase(),r=l.substring(i+1).trim(),!(!s||e[s]&&Dj[s])&&(s==="set-cookie"?e[s]?e[s].push(r):e[s]=[r]:e[s]=e[s]?e[s]+", "+r:r)}),e},Ym=Symbol("internals");function Ei(t){return t&&String(t).trim().toLowerCase()}function jl(t){return t===!1||t==null?t:q.isArray(t)?t.map(jl):String(t)}function Uj(t){const e=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=s.exec(t);)e[r[1]]=r[2];return e}const Wj=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function pc(t,e,s,r,i){if(q.isFunction(r))return r.call(this,e,s);if(i&&(e=s),!!q.isString(e)){if(q.isString(r))return e.indexOf(r)!==-1;if(q.isRegExp(r))return r.test(e)}}function Vj(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,s,r)=>s.toUpperCase()+r)}function qj(t,e){const s=q.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+s,{value:function(i,a,l){return this[r].call(this,e,i,a,l)},configurable:!0})})}let Tt=class{constructor(e){e&&this.set(e)}set(e,s,r){const i=this;function a(o,c,d){const m=Ei(c);if(!m)throw new Error("header name must be a non-empty string");const u=q.findKey(i,m);(!u||i[u]===void 0||d===!0||d===void 0&&i[u]!==!1)&&(i[u||c]=jl(o))}const l=(o,c)=>q.forEach(o,(d,m)=>a(d,m,c));if(q.isPlainObject(e)||e instanceof this.constructor)l(e,s);else if(q.isString(e)&&(e=e.trim())&&!Wj(e))l(Fj(e),s);else if(q.isObject(e)&&q.isIterable(e)){let o={},c,d;for(const m of e){if(!q.isArray(m))throw TypeError("Object iterator must return a key-value pair");o[d=m[0]]=(c=o[d])?q.isArray(c)?[...c,m[1]]:[c,m[1]]:m[1]}l(o,s)}else e!=null&&a(s,e,r);return this}get(e,s){if(e=Ei(e),e){const r=q.findKey(this,e);if(r){const i=this[r];if(!s)return i;if(s===!0)return Uj(i);if(q.isFunction(s))return s.call(this,i,r);if(q.isRegExp(s))return s.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,s){if(e=Ei(e),e){const r=q.findKey(this,e);return!!(r&&this[r]!==void 0&&(!s||pc(this,this[r],r,s)))}return!1}delete(e,s){const r=this;let i=!1;function a(l){if(l=Ei(l),l){const o=q.findKey(r,l);o&&(!s||pc(r,r[o],o,s))&&(delete r[o],i=!0)}}return q.isArray(e)?e.forEach(a):a(e),i}clear(e){const s=Object.keys(this);let r=s.length,i=!1;for(;r--;){const a=s[r];(!e||pc(this,this[a],a,e,!0))&&(delete this[a],i=!0)}return i}normalize(e){const s=this,r={};return q.forEach(this,(i,a)=>{const l=q.findKey(r,a);if(l){s[l]=jl(i),delete s[a];return}const o=e?Vj(a):String(a).trim();o!==a&&delete s[a],s[o]=jl(i),r[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const s=Object.create(null);return q.forEach(this,(r,i)=>{r!=null&&r!==!1&&(s[i]=e&&q.isArray(r)?r.join(", "):r)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,s])=>e+": "+s).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...s){const r=new this(e);return s.forEach(i=>r.set(i)),r}static accessor(e){const r=(this[Ym]=this[Ym]={accessors:{}}).accessors,i=this.prototype;function a(l){const o=Ei(l);r[o]||(qj(i,l),r[o]=!0)}return q.isArray(e)?e.forEach(a):a(e),this}};Tt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);q.reduceDescriptors(Tt.prototype,({value:t},e)=>{let s=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[s]=r}}});q.freezeMethods(Tt);function xc(t,e){const s=this||Ea,r=e||s,i=Tt.from(r.headers);let a=r.data;return q.forEach(t,function(o){a=o.call(s,a,i.normalize(),e?e.status:void 0)}),i.normalize(),a}function X0(t){return!!(t&&t.__CANCEL__)}function Vr(t,e,s){me.call(this,t??"canceled",me.ERR_CANCELED,e,s),this.name="CanceledError"}q.inherits(Vr,me,{__CANCEL__:!0});function G0(t,e,s){const r=s.config.validateStatus;!s.status||!r||r(s.status)?t(s):e(new me("Request failed with status code "+s.status,[me.ERR_BAD_REQUEST,me.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function Hj(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function Kj(t,e){t=t||10;const s=new Array(t),r=new Array(t);let i=0,a=0,l;return e=e!==void 0?e:1e3,function(c){const d=Date.now(),m=r[a];l||(l=d),s[i]=c,r[i]=d;let u=a,h=0;for(;u!==i;)h+=s[u++],u=u%t;if(i=(i+1)%t,i===a&&(a=(a+1)%t),d-l<e)return;const x=m&&d-m;return x?Math.round(h*1e3/x):void 0}}function Yj(t,e){let s=0,r=1e3/e,i,a;const l=(d,m=Date.now())=>{s=m,i=null,a&&(clearTimeout(a),a=null),t(...d)};return[(...d)=>{const m=Date.now(),u=m-s;u>=r?l(d,m):(i=d,a||(a=setTimeout(()=>{a=null,l(i)},r-u)))},()=>i&&l(i)]}const to=(t,e,s=3)=>{let r=0;const i=Kj(50,250);return Yj(a=>{const l=a.loaded,o=a.lengthComputable?a.total:void 0,c=l-r,d=i(c),m=l<=o;r=l;const u={loaded:l,total:o,progress:o?l/o:void 0,bytes:c,rate:d||void 0,estimated:d&&o&&m?(o-l)/d:void 0,event:a,lengthComputable:o!=null,[e?"download":"upload"]:!0};t(u)},s)},Qm=(t,e)=>{const s=t!=null;return[r=>e[0]({lengthComputable:s,total:t,loaded:r}),e[1]]},Xm=t=>(...e)=>q.asap(()=>t(...e)),Qj=mt.hasStandardBrowserEnv?((t,e)=>s=>(s=new URL(s,mt.origin),t.protocol===s.protocol&&t.host===s.host&&(e||t.port===s.port)))(new URL(mt.origin),mt.navigator&&/(msie|trident)/i.test(mt.navigator.userAgent)):()=>!0,Xj=mt.hasStandardBrowserEnv?{write(t,e,s,r,i,a,l){if(typeof document>"u")return;const o=[`${t}=${encodeURIComponent(e)}`];q.isNumber(s)&&o.push(`expires=${new Date(s).toUTCString()}`),q.isString(r)&&o.push(`path=${r}`),q.isString(i)&&o.push(`domain=${i}`),a===!0&&o.push("secure"),q.isString(l)&&o.push(`SameSite=${l}`),document.cookie=o.join("; ")},read(t){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function Gj(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Jj(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function J0(t,e,s){let r=!Gj(e);return t&&(r||s==!1)?Jj(t,e):e}const Gm=t=>t instanceof Tt?{...t}:t;function Un(t,e){e=e||{};const s={};function r(d,m,u,h){return q.isPlainObject(d)&&q.isPlainObject(m)?q.merge.call({caseless:h},d,m):q.isPlainObject(m)?q.merge({},m):q.isArray(m)?m.slice():m}function i(d,m,u,h){if(q.isUndefined(m)){if(!q.isUndefined(d))return r(void 0,d,u,h)}else return r(d,m,u,h)}function a(d,m){if(!q.isUndefined(m))return r(void 0,m)}function l(d,m){if(q.isUndefined(m)){if(!q.isUndefined(d))return r(void 0,d)}else return r(void 0,m)}function o(d,m,u){if(u in e)return r(d,m);if(u in t)return r(void 0,d)}const c={url:a,method:a,data:a,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:o,headers:(d,m,u)=>i(Gm(d),Gm(m),u,!0)};return q.forEach(Object.keys({...t,...e}),function(m){const u=c[m]||i,h=u(t[m],e[m],m);q.isUndefined(h)&&u!==o||(s[m]=h)}),s}const Z0=t=>{const e=Un({},t);let{data:s,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:a,headers:l,auth:o}=e;if(e.headers=l=Tt.from(l),e.url=K0(J0(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),o&&l.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),q.isFormData(s)){if(mt.hasStandardBrowserEnv||mt.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(q.isFunction(s.getHeaders)){const c=s.getHeaders(),d=["content-type","content-length"];Object.entries(c).forEach(([m,u])=>{d.includes(m.toLowerCase())&&l.set(m,u)})}}if(mt.hasStandardBrowserEnv&&(r&&q.isFunction(r)&&(r=r(e)),r||r!==!1&&Qj(e.url))){const c=i&&a&&Xj.read(a);c&&l.set(i,c)}return e},Zj=typeof XMLHttpRequest<"u",ew=Zj&&function(t){return new Promise(function(s,r){const i=Z0(t);let a=i.data;const l=Tt.from(i.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:d}=i,m,u,h,x,y;function f(){x&&x(),y&&y(),i.cancelToken&&i.cancelToken.unsubscribe(m),i.signal&&i.signal.removeEventListener("abort",m)}let w=new XMLHttpRequest;w.open(i.method.toUpperCase(),i.url,!0),w.timeout=i.timeout;function p(){if(!w)return;const v=Tt.from("getAllResponseHeaders"in w&&w.getAllResponseHeaders()),N={data:!o||o==="text"||o==="json"?w.responseText:w.response,status:w.status,statusText:w.statusText,headers:v,config:t,request:w};G0(function(j){s(j),f()},function(j){r(j),f()},N),w=null}"onloadend"in w?w.onloadend=p:w.onreadystatechange=function(){!w||w.readyState!==4||w.status===0&&!(w.responseURL&&w.responseURL.indexOf("file:")===0)||setTimeout(p)},w.onabort=function(){w&&(r(new me("Request aborted",me.ECONNABORTED,t,w)),w=null)},w.onerror=function(S){const N=S&&S.message?S.message:"Network Error",k=new me(N,me.ERR_NETWORK,t,w);k.event=S||null,r(k),w=null},w.ontimeout=function(){let S=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const N=i.transitional||Y0;i.timeoutErrorMessage&&(S=i.timeoutErrorMessage),r(new me(S,N.clarifyTimeoutError?me.ETIMEDOUT:me.ECONNABORTED,t,w)),w=null},a===void 0&&l.setContentType(null),"setRequestHeader"in w&&q.forEach(l.toJSON(),function(S,N){w.setRequestHeader(N,S)}),q.isUndefined(i.withCredentials)||(w.withCredentials=!!i.withCredentials),o&&o!=="json"&&(w.responseType=i.responseType),d&&([h,y]=to(d,!0),w.addEventListener("progress",h)),c&&w.upload&&([u,x]=to(c),w.upload.addEventListener("progress",u),w.upload.addEventListener("loadend",x)),(i.cancelToken||i.signal)&&(m=v=>{w&&(r(!v||v.type?new Vr(null,t,w):v),w.abort(),w=null)},i.cancelToken&&i.cancelToken.subscribe(m),i.signal&&(i.signal.aborted?m():i.signal.addEventListener("abort",m)));const b=Hj(i.url);if(b&&mt.protocols.indexOf(b)===-1){r(new me("Unsupported protocol "+b+":",me.ERR_BAD_REQUEST,t));return}w.send(a||null)})},tw=(t,e)=>{const{length:s}=t=t?t.filter(Boolean):[];if(e||s){let r=new AbortController,i;const a=function(d){if(!i){i=!0,o();const m=d instanceof Error?d:this.reason;r.abort(m instanceof me?m:new Vr(m instanceof Error?m.message:m))}};let l=e&&setTimeout(()=>{l=null,a(new me(`timeout ${e} of ms exceeded`,me.ETIMEDOUT))},e);const o=()=>{t&&(l&&clearTimeout(l),l=null,t.forEach(d=>{d.unsubscribe?d.unsubscribe(a):d.removeEventListener("abort",a)}),t=null)};t.forEach(d=>d.addEventListener("abort",a));const{signal:c}=r;return c.unsubscribe=()=>q.asap(o),c}},sw=function*(t,e){let s=t.byteLength;if(s<e){yield t;return}let r=0,i;for(;r<s;)i=r+e,yield t.slice(r,i),r=i},nw=async function*(t,e){for await(const s of rw(t))yield*sw(s,e)},rw=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:s,value:r}=await e.read();if(s)break;yield r}}finally{await e.cancel()}},Jm=(t,e,s,r)=>{const i=nw(t,e);let a=0,l,o=c=>{l||(l=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:d,value:m}=await i.next();if(d){o(),c.close();return}let u=m.byteLength;if(s){let h=a+=u;s(h)}c.enqueue(new Uint8Array(m))}catch(d){throw o(d),d}},cancel(c){return o(c),i.return()}},{highWaterMark:2})},Zm=64*1024,{isFunction:Qa}=q,iw=(({Request:t,Response:e})=>({Request:t,Response:e}))(q.global),{ReadableStream:ep,TextEncoder:tp}=q.global,sp=(t,...e)=>{try{return!!t(...e)}catch{return!1}},aw=t=>{t=q.merge.call({skipUndefined:!0},iw,t);const{fetch:e,Request:s,Response:r}=t,i=e?Qa(e):typeof fetch=="function",a=Qa(s),l=Qa(r);if(!i)return!1;const o=i&&Qa(ep),c=i&&(typeof tp=="function"?(y=>f=>y.encode(f))(new tp):async y=>new Uint8Array(await new s(y).arrayBuffer())),d=a&&o&&sp(()=>{let y=!1;const f=new s(mt.origin,{body:new ep,method:"POST",get duplex(){return y=!0,"half"}}).headers.has("Content-Type");return y&&!f}),m=l&&o&&sp(()=>q.isReadableStream(new r("").body)),u={stream:m&&(y=>y.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(y=>{!u[y]&&(u[y]=(f,w)=>{let p=f&&f[y];if(p)return p.call(f);throw new me(`Response type '${y}' is not supported`,me.ERR_NOT_SUPPORT,w)})});const h=async y=>{if(y==null)return 0;if(q.isBlob(y))return y.size;if(q.isSpecCompliantForm(y))return(await new s(mt.origin,{method:"POST",body:y}).arrayBuffer()).byteLength;if(q.isArrayBufferView(y)||q.isArrayBuffer(y))return y.byteLength;if(q.isURLSearchParams(y)&&(y=y+""),q.isString(y))return(await c(y)).byteLength},x=async(y,f)=>{const w=q.toFiniteNumber(y.getContentLength());return w??h(f)};return async y=>{let{url:f,method:w,data:p,signal:b,cancelToken:v,timeout:S,onDownloadProgress:N,onUploadProgress:k,responseType:j,headers:E,withCredentials:_="same-origin",fetchOptions:M}=Z0(y),V=e||fetch;j=j?(j+"").toLowerCase():"text";let B=tw([b,v&&v.toAbortSignal()],S),R=null;const O=B&&B.unsubscribe&&(()=>{B.unsubscribe()});let P;try{if(k&&d&&w!=="get"&&w!=="head"&&(P=await x(E,p))!==0){let C=new s(f,{method:"POST",body:p,duplex:"half"}),H;if(q.isFormData(p)&&(H=C.headers.get("content-type"))&&E.setContentType(H),C.body){const[J,ce]=Qm(P,to(Xm(k)));p=Jm(C.body,Zm,J,ce)}}q.isString(_)||(_=_?"include":"omit");const W=a&&"credentials"in s.prototype,D={...M,signal:B,method:w.toUpperCase(),headers:E.normalize().toJSON(),body:p,duplex:"half",credentials:W?_:void 0};R=a&&new s(f,D);let T=await(a?V(R,M):V(f,D));const L=m&&(j==="stream"||j==="response");if(m&&(N||L&&O)){const C={};["status","statusText","headers"].forEach(U=>{C[U]=T[U]});const H=q.toFiniteNumber(T.headers.get("content-length")),[J,ce]=N&&Qm(H,to(Xm(N),!0))||[];T=new r(Jm(T.body,Zm,J,()=>{ce&&ce(),O&&O()}),C)}j=j||"text";let F=await u[q.findKey(u,j)||"text"](T,y);return!L&&O&&O(),await new Promise((C,H)=>{G0(C,H,{data:F,headers:Tt.from(T.headers),status:T.status,statusText:T.statusText,config:y,request:R})})}catch(W){throw O&&O(),W&&W.name==="TypeError"&&/Load failed|fetch/i.test(W.message)?Object.assign(new me("Network Error",me.ERR_NETWORK,y,R),{cause:W.cause||W}):me.from(W,W&&W.code,y,R)}}},lw=new Map,eg=t=>{let e=t&&t.env||{};const{fetch:s,Request:r,Response:i}=e,a=[r,i,s];let l=a.length,o=l,c,d,m=lw;for(;o--;)c=a[o],d=m.get(c),d===void 0&&m.set(c,d=o?new Map:aw(e)),m=d;return d};eg();const ih={http:kj,xhr:ew,fetch:{get:eg}};q.forEach(ih,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const np=t=>`- ${t}`,ow=t=>q.isFunction(t)||t===null||t===!1;function cw(t,e){t=q.isArray(t)?t:[t];const{length:s}=t;let r,i;const a={};for(let l=0;l<s;l++){r=t[l];let o;if(i=r,!ow(r)&&(i=ih[(o=String(r)).toLowerCase()],i===void 0))throw new me(`Unknown adapter '${o}'`);if(i&&(q.isFunction(i)||(i=i.get(e))))break;a[o||"#"+l]=i}if(!i){const l=Object.entries(a).map(([c,d])=>`adapter ${c} `+(d===!1?"is not supported by the environment":"is not available in the build"));let o=s?l.length>1?`since :
`+l.map(np).join(`
`):" "+np(l[0]):"as no adapter specified";throw new me("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return i}const tg={getAdapter:cw,adapters:ih};function fc(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Vr(null,t)}function rp(t){return fc(t),t.headers=Tt.from(t.headers),t.data=xc.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),tg.getAdapter(t.adapter||Ea.adapter,t)(t).then(function(r){return fc(t),r.data=xc.call(t,t.transformResponse,r),r.headers=Tt.from(r.headers),r},function(r){return X0(r)||(fc(t),r&&r.response&&(r.response.data=xc.call(t,t.transformResponse,r.response),r.response.headers=Tt.from(r.response.headers))),Promise.reject(r)})}const sg="1.13.2",Mo={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Mo[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const ip={};Mo.transitional=function(e,s,r){function i(a,l){return"[Axios v"+sg+"] Transitional option '"+a+"'"+l+(r?". "+r:"")}return(a,l,o)=>{if(e===!1)throw new me(i(l," has been removed"+(s?" in "+s:"")),me.ERR_DEPRECATED);return s&&!ip[l]&&(ip[l]=!0,console.warn(i(l," has been deprecated since v"+s+" and will be removed in the near future"))),e?e(a,l,o):!0}};Mo.spelling=function(e){return(s,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function dw(t,e,s){if(typeof t!="object")throw new me("options must be an object",me.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let i=r.length;for(;i-- >0;){const a=r[i],l=e[a];if(l){const o=t[a],c=o===void 0||l(o,a,t);if(c!==!0)throw new me("option "+a+" must be "+c,me.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new me("Unknown option "+a,me.ERR_BAD_OPTION)}}const wl={assertOptions:dw,validators:Mo},cs=wl.validators;let zn=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Km,response:new Km}}async request(e,s){try{return await this._request(e,s)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const a=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?a&&!String(r.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+a):r.stack=a}catch{}}throw r}}_request(e,s){typeof e=="string"?(s=s||{},s.url=e):s=e||{},s=Un(this.defaults,s);const{transitional:r,paramsSerializer:i,headers:a}=s;r!==void 0&&wl.assertOptions(r,{silentJSONParsing:cs.transitional(cs.boolean),forcedJSONParsing:cs.transitional(cs.boolean),clarifyTimeoutError:cs.transitional(cs.boolean)},!1),i!=null&&(q.isFunction(i)?s.paramsSerializer={serialize:i}:wl.assertOptions(i,{encode:cs.function,serialize:cs.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),wl.assertOptions(s,{baseUrl:cs.spelling("baseURL"),withXsrfToken:cs.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let l=a&&q.merge(a.common,a[s.method]);a&&q.forEach(["delete","get","head","post","put","patch","common"],y=>{delete a[y]}),s.headers=Tt.concat(l,a);const o=[];let c=!0;this.interceptors.request.forEach(function(f){typeof f.runWhen=="function"&&f.runWhen(s)===!1||(c=c&&f.synchronous,o.unshift(f.fulfilled,f.rejected))});const d=[];this.interceptors.response.forEach(function(f){d.push(f.fulfilled,f.rejected)});let m,u=0,h;if(!c){const y=[rp.bind(this),void 0];for(y.unshift(...o),y.push(...d),h=y.length,m=Promise.resolve(s);u<h;)m=m.then(y[u++],y[u++]);return m}h=o.length;let x=s;for(;u<h;){const y=o[u++],f=o[u++];try{x=y(x)}catch(w){f.call(this,w);break}}try{m=rp.call(this,x)}catch(y){return Promise.reject(y)}for(u=0,h=d.length;u<h;)m=m.then(d[u++],d[u++]);return m}getUri(e){e=Un(this.defaults,e);const s=J0(e.baseURL,e.url,e.allowAbsoluteUrls);return K0(s,e.params,e.paramsSerializer)}};q.forEach(["delete","get","head","options"],function(e){zn.prototype[e]=function(s,r){return this.request(Un(r||{},{method:e,url:s,data:(r||{}).data}))}});q.forEach(["post","put","patch"],function(e){function s(r){return function(a,l,o){return this.request(Un(o||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:a,data:l}))}}zn.prototype[e]=s(),zn.prototype[e+"Form"]=s(!0)});let uw=class ng{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(a){s=a});const r=this;this.promise.then(i=>{if(!r._listeners)return;let a=r._listeners.length;for(;a-- >0;)r._listeners[a](i);r._listeners=null}),this.promise.then=i=>{let a;const l=new Promise(o=>{r.subscribe(o),a=o}).then(i);return l.cancel=function(){r.unsubscribe(a)},l},e(function(a,l,o){r.reason||(r.reason=new Vr(a,l,o),s(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const s=this._listeners.indexOf(e);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const e=new AbortController,s=r=>{e.abort(r)};return this.subscribe(s),e.signal.unsubscribe=()=>this.unsubscribe(s),e.signal}static source(){let e;return{token:new ng(function(i){e=i}),cancel:e}}};function hw(t){return function(s){return t.apply(null,s)}}function mw(t){return q.isObject(t)&&t.isAxiosError===!0}const Dd={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Dd).forEach(([t,e])=>{Dd[e]=t});function rg(t){const e=new zn(t),s=z0(zn.prototype.request,e);return q.extend(s,zn.prototype,e,{allOwnKeys:!0}),q.extend(s,e,null,{allOwnKeys:!0}),s.create=function(i){return rg(Un(t,i))},s}const I=rg(Ea);I.Axios=zn;I.CanceledError=Vr;I.CancelToken=uw;I.isCancel=X0;I.VERSION=sg;I.toFormData=_o;I.AxiosError=me;I.Cancel=I.CanceledError;I.all=function(e){return Promise.all(e)};I.spread=hw;I.isAxiosError=mw;I.mergeConfig=Un;I.AxiosHeaders=Tt;I.formToJSON=t=>Q0(q.isHTMLForm(t)?new FormData(t):t);I.getAdapter=tg.getAdapter;I.HttpStatusCode=Dd;I.default=I;const{Axios:P4,AxiosError:L4,CanceledError:_4,isCancel:M4,CancelToken:R4,VERSION:A4,all:z4,Cancel:O4,isAxiosError:I4,spread:$4,toFormData:B4,AxiosHeaders:D4,HttpStatusCode:F4,formToJSON:U4,getAdapter:W4,mergeConfig:V4}=I,ig=g.createContext(),we=()=>g.useContext(ig),pw=({children:t})=>{const[e,s]=g.useState(null),[r,i]=g.useState(null),[a,l]=g.useState(!0);g.useEffect(()=>{const f=localStorage.getItem("user"),w=localStorage.getItem("admin");f&&s(JSON.parse(f)),w&&i(JSON.parse(w)),l(!1)},[]);const y={user:e,admin:r,setAdmin:i,loading:a,loginUser:async(f,w)=>{const{data:p}=await I.post("/api/user/login",{email:f,password:w});return s(p),localStorage.setItem("user",JSON.stringify(p)),p},registerUser:async f=>{const{data:w}=await I.post("/api/user/register",f);return s(w),localStorage.setItem("user",JSON.stringify(w)),w},loginAdmin:async(f,w)=>{const{data:p}=await I.post("/api/admin/login",{email:f,password:w});return i(p),localStorage.setItem("admin",JSON.stringify(p)),p},setupAdmin:async(f,w,p)=>{const{data:b}=await I.post("/api/admin/setup",{username:f,email:w,password:p});return i(b),localStorage.setItem("admin",JSON.stringify(b)),b},logoutUser:()=>{s(null),localStorage.removeItem("user")},logoutAdmin:()=>{i(null),localStorage.removeItem("admin")},updateAdmin:f=>{const w={...r,...f};i(w),localStorage.setItem("admin",JSON.stringify(w))}};return n.jsx(ig.Provider,{value:y,children:t})};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var xw={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fw=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ie=(t,e)=>{const s=g.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:a=2,absoluteStrokeWidth:l,className:o="",children:c,...d},m)=>g.createElement("svg",{ref:m,...xw,width:i,height:i,stroke:r,strokeWidth:l?Number(a)*24/Number(i):a,className:["lucide",`lucide-${fw(t)}`,o].join(" "),...d},[...e.map(([u,h])=>g.createElement(u,h)),...Array.isArray(c)?c:[c]]));return s.displayName=`${t}`,s};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ag=ie("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gw=ie("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wn=ie("ArrowDownCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yw=ie("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bw=ie("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lg=ie("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const og=ie("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=ie("ArrowUpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vw=ie("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ah=ie("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=ie("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const so=ie("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rr=ie("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lh=ie("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cg=ie("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gc=ie("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nw=ie("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tn=ie("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jw=ie("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ww=ie("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dg=ie("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=ie("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=ie("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kw=ie("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ug=ie("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sw=ie("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=ie("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=ie("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=ie("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cw=ie("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fd=ie("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hg=ie("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const no=ie("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ew=ie("IndianRupee",[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tw=ie("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=ie("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mg=ie("LineChart",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pw=ie("ListOrdered",[["line",{x1:"10",x2:"21",y1:"6",y2:"6",key:"76qw6h"}],["line",{x1:"10",x2:"21",y1:"12",y2:"12",key:"16nom4"}],["line",{x1:"10",x2:"21",y1:"18",y2:"18",key:"u3jurt"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lw=ie("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=ie("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pg=ie("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _w=ie("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mw=ie("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xg=ie("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rw=ie("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ud=ie("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aw=ie("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=ie("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zw=ie("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=ie("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ap=ie("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ow=ie("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=ie("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=ie("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=ie("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iw=ie("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=ie("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fg=ie("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=ie("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gg=ie("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=ie("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=ie("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=ie("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lp=ie("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=ie("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yg=ie("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),$w=()=>{const[t,e]=g.useState(!1),[s,r]=g.useState({username:"",email:"",password:""}),[i,a]=g.useState(!1),[l,o]=g.useState(""),[c,d]=g.useState(!1),{loginAdmin:m,setupAdmin:u}=we(),h=rs(),x=async y=>{var f,w;y.preventDefault(),o(""),d(!0);try{t?await u(s.username,s.email,s.password):await m(s.email,s.password),h("/admin/users")}catch(p){o(((w=(f=p.response)==null?void 0:f.data)==null?void 0:w.message)||"Something went wrong")}finally{d(!1)}};return n.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex",children:[n.jsxs("div",{className:"hidden lg:flex lg:w-1/2 flex-col justify-center items-center p-12 relative overflow-hidden",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-600/20 to-blue-600/20"}),n.jsx("div",{className:"absolute top-20 left-20 w-72 h-72 bg-purple-500/30 rounded-full blur-3xl"}),n.jsx("div",{className:"absolute bottom-20 right-20 w-96 h-96 bg-blue-500/20 rounded-full blur-3xl"}),n.jsxs("div",{className:"relative z-10 text-center",children:[n.jsx("div",{className:"flex items-center justify-center gap-3 mb-8",children:n.jsx("div",{className:"p-4 bg-purple-600 rounded-2xl",children:n.jsx(ma,{className:"w-12 h-12 text-white"})})}),n.jsx("h1",{className:"text-4xl font-bold text-white mb-4",children:"Admin Control Center"}),n.jsx("p",{className:"text-xl text-gray-300 mb-12",children:"Manage your trading platform with ease"}),n.jsxs("div",{className:"grid grid-cols-2 gap-6 max-w-md",children:[n.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 text-left",children:[n.jsx(zr,{className:"w-8 h-8 text-purple-400 mb-3"}),n.jsx("h3",{className:"font-semibold text-white mb-1",children:"User Management"}),n.jsx("p",{className:"text-sm text-gray-400",children:"Create, modify & manage all users"})]}),n.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 text-left",children:[n.jsx(Mr,{className:"w-8 h-8 text-blue-400 mb-3"}),n.jsx("h3",{className:"font-semibold text-white mb-1",children:"Wallet Control"}),n.jsx("p",{className:"text-sm text-gray-400",children:"Deposit & withdraw user funds"})]}),n.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 text-left",children:[n.jsx(ts,{className:"w-8 h-8 text-green-400 mb-3"}),n.jsx("h3",{className:"font-semibold text-white mb-1",children:"Full Control"}),n.jsx("p",{className:"text-sm text-gray-400",children:"Complete platform settings"})]}),n.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 text-left",children:[n.jsx(Lw,{className:"w-8 h-8 text-yellow-400 mb-3"}),n.jsx("h3",{className:"font-semibold text-white mb-1",children:"Secure Access"}),n.jsx("p",{className:"text-sm text-gray-400",children:"Protected admin dashboard"})]})]})]})]}),n.jsx("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-8",children:n.jsxs("div",{className:"w-full max-w-md",children:[n.jsx("div",{className:"text-center mb-8 lg:hidden",children:n.jsxs("div",{className:"inline-flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"p-3 bg-purple-600 rounded-xl",children:n.jsx(ma,{className:"w-8 h-8 text-white"})}),n.jsx("span",{className:"text-2xl font-bold text-white",children:"Admin Panel"})]})}),n.jsxs("div",{className:"bg-dark-800/80 backdrop-blur-xl p-8 rounded-2xl border border-purple-500/20 shadow-2xl",children:[n.jsxs("div",{className:"text-center mb-6",children:[n.jsx("h2",{className:"text-2xl font-bold text-white",children:t?"Create Admin Account":"Admin Login"}),n.jsx("p",{className:"text-gray-400 mt-2",children:t?"Set up your admin credentials":"Access the control panel"})]}),l&&n.jsx("div",{className:"bg-red-500/20 border border-red-500 text-red-400 px-4 py-3 rounded-lg mb-6",children:l}),n.jsxs("form",{onSubmit:x,children:[t&&n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Username"}),n.jsx("input",{type:"text",value:s.username,onChange:y=>r({...s,username:y.target.value}),className:"w-full bg-dark-700 border border-purple-500/30 rounded-lg px-4 py-3 focus:outline-none focus:border-purple-500 transition",placeholder:"Enter username",required:!0})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Email Address"}),n.jsx("input",{type:"email",value:s.email,onChange:y=>r({...s,email:y.target.value}),className:"w-full bg-dark-700 border border-purple-500/30 rounded-lg px-4 py-3 focus:outline-none focus:border-purple-500 transition",placeholder:"admin@example.com",required:!0})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Password"}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:i?"text":"password",value:s.password,onChange:y=>r({...s,password:y.target.value}),className:"w-full bg-dark-700 border border-purple-500/30 rounded-lg px-4 py-3 pr-12 focus:outline-none focus:border-purple-500 transition",placeholder:"Enter password",required:!0}),n.jsx("button",{type:"button",onClick:()=>a(!i),className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white",children:i?n.jsx(Gn,{size:20}):n.jsx(wn,{size:20})})]})]}),n.jsx("button",{type:"submit",disabled:c,className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 py-3 rounded-lg font-semibold transition disabled:opacity-50 shadow-lg shadow-purple-500/25",children:c?"Please wait...":t?"Create Admin Account":"Sign In"}),n.jsx("button",{type:"button",onClick:()=>e(!t),className:"w-full mt-4 text-sm text-purple-400 hover:text-purple-300 transition",children:t?"Already have an account? Sign In":"First time? Create Admin Account"})]}),n.jsx("div",{className:"mt-6 pt-6 border-t border-gray-700 text-center",children:n.jsx(ze,{to:"/login",className:"text-sm text-gray-400 hover:text-white transition",children:"User Login "})})]})]})})]})},Bw=()=>{var x;const{admin:t,logoutAdmin:e,updateAdmin:s}=we(),r=rs(),i=jn(),[a,l]=g.useState(!1),[o,c]=g.useState(((x=t==null?void 0:t.wallet)==null?void 0:x.balance)||0),d=(t==null?void 0:t.role)==="SUPER_ADMIN";g.useEffect(()=>{!d&&(t!=null&&t.token)&&m()},[]);const m=async()=>{try{const{data:y}=await I.get("/api/admin/me",{headers:{Authorization:`Bearer ${t.token}`}});y.wallet&&(c(y.wallet.balance||0),s({wallet:y.wallet,stats:y.stats}))}catch(y){console.error("Error refreshing admin data:",y)}},u=()=>{e(),r("/admin/login")},h=d?[{path:"/admin/dashboard",icon:Mr,label:"Dashboard"},{path:"/admin/admins",icon:ma,label:"Admin Management"},{path:"/admin/all-users",icon:zr,label:"All Users"},{path:"/admin/all-trades",icon:hn,label:"All Trade Management"},{path:"/admin/all-fund-requests",icon:Ar,label:"All Fund Requests"},{path:"/admin/create-user",icon:gg,label:"Create User"},{path:"/admin/instruments",icon:gs,label:"Instruments"},{path:"/admin/lot-settings",icon:ts,label:"Lot Management"},{path:"/admin/admin-fund-requests",icon:Ge,label:"Admin Fund Requests"},{path:"/admin/market-control",icon:gs,label:"Market Control"},{path:"/admin/bank-management",icon:Rr,label:"Bank Settings"},{path:"/admin/profile",icon:ts,label:"Profile"}]:[{path:"/admin/dashboard",icon:Mr,label:"Dashboard"},{path:"/admin/wallet",icon:Ge,label:"My Wallet"},{path:"/admin/users",icon:zr,label:"User Management"},{path:"/admin/trades",icon:hn,label:"Trade Management"},{path:"/admin/fund-requests",icon:Ar,label:"Fund Requests"},{path:"/admin/bank-accounts",icon:Rr,label:"Bank Accounts"},{path:"/admin/ledger",icon:hn,label:"Transactions"},{path:"/admin/profile",icon:ts,label:"Profile"}];return n.jsxs("div",{className:"min-h-screen bg-dark-900 flex flex-col md:flex-row",children:[n.jsxs("header",{className:"md:hidden bg-dark-800 border-b border-dark-600 px-4 py-3 flex items-center justify-between",children:[n.jsxs(ze,{to:"/",className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-lg font-bold",children:"THEFX"}),n.jsx("span",{className:`text-xs ml-1 ${d?"text-yellow-400":"text-purple-400"}`,children:d?"Super Admin":"Admin"})]}),n.jsx("button",{onClick:()=>l(!a),className:"text-gray-400 hover:text-white",children:n.jsx(pg,{size:24})})]}),a&&n.jsxs("div",{className:"md:hidden bg-dark-800 border-b border-dark-600 p-4",children:[h.map(y=>n.jsxs(ze,{to:y.path,onClick:()=>l(!1),className:`flex items-center gap-3 px-4 py-3 rounded-lg mb-2 ${i.pathname===y.path||y.path!=="/admin/dashboard"&&i.pathname.startsWith(y.path)?(d?"bg-yellow-600":"bg-purple-600")+" text-white":"text-gray-400"}`,children:[n.jsx(y.icon,{size:20}),y.label]},y.path)),n.jsxs("div",{className:"border-t border-dark-600 pt-3 mt-3",children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1 px-4",children:(t==null?void 0:t.name)||(t==null?void 0:t.username)}),(t==null?void 0:t.adminCode)&&n.jsxs("div",{className:"text-xs text-purple-400 mb-2 px-4",children:["Code: ",t.adminCode]}),n.jsxs("button",{onClick:u,className:"flex items-center gap-2 text-red-400 hover:text-red-300 px-4 py-2",children:[n.jsx(jr,{size:18}),"Logout"]})]})]}),n.jsxs("aside",{className:"hidden md:flex w-64 bg-dark-800 border-r border-dark-600 flex-col",children:[n.jsxs("div",{className:"p-4 border-b border-dark-600",children:[n.jsx(ze,{to:"/",className:"flex items-center gap-2",children:n.jsx("span",{className:"text-xl font-bold",children:"THEFX"})}),n.jsx("p",{className:`text-xs mt-1 ${d?"text-yellow-400":"text-purple-400"}`,children:d?"Super Admin Panel":"Admin Panel"})]}),!d&&(t==null?void 0:t.adminCode)&&n.jsxs("div",{className:"px-4 py-3 border-b border-dark-600 bg-dark-700/50",children:[n.jsx("div",{className:"text-xs text-gray-400",children:"Your Admin Code"}),n.jsx("div",{className:"text-lg font-mono font-bold text-purple-400",children:t.adminCode}),n.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Wallet: ",o.toLocaleString()]})]}),n.jsx("nav",{className:"flex-1 p-4 space-y-1",children:h.map(y=>n.jsxs(ze,{to:y.path,className:`flex items-center gap-3 px-4 py-3 rounded-lg transition ${i.pathname===y.path||y.path!=="/admin/dashboard"&&i.pathname.startsWith(y.path)?(d?"bg-yellow-600":"bg-purple-600")+" text-white":"text-gray-400 hover:bg-dark-700"}`,children:[n.jsx(y.icon,{size:20}),y.label]},y.path))}),n.jsxs("div",{className:"p-4 border-t border-dark-600",children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:(t==null?void 0:t.name)||(t==null?void 0:t.username)}),n.jsx("div",{className:"text-xs text-gray-500 mb-2",children:t==null?void 0:t.email}),n.jsxs("button",{onClick:u,className:"flex items-center gap-2 text-red-400 hover:text-red-300 transition",children:[n.jsx(jr,{size:18}),"Logout"]})]})]}),n.jsx("main",{className:"flex-1 overflow-auto",children:n.jsxs(th,{children:[n.jsx(ye,{path:"dashboard",element:d?n.jsx(op,{}):n.jsx(cp,{})}),d&&n.jsx(ye,{path:"admins/*",element:n.jsx(Dw,{})}),d&&n.jsx(ye,{path:"all-users",element:n.jsx(ck,{})}),d&&n.jsx(ye,{path:"all-trades",element:n.jsx(rk,{})}),d&&n.jsx(ye,{path:"all-fund-requests",element:n.jsx(ik,{})}),d&&n.jsx(ye,{path:"create-user",element:n.jsx(Hw,{})}),d&&n.jsx(ye,{path:"instruments",element:n.jsx(tk,{})}),d&&n.jsx(ye,{path:"lot-settings",element:n.jsx(lk,{})}),d&&n.jsx(ye,{path:"fund-requests",element:n.jsx(Kw,{})}),d&&n.jsx(ye,{path:"admin-fund-requests",element:n.jsx(Jw,{})}),d&&n.jsx(ye,{path:"market-control",element:n.jsx(sk,{})}),d&&n.jsx(ye,{path:"bank-management",element:n.jsx(ek,{})}),!d&&n.jsx(ye,{path:"wallet",element:n.jsx(Gw,{})}),!d&&n.jsx(ye,{path:"users/*",element:n.jsx(mk,{})}),!d&&n.jsx(ye,{path:"trades",element:n.jsx(nk,{})}),!d&&n.jsx(ye,{path:"fund-requests",element:n.jsx(Yw,{})}),!d&&n.jsx(ye,{path:"bank-accounts",element:n.jsx(Qw,{})}),!d&&n.jsx(ye,{path:"ledger",element:n.jsx(Zw,{})}),n.jsx(ye,{path:"profile",element:n.jsx(ok,{})}),n.jsx(ye,{path:"*",element:d?n.jsx(op,{}):n.jsx(cp,{})})]})})]})},op=()=>{const{admin:t}=we(),[e,s]=g.useState(null),[r,i]=g.useState(!0);g.useEffect(()=>{a()},[]);const a=async()=>{try{const{data:l}=await I.get("/api/admin/manage/dashboard-stats",{headers:{Authorization:`Bearer ${t.token}`}});s(l)}catch(l){console.error("Error fetching stats:",l)}finally{i(!1)}};return r?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx(fe,{className:"animate-spin text-gray-400",size:32})}):n.jsxs("div",{className:"p-4 md:p-6",children:[n.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Super Admin Dashboard"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[n.jsx(tn,{title:"Total Admins",value:(e==null?void 0:e.totalAdmins)||0,subtitle:`${(e==null?void 0:e.activeAdmins)||0} active`,color:"yellow"}),n.jsx(tn,{title:"Total Users",value:(e==null?void 0:e.totalUsers)||0,subtitle:`${(e==null?void 0:e.activeUsers)||0} active`,color:"purple"}),n.jsx(tn,{title:"Admin Wallets",value:`${((e==null?void 0:e.totalAdminBalance)||0).toLocaleString()}`,subtitle:"Total balance",color:"green"}),n.jsx(tn,{title:"User Wallets",value:`${((e==null?void 0:e.totalUserBalance)||0).toLocaleString()}`,subtitle:"Total balance",color:"blue"})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6",children:[n.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Quick Actions"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs(ze,{to:"/admin/admins",className:"flex items-center gap-3 p-3 bg-dark-700 rounded-lg hover:bg-dark-600 transition",children:[n.jsx(ma,{className:"text-yellow-400",size:24}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:"Manage Admins"}),n.jsx("div",{className:"text-sm text-gray-400",children:"Create, edit, fund admins"})]})]}),n.jsxs(ze,{to:"/admin/instruments",className:"flex items-center gap-3 p-3 bg-dark-700 rounded-lg hover:bg-dark-600 transition",children:[n.jsx(gs,{className:"text-green-400",size:24}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:"Instruments"}),n.jsx("div",{className:"text-sm text-gray-400",children:"Manage trading instruments"})]})]}),n.jsxs(ze,{to:"/admin/market-control",className:"flex items-center gap-3 p-3 bg-dark-700 rounded-lg hover:bg-dark-600 transition",children:[n.jsx(Mr,{className:"text-blue-400",size:24}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:"Market Control"}),n.jsx("div",{className:"text-sm text-gray-400",children:"Open/Close market trading"})]})]})]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6",children:[n.jsx("h2",{className:"text-lg font-semibold mb-4",children:"System Info"}),n.jsxs("div",{className:"space-y-3 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Platform"}),n.jsx("span",{children:"NTrader v1.0"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Your Role"}),n.jsx("span",{className:"text-yellow-400",children:"SUPER_ADMIN"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Status"}),n.jsx("span",{className:"text-green-400",children:"Active"})]})]})]})]})]})},cp=()=>{var m;const{admin:t,updateAdmin:e}=we(),[s,r]=g.useState({users:0,pendingRequests:0}),[i,a]=g.useState(!0),[l,o]=g.useState(((m=t==null?void 0:t.wallet)==null?void 0:m.balance)||0);g.useEffect(()=>{d(),c()},[]);const c=async()=>{try{const{data:u}=await I.get("/api/admin/me",{headers:{Authorization:`Bearer ${t.token}`}});u.wallet&&(o(u.wallet.balance||0),e({wallet:u.wallet,stats:u.stats}))}catch(u){console.error("Error refreshing admin data:",u)}},d=async()=>{try{const[u,h]=await Promise.all([I.get("/api/admin/manage/users",{headers:{Authorization:`Bearer ${t.token}`}}),I.get("/api/admin/manage/fund-requests?status=PENDING",{headers:{Authorization:`Bearer ${t.token}`}})]);r({users:u.data.length,pendingRequests:h.data.length})}catch(u){console.error("Error:",u)}finally{a(!1)}};return n.jsxs("div",{className:"p-4 md:p-6",children:[n.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Dashboard"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[n.jsx(tn,{title:"Your Wallet",value:`${l.toLocaleString()}`,subtitle:"Available balance",color:"green"}),n.jsx(tn,{title:"Total Users",value:s.users,subtitle:"Under your code",color:"purple"}),n.jsx(tn,{title:"Pending Requests",value:s.pendingRequests,subtitle:"Fund requests",color:"yellow"}),n.jsx(tn,{title:"Admin Code",value:(t==null?void 0:t.adminCode)||"N/A",subtitle:"Share with users",color:"blue"})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6",children:[n.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Quick Actions"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs(ze,{to:"/admin/users",className:"flex items-center gap-3 p-3 bg-dark-700 rounded-lg hover:bg-dark-600 transition",children:[n.jsx(zr,{className:"text-purple-400",size:24}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:"Manage Users"}),n.jsx("div",{className:"text-sm text-gray-400",children:"Create, edit, fund users"})]})]}),n.jsxs(ze,{to:"/admin/trades",className:"flex items-center gap-3 p-3 bg-dark-700 rounded-lg hover:bg-dark-600 transition",children:[n.jsx(hn,{className:"text-green-400",size:24}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:"Trade Management"}),n.jsx("div",{className:"text-sm text-gray-400",children:"View and manage user trades"})]})]}),n.jsxs(ze,{to:"/admin/fund-requests",className:"flex items-center gap-3 p-3 bg-dark-700 rounded-lg hover:bg-dark-600 transition",children:[n.jsx(Ar,{className:"text-yellow-400",size:24}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:"Fund Requests"}),n.jsxs("div",{className:"text-sm text-gray-400",children:[s.pendingRequests," pending"]})]})]}),n.jsxs(ze,{to:"/admin/bank-accounts",className:"flex items-center gap-3 p-3 bg-dark-700 rounded-lg hover:bg-dark-600 transition",children:[n.jsx(Rr,{className:"text-blue-400",size:24}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:"Bank Accounts"}),n.jsx("div",{className:"text-sm text-gray-400",children:"Manage payment methods"})]})]})]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6",children:[n.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Your Info"}),n.jsxs("div",{className:"space-y-3 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Name"}),n.jsx("span",{children:(t==null?void 0:t.name)||(t==null?void 0:t.username)})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Email"}),n.jsx("span",{children:t==null?void 0:t.email})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Admin Code"}),n.jsx("span",{className:"text-purple-400 font-mono",children:t==null?void 0:t.adminCode})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Status"}),n.jsx("span",{className:"text-green-400",children:(t==null?void 0:t.status)||"ACTIVE"})]})]}),(t==null?void 0:t.referralCode)&&n.jsxs("div",{className:"mt-4 pt-4 border-t border-dark-600",children:[n.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"User Registration Link"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"text",readOnly:!0,value:`${window.location.origin}/login?ref=${t.referralCode}`,className:"flex-1 bg-dark-700 border border-dark-600 rounded px-3 py-2 text-xs font-mono text-green-400"}),n.jsx("button",{onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/login?ref=${t.referralCode}`),alert("Link copied!")},className:"px-3 py-2 bg-green-600 hover:bg-green-700 rounded text-sm",children:"Copy"})]}),n.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Share this link with users to register under your account."})]})]})]})]})},tn=({title:t,value:e,subtitle:s,color:r})=>{const i={green:"text-green-400",purple:"text-purple-400",yellow:"text-yellow-400",blue:"text-blue-400",red:"text-red-400"};return n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:t}),n.jsx("div",{className:`text-2xl font-bold ${i[r]||"text-white"}`,children:e}),n.jsx("div",{className:"text-xs text-gray-500",children:s})]})},Dw=()=>{const{admin:t}=we(),[e,s]=g.useState([]),[r,i]=g.useState(!0),[a,l]=g.useState(!1),[o,c]=g.useState(!1),[d,m]=g.useState(!1),[u,h]=g.useState(!1),[x,y]=g.useState(!1),[f,w]=g.useState(null),[p,b]=g.useState("");g.useEffect(()=>{v()},[]);const v=async()=>{try{const{data:k}=await I.get("/api/admin/manage/admins",{headers:{Authorization:`Bearer ${t.token}`}});s(k)}catch(k){console.error("Error:",k)}finally{i(!1)}},S=async(k,j)=>{var E,_;try{await I.put(`/api/admin/manage/admins/${k}/status`,{status:j},{headers:{Authorization:`Bearer ${t.token}`}}),v()}catch(M){alert(((_=(E=M.response)==null?void 0:E.data)==null?void 0:_.message)||"Error updating status")}},N=e.filter(k=>{var j,E,_,M;return((j=k.name)==null?void 0:j.toLowerCase().includes(p.toLowerCase()))||((E=k.username)==null?void 0:E.toLowerCase().includes(p.toLowerCase()))||((_=k.email)==null?void 0:_.toLowerCase().includes(p.toLowerCase()))||((M=k.adminCode)==null?void 0:M.toLowerCase().includes(p.toLowerCase()))});return n.jsxs("div",{className:"p-4 md:p-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Admin Management"}),n.jsxs("button",{onClick:()=>l(!0),className:"flex items-center gap-2 bg-yellow-600 hover:bg-yellow-700 px-4 py-2 rounded-lg",children:[n.jsx(Ls,{size:20}),"Create Admin"]})]}),n.jsxs("div",{className:"relative mb-6",children:[n.jsx(Jn,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),n.jsx("input",{type:"text",placeholder:"Search admins by name, email, or code...",value:p,onChange:k=>b(k.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg pl-10 pr-4 py-2 focus:outline-none focus:border-yellow-500"})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total Admins"}),n.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:e.length})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Active"}),n.jsx("div",{className:"text-2xl font-bold text-green-400",children:e.filter(k=>k.status==="ACTIVE").length})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total Users"}),n.jsx("div",{className:"text-2xl font-bold text-purple-400",children:e.reduce((k,j)=>{var E;return k+(((E=j.stats)==null?void 0:E.totalUsers)||0)},0)})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total Admin Wallet"}),n.jsxs("div",{className:"text-2xl font-bold text-green-400",children:["",e.reduce((k,j)=>{var E;return k+(((E=j.wallet)==null?void 0:E.balance)||0)},0).toLocaleString()]})]})]}),r?n.jsx("div",{className:"text-center py-8",children:n.jsx(fe,{className:"animate-spin inline"})}):N.length===0?n.jsx("div",{className:"text-center py-8 text-gray-400",children:"No admins found"}):n.jsx("div",{className:"space-y-4",children:N.map(k=>{var j,E,_;return n.jsx("div",{className:"bg-dark-800 rounded-lg p-4",children:n.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("span",{className:"font-bold text-lg",children:k.name||k.username}),n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${k.status==="ACTIVE"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:k.status})]}),n.jsxs("div",{className:"text-sm text-gray-400 mt-1",children:[k.email,"  ",k.phone||"No phone"]}),n.jsxs("div",{className:"flex items-center gap-4 mt-2 flex-wrap",children:[n.jsx("span",{className:"text-sm font-mono bg-purple-500/20 text-purple-400 px-2 py-1 rounded",children:k.adminCode}),n.jsxs("span",{className:"text-xs text-gray-500",children:["Created: ",new Date(k.createdAt).toLocaleDateString()]}),k.referralCode&&n.jsx("button",{onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/login?ref=${k.referralCode}`),alert("Registration link copied!")},className:"text-xs bg-green-600/20 text-green-400 px-2 py-1 rounded hover:bg-green-600/30",children:"Copy User Link"})]})]}),n.jsxs("div",{className:"flex gap-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-xs text-gray-400",children:"Wallet"}),n.jsxs("div",{className:"text-lg font-bold text-green-400",children:["",(((j=k.wallet)==null?void 0:j.balance)||0).toLocaleString()]})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-xs text-gray-400",children:"Users"}),n.jsx("div",{className:"text-lg font-bold",children:((E=k.stats)==null?void 0:E.totalUsers)||k.userCount||0})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-xs text-gray-400",children:"Brokerage"}),n.jsxs("div",{className:"text-lg font-bold",children:["",((_=k.charges)==null?void 0:_.brokerage)||20]})]})]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsxs("button",{onClick:()=>{w(k),m(!0)},className:"px-3 py-2 bg-blue-600 hover:bg-blue-700 rounded text-sm flex items-center gap-1",children:[n.jsx(wn,{size:16})," View"]}),n.jsxs("button",{onClick:()=>{w(k),c(!0)},className:"px-3 py-2 bg-green-600 hover:bg-green-700 rounded text-sm flex items-center gap-1",children:[n.jsx(Ge,{size:16})," Fund"]}),n.jsxs("button",{onClick:()=>{w(k),y(!0)},className:"px-3 py-2 bg-purple-600 hover:bg-purple-700 rounded text-sm flex items-center gap-1",children:[n.jsx(ts,{size:16})," Charges"]}),n.jsxs("button",{onClick:()=>{w(k),h(!0)},className:"px-3 py-2 bg-yellow-600 hover:bg-yellow-700 rounded text-sm flex items-center gap-1",children:[n.jsx(ro,{size:16})," Password"]}),k.status==="ACTIVE"?n.jsx("button",{onClick:()=>S(k._id,"SUSPENDED"),className:"px-3 py-2 bg-red-600 hover:bg-red-700 rounded text-sm",children:"Suspend"}):n.jsx("button",{onClick:()=>S(k._id,"ACTIVE"),className:"px-3 py-2 bg-green-600 hover:bg-green-700 rounded text-sm",children:"Activate"})]})]})},k._id)})}),a&&n.jsx(Fw,{token:t.token,onClose:()=>l(!1),onSuccess:()=>{l(!1),v()}}),o&&f&&n.jsx(Uw,{admin:f,token:t.token,onClose:()=>{c(!1),w(null)},onSuccess:()=>{v()}}),d&&f&&n.jsx(Ww,{admin:f,token:t.token,onClose:()=>{m(!1),w(null)}}),u&&f&&n.jsx(Vw,{admin:f,token:t.token,onClose:()=>{h(!1),w(null)}}),x&&f&&n.jsx(qw,{admin:f,token:t.token,onClose:()=>{y(!1),w(null)},onSuccess:()=>{v()}})]})},Fw=({token:t,onClose:e,onSuccess:s})=>{const[r,i]=g.useState({username:"",name:"",email:"",phone:"",password:"",pin:""}),[a,l]=g.useState(!1),[o,c]=g.useState(""),d=async m=>{var u,h;m.preventDefault(),l(!0),c("");try{await I.post("/api/admin/manage/admins",r,{headers:{Authorization:`Bearer ${t}`}}),s()}catch(x){c(((h=(u=x.response)==null?void 0:u.data)==null?void 0:h.message)||"Error creating admin")}finally{l(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg w-full max-w-md p-6",children:[n.jsxs("div",{className:"flex justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Create New Admin"}),n.jsx("button",{onClick:e,children:n.jsx(ve,{size:24})})]}),o&&n.jsx("div",{className:"bg-red-500/20 text-red-400 p-2 rounded mb-4",children:o}),n.jsxs("form",{onSubmit:d,className:"space-y-4",children:[n.jsx("input",{type:"text",placeholder:"Username *",value:r.username,onChange:m=>i({...r,username:m.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",required:!0}),n.jsx("input",{type:"text",placeholder:"Full Name",value:r.name,onChange:m=>i({...r,name:m.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"}),n.jsx("input",{type:"email",placeholder:"Email *",value:r.email,onChange:m=>i({...r,email:m.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",required:!0}),n.jsx("input",{type:"text",placeholder:"Phone",value:r.phone,onChange:m=>i({...r,phone:m.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"}),n.jsx("input",{type:"password",placeholder:"Password *",value:r.password,onChange:m=>i({...r,password:m.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",required:!0}),n.jsx("input",{type:"text",inputMode:"numeric",placeholder:"4-6 digit PIN *",value:r.pin,onChange:m=>i({...r,pin:m.target.value.replace(/\D/g,"")}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",required:!0,pattern:"[0-9]{4,6}"}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{type:"button",onClick:e,className:"flex-1 bg-dark-600 py-2 rounded",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:a,className:"flex-1 bg-yellow-600 py-2 rounded",children:a?"Creating...":"Create Admin"})]})]})]})})},Uw=({admin:t,token:e,onClose:s,onSuccess:r})=>{var x,y;const[i,a]=g.useState(""),[l,o]=g.useState(""),[c,d]=g.useState(!1),[m,u]=g.useState(""),h=async f=>{var w,p;if(!i||Number(i)<=0)return u("Enter valid amount");d(!0),u("");try{await I.post(`/api/admin/manage/admins/${t._id}/${f}-funds`,{amount:Number(i),description:l},{headers:{Authorization:`Bearer ${e}`}}),a(""),o(""),r(),s()}catch(b){u(((p=(w=b.response)==null?void 0:w.data)==null?void 0:p.message)||"Error")}finally{d(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg w-full max-w-md p-6",children:[n.jsxs("div",{className:"flex justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Manage Admin Wallet"}),n.jsx("button",{onClick:s,children:n.jsx(ve,{size:24})})]}),n.jsxs("div",{className:"bg-dark-700 rounded p-4 mb-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:t.name||t.username}),n.jsx("div",{className:"text-xs text-purple-400 font-mono",children:t.adminCode}),n.jsxs("div",{className:"text-2xl font-bold text-green-400 mt-2",children:["",((y=(x=t.wallet)==null?void 0:x.balance)==null?void 0:y.toLocaleString())||"0"]})]}),m&&n.jsx("div",{className:"bg-red-500/20 text-red-400 p-2 rounded mb-4",children:m}),n.jsx("input",{type:"number",placeholder:"Amount ()",value:i,onChange:f=>a(f.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 mb-3"}),n.jsx("input",{type:"text",placeholder:"Description (optional)",value:l,onChange:f=>o(f.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 mb-4"}),n.jsxs("div",{className:"flex gap-3",children:[n.jsxs("button",{onClick:()=>h("add"),disabled:c,className:"flex-1 bg-green-600 hover:bg-green-700 py-2 rounded flex items-center justify-center gap-2",children:[n.jsx(Vn,{size:18})," Deposit"]}),n.jsxs("button",{onClick:()=>h("deduct"),disabled:c,className:"flex-1 bg-red-600 hover:bg-red-700 py-2 rounded flex items-center justify-center gap-2",children:[n.jsx(Wn,{size:18})," Withdraw"]})]})]})})},Ww=({admin:t,token:e,onClose:s})=>{var h,x,y,f,w,p,b,v,S,N,k;const[r,i]=g.useState("users"),[a,l]=g.useState([]),[o,c]=g.useState([]),[d,m]=g.useState(!0);g.useEffect(()=>{u()},[]);const u=async()=>{try{const[j,E]=await Promise.all([I.get(`/api/admin/manage/admins/${t._id}/users`,{headers:{Authorization:`Bearer ${e}`}}),I.get(`/api/admin/manage/admins/${t._id}/ledger`,{headers:{Authorization:`Bearer ${e}`}})]);l(j.data.users||[]),c(E.data||[])}catch(j){console.error("Error:",j)}finally{m(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg w-full max-w-4xl max-h-[90vh] flex flex-col",children:[n.jsxs("div",{className:"flex justify-between items-start p-6 border-b border-dark-600",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold",children:t.name||t.username}),n.jsx("div",{className:"text-sm text-gray-400",children:t.email}),n.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[n.jsx("span",{className:"font-mono bg-purple-500/20 text-purple-400 px-2 py-1 rounded text-sm",children:t.adminCode}),n.jsx("span",{className:`px-2 py-1 rounded text-xs ${t.status==="ACTIVE"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:t.status})]})]}),n.jsx("button",{onClick:s,children:n.jsx(ve,{size:24})})]}),n.jsxs("div",{className:"grid grid-cols-4 gap-4 p-4 border-b border-dark-600",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-xs text-gray-400",children:"Wallet Balance"}),n.jsxs("div",{className:"text-lg font-bold text-green-400",children:["",(((h=t.wallet)==null?void 0:h.balance)||0).toLocaleString()]})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-xs text-gray-400",children:"Total Users"}),n.jsx("div",{className:"text-lg font-bold",children:a.length})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-xs text-gray-400",children:"Brokerage"}),n.jsxs("div",{className:"text-lg font-bold",children:["",((x=t.charges)==null?void 0:x.brokerage)||20]})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-xs text-gray-400",children:"Leverage"}),n.jsxs("div",{className:"text-lg font-bold",children:[((y=t.charges)==null?void 0:y.intradayLeverage)||5,"x"]})]})]}),n.jsxs("div",{className:"flex border-b border-dark-600",children:[n.jsxs("button",{onClick:()=>i("users"),className:`flex-1 py-3 ${r==="users"?"bg-purple-600":"bg-dark-700"}`,children:["Users (",a.length,")"]}),n.jsxs("button",{onClick:()=>i("ledger"),className:`flex-1 py-3 ${r==="ledger"?"bg-purple-600":"bg-dark-700"}`,children:["Ledger (",o.length,")"]}),n.jsx("button",{onClick:()=>i("charges"),className:`flex-1 py-3 ${r==="charges"?"bg-purple-600":"bg-dark-700"}`,children:"Charges"})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:d?n.jsx("div",{className:"text-center py-8",children:n.jsx(fe,{className:"animate-spin inline"})}):r==="users"?a.length===0?n.jsx("div",{className:"text-center py-8 text-gray-400",children:"No users under this admin"}):n.jsx("div",{className:"space-y-2",children:a.map(j=>{var E;return n.jsxs("div",{className:"flex items-center justify-between bg-dark-700 rounded p-3",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:j.fullName||j.username}),n.jsxs("div",{className:"text-xs text-gray-400",children:[j.email,"  ",j.userId]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:"text-green-400 font-bold",children:["",(((E=j.wallet)==null?void 0:E.cashBalance)||0).toLocaleString()]}),n.jsx("div",{className:`text-xs ${j.isActive?"text-green-400":"text-red-400"}`,children:j.isActive?"Active":"Inactive"})]})]},j._id)})}):r==="ledger"?o.length===0?n.jsx("div",{className:"text-center py-8 text-gray-400",children:"No transactions"}):n.jsx("div",{className:"space-y-2",children:o.map(j=>{var E,_;return n.jsxs("div",{className:"flex items-center justify-between bg-dark-700 rounded p-3",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm",children:j.reason}),n.jsx("div",{className:"text-xs text-gray-400",children:new Date(j.createdAt).toLocaleString()})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:j.type==="CREDIT"?"text-green-400":"text-red-400",children:[j.type==="CREDIT"?"+":"-","",(E=j.amount)==null?void 0:E.toLocaleString()]}),n.jsxs("div",{className:"text-xs text-gray-400",children:["Bal: ",(_=j.balanceAfter)==null?void 0:_.toLocaleString()]})]})]},j._id)})}):n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"bg-dark-700 rounded p-3",children:[n.jsx("div",{className:"text-xs text-gray-400",children:"Brokerage"}),n.jsxs("div",{className:"text-lg font-bold",children:["",((f=t.charges)==null?void 0:f.brokerage)||20]})]}),n.jsxs("div",{className:"bg-dark-700 rounded p-3",children:[n.jsx("div",{className:"text-xs text-gray-400",children:"Intraday Leverage"}),n.jsxs("div",{className:"text-lg font-bold",children:[((w=t.charges)==null?void 0:w.intradayLeverage)||5,"x"]})]}),n.jsxs("div",{className:"bg-dark-700 rounded p-3",children:[n.jsx("div",{className:"text-xs text-gray-400",children:"Delivery Leverage"}),n.jsxs("div",{className:"text-lg font-bold",children:[((p=t.charges)==null?void 0:p.deliveryLeverage)||1,"x"]})]}),n.jsxs("div",{className:"bg-dark-700 rounded p-3",children:[n.jsx("div",{className:"text-xs text-gray-400",children:"Option Buy Leverage"}),n.jsxs("div",{className:"text-lg font-bold",children:[((b=t.charges)==null?void 0:b.optionBuyLeverage)||1,"x"]})]}),n.jsxs("div",{className:"bg-dark-700 rounded p-3",children:[n.jsx("div",{className:"text-xs text-gray-400",children:"Withdrawal Fee"}),n.jsxs("div",{className:"text-lg font-bold",children:["",((v=t.charges)==null?void 0:v.withdrawalFee)||0]})]}),n.jsxs("div",{className:"bg-dark-700 rounded p-3",children:[n.jsx("div",{className:"text-xs text-gray-400",children:"Profit Share"}),n.jsxs("div",{className:"text-lg font-bold",children:[((S=t.charges)==null?void 0:S.profitShare)||0,"%"]})]}),n.jsxs("div",{className:"bg-dark-700 rounded p-3",children:[n.jsx("div",{className:"text-xs text-gray-400",children:"Min Withdrawal"}),n.jsxs("div",{className:"text-lg font-bold",children:["",((N=t.charges)==null?void 0:N.minWithdrawal)||100]})]}),n.jsxs("div",{className:"bg-dark-700 rounded p-3",children:[n.jsx("div",{className:"text-xs text-gray-400",children:"Max Withdrawal"}),n.jsxs("div",{className:"text-lg font-bold",children:["",((k=t.charges)==null?void 0:k.maxWithdrawal)||1e5]})]})]})}),n.jsx("div",{className:"p-4 border-t border-dark-600",children:n.jsx("button",{onClick:s,className:"w-full bg-dark-600 hover:bg-dark-500 py-2 rounded",children:"Close"})})]})})},Vw=({admin:t,token:e,onClose:s})=>{const[r,i]=g.useState(""),[a,l]=g.useState(!1),[o,c]=g.useState(!1),[d,m]=g.useState({type:"",text:""}),u=async h=>{var x,y;if(h.preventDefault(),r.length<6){m({type:"error",text:"Password must be at least 6 characters"});return}c(!0),m({type:"",text:""});try{await I.put(`/api/admin/manage/admins/${t._id}/reset-password`,{newPassword:r},{headers:{Authorization:`Bearer ${e}`}}),m({type:"success",text:"Password reset successfully"}),setTimeout(s,1500)}catch(f){m({type:"error",text:((y=(x=f.response)==null?void 0:x.data)==null?void 0:y.message)||"Error resetting password"})}finally{c(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg w-full max-w-md p-6",children:[n.jsxs("div",{className:"flex justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Reset Admin Password"}),n.jsx("button",{onClick:s,children:n.jsx(ve,{size:24})})]}),n.jsxs("div",{className:"bg-dark-700 rounded p-4 mb-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Resetting password for:"}),n.jsx("div",{className:"font-bold",children:t.name||t.username}),n.jsx("div",{className:"text-xs text-purple-400 font-mono",children:t.adminCode})]}),d.text&&n.jsx("div",{className:`p-3 rounded mb-4 ${d.type==="success"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:d.text}),n.jsxs("form",{onSubmit:u,children:[n.jsxs("div",{className:"relative mb-4",children:[n.jsx("input",{type:a?"text":"password",placeholder:"New Password (min 6 characters)",value:r,onChange:h=>i(h.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 pr-10",required:!0,minLength:6}),n.jsx("button",{type:"button",onClick:()=>l(!a),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",children:a?n.jsx(Gn,{size:18}):n.jsx(wn,{size:18})})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{type:"button",onClick:s,className:"flex-1 bg-dark-600 py-2 rounded",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:o,className:"flex-1 bg-yellow-600 hover:bg-yellow-700 py-2 rounded",children:o?"Resetting...":"Reset Password"})]})]})]})})},qw=({admin:t,token:e,onClose:s,onSuccess:r})=>{var u,h,x,y,f,w,p,b,v,S;const[i,a]=g.useState({brokerage:((u=t.charges)==null?void 0:u.brokerage)||20,intradayLeverage:((h=t.charges)==null?void 0:h.intradayLeverage)||5,deliveryLeverage:((x=t.charges)==null?void 0:x.deliveryLeverage)||1,optionBuyLeverage:((y=t.charges)==null?void 0:y.optionBuyLeverage)||1,optionSellLeverage:((f=t.charges)==null?void 0:f.optionSellLeverage)||1,futuresLeverage:((w=t.charges)==null?void 0:w.futuresLeverage)||1,withdrawalFee:((p=t.charges)==null?void 0:p.withdrawalFee)||0,profitShare:((b=t.charges)==null?void 0:b.profitShare)||0,minWithdrawal:((v=t.charges)==null?void 0:v.minWithdrawal)||100,maxWithdrawal:((S=t.charges)==null?void 0:S.maxWithdrawal)||1e5}),[l,o]=g.useState(!1),[c,d]=g.useState({type:"",text:""}),m=async N=>{var k,j;N.preventDefault(),o(!0),d({type:"",text:""});try{await I.put(`/api/admin/manage/admins/${t._id}/charges`,{charges:i},{headers:{Authorization:`Bearer ${e}`}}),d({type:"success",text:"Charges updated successfully"}),r(),setTimeout(s,1500)}catch(E){d({type:"error",text:((j=(k=E.response)==null?void 0:k.data)==null?void 0:j.message)||"Error updating charges"})}finally{o(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg w-full max-w-lg p-6 max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Edit Admin Charges"}),n.jsx("button",{onClick:s,children:n.jsx(ve,{size:24})})]}),n.jsxs("div",{className:"bg-dark-700 rounded p-3 mb-4",children:[n.jsx("div",{className:"font-bold",children:t.name||t.username}),n.jsx("div",{className:"text-xs text-purple-400 font-mono",children:t.adminCode})]}),c.text&&n.jsx("div",{className:`p-3 rounded mb-4 ${c.type==="success"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:c.text}),n.jsxs("form",{onSubmit:m,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Brokerage ()"}),n.jsx("input",{type:"number",value:i.brokerage,onChange:N=>a({...i,brokerage:Number(N.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Intraday Leverage"}),n.jsx("input",{type:"number",value:i.intradayLeverage,onChange:N=>a({...i,intradayLeverage:Number(N.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Delivery Leverage"}),n.jsx("input",{type:"number",value:i.deliveryLeverage,onChange:N=>a({...i,deliveryLeverage:Number(N.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Option Buy Leverage"}),n.jsx("input",{type:"number",value:i.optionBuyLeverage,onChange:N=>a({...i,optionBuyLeverage:Number(N.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Option Sell Leverage"}),n.jsx("input",{type:"number",value:i.optionSellLeverage,onChange:N=>a({...i,optionSellLeverage:Number(N.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Futures Leverage"}),n.jsx("input",{type:"number",value:i.futuresLeverage,onChange:N=>a({...i,futuresLeverage:Number(N.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Withdrawal Fee ()"}),n.jsx("input",{type:"number",value:i.withdrawalFee,onChange:N=>a({...i,withdrawalFee:Number(N.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Profit Share (%)"}),n.jsx("input",{type:"number",value:i.profitShare,onChange:N=>a({...i,profitShare:Number(N.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Min Withdrawal ()"}),n.jsx("input",{type:"number",value:i.minWithdrawal,onChange:N=>a({...i,minWithdrawal:Number(N.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Max Withdrawal ()"}),n.jsx("input",{type:"number",value:i.maxWithdrawal,onChange:N=>a({...i,maxWithdrawal:Number(N.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"})]})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:s,className:"flex-1 bg-dark-600 py-2 rounded",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:l,className:"flex-1 bg-purple-600 hover:bg-purple-700 py-2 rounded",children:l?"Saving...":"Save Charges"})]})]})]})})},Hw=()=>{var S,N,k,j,E,_,M,V,B,R,O,P,W,D,T,L,F,C,H,J,ce,U,le,G,Q,ge,ke,pe,De,qe,Je,oe,ue,Ce,Ne,Ee,Le,lt,Te,de,ot,ae,_e,tt,qt,Ht,xt,Kt,ls,Ms,Rs,As,zs,Os,Is,$s,Bs,Ds,Fs,Us,Ws,Vs,qs;const{admin:t}=we(),[e,s]=g.useState([]),[r,i]=g.useState(""),[a,l]=g.useState(!1),[o,c]=g.useState({type:"",text:""}),[d,m]=g.useState(null),u={enabled:!1,fraction:!1,maxExchangeLots:100,commissionType:"PER_LOT",commissionLot:0,maxLots:50,minLots:1,orderLots:10,exposureIntraday:1,exposureCarryForward:1,optionBuy:{allowed:!0,fraction:!1,commissionType:"PER_LOT",commission:0,strikeSelection:50,maxExchangeLots:100},optionSell:{allowed:!0,fraction:!1,commissionType:"PER_LOT",commission:0,strikeSelection:50,maxExchangeLots:100}},[h,x]=g.useState({username:"",email:"",password:"",fullName:"",phone:"",initialBalance:0,marginType:"exposure",ledgerBalanceClosePercent:90,profitTradeHoldSeconds:0,lossTradeHoldSeconds:0,isActivated:!0,isReadOnly:!1,isDemo:!1,intradaySquare:!1,blockLimitAboveBelowHighLow:!1,blockLimitBetweenHighLow:!1,segmentPermissions:{MCX:{...u,enabled:!0},NSEINDEX:{...u,enabled:!0},NSESTOCK:{...u,enabled:!0},BSE:{...u,enabled:!1},EQ:{...u,enabled:!0}},scriptSettings:{},selectedScriptSegment:null,selectedScript:null,segmentSymbols:{}});g.useEffect(()=>{f(),y()},[]);const y=async()=>{try{const{data:$}=await I.get("/api/instruments/settings-data",{headers:{Authorization:`Bearer ${t.token}`}}),X={};for(const[he,ct]of Object.entries($.scripts||{}))X[he]=ct.map(Ot=>Ot.baseSymbol);const ne={...h.segmentPermissions};for(const he of $.segments||[])ne[he.id]||(ne[he.id]={...u,enabled:!1});x(he=>({...he,segmentSymbols:X,marketSegments:$.segments||[],marketScripts:$.scripts||{},segmentPermissions:ne}))}catch($){console.error("Error fetching segment symbols:",$),x(X=>({...X,segmentSymbols:{MCX:["CRUDEOIL","CRUDEM","GOLD","SILVER","SILVERMIC","NATURALGAS","NATGASMINI","COPPER","ZINC","ZINCMINI","ALUMINIUM","LEAD","LEADMINI","NICKEL"],NSEINDEX:["NIFTY","BANKNIFTY","FINNIFTY","MIDCPNIFTY","NIFTYIT"],NSESTOCK:["RELIANCE","TCS","HDFCBANK","INFY","ICICIBANK","SBIN","BHARTIARTL","ITC","KOTAKBANK","LT"],BSE:["SENSEX","BANKEX"],EQ:["RELIANCE","TCS","HDFCBANK","INFY","ICICIBANK","SBIN","BHARTIARTL","ITC","KOTAKBANK","LT"]}}))}},f=async()=>{try{const{data:$}=await I.get("/api/admin/manage/admins",{headers:{Authorization:`Bearer ${t.token}`}}),X=[{_id:"SUPER",username:"Super Admin (Direct)",adminCode:"SUPER"},...$];s(X),i("SUPER")}catch($){console.error("Error fetching admins:",$)}},w=$=>{m(d===$?null:$)},p=($,X,ne)=>{x(he=>({...he,segmentPermissions:{...he.segmentPermissions,[$]:{...he.segmentPermissions[$],[X]:ne}}}))},b=async $=>{var X,ne,he;$.preventDefault(),l(!0),c({type:"",text:""});try{const ct=e.find(kn=>kn._id===r),Ot=(ct==null?void 0:ct.adminCode)||"SUPER",{data:Nt}=await I.post("/api/admin/manage/create-user",{...h,adminCode:Ot},{headers:{Authorization:`Bearer ${t.token}`}});c({type:"success",text:`User created successfully! User ID: ${((X=Nt.user)==null?void 0:X.userId)||Nt.userId}`}),x({username:"",email:"",password:"",fullName:"",phone:"",initialBalance:0,marginType:"exposure",ledgerBalanceClosePercent:90,profitTradeHoldSeconds:0,lossTradeHoldSeconds:0,isActivated:!0,isReadOnly:!1,isDemo:!1,intradaySquare:!1,blockLimitAboveBelowHighLow:!1,blockLimitBetweenHighLow:!1,segmentPermissions:{MCX:{...u,enabled:!0},NSEINDEX:{...u,enabled:!0},NSESTOCK:{...u,enabled:!0},BSE:{...u,enabled:!1},EQ:{...u,enabled:!0}},scriptSettings:{},selectedScriptSegment:null,selectedScript:null}),m(null)}catch(ct){c({type:"error",text:((he=(ne=ct.response)==null?void 0:ne.data)==null?void 0:he.message)||"Failed to create user"})}finally{l(!1)}},v=({label:$,checked:X,onChange:ne})=>n.jsxs("div",{className:"flex items-center justify-between py-2",children:[n.jsx("span",{className:"text-sm text-gray-300",children:$}),n.jsx("button",{type:"button",onClick:ne,className:`relative w-12 h-6 rounded-full transition-colors ${X?"bg-green-600":"bg-dark-600"}`,children:n.jsx("span",{className:`absolute top-1 w-4 h-4 rounded-full bg-white transition-transform ${X?"left-7":"left-1"}`})})]});return n.jsxs("div",{className:"p-4 md:p-6",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Create User"}),n.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Create a new user with comprehensive settings"})]}),o.text&&n.jsx("div",{className:`mb-4 p-3 rounded-lg ${o.type==="success"?"bg-green-900/30 text-green-400":"bg-red-900/30 text-red-400"}`,children:o.text}),n.jsxs("form",{onSubmit:b,className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6 space-y-4",children:[n.jsx("h2",{className:"text-lg font-semibold text-yellow-500 mb-4",children:"Basic Information"}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Assign to Admin"}),n.jsx("select",{value:r,onChange:$=>i($.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",children:e.map($=>n.jsxs("option",{value:$._id,children:[$.username," (",$.adminCode,")"]},$._id))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Username *"}),n.jsx("input",{type:"text",value:h.username,onChange:$=>x({...h,username:$.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Full Name"}),n.jsx("input",{type:"text",value:h.fullName,onChange:$=>x({...h,fullName:$.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Email *"}),n.jsx("input",{type:"email",value:h.email,onChange:$=>x({...h,email:$.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Phone"}),n.jsx("input",{type:"tel",value:h.phone,onChange:$=>x({...h,phone:$.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Password *"}),n.jsx("input",{type:"password",value:h.password,onChange:$=>x({...h,password:$.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",required:!0,minLength:6})]})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-yellow-500 mb-4",children:"Trading Settings"}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Ledger Balance Close (%)"}),n.jsx("input",{type:"number",value:h.ledgerBalanceClosePercent,onChange:$=>x({...h,ledgerBalanceClosePercent:parseInt($.target.value)||90}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",min:"0",max:"100"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Close positions when loss reaches this % of ledger balance"})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Profit Trade Hold (seconds)"}),n.jsx("input",{type:"number",value:h.profitTradeHoldSeconds,onChange:$=>x({...h,profitTradeHoldSeconds:parseInt($.target.value)||0}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",min:"0"})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Loss Trade Hold (seconds)"}),n.jsx("input",{type:"number",value:h.lossTradeHoldSeconds,onChange:$=>x({...h,lossTradeHoldSeconds:parseInt($.target.value)||0}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",min:"0"})]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-yellow-500 mb-4",children:"Account Controls"}),n.jsx(v,{label:"Activation",checked:h.isActivated,onChange:()=>x({...h,isActivated:!h.isActivated})}),n.jsx(v,{label:"Read Only",checked:h.isReadOnly,onChange:()=>x({...h,isReadOnly:!h.isReadOnly})}),n.jsx(v,{label:"Demo Account",checked:h.isDemo,onChange:()=>x({...h,isDemo:!h.isDemo})}),n.jsx(v,{label:"Intraday Square (3:29 PM)",checked:h.intradaySquare,onChange:()=>x({...h,intradaySquare:!h.intradaySquare})}),n.jsx(v,{label:"Block Limit Above/Below High Low",checked:h.blockLimitAboveBelowHighLow,onChange:()=>x({...h,blockLimitAboveBelowHighLow:!h.blockLimitAboveBelowHighLow})}),n.jsx(v,{label:"Block Limit Between High Low",checked:h.blockLimitBetweenHighLow,onChange:()=>x({...h,blockLimitBetweenHighLow:!h.blockLimitBetweenHighLow})})]})]}),n.jsxs("div",{className:"lg:col-span-2 bg-dark-800 rounded-lg p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-yellow-500 mb-4",children:"Segment Settings"}),n.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Click on a segment to configure its settings. Green = Enabled, Gray = Disabled"}),n.jsx("div",{className:"flex flex-wrap gap-3 mb-4",children:(((S=h.marketSegments)==null?void 0:S.length)>0?h.marketSegments.map($=>$.id):["MCX","NSEINDEX","NSESTOCK","BSE","EQ"]).map($=>{var X,ne,he,ct,Ot;return n.jsxs("button",{type:"button",onClick:()=>w($),className:`px-4 py-2 rounded-lg font-medium transition-all ${d===$?"bg-yellow-600 text-white ring-2 ring-yellow-400":(X=h.segmentPermissions[$])!=null&&X.enabled?"bg-green-600 text-white hover:bg-green-700":"bg-dark-700 text-gray-400 hover:bg-dark-600"}`,children:[((he=(ne=h.marketSegments)==null?void 0:ne.find(Nt=>Nt.id===$))==null?void 0:he.name)||$,((Ot=(ct=h.marketSegments)==null?void 0:ct.find(Nt=>Nt.id===$))==null?void 0:Ot.count)&&n.jsxs("span",{className:"ml-1 text-xs opacity-70",children:["(",h.marketSegments.find(Nt=>Nt.id===$).count,")"]})]},$)})}),d&&h.segmentPermissions[d]&&n.jsxs("div",{className:"bg-dark-700 rounded-lg p-4 border border-dark-600 animate-fadeIn",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h3",{className:"text-lg font-semibold text-blue-400",children:[d," Settings"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{type:"button",onClick:()=>p(d,"fraction",!h.segmentPermissions[d].fraction),className:`px-4 py-1.5 rounded-lg text-sm font-medium transition-colors ${h.segmentPermissions[d].fraction?"bg-purple-600 text-white":"bg-gray-600 text-white"}`,children:h.segmentPermissions[d].fraction?"Fraction On":"Fraction Off"}),n.jsx("button",{type:"button",onClick:()=>p(d,"enabled",!h.segmentPermissions[d].enabled),className:`px-4 py-1.5 rounded-lg text-sm font-medium transition-colors ${h.segmentPermissions[d].enabled?"bg-green-600 text-white":"bg-red-600 text-white"}`,children:h.segmentPermissions[d].enabled?"Enabled":"Disabled"})]})]}),n.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-2",children:"General Settings"}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Max Exchange Lots"}),n.jsx("input",{type:"number",value:h.segmentPermissions[d].maxExchangeLots,onChange:$=>p(d,"maxExchangeLots",Number($.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-3 py-2 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Max Lots"}),n.jsx("input",{type:"number",value:h.segmentPermissions[d].maxLots,onChange:$=>p(d,"maxLots",Number($.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-3 py-2 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Commission Type"}),n.jsxs("select",{value:h.segmentPermissions[d].commissionType,onChange:$=>p(d,"commissionType",$.target.value),className:"w-full bg-dark-800 border border-dark-600 rounded px-3 py-2 text-sm",children:[n.jsx("option",{value:"PER_LOT",children:"Per Lot"}),n.jsx("option",{value:"PER_TRADE",children:"Per Trade"}),n.jsx("option",{value:"PER_CRORE",children:"Per Crore"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Commission ()"}),n.jsx("input",{type:"number",value:h.segmentPermissions[d].commissionLot,onChange:$=>p(d,"commissionLot",Number($.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-3 py-2 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Min Lots"}),n.jsx("input",{type:"number",value:h.segmentPermissions[d].minLots,onChange:$=>p(d,"minLots",Number($.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-3 py-2 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Order Lots"}),n.jsx("input",{type:"number",value:h.segmentPermissions[d].orderLots,onChange:$=>p(d,"orderLots",Number($.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-3 py-2 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Exposure Intraday"}),n.jsx("input",{type:"number",value:h.segmentPermissions[d].exposureIntraday,onChange:$=>p(d,"exposureIntraday",Number($.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-3 py-2 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Exposure Carry Forward"}),n.jsx("input",{type:"number",value:h.segmentPermissions[d].exposureCarryForward,onChange:$=>p(d,"exposureCarryForward",Number($.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-3 py-2 text-sm"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-green-900/50",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h4",{className:"text-sm font-medium text-green-400",children:"Option Buy Settings"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{type:"button",onClick:()=>{var $;return p(d,"optionBuy",{...h.segmentPermissions[d].optionBuy,fraction:!(($=h.segmentPermissions[d].optionBuy)!=null&&$.fraction)})},className:`px-3 py-1 rounded text-xs font-medium ${(N=h.segmentPermissions[d].optionBuy)!=null&&N.fraction?"bg-purple-600 text-white":"bg-gray-600 text-white"}`,children:(k=h.segmentPermissions[d].optionBuy)!=null&&k.fraction?"Fraction On":"Fraction Off"}),n.jsx("button",{type:"button",onClick:()=>{var $;return p(d,"optionBuy",{...h.segmentPermissions[d].optionBuy,allowed:!(($=h.segmentPermissions[d].optionBuy)!=null&&$.allowed)})},className:`px-3 py-1 rounded text-xs font-medium ${(j=h.segmentPermissions[d].optionBuy)!=null&&j.allowed?"bg-green-600 text-white":"bg-red-600 text-white"}`,children:(E=h.segmentPermissions[d].optionBuy)!=null&&E.allowed?"Allowed":"Blocked"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Commission Type"}),n.jsxs("select",{value:((_=h.segmentPermissions[d].optionBuy)==null?void 0:_.commissionType)||"PER_LOT",onChange:$=>p(d,"optionBuy",{...h.segmentPermissions[d].optionBuy,commissionType:$.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1.5 text-sm",children:[n.jsx("option",{value:"PER_LOT",children:"Per Lot"}),n.jsx("option",{value:"PER_TRADE",children:"Per Trade"}),n.jsx("option",{value:"PER_CRORE",children:"Per Crore"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Commission ()"}),n.jsx("input",{type:"number",value:((M=h.segmentPermissions[d].optionBuy)==null?void 0:M.commission)||0,onChange:$=>p(d,"optionBuy",{...h.segmentPermissions[d].optionBuy,commission:Number($.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1.5 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Strike Selection ()"}),n.jsx("input",{type:"number",value:((V=h.segmentPermissions[d].optionBuy)==null?void 0:V.strikeSelection)||50,onChange:$=>p(d,"optionBuy",{...h.segmentPermissions[d].optionBuy,strikeSelection:Number($.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1.5 text-sm",placeholder:"Strikes from ATM"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Max Exchange Lots"}),n.jsx("input",{type:"number",value:((B=h.segmentPermissions[d].optionBuy)==null?void 0:B.maxExchangeLots)||100,onChange:$=>p(d,"optionBuy",{...h.segmentPermissions[d].optionBuy,maxExchangeLots:Number($.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1.5 text-sm"})]})]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-red-900/50",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h4",{className:"text-sm font-medium text-red-400",children:"Option Sell Settings"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{type:"button",onClick:()=>{var $;return p(d,"optionSell",{...h.segmentPermissions[d].optionSell,fraction:!(($=h.segmentPermissions[d].optionSell)!=null&&$.fraction)})},className:`px-3 py-1 rounded text-xs font-medium ${(R=h.segmentPermissions[d].optionSell)!=null&&R.fraction?"bg-purple-600 text-white":"bg-gray-600 text-white"}`,children:(O=h.segmentPermissions[d].optionSell)!=null&&O.fraction?"Fraction On":"Fraction Off"}),n.jsx("button",{type:"button",onClick:()=>{var $;return p(d,"optionSell",{...h.segmentPermissions[d].optionSell,allowed:!(($=h.segmentPermissions[d].optionSell)!=null&&$.allowed)})},className:`px-3 py-1 rounded text-xs font-medium ${(P=h.segmentPermissions[d].optionSell)!=null&&P.allowed?"bg-green-600 text-white":"bg-red-600 text-white"}`,children:(W=h.segmentPermissions[d].optionSell)!=null&&W.allowed?"Allowed":"Blocked"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Commission Type"}),n.jsxs("select",{value:((D=h.segmentPermissions[d].optionSell)==null?void 0:D.commissionType)||"PER_LOT",onChange:$=>p(d,"optionSell",{...h.segmentPermissions[d].optionSell,commissionType:$.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1.5 text-sm",children:[n.jsx("option",{value:"PER_LOT",children:"Per Lot"}),n.jsx("option",{value:"PER_TRADE",children:"Per Trade"}),n.jsx("option",{value:"PER_CRORE",children:"Per Crore"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Commission ()"}),n.jsx("input",{type:"number",value:((T=h.segmentPermissions[d].optionSell)==null?void 0:T.commission)||0,onChange:$=>p(d,"optionSell",{...h.segmentPermissions[d].optionSell,commission:Number($.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1.5 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Strike Selection ()"}),n.jsx("input",{type:"number",value:((L=h.segmentPermissions[d].optionSell)==null?void 0:L.strikeSelection)||50,onChange:$=>p(d,"optionSell",{...h.segmentPermissions[d].optionSell,strikeSelection:Number($.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1.5 text-sm",placeholder:"Strikes from ATM"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Max Exchange Lots"}),n.jsx("input",{type:"number",value:((F=h.segmentPermissions[d].optionSell)==null?void 0:F.maxExchangeLots)||100,onChange:$=>p(d,"optionSell",{...h.segmentPermissions[d].optionSell,maxExchangeLots:Number($.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1.5 text-sm"})]})]})]})]})]})]}),n.jsxs("div",{className:"lg:col-span-2 bg-dark-800 rounded-lg p-6",children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("h2",{className:"text-lg font-semibold text-purple-400",children:"Script Settings"}),n.jsx("p",{className:"text-gray-400 text-sm",children:"Select a segment to view its symbols. Click on a symbol to customize its settings (overrides segment defaults)."})]}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:["MCX","NSEINDEX","NSESTOCK","BSE","EQ"].map($=>n.jsx("button",{type:"button",onClick:()=>x(X=>({...X,selectedScriptSegment:$})),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${h.selectedScriptSegment===$?"bg-purple-600 text-white":"bg-dark-700 text-gray-400 hover:bg-dark-600"}`,children:$},$))}),h.selectedScriptSegment?n.jsxs("div",{className:"bg-dark-700 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("h3",{className:"text-sm font-medium text-yellow-400",children:[h.selectedScriptSegment," Symbols"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-xs text-gray-500",children:[Object.keys(h.scriptSettings||{}).filter($=>{var X;return((X=h.scriptSettings[$])==null?void 0:X.segment)===h.selectedScriptSegment}).length," customized"]}),n.jsx("button",{type:"button",onClick:()=>{var ne;const $=((ne=h.segmentSymbols)==null?void 0:ne[h.selectedScriptSegment])||[],X={...h.scriptSettings};$.forEach(he=>{X[he]||(X[he]={segment:h.selectedScriptSegment,settingType:"LOT",lotSettings:{maxLots:50,minLots:1,perOrderLots:10},quantitySettings:{maxQuantity:1e3,minQuantity:1,perOrderQuantity:100},fixedMargin:{intradayFuture:0,carryFuture:0,optionBuyIntraday:0,optionBuyCarry:0,optionSellIntraday:0,optionSellCarry:0},brokerage:{type:"PER_LOT",value:0},spread:0,block:{future:!1,option:!1}})}),x(he=>({...he,scriptSettings:X}))},className:"px-2 py-1 bg-green-600 hover:bg-green-700 rounded text-xs font-medium",children:"Select All"}),n.jsx("button",{type:"button",onClick:()=>{var ne;const $=((ne=h.segmentSymbols)==null?void 0:ne[h.selectedScriptSegment])||[],X={...h.scriptSettings};$.forEach(he=>{delete X[he]}),x(he=>({...he,scriptSettings:X,selectedScript:null}))},className:"px-2 py-1 bg-red-600 hover:bg-red-700 rounded text-xs font-medium",children:"Unselect All"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-2 mb-4 max-h-40 overflow-y-auto",children:[(((C=h.segmentSymbols)==null?void 0:C[h.selectedScriptSegment])||[]).map($=>{var ne;const X=(ne=h.scriptSettings)==null?void 0:ne[$];return n.jsx("button",{type:"button",onClick:()=>{x(X?he=>({...he,selectedScript:$}):he=>({...he,selectedScript:$,scriptSettings:{...he.scriptSettings,[$]:{segment:h.selectedScriptSegment,settingType:"LOT",lotSettings:{maxLots:50,minLots:1,perOrderLots:10},quantitySettings:{maxQuantity:1e3,minQuantity:1,perOrderQuantity:100},fixedMargin:{intradayFuture:0,carryFuture:0,optionBuyIntraday:0,optionBuyCarry:0,optionSellIntraday:0,optionSellCarry:0},brokerage:{type:"PER_LOT",value:0},spread:0,block:{future:!1,option:!1}}}}))},className:`px-2 py-1.5 rounded text-xs font-medium transition-all ${X?"bg-purple-600 text-white":"bg-dark-600 text-gray-400 hover:bg-dark-500"} ${h.selectedScript===$?"ring-2 ring-yellow-500":""}`,children:$},$)}),(!((H=h.segmentSymbols)!=null&&H[h.selectedScriptSegment])||h.segmentSymbols[h.selectedScriptSegment].length===0)&&n.jsx("p",{className:"col-span-full text-xs text-gray-500 italic",children:"No symbols available for this segment"})]}),h.selectedScript&&((J=h.scriptSettings)==null?void 0:J[h.selectedScript])&&n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-purple-600",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("span",{className:"text-sm font-medium text-yellow-400",children:[h.selectedScript," Settings"]}),n.jsx("button",{type:"button",onClick:()=>{const $={...h.scriptSettings};delete $[h.selectedScript],x(X=>({...X,scriptSettings:$,selectedScript:null}))},className:"text-red-400 hover:text-red-300 text-xs",children:"Reset to Default"})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-xs text-gray-400 font-medium mb-2",children:"Setting Type"}),n.jsx("div",{className:"flex gap-2",children:["LOT","QUANTITY","FIXED_MARGIN","BROKERAGE","SPREAD","BLOCK"].map($=>{var X;return n.jsx("button",{type:"button",onClick:()=>x(ne=>({...ne,scriptSettings:{...ne.scriptSettings,[h.selectedScript]:{...ne.scriptSettings[h.selectedScript],settingType:$}}})),className:`px-3 py-1.5 rounded text-xs font-medium transition-all ${(((X=h.scriptSettings[h.selectedScript])==null?void 0:X.settingType)||"LOT")===$?"bg-purple-600 text-white":"bg-dark-600 text-gray-400 hover:bg-dark-500"}`,children:$==="LOT"?"Lot":$==="QUANTITY"?"Quantity":$==="FIXED_MARGIN"?"Fixed Margin":$==="BROKERAGE"?"Brokerage":$==="SPREAD"?"Spread":"Block"},$)})})]}),(((ce=h.scriptSettings[h.selectedScript])==null?void 0:ce.settingType)||"LOT")==="LOT"&&n.jsxs("div",{className:"mb-3",children:[n.jsx("span",{className:"text-xs text-gray-400 font-medium",children:"Lot Settings"}),n.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-1",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Max Lots"}),n.jsx("input",{type:"number",value:((le=(U=h.scriptSettings[h.selectedScript])==null?void 0:U.lotSettings)==null?void 0:le.maxLots)||50,onChange:$=>x(X=>{var ne;return{...X,scriptSettings:{...X.scriptSettings,[h.selectedScript]:{...X.scriptSettings[h.selectedScript],lotSettings:{...(ne=X.scriptSettings[h.selectedScript])==null?void 0:ne.lotSettings,maxLots:Number($.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Min Lots"}),n.jsx("input",{type:"number",value:((Q=(G=h.scriptSettings[h.selectedScript])==null?void 0:G.lotSettings)==null?void 0:Q.minLots)||1,onChange:$=>x(X=>{var ne;return{...X,scriptSettings:{...X.scriptSettings,[h.selectedScript]:{...X.scriptSettings[h.selectedScript],lotSettings:{...(ne=X.scriptSettings[h.selectedScript])==null?void 0:ne.lotSettings,minLots:Number($.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Per Order"}),n.jsx("input",{type:"number",value:((ke=(ge=h.scriptSettings[h.selectedScript])==null?void 0:ge.lotSettings)==null?void 0:ke.perOrderLots)||10,onChange:$=>x(X=>{var ne;return{...X,scriptSettings:{...X.scriptSettings,[h.selectedScript]:{...X.scriptSettings[h.selectedScript],lotSettings:{...(ne=X.scriptSettings[h.selectedScript])==null?void 0:ne.lotSettings,perOrderLots:Number($.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})]})]}),((pe=h.scriptSettings[h.selectedScript])==null?void 0:pe.settingType)==="QUANTITY"&&n.jsxs("div",{className:"mb-3",children:[n.jsx("span",{className:"text-xs text-gray-400 font-medium",children:"Quantity Settings"}),n.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-1",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Max Qty"}),n.jsx("input",{type:"number",value:((qe=(De=h.scriptSettings[h.selectedScript])==null?void 0:De.quantitySettings)==null?void 0:qe.maxQuantity)||1e3,onChange:$=>x(X=>{var ne;return{...X,scriptSettings:{...X.scriptSettings,[h.selectedScript]:{...X.scriptSettings[h.selectedScript],quantitySettings:{...(ne=X.scriptSettings[h.selectedScript])==null?void 0:ne.quantitySettings,maxQuantity:Number($.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Min Qty"}),n.jsx("input",{type:"number",value:((oe=(Je=h.scriptSettings[h.selectedScript])==null?void 0:Je.quantitySettings)==null?void 0:oe.minQuantity)||1,onChange:$=>x(X=>{var ne;return{...X,scriptSettings:{...X.scriptSettings,[h.selectedScript]:{...X.scriptSettings[h.selectedScript],quantitySettings:{...(ne=X.scriptSettings[h.selectedScript])==null?void 0:ne.quantitySettings,minQuantity:Number($.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Per Order"}),n.jsx("input",{type:"number",value:((Ce=(ue=h.scriptSettings[h.selectedScript])==null?void 0:ue.quantitySettings)==null?void 0:Ce.perOrderQuantity)||100,onChange:$=>x(X=>{var ne;return{...X,scriptSettings:{...X.scriptSettings,[h.selectedScript]:{...X.scriptSettings[h.selectedScript],quantitySettings:{...(ne=X.scriptSettings[h.selectedScript])==null?void 0:ne.quantitySettings,perOrderQuantity:Number($.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})]})]}),((Ne=h.scriptSettings[h.selectedScript])==null?void 0:Ne.settingType)==="FIXED_MARGIN"&&n.jsxs("div",{className:"space-y-3",children:[n.jsx("span",{className:"text-xs text-gray-400 font-medium block",children:"Fixed Margin Settings"}),n.jsxs("div",{className:"bg-dark-700 rounded p-3",children:[n.jsx("span",{className:"text-xs text-blue-400 font-medium block mb-2",children:"Future Margins"}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Intraday Future"}),n.jsx("input",{type:"number",value:((Le=(Ee=h.scriptSettings[h.selectedScript])==null?void 0:Ee.fixedMargin)==null?void 0:Le.intradayFuture)||0,onChange:$=>x(X=>{var ne;return{...X,scriptSettings:{...X.scriptSettings,[h.selectedScript]:{...X.scriptSettings[h.selectedScript],fixedMargin:{...(ne=X.scriptSettings[h.selectedScript])==null?void 0:ne.fixedMargin,intradayFuture:Number($.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Carry Future"}),n.jsx("input",{type:"number",value:((Te=(lt=h.scriptSettings[h.selectedScript])==null?void 0:lt.fixedMargin)==null?void 0:Te.carryFuture)||0,onChange:$=>x(X=>{var ne;return{...X,scriptSettings:{...X.scriptSettings,[h.selectedScript]:{...X.scriptSettings[h.selectedScript],fixedMargin:{...(ne=X.scriptSettings[h.selectedScript])==null?void 0:ne.fixedMargin,carryFuture:Number($.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})]})]}),n.jsxs("div",{className:"bg-dark-700 rounded p-3",children:[n.jsx("span",{className:"text-xs text-green-400 font-medium block mb-2",children:"Option Buy Margins"}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Option Buy Intraday"}),n.jsx("input",{type:"number",value:((ot=(de=h.scriptSettings[h.selectedScript])==null?void 0:de.fixedMargin)==null?void 0:ot.optionBuyIntraday)||0,onChange:$=>x(X=>{var ne;return{...X,scriptSettings:{...X.scriptSettings,[h.selectedScript]:{...X.scriptSettings[h.selectedScript],fixedMargin:{...(ne=X.scriptSettings[h.selectedScript])==null?void 0:ne.fixedMargin,optionBuyIntraday:Number($.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Option Buy Carry"}),n.jsx("input",{type:"number",value:((_e=(ae=h.scriptSettings[h.selectedScript])==null?void 0:ae.fixedMargin)==null?void 0:_e.optionBuyCarry)||0,onChange:$=>x(X=>{var ne;return{...X,scriptSettings:{...X.scriptSettings,[h.selectedScript]:{...X.scriptSettings[h.selectedScript],fixedMargin:{...(ne=X.scriptSettings[h.selectedScript])==null?void 0:ne.fixedMargin,optionBuyCarry:Number($.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})]})]}),n.jsxs("div",{className:"bg-dark-700 rounded p-3",children:[n.jsx("span",{className:"text-xs text-red-400 font-medium block mb-2",children:"Option Sell Margins"}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Option Sell Intraday"}),n.jsx("input",{type:"number",value:((qt=(tt=h.scriptSettings[h.selectedScript])==null?void 0:tt.fixedMargin)==null?void 0:qt.optionSellIntraday)||0,onChange:$=>x(X=>{var ne;return{...X,scriptSettings:{...X.scriptSettings,[h.selectedScript]:{...X.scriptSettings[h.selectedScript],fixedMargin:{...(ne=X.scriptSettings[h.selectedScript])==null?void 0:ne.fixedMargin,optionSellIntraday:Number($.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Option Sell Carry"}),n.jsx("input",{type:"number",value:((xt=(Ht=h.scriptSettings[h.selectedScript])==null?void 0:Ht.fixedMargin)==null?void 0:xt.optionSellCarry)||0,onChange:$=>x(X=>{var ne;return{...X,scriptSettings:{...X.scriptSettings,[h.selectedScript]:{...X.scriptSettings[h.selectedScript],fixedMargin:{...(ne=X.scriptSettings[h.selectedScript])==null?void 0:ne.fixedMargin,optionSellCarry:Number($.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})]})]})]}),((Kt=h.scriptSettings[h.selectedScript])==null?void 0:Kt.settingType)==="BROKERAGE"&&n.jsxs("div",{className:"space-y-3",children:[n.jsx("span",{className:"text-xs text-gray-400 font-medium block",children:"Brokerage Settings"}),n.jsx("div",{className:"bg-dark-700 rounded p-3",children:n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Brokerage Type"}),n.jsxs("select",{value:((Ms=(ls=h.scriptSettings[h.selectedScript])==null?void 0:ls.brokerage)==null?void 0:Ms.type)||"PER_LOT",onChange:$=>x(X=>{var ne;return{...X,scriptSettings:{...X.scriptSettings,[h.selectedScript]:{...X.scriptSettings[h.selectedScript],brokerage:{...(ne=X.scriptSettings[h.selectedScript])==null?void 0:ne.brokerage,type:$.target.value}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs",children:[n.jsx("option",{value:"PER_LOT",children:"Per Lot"}),n.jsx("option",{value:"PER_CRORE",children:"Per Crore"}),n.jsx("option",{value:"PER_TRADE",children:"Per Trade"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Brokerage Value"}),n.jsx("input",{type:"number",value:((As=(Rs=h.scriptSettings[h.selectedScript])==null?void 0:Rs.brokerage)==null?void 0:As.value)||0,onChange:$=>x(X=>{var ne;return{...X,scriptSettings:{...X.scriptSettings,[h.selectedScript]:{...X.scriptSettings[h.selectedScript],brokerage:{...(ne=X.scriptSettings[h.selectedScript])==null?void 0:ne.brokerage,value:Number($.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})]})})]}),((zs=h.scriptSettings[h.selectedScript])==null?void 0:zs.settingType)==="SPREAD"&&n.jsxs("div",{className:"space-y-3",children:[n.jsx("span",{className:"text-xs text-gray-400 font-medium block",children:"Spread Settings"}),n.jsx("div",{className:"bg-dark-700 rounded p-3",children:n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Spread Value"}),n.jsx("input",{type:"number",step:"0.01",value:((Os=h.scriptSettings[h.selectedScript])==null?void 0:Os.spread)||0,onChange:$=>x(X=>({...X,scriptSettings:{...X.scriptSettings,[h.selectedScript]:{...X.scriptSettings[h.selectedScript],spread:Number($.target.value)}}})),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})})]}),((Is=h.scriptSettings[h.selectedScript])==null?void 0:Is.settingType)==="BLOCK"&&n.jsxs("div",{className:"space-y-3",children:[n.jsx("span",{className:"text-xs text-gray-400 font-medium block",children:"Block Settings"}),n.jsx("div",{className:"bg-dark-700 rounded p-3",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("label",{className:"text-xs text-gray-500",children:"Block Future"}),n.jsx("button",{type:"button",onClick:()=>x($=>{var X,ne,he;return{...$,scriptSettings:{...$.scriptSettings,[h.selectedScript]:{...$.scriptSettings[h.selectedScript],block:{...(X=$.scriptSettings[h.selectedScript])==null?void 0:X.block,future:!((he=(ne=$.scriptSettings[h.selectedScript])==null?void 0:ne.block)!=null&&he.future)}}}}}),className:`px-3 py-1 rounded text-xs font-medium ${(Bs=($s=h.scriptSettings[h.selectedScript])==null?void 0:$s.block)!=null&&Bs.future?"bg-red-600 text-white":"bg-green-600 text-white"}`,children:(Fs=(Ds=h.scriptSettings[h.selectedScript])==null?void 0:Ds.block)!=null&&Fs.future?"Yes":"No"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("label",{className:"text-xs text-gray-500",children:"Block Option"}),n.jsx("button",{type:"button",onClick:()=>x($=>{var X,ne,he;return{...$,scriptSettings:{...$.scriptSettings,[h.selectedScript]:{...$.scriptSettings[h.selectedScript],block:{...(X=$.scriptSettings[h.selectedScript])==null?void 0:X.block,option:!((he=(ne=$.scriptSettings[h.selectedScript])==null?void 0:ne.block)!=null&&he.option)}}}}}),className:`px-3 py-1 rounded text-xs font-medium ${(Ws=(Us=h.scriptSettings[h.selectedScript])==null?void 0:Us.block)!=null&&Ws.option?"bg-red-600 text-white":"bg-green-600 text-white"}`,children:(qs=(Vs=h.scriptSettings[h.selectedScript])==null?void 0:Vs.block)!=null&&qs.option?"Yes":"No"})]})]})})]})]})]}):n.jsx("p",{className:"text-sm text-gray-500 italic text-center py-4",children:"Select a segment above to view and customize symbol settings"})]}),n.jsx("div",{className:"lg:col-span-2",children:n.jsx("button",{type:"submit",disabled:a,className:"w-full py-3 bg-yellow-600 hover:bg-yellow-700 rounded-lg font-semibold disabled:opacity-50",children:a?"Creating User...":"Create User"})})]})]})},Kw=()=>{var x,y;const{admin:t}=we(),[e,s]=g.useState([]),[r,i]=g.useState(!0),[a,l]=g.useState("PENDING"),[o,c]=g.useState("ALL"),[d,m]=g.useState({pending:0,approved:0,rejected:0,totalDeposits:0,totalWithdrawals:0});g.useEffect(()=>{u()},[a,o]);const u=async()=>{try{i(!0);const{data:f}=await I.get("/api/admin/manage/all-fund-requests",{params:{status:a,type:o!=="ALL"?o:void 0},headers:{Authorization:`Bearer ${t.token}`}});s(f.requests||[]),m(f.stats||d)}catch(f){console.error("Error:",f)}finally{i(!1)}},h=async(f,w)=>{var p,b;try{await I.post(`/api/admin/manage/fund-requests/${f}/${w}`,{},{headers:{Authorization:`Bearer ${t.token}`}}),u()}catch(v){alert(((b=(p=v.response)==null?void 0:p.data)==null?void 0:b.message)||"Error")}};return n.jsxs("div",{className:"p-4 md:p-6",children:[n.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6",children:n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Fund Requests"}),n.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Manage deposit and withdrawal requests from all users"})]})}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Pending"}),n.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:d.pending})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Approved"}),n.jsx("div",{className:"text-2xl font-bold text-green-400",children:d.approved})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Rejected"}),n.jsx("div",{className:"text-2xl font-bold text-red-400",children:d.rejected})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total Deposits"}),n.jsxs("div",{className:"text-xl font-bold text-green-400",children:["",((x=d.totalDeposits)==null?void 0:x.toLocaleString())||0]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total Withdrawals"}),n.jsxs("div",{className:"text-xl font-bold text-red-400",children:["",((y=d.totalWithdrawals)==null?void 0:y.toLocaleString())||0]})]})]}),n.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[n.jsx("div",{className:"flex gap-2",children:["PENDING","APPROVED","REJECTED","ALL"].map(f=>n.jsx("button",{onClick:()=>l(f),className:`px-4 py-2 rounded text-sm ${a===f?"bg-purple-600":"bg-dark-700 hover:bg-dark-600"}`,children:f},f))}),n.jsx("div",{className:"flex gap-2",children:["ALL","DEPOSIT","WITHDRAWAL"].map(f=>n.jsx("button",{onClick:()=>c(f),className:`px-4 py-2 rounded text-sm ${o===f?"bg-blue-600":"bg-dark-700 hover:bg-dark-600"}`,children:f==="ALL"?"All Types":f},f))})]}),r?n.jsx("div",{className:"text-center py-8",children:n.jsx(fe,{className:"animate-spin inline"})}):e.length===0?n.jsxs("div",{className:"text-center py-8 text-gray-400",children:["No ",a.toLowerCase()," requests found"]}):n.jsx("div",{className:"bg-dark-800 rounded-lg overflow-hidden",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-dark-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"User"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Admin"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Type"}),n.jsx("th",{className:"text-right px-4 py-3 text-gray-400",children:"Amount"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Reference"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Date"}),n.jsx("th",{className:"text-center px-4 py-3 text-gray-400",children:"Status"}),n.jsx("th",{className:"text-center px-4 py-3 text-gray-400",children:"Action"})]})}),n.jsx("tbody",{children:e.map(f=>{var w,p,b,v,S,N;return n.jsxs("tr",{className:"border-t border-dark-600 hover:bg-dark-700/50",children:[n.jsxs("td",{className:"px-4 py-3",children:[n.jsx("div",{className:"font-medium",children:((w=f.user)==null?void 0:w.fullName)||((p=f.user)==null?void 0:p.username)}),n.jsx("div",{className:"text-xs text-gray-500",children:(b=f.user)==null?void 0:b.userId})]}),n.jsxs("td",{className:"px-4 py-3",children:[n.jsx("div",{className:"text-sm",children:((v=f.admin)==null?void 0:v.username)||"Super Admin"}),n.jsx("div",{className:"text-xs text-gray-500",children:((S=f.admin)==null?void 0:S.adminCode)||"-"})]}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${f.type==="DEPOSIT"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:f.type})}),n.jsxs("td",{className:"px-4 py-3 text-right font-mono font-bold",children:["",(N=f.amount)==null?void 0:N.toLocaleString()]}),n.jsx("td",{className:"px-4 py-3 text-gray-400 text-xs",children:f.referenceId||"-"}),n.jsx("td",{className:"px-4 py-3 text-gray-400 text-xs",children:new Date(f.createdAt).toLocaleString()}),n.jsx("td",{className:"px-4 py-3 text-center",children:n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${f.status==="PENDING"?"bg-yellow-500/20 text-yellow-400":f.status==="APPROVED"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:f.status})}),n.jsx("td",{className:"px-4 py-3 text-center",children:f.status==="PENDING"&&n.jsxs("div",{className:"flex gap-1 justify-center",children:[n.jsx("button",{onClick:()=>h(f._id,"approve"),className:"px-2 py-1 bg-green-600 hover:bg-green-700 rounded text-xs",children:"Approve"}),n.jsx("button",{onClick:()=>h(f._id,"reject"),className:"px-2 py-1 bg-red-600 hover:bg-red-700 rounded text-xs",children:"Reject"})]})})]},f._id)})})]})})]})},Yw=()=>{const{admin:t}=we(),[e,s]=g.useState([]),[r,i]=g.useState(!0),[a,l]=g.useState("PENDING");g.useEffect(()=>{o()},[a]);const o=async()=>{try{const{data:d}=await I.get(`/api/admin/manage/fund-requests?status=${a}`,{headers:{Authorization:`Bearer ${t.token}`}});s(d)}catch(d){console.error("Error:",d)}finally{i(!1)}},c=async(d,m)=>{var u,h;try{await I.post(`/api/admin/manage/fund-requests/${d}/${m}`,{},{headers:{Authorization:`Bearer ${t.token}`}}),o()}catch(x){alert(((h=(u=x.response)==null?void 0:u.data)==null?void 0:h.message)||"Error")}};return n.jsxs("div",{className:"p-4 md:p-6",children:[n.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Fund Requests"}),n.jsx("div",{className:"flex gap-2 mb-6",children:["PENDING","APPROVED","REJECTED"].map(d=>n.jsx("button",{onClick:()=>l(d),className:`px-4 py-2 rounded ${a===d?"bg-purple-600":"bg-dark-700"}`,children:d},d))}),r?n.jsx("div",{className:"text-center py-8",children:n.jsx(fe,{className:"animate-spin inline"})}):e.length===0?n.jsxs("div",{className:"text-center py-8 text-gray-400",children:["No ",a.toLowerCase()," requests"]}):n.jsx("div",{className:"space-y-4",children:e.map(d=>{var m,u;return n.jsx("div",{className:"bg-dark-800 rounded-lg p-4",children:n.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-4",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${d.type==="DEPOSIT"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:d.type}),n.jsxs("span",{className:"font-bold",children:["",d.amount.toLocaleString()]})]}),n.jsxs("div",{className:"text-sm text-gray-400 mt-1",children:["User: ",((m=d.user)==null?void 0:m.fullName)||((u=d.user)==null?void 0:u.username)," (",d.userId,")"]}),n.jsx("div",{className:"text-xs text-gray-500 mt-1",children:new Date(d.createdAt).toLocaleString()}),d.referenceId&&n.jsxs("div",{className:"text-xs text-gray-500",children:["Ref: ",d.referenceId]})]}),d.status==="PENDING"&&n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>c(d._id,"approve"),className:"px-4 py-2 bg-green-600 rounded text-sm",children:"Approve"}),n.jsx("button",{onClick:()=>c(d._id,"reject"),className:"px-4 py-2 bg-red-600 rounded text-sm",children:"Reject"})]})]})},d._id)})})]})},Qw=()=>{const{admin:t}=we(),[e,s]=g.useState([]),[r,i]=g.useState(!0),[a,l]=g.useState(!1);g.useEffect(()=>{o()},[]);const o=async()=>{try{const{data:d}=await I.get("/api/admin/manage/bank-accounts",{headers:{Authorization:`Bearer ${t.token}`}});s(d)}catch(d){console.error("Error:",d)}finally{i(!1)}},c=async d=>{if(confirm("Delete this account?"))try{await I.delete(`/api/admin/manage/bank-accounts/${d}`,{headers:{Authorization:`Bearer ${t.token}`}}),o()}catch{alert("Error deleting")}};return n.jsxs("div",{className:"p-4 md:p-6",children:[n.jsxs("div",{className:"flex justify-between mb-6",children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Bank Accounts"}),n.jsxs("button",{onClick:()=>l(!0),className:"flex items-center gap-2 bg-purple-600 px-4 py-2 rounded",children:[n.jsx(Ls,{size:20})," Add Account"]})]}),r?n.jsx("div",{className:"text-center py-8",children:n.jsx(fe,{className:"animate-spin inline"})}):e.length===0?n.jsx("div",{className:"text-center py-8 text-gray-400",children:"No bank accounts added"}):n.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:e.map(d=>n.jsx("div",{className:"bg-dark-800 rounded-lg p-4",children:n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{children:[n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${d.type==="BANK"?"bg-blue-500/20 text-blue-400":"bg-purple-500/20 text-purple-400"}`,children:d.type}),n.jsx("div",{className:"font-bold mt-2",children:d.holderName}),d.type==="BANK"?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-sm text-gray-400",children:d.bankName}),n.jsx("div",{className:"text-sm font-mono",children:d.accountNumber}),n.jsxs("div",{className:"text-xs text-gray-500",children:["IFSC: ",d.ifsc]})]}):n.jsx("div",{className:"text-sm font-mono text-purple-400",children:d.upiId})]}),n.jsx("button",{onClick:()=>c(d._id),className:"text-red-400 hover:text-red-300",children:n.jsx(io,{size:18})})]})},d._id))}),a&&n.jsx(Xw,{token:t.token,onClose:()=>l(!1),onSuccess:()=>{l(!1),o()}})]})},Xw=({token:t,onClose:e,onSuccess:s})=>{const[r,i]=g.useState("BANK"),[a,l]=g.useState({holderName:"",bankName:"",accountNumber:"",ifsc:"",upiId:""}),[o,c]=g.useState(!1),d=async m=>{var u,h;m.preventDefault(),c(!0);try{await I.post("/api/admin/manage/bank-accounts",{type:r,...a},{headers:{Authorization:`Bearer ${t}`}}),s()}catch(x){alert(((h=(u=x.response)==null?void 0:u.data)==null?void 0:h.message)||"Error")}finally{c(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg w-full max-w-md p-6",children:[n.jsxs("div",{className:"flex justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Add Payment Method"}),n.jsx("button",{onClick:e,children:n.jsx(ve,{size:24})})]}),n.jsxs("div",{className:"flex gap-2 mb-4",children:[n.jsx("button",{onClick:()=>i("BANK"),className:`flex-1 py-2 rounded ${r==="BANK"?"bg-blue-600":"bg-dark-700"}`,children:"Bank"}),n.jsx("button",{onClick:()=>i("UPI"),className:`flex-1 py-2 rounded ${r==="UPI"?"bg-purple-600":"bg-dark-700"}`,children:"UPI"})]}),n.jsxs("form",{onSubmit:d,className:"space-y-4",children:[n.jsx("input",{type:"text",placeholder:"Account Holder Name *",value:a.holderName,onChange:m=>l({...a,holderName:m.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",required:!0}),r==="BANK"?n.jsxs(n.Fragment,{children:[n.jsx("input",{type:"text",placeholder:"Bank Name *",value:a.bankName,onChange:m=>l({...a,bankName:m.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",required:!0}),n.jsx("input",{type:"text",placeholder:"Account Number *",value:a.accountNumber,onChange:m=>l({...a,accountNumber:m.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",required:!0}),n.jsx("input",{type:"text",placeholder:"IFSC Code *",value:a.ifsc,onChange:m=>l({...a,ifsc:m.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",required:!0})]}):n.jsx("input",{type:"text",placeholder:"UPI ID *",value:a.upiId,onChange:m=>l({...a,upiId:m.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",required:!0}),n.jsx("button",{type:"submit",disabled:o,className:"w-full bg-green-600 py-2 rounded",children:o?"Adding...":"Add Account"})]})]})})},Gw=()=>{var j,E,_,M,V,B,R,O,P,W,D;const{admin:t,updateAdmin:e}=we(),[s,r]=g.useState(null),[i,a]=g.useState([]),[l,o]=g.useState(!0),[c,d]=g.useState(!1),[m,u]=g.useState(""),[h,x]=g.useState(""),[y,f]=g.useState(!1),[w,p]=g.useState({type:"",text:""});g.useEffect(()=>{b(),v()},[]);const b=async()=>{try{const{data:T}=await I.get("/api/admin/manage/my-wallet",{headers:{Authorization:`Bearer ${t.token}`}});r(T)}catch(T){console.error("Error:",T)}finally{o(!1)}},v=async()=>{try{const{data:T}=await I.get("/api/admin/manage/my-fund-requests",{headers:{Authorization:`Bearer ${t.token}`}});a(T)}catch(T){console.error("Error:",T)}},S=async T=>{var L,F;if(T.preventDefault(),!m||Number(m)<=0){p({type:"error",text:"Enter valid amount"});return}f(!0),p({type:"",text:""});try{await I.post("/api/admin/manage/fund-request",{amount:Number(m),reason:h},{headers:{Authorization:`Bearer ${t.token}`}}),p({type:"success",text:"Fund request submitted successfully"}),u(""),x(""),d(!1),v()}catch(C){p({type:"error",text:((F=(L=C.response)==null?void 0:L.data)==null?void 0:F.message)||"Error submitting request"})}finally{f(!1)}},N=async()=>{try{const T=await I.get("/api/admin/manage/my-ledger/download",{headers:{Authorization:`Bearer ${t.token}`},responseType:"blob"}),L=window.URL.createObjectURL(new Blob([T.data])),F=document.createElement("a");F.href=L,F.setAttribute("download",`admin-ledger-${Date.now()}.csv`),document.body.appendChild(F),F.click(),F.remove()}catch{alert("Error downloading ledger")}},k=async()=>{try{const T=await I.get("/api/admin/manage/user-transactions/download",{headers:{Authorization:`Bearer ${t.token}`},responseType:"blob"}),L=window.URL.createObjectURL(new Blob([T.data])),F=document.createElement("a");F.href=L,F.setAttribute("download",`user-transactions-${Date.now()}.csv`),document.body.appendChild(F),F.click(),F.remove()}catch{alert("Error downloading transactions")}};return l?n.jsx("div",{className:"p-6 text-center",children:n.jsx(fe,{className:"animate-spin inline",size:24})}):n.jsxs("div",{className:"p-4 md:p-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[n.jsx("h1",{className:"text-2xl font-bold",children:"My Wallet"}),n.jsxs("button",{onClick:()=>d(!0),className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg",children:[n.jsx(Ls,{size:20}),"Request Funds"]})]}),w.text&&n.jsx("div",{className:`mb-4 p-3 rounded ${w.type==="success"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:w.text}),n.jsxs("div",{className:"bg-gradient-to-r from-green-600 to-emerald-600 rounded-xl p-6 mb-6",children:[n.jsx("div",{className:"text-white/80 text-sm mb-1",children:"Available Balance"}),n.jsxs("div",{className:"text-4xl font-bold text-white mb-4",children:["",(((j=s==null?void 0:s.wallet)==null?void 0:j.balance)||0).toLocaleString()]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-white/60",children:"Total Deposited"}),n.jsxs("div",{className:"text-white font-semibold",children:["",(((E=s==null?void 0:s.wallet)==null?void 0:E.totalDeposited)||0).toLocaleString()]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-white/60",children:"Total Withdrawn"}),n.jsxs("div",{className:"text-white font-semibold",children:["",(((_=s==null?void 0:s.wallet)==null?void 0:_.totalWithdrawn)||0).toLocaleString()]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total Users"}),n.jsx("div",{className:"text-2xl font-bold text-purple-400",children:((M=s==null?void 0:s.summary)==null?void 0:M.totalUsers)||0})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"User Deposits"}),n.jsxs("div",{className:"text-2xl font-bold text-green-400",children:["",(((V=s==null?void 0:s.summary)==null?void 0:V.totalUserDeposits)||0).toLocaleString()]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"User Withdrawals"}),n.jsxs("div",{className:"text-2xl font-bold text-red-400",children:["",(((B=s==null?void 0:s.summary)==null?void 0:B.totalUserWithdrawals)||0).toLocaleString()]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Distributed to Users"}),n.jsxs("div",{className:"text-2xl font-bold text-blue-400",children:["",(((R=s==null?void 0:s.summary)==null?void 0:R.distributedToUsers)||0).toLocaleString()]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total User Profits"}),n.jsxs("div",{className:"text-2xl font-bold text-green-400",children:["",(((O=s==null?void 0:s.summary)==null?void 0:O.totalUserProfits)||0).toLocaleString()]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total User Losses"}),n.jsxs("div",{className:"text-2xl font-bold text-red-400",children:["",(((P=s==null?void 0:s.summary)==null?void 0:P.totalUserLosses)||0).toLocaleString()]})]})]}),n.jsxs("div",{className:"flex flex-wrap gap-3 mb-6",children:[n.jsxs("button",{onClick:N,className:"flex items-center gap-2 bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded-lg",children:[n.jsx(hn,{size:18})," Download My Ledger"]}),n.jsxs("button",{onClick:k,className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg",children:[n.jsx(hn,{size:18})," Download User Transactions"]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 mb-6",children:[n.jsx("h2",{className:"text-lg font-semibold mb-4",children:"My Fund Requests"}),i.length===0?n.jsx("div",{className:"text-center py-4 text-gray-400",children:"No fund requests yet"}):n.jsx("div",{className:"space-y-2",children:i.map(T=>n.jsxs("div",{className:"flex items-center justify-between bg-dark-700 rounded p-3",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"font-medium",children:["",T.amount.toLocaleString()]}),n.jsx("div",{className:"text-xs text-gray-400",children:T.reason||"No reason"}),n.jsx("div",{className:"text-xs text-gray-500",children:new Date(T.createdAt).toLocaleString()})]}),n.jsx("span",{className:`px-3 py-1 rounded text-sm ${T.status==="APPROVED"?"bg-green-500/20 text-green-400":T.status==="REJECTED"?"bg-red-500/20 text-red-400":"bg-yellow-500/20 text-yellow-400"}`,children:T.status})]},T._id))})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Recent Transactions"}),(W=s==null?void 0:s.ledger)!=null&&W.length?n.jsx("div",{className:"space-y-2",children:s.ledger.slice(0,10).map(T=>n.jsxs("div",{className:"flex items-center justify-between bg-dark-700 rounded p-3",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm",children:T.reason}),n.jsx("div",{className:"text-xs text-gray-400",children:T.description}),n.jsx("div",{className:"text-xs text-gray-500",children:new Date(T.createdAt).toLocaleString()})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:T.type==="CREDIT"?"text-green-400":"text-red-400",children:[T.type==="CREDIT"?"+":"-","",T.amount.toLocaleString()]}),n.jsxs("div",{className:"text-xs text-gray-400",children:["Bal: ",T.balanceAfter.toLocaleString()]})]})]},T._id))}):n.jsx("div",{className:"text-center py-4 text-gray-400",children:"No transactions yet"})]}),c&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg w-full max-w-md p-6",children:[n.jsxs("div",{className:"flex justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Request Funds"}),n.jsx("button",{onClick:()=>d(!1),children:n.jsx(ve,{size:24})})]}),n.jsxs("p",{className:"text-gray-400 text-sm mb-4",children:["Request funds from Super Admin. Your current balance is ",(((D=s==null?void 0:s.wallet)==null?void 0:D.balance)||0).toLocaleString()]}),n.jsxs("form",{onSubmit:S,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Amount ()"}),n.jsx("input",{type:"number",value:m,onChange:T=>u(T.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",placeholder:"Enter amount",required:!0,min:"1"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Reason (optional)"}),n.jsx("textarea",{value:h,onChange:T=>x(T.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",placeholder:"Why do you need these funds?",rows:3})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{type:"button",onClick:()=>d(!1),className:"flex-1 bg-dark-600 py-2 rounded",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:y,className:"flex-1 bg-green-600 hover:bg-green-700 py-2 rounded",children:y?"Submitting...":"Submit Request"})]})]})]})})]})},Jw=()=>{const{admin:t}=we(),[e,s]=g.useState([]),[r,i]=g.useState(!0),[a,l]=g.useState("PENDING"),[o,c]=g.useState(null);g.useEffect(()=>{d()},[a]);const d=async()=>{i(!0);try{const{data:u}=await I.get(`/api/admin/manage/admin-fund-requests?status=${a}`,{headers:{Authorization:`Bearer ${t.token}`}});s(u)}catch(u){console.error("Error:",u)}finally{i(!1)}},m=async(u,h,x="")=>{var y,f;c(u);try{await I.put(`/api/admin/manage/admin-fund-requests/${u}`,{status:h,remarks:x},{headers:{Authorization:`Bearer ${t.token}`}}),d()}catch(w){alert(((f=(y=w.response)==null?void 0:y.data)==null?void 0:f.message)||"Error processing request")}finally{c(null)}};return n.jsxs("div",{className:"p-4 md:p-6",children:[n.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Admin Fund Requests"}),n.jsx("div",{className:"flex gap-2 mb-6",children:["PENDING","APPROVED","REJECTED"].map(u=>n.jsx("button",{onClick:()=>l(u),className:`px-4 py-2 rounded-lg ${a===u?u==="PENDING"?"bg-yellow-600":u==="APPROVED"?"bg-green-600":"bg-red-600":"bg-dark-700"}`,children:u},u))}),r?n.jsx("div",{className:"text-center py-8",children:n.jsx(fe,{className:"animate-spin inline"})}):e.length===0?n.jsxs("div",{className:"text-center py-8 text-gray-400",children:["No ",a.toLowerCase()," requests"]}):n.jsx("div",{className:"space-y-4",children:e.map(u=>{var h,x,y,f,w;return n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("span",{className:"font-bold text-lg",children:((h=u.admin)==null?void 0:h.name)||((x=u.admin)==null?void 0:x.username)}),n.jsx("span",{className:"font-mono bg-purple-500/20 text-purple-400 px-2 py-0.5 rounded text-sm",children:u.adminCode})]}),n.jsx("div",{className:"text-sm text-gray-400 mt-1",children:(y=u.admin)==null?void 0:y.email}),n.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["Current Balance: ",(((w=(f=u.admin)==null?void 0:f.wallet)==null?void 0:w.balance)||0).toLocaleString()]}),u.reason&&n.jsxs("div",{className:"text-sm mt-2 text-gray-300",children:["Reason: ",u.reason]}),n.jsx("div",{className:"text-xs text-gray-500 mt-1",children:new Date(u.createdAt).toLocaleString()})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Requested Amount"}),n.jsxs("div",{className:"text-2xl font-bold text-green-400",children:["",u.amount.toLocaleString()]})]}),a==="PENDING"&&n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:()=>m(u._id,"APPROVED"),disabled:o===u._id,className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded flex items-center gap-1",children:[n.jsx(Vn,{size:18})," Approve"]}),n.jsxs("button",{onClick:()=>m(u._id,"REJECTED"),disabled:o===u._id,className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded flex items-center gap-1",children:[n.jsx(Wn,{size:18})," Reject"]})]}),a!=="PENDING"&&n.jsx("span",{className:`px-4 py-2 rounded ${u.status==="APPROVED"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:u.status})]}),u.adminRemarks&&n.jsxs("div",{className:"mt-3 pt-3 border-t border-dark-600 text-sm text-gray-400",children:["Remarks: ",u.adminRemarks]})]},u._id)})})]})},Zw=()=>{const{admin:t}=we(),[e,s]=g.useState([]),[r,i]=g.useState(!0);g.useEffect(()=>{a()},[]);const a=async()=>{try{const{data:l}=await I.get("/api/admin/manage/my-ledger",{headers:{Authorization:`Bearer ${t.token}`}});s(l)}catch(l){console.error("Error:",l)}finally{i(!1)}};return n.jsxs("div",{className:"p-4 md:p-6",children:[n.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Wallet Ledger"}),r?n.jsx("div",{className:"text-center py-8",children:n.jsx(fe,{className:"animate-spin inline"})}):e.length===0?n.jsx("div",{className:"text-center py-8 text-gray-400",children:"No transactions yet"}):n.jsx("div",{className:"bg-dark-800 rounded-lg overflow-hidden",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-dark-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Date"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Type"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Reason"}),n.jsx("th",{className:"text-right px-4 py-3 text-gray-400",children:"Amount"}),n.jsx("th",{className:"text-right px-4 py-3 text-gray-400",children:"Balance"})]})}),n.jsx("tbody",{children:e.map(l=>n.jsxs("tr",{className:"border-t border-dark-600",children:[n.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(l.createdAt).toLocaleString()}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${l.type==="CREDIT"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:l.type})}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-400",children:l.reason}),n.jsxs("td",{className:`px-4 py-3 text-right ${l.type==="CREDIT"?"text-green-400":"text-red-400"}`,children:[l.type==="CREDIT"?"+":"-","",l.amount.toLocaleString()]}),n.jsxs("td",{className:"px-4 py-3 text-right",children:["",l.balanceAfter.toLocaleString()]})]},l._id))})]})})]})},ek=()=>{var E,_,M,V;const{admin:t}=we(),[e,s]=g.useState(null),[r,i]=g.useState(!0),[a,l]=g.useState(!1),[o,c]=g.useState(!1),[d,m]=g.useState(null),[u,h]=g.useState(null),[x,y]=g.useState({});g.useEffect(()=>{f()},[]);const f=async()=>{try{const{data:B}=await I.get("/api/admin/bank-settings",{headers:{Authorization:`Bearer ${t.token}`}});s(B)}catch(B){console.error("Error fetching bank settings:",B)}finally{i(!1)}},w=async B=>{var R,O;B.preventDefault();try{const{data:P}=await I.post("/api/admin/bank-settings/bank-account",x,{headers:{Authorization:`Bearer ${t.token}`}});s(P),l(!1),y({})}catch(P){alert(((O=(R=P.response)==null?void 0:R.data)==null?void 0:O.message)||"Error adding bank account")}},p=async B=>{var R,O;if(confirm("Are you sure you want to delete this bank account?"))try{const{data:P}=await I.delete(`/api/admin/bank-settings/bank-account/${B}`,{headers:{Authorization:`Bearer ${t.token}`}});s(P)}catch(P){alert(((O=(R=P.response)==null?void 0:R.data)==null?void 0:O.message)||"Error deleting bank account")}},b=async B=>{var R,O;B.preventDefault();try{const{data:P}=await I.post("/api/admin/bank-settings/upi-account",x,{headers:{Authorization:`Bearer ${t.token}`}});s(P),c(!1),y({})}catch(P){alert(((O=(R=P.response)==null?void 0:R.data)==null?void 0:O.message)||"Error adding UPI account")}},v=async B=>{var R,O;if(confirm("Are you sure you want to delete this UPI account?"))try{const{data:P}=await I.delete(`/api/admin/bank-settings/upi-account/${B}`,{headers:{Authorization:`Bearer ${t.token}`}});s(P)}catch(P){alert(((O=(R=P.response)==null?void 0:R.data)==null?void 0:O.message)||"Error deleting UPI account")}},S=async(B,R)=>{var O,P;try{const{data:W}=await I.put(`/api/admin/bank-settings/bank-account/${B}`,{isActive:!R},{headers:{Authorization:`Bearer ${t.token}`}});s(W)}catch(W){alert(((P=(O=W.response)==null?void 0:O.data)==null?void 0:P.message)||"Error updating bank status")}},N=async(B,R)=>{var O,P;try{const{data:W}=await I.put(`/api/admin/bank-settings/upi-account/${B}`,{isActive:!R},{headers:{Authorization:`Bearer ${t.token}`}});s(W)}catch(W){alert(((P=(O=W.response)==null?void 0:O.data)==null?void 0:P.message)||"Error updating UPI status")}},k=async B=>{var R,O;try{const{data:P}=await I.put(`/api/admin/bank-settings/bank-account/${B}`,{isPrimary:!0},{headers:{Authorization:`Bearer ${t.token}`}});s(P)}catch(P){alert(((O=(R=P.response)==null?void 0:R.data)==null?void 0:O.message)||"Error setting primary bank")}},j=async B=>{var R,O;try{const{data:P}=await I.put(`/api/admin/bank-settings/upi-account/${B}`,{isPrimary:!0},{headers:{Authorization:`Bearer ${t.token}`}});s(P)}catch(P){alert(((O=(R=P.response)==null?void 0:R.data)==null?void 0:O.message)||"Error setting primary UPI")}};return r?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx(fe,{className:"animate-spin",size:32})}):n.jsxs("div",{className:"p-4 md:p-6",children:[n.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Bank Management"}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6 mb-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[n.jsx(Rr,{size:24}),"Bank Accounts"]}),n.jsxs("button",{onClick:()=>{l(!0),y({})},className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg flex items-center gap-2",children:[n.jsx(Ls,{size:18})," Add Bank"]})]}),((E=e==null?void 0:e.bankAccounts)==null?void 0:E.length)===0?n.jsx("p",{className:"text-gray-400 text-center py-8",children:"No bank accounts configured"}):n.jsx("div",{className:"space-y-4",children:(_=e==null?void 0:e.bankAccounts)==null?void 0:_.map(B=>n.jsx("div",{className:`bg-dark-700 rounded-lg p-4 border-l-4 ${B.isPrimary?"border-green-500":"border-dark-600"}`,children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("h3",{className:"font-semibold text-lg",children:B.bankName}),B.isPrimary&&n.jsx("span",{className:"text-xs bg-green-600 px-2 py-0.5 rounded",children:"PRIMARY"}),!B.isActive&&n.jsx("span",{className:"text-xs bg-red-600 px-2 py-0.5 rounded",children:"INACTIVE"})]}),n.jsx("p",{className:"text-gray-400 text-sm mt-1",children:B.accountName}),n.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"Account Number:"}),n.jsx("span",{className:"ml-2 font-mono",children:B.accountNumber})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"IFSC:"}),n.jsx("span",{className:"ml-2 font-mono",children:B.ifscCode})]}),B.branch&&n.jsxs("div",{className:"col-span-2",children:[n.jsx("span",{className:"text-gray-500",children:"Branch:"}),n.jsx("span",{className:"ml-2",children:B.branch})]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[!B.isPrimary&&n.jsx("button",{onClick:()=>k(B._id),className:"px-3 py-1 text-xs bg-blue-600 hover:bg-blue-700 rounded",children:"Set Primary"}),n.jsx("button",{onClick:()=>S(B._id,B.isActive),className:`px-3 py-1 text-xs rounded ${B.isActive?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"}`,children:B.isActive?"Disable":"Enable"}),n.jsx("button",{onClick:()=>{m(B._id),y(B)},className:"px-3 py-1 text-xs bg-gray-600 hover:bg-gray-700 rounded",children:"Edit"}),n.jsx("button",{onClick:()=>p(B._id),className:"px-3 py-1 text-xs bg-red-600 hover:bg-red-700 rounded",children:"Delete"})]})]})},B._id))})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6 mb-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[n.jsx(Ar,{size:24}),"UPI Accounts"]}),n.jsxs("button",{onClick:()=>{c(!0),y({})},className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg flex items-center gap-2",children:[n.jsx(Ls,{size:18})," Add UPI"]})]}),((M=e==null?void 0:e.upiAccounts)==null?void 0:M.length)===0?n.jsx("p",{className:"text-gray-400 text-center py-8",children:"No UPI accounts configured"}):n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:(V=e==null?void 0:e.upiAccounts)==null?void 0:V.map(B=>n.jsxs("div",{className:`bg-dark-700 rounded-lg p-4 border-l-4 ${B.isPrimary?"border-green-500":"border-dark-600"}`,children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("h3",{className:"font-semibold",children:B.name}),B.isPrimary&&n.jsx("span",{className:"text-xs bg-green-600 px-2 py-0.5 rounded",children:"PRIMARY"})]}),!B.isActive&&n.jsx("span",{className:"text-xs bg-red-600 px-2 py-0.5 rounded",children:"INACTIVE"})]}),n.jsx("p",{className:"font-mono text-lg text-green-400",children:B.upiId}),n.jsx("p",{className:"text-xs text-gray-500 capitalize mt-1",children:B.provider}),n.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[!B.isPrimary&&n.jsx("button",{onClick:()=>j(B._id),className:"px-2 py-1 text-xs bg-blue-600 hover:bg-blue-700 rounded",children:"Primary"}),n.jsx("button",{onClick:()=>N(B._id,B.isActive),className:`px-2 py-1 text-xs rounded ${B.isActive?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"}`,children:B.isActive?"Disable":"Enable"}),n.jsx("button",{onClick:()=>v(B._id),className:"px-2 py-1 text-xs bg-red-600 hover:bg-red-700 rounded",children:"Delete"})]})]},B._id))})]}),a&&n.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6 w-full max-w-md",children:[n.jsx("h3",{className:"text-xl font-bold mb-4",children:"Add Bank Account"}),n.jsxs("form",{onSubmit:w,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Bank Name *"}),n.jsx("input",{type:"text",value:x.bankName||"",onChange:B=>y({...x,bankName:B.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Account Name *"}),n.jsx("input",{type:"text",value:x.accountName||"",onChange:B=>y({...x,accountName:B.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Account Number *"}),n.jsx("input",{type:"text",value:x.accountNumber||"",onChange:B=>y({...x,accountNumber:B.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"IFSC Code *"}),n.jsx("input",{type:"text",value:x.ifscCode||"",onChange:B=>y({...x,ifscCode:B.target.value.toUpperCase()}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Branch"}),n.jsx("input",{type:"text",value:x.branch||"",onChange:B=>y({...x,branch:B.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",id:"isPrimary",checked:x.isPrimary||!1,onChange:B=>y({...x,isPrimary:B.target.checked})}),n.jsx("label",{htmlFor:"isPrimary",className:"text-sm",children:"Set as primary account"})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx("button",{type:"submit",className:"flex-1 py-2 bg-green-600 hover:bg-green-700 rounded font-medium",children:"Add Bank"}),n.jsx("button",{type:"button",onClick:()=>l(!1),className:"flex-1 py-2 bg-gray-600 hover:bg-gray-700 rounded font-medium",children:"Cancel"})]})]})]})}),o&&n.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6 w-full max-w-md",children:[n.jsx("h3",{className:"text-xl font-bold mb-4",children:"Add UPI Account"}),n.jsxs("form",{onSubmit:b,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"UPI ID *"}),n.jsx("input",{type:"text",value:x.upiId||"",onChange:B=>y({...x,upiId:B.target.value}),placeholder:"example@upi",className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Display Name *"}),n.jsx("input",{type:"text",value:x.name||"",onChange:B=>y({...x,name:B.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Provider"}),n.jsxs("select",{value:x.provider||"other",onChange:B=>y({...x,provider:B.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",children:[n.jsx("option",{value:"gpay",children:"Google Pay"}),n.jsx("option",{value:"phonepe",children:"PhonePe"}),n.jsx("option",{value:"paytm",children:"Paytm"}),n.jsx("option",{value:"bhim",children:"BHIM"}),n.jsx("option",{value:"other",children:"Other"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",id:"isPrimaryUpi",checked:x.isPrimary||!1,onChange:B=>y({...x,isPrimary:B.target.checked})}),n.jsx("label",{htmlFor:"isPrimaryUpi",className:"text-sm",children:"Set as primary UPI"})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx("button",{type:"submit",className:"flex-1 py-2 bg-green-600 hover:bg-green-700 rounded font-medium",children:"Add UPI"}),n.jsx("button",{type:"button",onClick:()=>c(!1),className:"flex-1 py-2 bg-gray-600 hover:bg-gray-700 rounded font-medium",children:"Cancel"})]})]})]})})]})},tk=()=>{const{admin:t}=we(),[e,s]=g.useState([]),[r,i]=g.useState(!0),[a,l]=g.useState(""),[o,c]=g.useState({segment:"",category:"",enabled:"",optionType:""}),[d,m]=g.useState(!1),[u,h]=g.useState({}),[x,y]=g.useState({connected:!1});g.useEffect(()=>{p(),f(),w();const j=setInterval(w,2e3);return()=>clearInterval(j)},[o]);const f=async()=>{try{const{data:j}=await I.get("/api/zerodha/status");y(j)}catch(j){console.error("Error fetching Zerodha status:",j)}},w=async()=>{try{const{data:j}=await I.get("/api/zerodha/market-data");j&&Object.keys(j).length>0&&h(j)}catch{}},p=async()=>{try{let j="/api/instruments/admin?";o.segment&&(j+=`segment=${o.segment}&`),o.category&&(j+=`category=${o.category}&`),o.enabled&&(j+=`enabled=${o.enabled}&`),a&&(j+=`search=${a}&`);const{data:E}=await I.get(j,{headers:{Authorization:`Bearer ${t.token}`}});s(E)}catch(j){console.error("Error:",j)}finally{i(!1)}},b=async j=>{var E,_;try{await I.put(`/api/instruments/admin/${j}/toggle`,{},{headers:{Authorization:`Bearer ${t.token}`}}),p()}catch(M){alert(((_=(E=M.response)==null?void 0:E.data)==null?void 0:_.message)||"Error toggling instrument")}},v=async j=>{var _,M;const E=e.filter(V=>V.isEnabled!==j).map(V=>V._id);if(E.length!==0)try{await I.put("/api/instruments/admin/bulk-toggle",{ids:E,isEnabled:j},{headers:{Authorization:`Bearer ${t.token}`}}),p()}catch(V){alert(((M=(_=V.response)==null?void 0:_.data)==null?void 0:M.message)||"Error")}},S=async()=>{var j,E;m(!0);try{const{data:_}=await I.post("/api/instruments/admin/seed-defaults",{},{headers:{Authorization:`Bearer ${t.token}`}});alert(_.message),p()}catch(_){alert(((E=(j=_.response)==null?void 0:j.data)==null?void 0:E.message)||"Error seeding instruments")}finally{m(!1)}},N=j=>{j.preventDefault(),p()},k=["NIFTY","BANKNIFTY","FINNIFTY","MIDCPNIFTY","STOCKS","INDICES","MCX","COMMODITY","CURRENCY","OTHER"];return n.jsxs("div",{className:"p-4 md:p-6",children:[n.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Instrument Management"}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsx("span",{className:`w-2 h-2 rounded-full ${x.connected?"bg-green-500 animate-pulse":"bg-red-500"}`}),n.jsxs("span",{className:"text-sm text-gray-400",children:["Zerodha: ",x.connected?`Connected (${x.userId})`:"Not Connected"]}),Object.keys(u).length>0&&n.jsxs("span",{className:"text-sm text-green-400 ml-2",children:[" ",Object.keys(u).length," live prices"]})]})]}),n.jsx("div",{className:"flex gap-2",children:n.jsx("button",{onClick:S,disabled:d,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded text-sm",children:d?"Seeding...":"Seed Default Instruments"})})]}),n.jsx("div",{className:"bg-dark-800 rounded-lg p-4 mb-6",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[n.jsx("form",{onSubmit:N,className:"md:col-span-2",children:n.jsxs("div",{className:"relative",children:[n.jsx(Jn,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),n.jsx("input",{type:"text",placeholder:"Search symbol or name...",value:a,onChange:j=>l(j.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded pl-10 pr-4 py-2"})]})}),n.jsxs("select",{value:o.segment,onChange:j=>c({...o,segment:j.target.value}),className:"bg-dark-700 border border-dark-600 rounded px-3 py-2",children:[n.jsx("option",{value:"",children:"All Segments"}),n.jsx("option",{value:"EQUITY",children:"Equity"}),n.jsx("option",{value:"FNO",children:"F&O"}),n.jsx("option",{value:"MCX",children:"MCX"}),n.jsx("option",{value:"COMMODITY",children:"Commodity"}),n.jsx("option",{value:"CURRENCY",children:"Currency"})]}),n.jsxs("select",{value:o.category,onChange:j=>c({...o,category:j.target.value}),className:"bg-dark-700 border border-dark-600 rounded px-3 py-2",children:[n.jsx("option",{value:"",children:"All Categories"}),k.map(j=>n.jsx("option",{value:j,children:j},j))]}),n.jsxs("select",{value:o.enabled,onChange:j=>c({...o,enabled:j.target.value}),className:"bg-dark-700 border border-dark-600 rounded px-3 py-2",children:[n.jsx("option",{value:"",children:"All Status"}),n.jsx("option",{value:"true",children:"Enabled"}),n.jsx("option",{value:"false",children:"Disabled"})]}),n.jsxs("select",{value:o.optionType,onChange:j=>c({...o,optionType:j.target.value}),className:"bg-dark-700 border border-dark-600 rounded px-3 py-2",children:[n.jsx("option",{value:"",children:"All Types"}),n.jsx("option",{value:"CE",children:"Calls (CE)"}),n.jsx("option",{value:"PE",children:"Puts (PE)"}),n.jsx("option",{value:"FUT",children:"Futures"})]})]})}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total"}),n.jsx("div",{className:"text-2xl font-bold",children:e.length})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Enabled"}),n.jsx("div",{className:"text-2xl font-bold text-green-400",children:e.filter(j=>j.isEnabled).length})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Disabled"}),n.jsx("div",{className:"text-2xl font-bold text-red-400",children:e.filter(j=>!j.isEnabled).length})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Featured"}),n.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:e.filter(j=>j.isFeatured).length})]})]}),n.jsxs("div",{className:"flex gap-2 mb-4",children:[n.jsx("button",{onClick:()=>v(!0),className:"px-3 py-1 bg-green-600 hover:bg-green-700 rounded text-sm",children:"Enable All Visible"}),n.jsx("button",{onClick:()=>v(!1),className:"px-3 py-1 bg-red-600 hover:bg-red-700 rounded text-sm",children:"Disable All Visible"}),n.jsxs("button",{onClick:p,className:"px-3 py-1 bg-dark-600 hover:bg-dark-500 rounded text-sm flex items-center gap-1",children:[n.jsx(fe,{size:14})," Refresh"]})]}),r?n.jsx("div",{className:"text-center py-8",children:n.jsx(fe,{className:"animate-spin inline"})}):e.length===0?n.jsx("div",{className:"text-center py-8 text-gray-400",children:'No instruments found. Click "Seed Default Instruments" to add popular stocks and indices.'}):n.jsx("div",{className:"bg-dark-800 rounded-lg overflow-hidden overflow-x-auto",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-dark-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Symbol"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Type"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Category"}),n.jsx("th",{className:"text-right px-4 py-3 text-gray-400",children:"Strike"}),n.jsx("th",{className:"text-right px-4 py-3 text-gray-400",children:"LTP"}),n.jsx("th",{className:"text-right px-4 py-3 text-gray-400",children:"Change"}),n.jsx("th",{className:"text-center px-4 py-3 text-gray-400",children:"Live"}),n.jsx("th",{className:"text-center px-4 py-3 text-gray-400",children:"Status"})]})}),n.jsx("tbody",{children:e.map(j=>{const E=u[j.token]||{},_=E.ltp||j.ltp||0,M=E.change||j.change||0,V=E.changePercent||j.changePercent||0,B=!!E.ltp;return n.jsxs("tr",{className:"border-t border-dark-600 hover:bg-dark-700/50",children:[n.jsxs("td",{className:"px-4 py-3",children:[n.jsx("div",{className:"font-medium",children:j.symbol}),n.jsxs("div",{className:"text-xs text-gray-500",children:[j.exchange,"  ",j.expiry||"Spot"]})]}),n.jsx("td",{className:"px-4 py-3",children:j.optionType?n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${j.optionType==="CE"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:j.optionType}):j.instrumentType==="FUTURES"?n.jsx("span",{className:"px-2 py-0.5 bg-blue-500/20 text-blue-400 rounded text-xs",children:"FUT"}):n.jsx("span",{className:"px-2 py-0.5 bg-gray-500/20 text-gray-400 rounded text-xs",children:j.instrumentType})}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("span",{className:"px-2 py-0.5 bg-purple-500/20 text-purple-400 rounded text-xs",children:j.category})}),n.jsx("td",{className:"px-4 py-3 text-right font-mono text-gray-400",children:j.strike?`${j.strike.toLocaleString()}`:"-"}),n.jsx("td",{className:"px-4 py-3 text-right font-mono",children:_>0?`${_.toLocaleString()}`:"-"}),n.jsx("td",{className:`px-4 py-3 text-right font-mono ${M>=0?"text-green-400":"text-red-400"}`,children:V?`${M>=0?"+":""}${parseFloat(V).toFixed(2)}%`:"-"}),n.jsx("td",{className:"px-4 py-3 text-center",children:B?n.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full inline-block animate-pulse"}):n.jsx("span",{className:"w-2 h-2 bg-gray-600 rounded-full inline-block"})}),n.jsx("td",{className:"px-4 py-3 text-center",children:n.jsx("button",{onClick:()=>b(j._id),className:`relative w-12 h-6 rounded-full transition ${j.isEnabled?"bg-green-600":"bg-dark-600"}`,children:n.jsx("span",{className:`absolute top-1 w-4 h-4 bg-white rounded-full transition ${j.isEnabled?"left-7":"left-1"}`})})})]},j._id)})})]})})]})},sk=()=>{const{admin:t}=we(),[e,s]=g.useState(null),[r,i]=g.useState(!0),[a,l]=g.useState(!1),[o,c]=g.useState(null),[d,m]=g.useState(null),[u,h]=g.useState({});g.useEffect(()=>{y(),x();const j=new URLSearchParams(window.location.search),E=j.get("zerodha");E==="success"?(alert("Zerodha connected successfully!"),window.history.replaceState({},"",window.location.pathname),x()):E==="error"?(alert("Zerodha connection failed: "+(j.get("message")||"Unknown error")),window.history.replaceState({},"",window.location.pathname)):E==="cancelled"&&(alert("Zerodha login was cancelled"),window.history.replaceState({},"",window.location.pathname))},[]);const x=async()=>{try{const{data:j}=await I.get("/api/zerodha/status");c(j)}catch(j){console.error("Error fetching broker status:",j)}},y=async()=>{try{const{data:j}=await I.get("/api/trade/market-state");s(j)}catch(j){console.error("Error:",j)}finally{i(!1)}},f=async()=>{var j,E;l(!0);try{const{data:_}=await I.put("/api/trade/market-state",{isMarketOpen:!e.isMarketOpen},{headers:{Authorization:`Bearer ${t.token}`}});s(_)}catch(_){alert(((E=(j=_.response)==null?void 0:j.data)==null?void 0:E.message)||"Error updating market state")}finally{l(!1)}},w=async j=>{var E,_;try{const{data:M}=await I.put(`/api/trade/market-state/segment/${j}/toggle`,{},{headers:{Authorization:`Bearer ${t.token}`}});s(M)}catch(M){alert(((_=(E=M.response)==null?void 0:E.data)==null?void 0:_.message)||"Error toggling segment")}},p=async j=>{var E,_;try{const{data:M}=await I.put(`/api/trade/market-state/segment/${j}`,u,{headers:{Authorization:`Bearer ${t.token}`}});s(M),m(null),h({})}catch(M){alert(((_=(E=M.response)==null?void 0:E.data)==null?void 0:_.message)||"Error updating segment")}},b=j=>{const E=e.segments[j];h({dataStartTime:E.dataStartTime||"09:00",tradingStartTime:E.tradingStartTime||"09:15",tradingEndTime:E.tradingEndTime||"15:30",dataEndTime:E.dataEndTime||"15:30",intradaySquareOffTime:E.intradaySquareOffTime||"15:15",preMarketDataOnly:E.preMarketDataOnly!==!1}),m(j)},v=async()=>{var j,E;try{const{data:_}=await I.get("/api/zerodha/login-url",{headers:{Authorization:`Bearer ${t.token}`}});window.location.href=_.loginUrl}catch(_){alert(((E=(j=_.response)==null?void 0:j.data)==null?void 0:E.message)||"Error getting Zerodha login URL")}},S=async()=>{var j,E;try{await I.post("/api/zerodha/logout",{},{headers:{Authorization:`Bearer ${t.token}`}}),x(),alert("Zerodha disconnected")}catch(_){alert(((E=(j=_.response)==null?void 0:j.data)==null?void 0:E.message)||"Error disconnecting Zerodha")}};if(r)return n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx(fe,{className:"animate-spin",size:32})});const N=["EQUITY","FNO","MCX","CRYPTO"],k={EQUITY:"blue",FNO:"purple",MCX:"yellow",CRYPTO:"green"};return n.jsxs("div",{className:"p-4 md:p-6",children:[n.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Market Control"}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6 mb-6",children:[n.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Zerodha Kite Connect"}),n.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Connect to Zerodha Kite API for live market data feed"}),n.jsx("div",{className:"grid md:grid-cols-1 gap-4",children:n.jsxs("div",{className:"bg-dark-700 rounded-lg p-4 border border-dark-600",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-500/20 rounded-lg flex items-center justify-center",children:n.jsx(gs,{className:"text-blue-400",size:20})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold",children:"Zerodha Kite"}),n.jsx("p",{className:"text-xs text-gray-400",children:"Kite Connect API"})]})]}),n.jsx("div",{className:`px-2 py-1 rounded text-xs ${o!=null&&o.connected?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:o!=null&&o.connected?"Connected":"Disconnected"})]}),o!=null&&o.connected?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-gray-400 mb-3",children:["User ID: ",o.userId]}),n.jsxs("div",{className:"flex gap-2 mb-2",children:[n.jsx("button",{onClick:async()=>{var j,E;if(confirm("This will DELETE all instruments and resync from Zerodha. Continue?"))try{const _=document.activeElement;_.disabled=!0,_.textContent="Resetting...";const{data:M}=await I.post("/api/zerodha/reset-and-sync",{},{headers:{Authorization:`Bearer ${t.token}`}}),V=Object.entries(M.counts||{}).map(([B,R])=>`${B}: ${R}`).join(`
`);alert(`${M.message}

Deleted: ${M.deleted}

${V}

Added: ${M.added}
Total in DB: ${M.totalInDatabase}
Subscribed: ${M.subscribedTokens}`),_.disabled=!1,_.textContent="Reset & Sync"}catch(_){alert(((E=(j=_.response)==null?void 0:j.data)==null?void 0:E.message)||"Error resetting");const M=document.activeElement;M&&(M.disabled=!1,M.textContent="Reset & Sync")}},className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded text-sm disabled:opacity-50",children:"Reset & Sync"}),n.jsx("button",{onClick:async()=>{var j,E;try{const _=document.activeElement;_.disabled=!0,_.textContent="Syncing...";const{data:M}=await I.post("/api/zerodha/sync-all-instruments",{},{headers:{Authorization:`Bearer ${t.token}`}});alert(`${M.message}

Added: ${M.added}
Updated: ${M.updated}
Total in DB: ${M.totalInDatabase}
Subscribed: ${M.subscribedTokens}`),_.disabled=!1,_.textContent="Sync Popular"}catch(_){alert(((E=(j=_.response)==null?void 0:j.data)==null?void 0:E.message)||"Error syncing instruments");const M=document.activeElement;M&&(M.disabled=!1,M.textContent="Sync Popular")}},className:"flex-1 bg-purple-600 hover:bg-purple-700 text-white py-2 rounded text-sm disabled:opacity-50",children:"Sync Popular"})]}),n.jsx("div",{className:"flex gap-2 mb-2",children:n.jsx("button",{onClick:async()=>{var j,E;try{const _=document.activeElement;_.disabled=!0,_.textContent="Subscribing...";const{data:M}=await I.post("/api/zerodha/subscribe-all",{},{headers:{Authorization:`Bearer ${t.token}`}});alert(`${M.message}

Subscribed: ${M.subscribed}
Total Active: ${M.total}
Requested: ${M.requested}`),_.disabled=!1,_.textContent="Subscribe All"}catch(_){alert(((E=(j=_.response)==null?void 0:j.data)==null?void 0:E.message)||"Error subscribing");const M=document.activeElement;M&&(M.disabled=!1,M.textContent="Subscribe All")}},className:"flex-1 bg-green-600 hover:bg-green-700 text-white py-2 rounded text-sm disabled:opacity-50",children:"Subscribe All"})}),n.jsxs("div",{className:"flex gap-2 mb-2",children:[n.jsx("button",{onClick:async()=>{var j,E;try{const{data:_}=await I.get("/api/zerodha/subscription-status",{headers:{Authorization:`Bearer ${t.token}`}});alert(`WebSocket: ${_.connected?"Connected":"Disconnected"}
Subscribed Tokens: ${_.subscribedTokens}
Total Enabled: ${_.totalEnabledInstruments}
All Subscribed: ${_.allSubscribed?"Yes":"No"}`)}catch(_){alert(((E=(j=_.response)==null?void 0:j.data)==null?void 0:E.message)||"Error fetching status")}},className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded text-sm",children:"Check Status"}),n.jsx("button",{onClick:async()=>{var j,E;try{const _=document.activeElement;_.disabled=!0,_.textContent="Fetching...";const{data:M}=await I.post("/api/zerodha/historical-bulk",{interval:"15minute"},{headers:{Authorization:`Bearer ${t.token}`}});alert(`${M.message}

Success: ${M.success}
Errors: ${M.errors}`),_.disabled=!1,_.textContent="Fetch Historical"}catch(_){alert(((E=(j=_.response)==null?void 0:j.data)==null?void 0:E.message)||"Error fetching historical data");const M=document.activeElement;M&&(M.disabled=!1,M.textContent="Fetch Historical")}},className:"flex-1 bg-yellow-600 hover:bg-yellow-700 text-white py-2 rounded text-sm disabled:opacity-50",children:"Fetch Historical"})]}),n.jsx("button",{onClick:S,className:"w-full bg-red-600 hover:bg-red-700 text-white py-2 rounded text-sm",children:"Disconnect"})]}):n.jsx("button",{onClick:v,className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded text-sm",children:"Connect to Kite"})]})}),n.jsxs("div",{className:"mt-4 p-3 bg-dark-700 rounded-lg border border-dark-600",children:[n.jsx("h4",{className:"text-sm font-medium mb-2",children:"Kite Connect Redirect URL"}),n.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Add this URL in your Kite Connect app settings:"}),n.jsxs("code",{className:"block bg-dark-900 p-2 rounded text-xs text-green-400 break-all",children:[window.location.origin.replace(":3000",":5001"),"/api/zerodha/callback"]})]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6 mb-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Global Market Status"}),n.jsx("p",{className:"text-gray-400 text-sm mt-1",children:e!=null&&e.isMarketOpen?"Market is OPEN - Trading is allowed":"Market is CLOSED - Trading is disabled"})]}),n.jsx("button",{onClick:f,disabled:a,className:`px-8 py-4 rounded-lg text-lg font-bold transition ${e!=null&&e.isMarketOpen?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:a?"Updating...":e!=null&&e.isMarketOpen?"CLOSE MARKET":"OPEN MARKET"})]}),n.jsxs("div",{className:"mt-6 flex items-center gap-4",children:[n.jsx("div",{className:`w-4 h-4 rounded-full ${e!=null&&e.isMarketOpen?"bg-green-500 animate-pulse":"bg-red-500"}`}),n.jsx("span",{className:`text-lg font-bold ${e!=null&&e.isMarketOpen?"text-green-400":"text-red-400"}`,children:e!=null&&e.isMarketOpen?"MARKET OPEN":"MARKET CLOSED"})]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6 mb-6",children:[n.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Segment Timings"}),n.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Configure market data and trading hours for each segment. Data can start before trading hours (pre-market data only mode)."}),n.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:N.map(j=>{var M;const E=((M=e==null?void 0:e.segments)==null?void 0:M[j])||{},_=k[j];return n.jsxs("div",{className:`bg-dark-700 rounded-lg p-4 border ${E.isOpen?`border-${_}-500/50`:"border-dark-600"}`,children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:`font-bold text-${_}-400`,children:j}),n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${E.isOpen?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:E.isOpen?"OPEN":"CLOSED"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>b(j),className:"px-2 py-1 bg-blue-600 hover:bg-blue-700 rounded text-xs",children:"Edit Timings"}),n.jsx("button",{onClick:()=>w(j),className:`px-2 py-1 rounded text-xs ${E.isOpen?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:E.isOpen?"Close":"Open"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[n.jsxs("div",{className:"bg-dark-800 rounded p-2",children:[n.jsx("div",{className:"text-gray-500",children:"Data Start"}),n.jsx("div",{className:"font-mono text-blue-400",children:E.dataStartTime||"09:00"})]}),n.jsxs("div",{className:"bg-dark-800 rounded p-2",children:[n.jsx("div",{className:"text-gray-500",children:"Trading Start"}),n.jsx("div",{className:"font-mono text-green-400",children:E.tradingStartTime||"09:15"})]}),n.jsxs("div",{className:"bg-dark-800 rounded p-2",children:[n.jsx("div",{className:"text-gray-500",children:"Trading End"}),n.jsx("div",{className:"font-mono text-red-400",children:E.tradingEndTime||"15:30"})]}),n.jsxs("div",{className:"bg-dark-800 rounded p-2",children:[n.jsx("div",{className:"text-gray-500",children:"Data End"}),n.jsx("div",{className:"font-mono text-purple-400",children:E.dataEndTime||"15:30"})]})]}),n.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Square-off: ",E.intradaySquareOffTime||"15:15"," | Pre-market data: ",E.preMarketDataOnly!==!1?"Yes":"No"]})]},j)})})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-blue-400",children:"Pre-Market Data Mode"}),n.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[n.jsx("li",{children:" Market data is visible to users"}),n.jsx("li",{children:" Trading is NOT allowed"}),n.jsx("li",{children:" Active between Data Start and Trading Start times"}),n.jsx("li",{children:" Users can analyze market before trading begins"})]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-green-400",children:"Trading Hours"}),n.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[n.jsx("li",{children:" Full trading allowed"}),n.jsx("li",{children:" Market data visible"}),n.jsx("li",{children:" Active between Trading Start and Trading End"}),n.jsx("li",{children:" Auto square-off at configured time"})]})]})]}),(e==null?void 0:e.lastUpdatedAt)&&n.jsxs("div",{className:"text-sm text-gray-500",children:["Last updated: ",new Date(e.lastUpdatedAt).toLocaleString()]}),d&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg w-full max-w-md p-6",children:[n.jsxs("div",{className:"flex justify-between mb-4",children:[n.jsxs("h2",{className:"text-xl font-bold",children:["Edit ",d," Timings"]}),n.jsx("button",{onClick:()=>m(null),children:n.jsx(ve,{size:24})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Data Start Time"}),n.jsx("input",{type:"time",value:u.dataStartTime,onChange:j=>h({...u,dataStartTime:j.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"When market data becomes visible"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Trading Start Time"}),n.jsx("input",{type:"time",value:u.tradingStartTime,onChange:j=>h({...u,tradingStartTime:j.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"When trading is allowed"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Trading End Time"}),n.jsx("input",{type:"time",value:u.tradingEndTime,onChange:j=>h({...u,tradingEndTime:j.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"When trading stops"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Data End Time"}),n.jsx("input",{type:"time",value:u.dataEndTime,onChange:j=>h({...u,dataEndTime:j.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"When market data stops"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Intraday Square-off Time"}),n.jsx("input",{type:"time",value:u.intradaySquareOffTime,onChange:j=>h({...u,intradaySquareOffTime:j.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Auto square-off intraday positions"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",id:"preMarketDataOnly",checked:u.preMarketDataOnly,onChange:j=>h({...u,preMarketDataOnly:j.target.checked}),className:"w-4 h-4"}),n.jsx("label",{htmlFor:"preMarketDataOnly",className:"text-sm text-gray-400",children:"Enable pre-market data only mode (show data but no trading before trading start)"})]}),n.jsxs("div",{className:"flex gap-3 mt-6",children:[n.jsx("button",{onClick:()=>m(null),className:"flex-1 bg-dark-600 py-2 rounded",children:"Cancel"}),n.jsx("button",{onClick:()=>p(d),className:"flex-1 bg-green-600 hover:bg-green-700 py-2 rounded",children:"Save Timings"})]})]})]})})]})},nk=()=>{const{admin:t}=we(),[e,s]=g.useState([]),[r,i]=g.useState(!0),[a,l]=g.useState(""),[o,c]=g.useState(!1);g.useEffect(()=>{d()},[a]);const d=async()=>{try{const u=a?`/api/trade/admin/trades?status=${a}`:"/api/trade/admin/trades",{data:h}=await I.get(u,{headers:{Authorization:`Bearer ${t.token}`}});s(h)}catch(u){console.error("Error:",u)}finally{i(!1)}},m=async(u,h)=>{var y,f;const x=prompt("Enter exit price:",h);if(x)try{await I.post(`/api/trade/admin/trade/${u}/close`,{exitPrice:Number(x)},{headers:{Authorization:`Bearer ${t.token}`}}),d()}catch(w){alert(((f=(y=w.response)==null?void 0:y.data)==null?void 0:f.message)||"Error closing trade")}};return n.jsxs("div",{className:"p-4 md:p-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6",children:[n.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:"Trade Management"}),n.jsxs("button",{onClick:()=>c(!0),className:"flex items-center justify-center gap-2 bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg transition",children:[n.jsx(Ls,{size:20}),n.jsx("span",{children:"Create Trade"})]})]}),n.jsxs("div",{className:"flex gap-2 mb-6 flex-wrap",children:[n.jsx("button",{onClick:()=>l(""),className:`px-4 py-2 rounded ${a?"bg-dark-700":"bg-purple-600"}`,children:"All"}),n.jsx("button",{onClick:()=>l("OPEN"),className:`px-4 py-2 rounded ${a==="OPEN"?"bg-green-600":"bg-dark-700"}`,children:"Open"}),n.jsx("button",{onClick:()=>l("CLOSED"),className:`px-4 py-2 rounded ${a==="CLOSED"?"bg-red-600":"bg-dark-700"}`,children:"Closed"})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total Trades"}),n.jsx("div",{className:"text-2xl font-bold",children:e.length})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Open"}),n.jsx("div",{className:"text-2xl font-bold text-green-400",children:e.filter(u=>u.status==="OPEN").length})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total P&L"}),n.jsxs("div",{className:`text-2xl font-bold ${e.reduce((u,h)=>u+(h.netPnL||h.unrealizedPnL||0),0)>=0?"text-green-400":"text-red-400"}`,children:["",e.reduce((u,h)=>u+(h.netPnL||h.unrealizedPnL||0),0).toLocaleString()]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total Brokerage"}),n.jsxs("div",{className:"text-2xl font-bold text-purple-400",children:["",e.reduce((u,h)=>{var x;return u+(((x=h.charges)==null?void 0:x.brokerage)||0)},0).toLocaleString()]})]})]}),r?n.jsx("div",{className:"text-center py-8",children:n.jsx(fe,{className:"animate-spin inline"})}):e.length===0?n.jsx("div",{className:"text-center py-8 text-gray-400",children:"No trades found"}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"md:hidden space-y-4",children:e.map(u=>{var y,f;const h=u.isCrypto||u.segment==="CRYPTO"||u.exchange==="BINANCE",x=h?"$":"";return n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsxs("div",{className:"flex justify-between items-start mb-2",children:[n.jsxs("div",{children:[n.jsx("div",{className:`font-bold ${h?"text-orange-400":""}`,children:u.symbol}),n.jsxs("div",{className:"text-xs text-gray-400",children:[u.segment,"  ",u.productType]})]}),n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${u.status==="OPEN"?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:u.status})]}),n.jsxs("div",{className:"text-sm text-gray-400 mb-2",children:["User: ",((y=u.user)==null?void 0:y.fullName)||((f=u.user)==null?void 0:f.username)]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{children:[n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${u.side==="BUY"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:u.side}),n.jsxs("span",{className:"ml-2 text-sm",children:["Qty: ",u.quantity]})]}),n.jsxs("div",{className:`font-bold ${(u.netPnL||u.unrealizedPnL||0)>=0?"text-green-400":"text-red-400"}`,children:[(u.netPnL||u.unrealizedPnL||0)>=0?"+":"",x,(u.netPnL||u.unrealizedPnL||0).toFixed(2)]})]}),u.status==="OPEN"&&n.jsx("button",{onClick:()=>m(u._id,u.currentPrice||u.entryPrice),className:"w-full mt-3 px-3 py-2 bg-red-600 hover:bg-red-700 rounded text-sm",children:"Force Close"})]},u._id)})}),n.jsx("div",{className:"hidden md:block bg-dark-800 rounded-lg overflow-hidden overflow-x-auto",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-dark-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Trade ID"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"User"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Symbol"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Side"}),n.jsx("th",{className:"text-right px-4 py-3 text-gray-400",children:"Qty"}),n.jsx("th",{className:"text-right px-4 py-3 text-gray-400",children:"Entry"}),n.jsx("th",{className:"text-right px-4 py-3 text-gray-400",children:"Exit/LTP"}),n.jsx("th",{className:"text-right px-4 py-3 text-gray-400",children:"P&L"}),n.jsx("th",{className:"text-center px-4 py-3 text-gray-400",children:"Status"}),n.jsx("th",{className:"text-center px-4 py-3 text-gray-400",children:"Action"})]})}),n.jsx("tbody",{children:e.map(u=>{var y,f,w,p;const h=u.isCrypto||u.segment==="CRYPTO"||u.exchange==="BINANCE",x=h?"$":"";return n.jsxs("tr",{className:"border-t border-dark-600",children:[n.jsx("td",{className:"px-4 py-3 font-mono text-xs",children:u.tradeId}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("div",{children:((y=u.user)==null?void 0:y.fullName)||((f=u.user)==null?void 0:f.username)})}),n.jsxs("td",{className:"px-4 py-3",children:[n.jsx("div",{className:`font-medium ${h?"text-orange-400":""}`,children:u.symbol}),n.jsxs("div",{className:"text-xs text-gray-500",children:[u.segment,"  ",u.productType]})]}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${u.side==="BUY"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:u.side})}),n.jsx("td",{className:"px-4 py-3 text-right",children:u.quantity}),n.jsxs("td",{className:"px-4 py-3 text-right",children:[x,(w=u.entryPrice)==null?void 0:w.toFixed(2)]}),n.jsxs("td",{className:"px-4 py-3 text-right",children:[x,(p=u.exitPrice||u.currentPrice||u.entryPrice)==null?void 0:p.toFixed(2)]}),n.jsxs("td",{className:`px-4 py-3 text-right font-bold ${(u.netPnL||u.unrealizedPnL||0)>=0?"text-green-400":"text-red-400"}`,children:[(u.netPnL||u.unrealizedPnL||0)>=0?"+":"",x,(u.netPnL||u.unrealizedPnL||0).toFixed(2)]}),n.jsx("td",{className:"px-4 py-3 text-center",children:n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${u.status==="OPEN"?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:u.status})}),n.jsx("td",{className:"px-4 py-3 text-center",children:u.status==="OPEN"&&n.jsx("button",{onClick:()=>m(u._id,u.currentPrice||u.entryPrice),className:"px-2 py-1 bg-red-600 hover:bg-red-700 rounded text-xs",children:"Close"})})]},u._id)})})]})})]}),o&&n.jsx(ak,{token:t.token,onClose:()=>c(!1),onSuccess:()=>{c(!1),d()}})]})},rk=()=>{const{admin:t}=we(),[e,s]=g.useState([]),[r,i]=g.useState([]),[a,l]=g.useState(!0),[o,c]=g.useState(""),[d,m]=g.useState(""),[u,h]=g.useState(""),x=e.filter(p=>{var v,S,N,k,j;if(!u)return!0;const b=u.toLowerCase();return((v=p.symbol)==null?void 0:v.toLowerCase().includes(b))||((S=p.userId)==null?void 0:S.toLowerCase().includes(b))||((N=p.tradeId)==null?void 0:N.toLowerCase().includes(b))||((k=p.adminCode)==null?void 0:k.toLowerCase().includes(b))||((j=p.segment)==null?void 0:j.toLowerCase().includes(b))});g.useEffect(()=>{y()},[]),g.useEffect(()=>{f()},[o,d]);const y=async()=>{try{const{data:p}=await I.get("/api/admin/manage/admins",{headers:{Authorization:`Bearer ${t.token}`}});i(p)}catch(p){console.error("Error fetching admins:",p)}},f=async()=>{try{l(!0);let p="/api/trade/admin/all-trades";const b=new URLSearchParams;o&&b.append("status",o),d&&b.append("adminCode",d),b.toString()&&(p+=`?${b.toString()}`);const{data:v}=await I.get(p,{headers:{Authorization:`Bearer ${t.token}`}});s(v)}catch(p){console.error("Error:",p)}finally{l(!1)}},w=async(p,b)=>{var S,N;const v=prompt("Enter exit price:",b);if(v)try{await I.post(`/api/trade/admin/trade/${p}/close`,{exitPrice:Number(v)},{headers:{Authorization:`Bearer ${t.token}`}}),f()}catch(k){alert(((N=(S=k.response)==null?void 0:S.data)==null?void 0:N.message)||"Error closing trade")}};return n.jsxs("div",{className:"p-4 md:p-6",children:[n.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6",children:n.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:"All Trade Management"})}),n.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[n.jsxs("div",{className:"flex-1 min-w-[200px]",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Filter by Admin"}),n.jsxs("select",{value:d,onChange:p=>m(p.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2",children:[n.jsx("option",{value:"",children:"All Admins"}),r.map(p=>n.jsxs("option",{value:p.adminCode,children:[p.name||p.username," (",p.adminCode,")"]},p._id))]})]}),n.jsxs("div",{className:"flex-1 min-w-[200px]",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Search"}),n.jsxs("div",{className:"relative",children:[n.jsx(Jn,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),n.jsx("input",{type:"text",placeholder:"Search by symbol, user ID, trade ID...",value:u||"",onChange:p=>h(p.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg pl-10 pr-4 py-2"})]})]}),n.jsxs("div",{className:"flex gap-2 items-end",children:[n.jsx("button",{onClick:()=>c(""),className:`px-4 py-2 rounded ${o?"bg-dark-700":"bg-purple-600"}`,children:"All"}),n.jsx("button",{onClick:()=>c("OPEN"),className:`px-4 py-2 rounded ${o==="OPEN"?"bg-green-600":"bg-dark-700"}`,children:"Open"}),n.jsx("button",{onClick:()=>c("CLOSED"),className:`px-4 py-2 rounded ${o==="CLOSED"?"bg-red-600":"bg-dark-700"}`,children:"Closed"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total Trades"}),n.jsx("div",{className:"text-2xl font-bold",children:x.length})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Open"}),n.jsx("div",{className:"text-2xl font-bold text-green-400",children:x.filter(p=>p.status==="OPEN").length})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Closed"}),n.jsx("div",{className:"text-2xl font-bold text-gray-400",children:x.filter(p=>p.status==="CLOSED").length})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total P&L"}),n.jsxs("div",{className:`text-2xl font-bold ${x.reduce((p,b)=>p+(b.netPnL||b.unrealizedPnL||0),0)>=0?"text-green-400":"text-red-400"}`,children:["",x.reduce((p,b)=>p+(b.netPnL||b.unrealizedPnL||0),0).toLocaleString()]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total Brokerage"}),n.jsxs("div",{className:"text-2xl font-bold text-purple-400",children:["",x.reduce((p,b)=>{var v;return p+(((v=b.charges)==null?void 0:v.brokerage)||0)},0).toLocaleString()]})]})]}),a?n.jsx("div",{className:"text-center py-8",children:n.jsx(fe,{className:"animate-spin inline"})}):x.length===0?n.jsx("div",{className:"text-center py-8 text-gray-400",children:"No trades found"}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"md:hidden space-y-4",children:x.map(p=>{var S,N;const b=p.isCrypto||p.segment==="CRYPTO"||p.exchange==="BINANCE",v=b?"$":"";return n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsxs("div",{className:"flex justify-between items-start mb-2",children:[n.jsxs("div",{children:[n.jsx("div",{className:`font-bold ${b?"text-orange-400":""}`,children:p.symbol}),n.jsxs("div",{className:"text-xs text-gray-400",children:[p.segment,"  ",p.productType]})]}),n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${p.status==="OPEN"?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:p.status})]}),n.jsxs("div",{className:"text-sm text-gray-400 mb-1",children:["User: ",((S=p.user)==null?void 0:S.fullName)||((N=p.user)==null?void 0:N.username)]}),n.jsxs("div",{className:"text-xs text-purple-400 mb-2",children:["Admin: ",p.adminCode]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{children:[n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${p.side==="BUY"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:p.side}),n.jsxs("span",{className:"ml-2 text-sm",children:["Qty: ",p.quantity]})]}),n.jsxs("div",{className:`font-bold ${(p.netPnL||p.unrealizedPnL||0)>=0?"text-green-400":"text-red-400"}`,children:[(p.netPnL||p.unrealizedPnL||0)>=0?"+":"",v,(p.netPnL||p.unrealizedPnL||0).toFixed(2)]})]}),p.status==="OPEN"&&n.jsx("button",{onClick:()=>w(p._id,p.currentPrice||p.entryPrice),className:"w-full mt-3 px-3 py-2 bg-red-600 hover:bg-red-700 rounded text-sm",children:"Force Close"})]},p._id)})}),n.jsx("div",{className:"hidden md:block bg-dark-800 rounded-lg overflow-hidden overflow-x-auto",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-dark-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Trade ID"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Admin"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"User"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Symbol"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Side"}),n.jsx("th",{className:"text-right px-4 py-3 text-gray-400",children:"Qty"}),n.jsx("th",{className:"text-right px-4 py-3 text-gray-400",children:"Entry"}),n.jsx("th",{className:"text-right px-4 py-3 text-gray-400",children:"Exit/LTP"}),n.jsx("th",{className:"text-right px-4 py-3 text-gray-400",children:"P&L"}),n.jsx("th",{className:"text-center px-4 py-3 text-gray-400",children:"Status"}),n.jsx("th",{className:"text-center px-4 py-3 text-gray-400",children:"Action"})]})}),n.jsx("tbody",{children:x.map(p=>{var S,N,k,j,E;const b=p.isCrypto||p.segment==="CRYPTO"||p.exchange==="BINANCE",v=b?"$":"";return n.jsxs("tr",{className:"border-t border-dark-600",children:[n.jsx("td",{className:"px-4 py-3 font-mono text-xs",children:p.tradeId}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("span",{className:"text-purple-400 font-mono text-xs",children:p.adminCode})}),n.jsxs("td",{className:"px-4 py-3",children:[n.jsx("div",{children:((S=p.user)==null?void 0:S.fullName)||((N=p.user)==null?void 0:N.username)}),n.jsx("div",{className:"text-xs text-gray-500",children:(k=p.user)==null?void 0:k.email})]}),n.jsxs("td",{className:"px-4 py-3",children:[n.jsx("div",{className:`font-medium ${b?"text-orange-400":""}`,children:p.symbol}),n.jsxs("div",{className:"text-xs text-gray-500",children:[p.segment,"  ",p.productType]})]}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${p.side==="BUY"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:p.side})}),n.jsx("td",{className:"px-4 py-3 text-right",children:p.quantity}),n.jsxs("td",{className:"px-4 py-3 text-right",children:[v,(j=p.entryPrice)==null?void 0:j.toFixed(2)]}),n.jsxs("td",{className:"px-4 py-3 text-right",children:[v,(E=p.exitPrice||p.currentPrice||p.entryPrice)==null?void 0:E.toFixed(2)]}),n.jsxs("td",{className:`px-4 py-3 text-right font-bold ${(p.netPnL||p.unrealizedPnL||0)>=0?"text-green-400":"text-red-400"}`,children:[(p.netPnL||p.unrealizedPnL||0)>=0?"+":"",v,(p.netPnL||p.unrealizedPnL||0).toFixed(2)]}),n.jsx("td",{className:"px-4 py-3 text-center",children:n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${p.status==="OPEN"?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:p.status})}),n.jsx("td",{className:"px-4 py-3 text-center",children:p.status==="OPEN"&&n.jsx("button",{onClick:()=>w(p._id,p.currentPrice||p.entryPrice),className:"px-2 py-1 bg-red-600 hover:bg-red-700 rounded text-xs",children:"Close"})})]},p._id)})})]})})]})]})},ik=()=>{const{admin:t}=we(),[e,s]=g.useState([]),[r,i]=g.useState([]),[a,l]=g.useState(!0),[o,c]=g.useState("PENDING"),[d,m]=g.useState(""),[u,h]=g.useState(null);g.useEffect(()=>{x()},[]),g.useEffect(()=>{y()},[o,d]);const x=async()=>{try{const{data:v}=await I.get("/api/admin/manage/admins",{headers:{Authorization:`Bearer ${t.token}`}});i(v)}catch(v){console.error("Error fetching admins:",v)}},y=async()=>{try{l(!0);let v="/api/admin/manage/all-fund-requests";const S=new URLSearchParams;o?S.append("status",o):S.append("status","ALL"),S.toString()&&(v+=`?${S.toString()}`);const{data:N}=await I.get(v,{headers:{Authorization:`Bearer ${t.token}`}}),k=Array.isArray(N)?N:N.requests||[],j=d?k.filter(E=>E.adminCode===d):k;s(j)}catch(v){console.error("Error fetching fund requests:",v),s([])}finally{l(!1)}},f=async v=>{var S,N;if(confirm("Approve this fund request? This will deduct from the admin wallet.")){h(v);try{await I.post(`/api/admin/manage/all-fund-requests/${v}/approve`,{},{headers:{Authorization:`Bearer ${t.token}`}}),y()}catch(k){alert(((N=(S=k.response)==null?void 0:S.data)==null?void 0:N.message)||"Error approving request")}finally{h(null)}}},w=async v=>{var N,k;const S=prompt("Enter rejection reason (optional):");if(S!==null){h(v);try{await I.post(`/api/admin/manage/all-fund-requests/${v}/reject`,{remarks:S},{headers:{Authorization:`Bearer ${t.token}`}}),y()}catch(j){alert(((k=(N=j.response)==null?void 0:N.data)==null?void 0:k.message)||"Error rejecting request")}finally{h(null)}}},p=v=>{const S={PENDING:"bg-yellow-500/20 text-yellow-400",APPROVED:"bg-green-500/20 text-green-400",REJECTED:"bg-red-500/20 text-red-400",CANCELLED:"bg-gray-500/20 text-gray-400"};return n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${S[v]||S.PENDING}`,children:v})},b=v=>v==="DEPOSIT"?n.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-500/20 text-green-400",children:"DEPOSIT"}):n.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-red-500/20 text-red-400",children:"WITHDRAWAL"});return n.jsxs("div",{className:"p-4 md:p-6",children:[n.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6",children:n.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:"All User Fund Requests"})}),n.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[n.jsxs("div",{className:"flex-1 min-w-[200px]",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Filter by Admin"}),n.jsxs("select",{value:d,onChange:v=>m(v.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2",children:[n.jsx("option",{value:"",children:"All Admins"}),r.map(v=>n.jsxs("option",{value:v.adminCode,children:[v.name||v.username," (",v.adminCode,")"]},v._id))]})]}),n.jsxs("div",{className:"flex gap-2 items-end",children:[n.jsx("button",{onClick:()=>c(""),className:`px-4 py-2 rounded ${o?"bg-dark-700":"bg-purple-600"}`,children:"All"}),n.jsx("button",{onClick:()=>c("PENDING"),className:`px-4 py-2 rounded ${o==="PENDING"?"bg-yellow-600":"bg-dark-700"}`,children:"Pending"}),n.jsx("button",{onClick:()=>c("APPROVED"),className:`px-4 py-2 rounded ${o==="APPROVED"?"bg-green-600":"bg-dark-700"}`,children:"Approved"}),n.jsx("button",{onClick:()=>c("REJECTED"),className:`px-4 py-2 rounded ${o==="REJECTED"?"bg-red-600":"bg-dark-700"}`,children:"Rejected"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total Requests"}),n.jsx("div",{className:"text-2xl font-bold",children:e.length})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Pending"}),n.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:e.filter(v=>v.status==="PENDING").length})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total Deposit Requests"}),n.jsxs("div",{className:"text-2xl font-bold text-green-400",children:["",e.filter(v=>v.type==="DEPOSIT").reduce((v,S)=>v+S.amount,0).toLocaleString()]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total Withdrawal Requests"}),n.jsxs("div",{className:"text-2xl font-bold text-red-400",children:["",e.filter(v=>v.type==="WITHDRAWAL").reduce((v,S)=>v+S.amount,0).toLocaleString()]})]})]}),a?n.jsx("div",{className:"text-center py-8",children:n.jsx(fe,{className:"animate-spin inline"})}):e.length===0?n.jsx("div",{className:"text-center py-8 text-gray-400",children:"No fund requests found"}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"md:hidden space-y-4",children:e.map(v=>{var S,N,k;return n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsxs("div",{className:"flex justify-between items-start mb-2",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-bold",children:((S=v.user)==null?void 0:S.fullName)||((N=v.user)==null?void 0:N.username)}),n.jsx("div",{className:"text-xs text-gray-400",children:(k=v.user)==null?void 0:k.email})]}),p(v.status)]}),n.jsxs("div",{className:"text-xs text-purple-400 mb-2",children:["Admin: ",v.adminCode]}),n.jsxs("div",{className:"flex justify-between items-center mb-2",children:[b(v.type),n.jsxs("div",{className:"text-xl font-bold",children:["",v.amount.toLocaleString()]})]}),n.jsx("div",{className:"text-xs text-gray-500 mb-2",children:new Date(v.createdAt).toLocaleString()}),v.referenceId&&n.jsxs("div",{className:"text-xs text-gray-400 mb-2",children:["Ref: ",v.referenceId]}),v.status==="PENDING"&&n.jsxs("div",{className:"flex gap-2 mt-3",children:[n.jsx("button",{onClick:()=>f(v._id),disabled:u===v._id,className:"flex-1 px-3 py-2 bg-green-600 hover:bg-green-700 rounded text-sm disabled:opacity-50",children:u===v._id?"Processing...":"Approve"}),n.jsx("button",{onClick:()=>w(v._id),disabled:u===v._id,className:"flex-1 px-3 py-2 bg-red-600 hover:bg-red-700 rounded text-sm disabled:opacity-50",children:"Reject"})]})]},v._id)})}),n.jsx("div",{className:"hidden md:block bg-dark-800 rounded-lg overflow-hidden overflow-x-auto",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-dark-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Request ID"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Admin"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"User"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Type"}),n.jsx("th",{className:"text-right px-4 py-3 text-gray-400",children:"Amount"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Reference"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400",children:"Date"}),n.jsx("th",{className:"text-center px-4 py-3 text-gray-400",children:"Status"}),n.jsx("th",{className:"text-center px-4 py-3 text-gray-400",children:"Action"})]})}),n.jsx("tbody",{children:e.map(v=>{var S,N,k;return n.jsxs("tr",{className:"border-t border-dark-600",children:[n.jsx("td",{className:"px-4 py-3 font-mono text-xs",children:v.requestId}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("span",{className:"text-purple-400 font-mono text-xs",children:v.adminCode})}),n.jsxs("td",{className:"px-4 py-3",children:[n.jsx("div",{children:((S=v.user)==null?void 0:S.fullName)||((N=v.user)==null?void 0:N.username)}),n.jsx("div",{className:"text-xs text-gray-500",children:(k=v.user)==null?void 0:k.email})]}),n.jsx("td",{className:"px-4 py-3",children:b(v.type)}),n.jsxs("td",{className:"px-4 py-3 text-right font-bold",children:["",v.amount.toLocaleString()]}),n.jsx("td",{className:"px-4 py-3 text-xs",children:v.referenceId||"-"}),n.jsx("td",{className:"px-4 py-3 text-xs",children:new Date(v.createdAt).toLocaleString()}),n.jsx("td",{className:"px-4 py-3 text-center",children:p(v.status)}),n.jsx("td",{className:"px-4 py-3 text-center",children:v.status==="PENDING"?n.jsxs("div",{className:"flex gap-1 justify-center",children:[n.jsx("button",{onClick:()=>f(v._id),disabled:u===v._id,className:"px-2 py-1 bg-green-600 hover:bg-green-700 rounded text-xs disabled:opacity-50",children:""}),n.jsx("button",{onClick:()=>w(v._id),disabled:u===v._id,className:"px-2 py-1 bg-red-600 hover:bg-red-700 rounded text-xs disabled:opacity-50",children:""})]}):n.jsx("span",{className:"text-xs text-gray-500",children:"-"})})]},v._id)})})]})})]})]})},ak=({token:t,onClose:e,onSuccess:s})=>{const[r,i]=g.useState([]),[a,l]=g.useState([]),[o,c]=g.useState(!1),[d,m]=g.useState(""),[u,h]=g.useState(""),[x,y]=g.useState(""),[f,w]=g.useState({userId:"",userName:"",symbol:"",instrumentToken:"",segment:"NSE",side:"BUY",productType:"INTRADAY",quantity:1,entryPrice:"",tradeDate:new Date().toISOString().split("T")[0],tradeTime:new Date().toTimeString().slice(0,5)});g.useEffect(()=>{p(),b()},[]);const p=async()=>{try{const{data:k}=await I.get("/api/admin/manage/users",{headers:{Authorization:`Bearer ${t}`}});i(k)}catch(k){console.error("Error fetching users:",k)}},b=async()=>{try{const{data:k}=await I.get("/api/instruments/admin",{headers:{Authorization:`Bearer ${t}`}}),j=(k||[]).map(E=>({...E,tradingsymbol:E.tradingSymbol||E.symbol,instrument_token:E.token}));l(j)}catch(k){console.error("Error fetching instruments:",k)}},v=r.filter(k=>{var j,E,_;return((j=k.fullName)==null?void 0:j.toLowerCase().includes(u.toLowerCase()))||((E=k.username)==null?void 0:E.toLowerCase().includes(u.toLowerCase()))||((_=k.userId)==null?void 0:_.toLowerCase().includes(u.toLowerCase()))}).slice(0,10),S=a.filter(k=>{var j,E;return((j=k.tradingsymbol)==null?void 0:j.toLowerCase().includes(x.toLowerCase()))||((E=k.name)==null?void 0:E.toLowerCase().includes(x.toLowerCase()))}).slice(0,10),N=async k=>{var j,E;if(k.preventDefault(),!f.userId)return m("Please select a user");if(!f.symbol)return m("Please select an instrument");if(!f.entryPrice||Number(f.entryPrice)<=0)return m("Please enter valid entry price");if(!f.quantity||Number(f.quantity)<=0)return m("Please enter valid quantity");c(!0),m("");try{await I.post("/api/trade/admin/create-trade",{userId:f.userId,symbol:f.symbol,instrumentToken:f.instrumentToken,segment:f.segment,side:f.side,productType:f.productType,quantity:Number(f.quantity),entryPrice:Number(f.entryPrice),tradeDate:f.tradeDate,tradeTime:f.tradeTime},{headers:{Authorization:`Bearer ${t}`}}),s()}catch(_){m(((E=(j=_.response)==null?void 0:j.data)==null?void 0:E.message)||"Error creating trade")}finally{c(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"sticky top-0 bg-dark-800 p-4 border-b border-dark-600 flex justify-between items-center",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Create Trade"}),n.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white",children:n.jsx(ve,{size:24})})]}),n.jsxs("form",{onSubmit:N,className:"p-4 space-y-4",children:[d&&n.jsx("div",{className:"bg-red-500/20 border border-red-500 text-red-400 px-4 py-2 rounded",children:d}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Select User *"}),n.jsx("input",{type:"text",placeholder:"Search by name or ID...",value:u,onChange:k=>h(k.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 mb-2"}),u&&v.length>0&&!f.userId&&n.jsx("div",{className:"bg-dark-700 border border-dark-600 rounded max-h-40 overflow-y-auto",children:v.map(k=>n.jsxs("div",{onClick:()=>{w({...f,userId:k._id,userName:k.fullName||k.username}),h(k.fullName||k.username)},className:"px-3 py-2 hover:bg-dark-600 cursor-pointer",children:[n.jsx("div",{className:"font-medium",children:k.fullName||k.username}),n.jsxs("div",{className:"text-xs text-gray-400",children:["@",k.username,"  ",k.userId]})]},k._id))}),f.userId&&n.jsxs("div",{className:"flex items-center justify-between bg-green-500/10 border border-green-500/30 rounded px-3 py-2",children:[n.jsx("span",{className:"text-green-400",children:f.userName}),n.jsx("button",{type:"button",onClick:()=>{w({...f,userId:"",userName:""}),h("")},className:"text-gray-400 hover:text-white",children:n.jsx(ve,{size:16})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Select Instrument *"}),n.jsx("input",{type:"text",placeholder:"Search instruments...",value:x,onChange:k=>y(k.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 mb-2"}),x&&S.length>0&&!f.symbol&&n.jsx("div",{className:"bg-dark-700 border border-dark-600 rounded max-h-40 overflow-y-auto",children:S.map(k=>n.jsxs("div",{onClick:()=>{w({...f,symbol:k.tradingsymbol,instrumentToken:k.instrument_token,segment:k.segment||k.exchange||"NSE"}),y(k.tradingsymbol)},className:"px-3 py-2 hover:bg-dark-600 cursor-pointer",children:[n.jsx("div",{className:"font-medium",children:k.tradingsymbol}),n.jsxs("div",{className:"text-xs text-gray-400",children:[k.name,"  ",k.segment||k.exchange]})]},k._id||k.instrument_token))}),f.symbol&&n.jsxs("div",{className:"flex items-center justify-between bg-blue-500/10 border border-blue-500/30 rounded px-3 py-2",children:[n.jsxs("span",{className:"text-blue-400",children:[f.symbol," (",f.segment,")"]}),n.jsx("button",{type:"button",onClick:()=>{w({...f,symbol:"",instrumentToken:""}),y("")},className:"text-gray-400 hover:text-white",children:n.jsx(ve,{size:16})})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Side *"}),n.jsxs("select",{value:f.side,onChange:k=>w({...f,side:k.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",children:[n.jsx("option",{value:"BUY",children:"BUY"}),n.jsx("option",{value:"SELL",children:"SELL"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Product Type *"}),n.jsxs("select",{value:f.productType,onChange:k=>w({...f,productType:k.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",children:[n.jsx("option",{value:"INTRADAY",children:"INTRADAY"}),n.jsx("option",{value:"DELIVERY",children:"DELIVERY"}),n.jsx("option",{value:"CARRYFORWARD",children:"CARRYFORWARD"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Quantity *"}),n.jsx("input",{type:"number",value:f.quantity,onChange:k=>w({...f,quantity:k.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",min:"1",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Entry Price *"}),n.jsx("input",{type:"number",step:"0.01",value:f.entryPrice,onChange:k=>w({...f,entryPrice:k.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",placeholder:"0.00",required:!0})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Trade Date"}),n.jsx("input",{type:"date",value:f.tradeDate,onChange:k=>w({...f,tradeDate:k.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Trade Time"}),n.jsx("input",{type:"time",value:f.tradeTime,onChange:k=>w({...f,tradeTime:k.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"})]})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:e,className:"flex-1 bg-dark-600 hover:bg-dark-500 py-2 rounded",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:o,className:"flex-1 bg-green-600 hover:bg-green-700 py-2 rounded disabled:opacity-50",children:o?"Creating...":"Create Trade"})]})]})]})})},lk=()=>{const{admin:t}=we(),[e,s]=g.useState([]),[r,i]=g.useState(null),[a,l]=g.useState({niftyMaxLotIntraday:100,niftyMaxLotCarryForward:50,niftyLotSize:25,bankniftyMaxLotIntraday:100,bankniftyMaxLotCarryForward:50,bankniftyLotSize:15,finniftyMaxLotIntraday:100,finniftyMaxLotCarryForward:50,finniftyLotSize:25,midcpniftyMaxLotIntraday:100,midcpniftyMaxLotCarryForward:50,midcpniftyLotSize:50,equityMaxQtyIntraday:1e4,equityMaxQtyDelivery:5e3,maxOpenPositions:20,maxDailyTrades:100}),[o,c]=g.useState(!0),[d,m]=g.useState(!1),[u,h]=g.useState({type:"",text:""});g.useEffect(()=>{x()},[]),g.useEffect(()=>{r&&y(r)},[r]);const x=async()=>{try{const{data:b}=await I.get("/api/admin/manage/admins",{headers:{Authorization:`Bearer ${t.token}`}});s(b),b.length>0&&i(b[0]._id)}catch(b){console.error("Error fetching admins:",b)}finally{c(!1)}},y=async b=>{try{const{data:v}=await I.get(`/api/admin/manage/admins/${b}`,{headers:{Authorization:`Bearer ${t.token}`}});v.lotSettings&&l(v.lotSettings)}catch(v){console.error("Error fetching lot settings:",v)}},f=async()=>{var b,v;m(!0),h({type:"",text:""});try{await I.put(`/api/admin/manage/admins/${r}/lot-settings`,{lotSettings:a,enabledLeverages:a.enabledLeverages,allowTradingOutsideMarketHours:a.allowTradingOutsideMarketHours,marginCallPercentage:a.marginCallPercentage},{headers:{Authorization:`Bearer ${t.token}`}}),h({type:"success",text:"All settings saved successfully!"})}catch(S){h({type:"error",text:((v=(b=S.response)==null?void 0:b.data)==null?void 0:v.message)||"Error saving settings"})}finally{m(!1)}},w=(b,v)=>{l(S=>({...S,[b]:parseInt(v)||0}))},p=[{name:"NIFTY",color:"blue",fields:[{key:"niftyLotSize",label:"Lot Size",desc:"Qty per lot"},{key:"niftyMaxLotIntraday",label:"Max Lot (Intraday)",desc:"MIS orders"},{key:"niftyMaxLotCarryForward",label:"Max Lot (Carry Forward)",desc:"NRML orders"}]},{name:"BANKNIFTY",color:"purple",fields:[{key:"bankniftyLotSize",label:"Lot Size",desc:"Qty per lot"},{key:"bankniftyMaxLotIntraday",label:"Max Lot (Intraday)",desc:"MIS orders"},{key:"bankniftyMaxLotCarryForward",label:"Max Lot (Carry Forward)",desc:"NRML orders"}]},{name:"FINNIFTY",color:"green",fields:[{key:"finniftyLotSize",label:"Lot Size",desc:"Qty per lot"},{key:"finniftyMaxLotIntraday",label:"Max Lot (Intraday)",desc:"MIS orders"},{key:"finniftyMaxLotCarryForward",label:"Max Lot (Carry Forward)",desc:"NRML orders"}]},{name:"MIDCPNIFTY",color:"yellow",fields:[{key:"midcpniftyLotSize",label:"Lot Size",desc:"Qty per lot"},{key:"midcpniftyMaxLotIntraday",label:"Max Lot (Intraday)",desc:"MIS orders"},{key:"midcpniftyMaxLotCarryForward",label:"Max Lot (Carry Forward)",desc:"NRML orders"}]}];return o?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx(fe,{className:"animate-spin",size:32})}):n.jsxs("div",{className:"p-4 md:p-6",children:[n.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Lot Management"}),n.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Configure max lot limits for each admin's users"})]}),n.jsx("button",{onClick:f,disabled:d,className:"px-6 py-2 bg-green-600 hover:bg-green-700 rounded-lg font-medium disabled:opacity-50",children:d?"Saving...":"Save Settings"})]}),u.text&&n.jsx("div",{className:`mb-4 p-3 rounded-lg ${u.type==="success"?"bg-green-900/30 text-green-400":"bg-red-900/30 text-red-400"}`,children:u.text}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 mb-6",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Select Admin"}),n.jsx("select",{value:r||"",onChange:b=>i(b.target.value),className:"w-full md:w-64 bg-dark-700 border border-dark-600 rounded px-3 py-2",children:e.map(b=>n.jsxs("option",{value:b._id,children:[b.username," (",b.adminCode,")"]},b._id))})]}),n.jsx("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:p.map(b=>n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("h3",{className:`text-lg font-semibold mb-4 text-${b.color}-400`,children:b.name}),n.jsx("div",{className:"space-y-4",children:b.fields.map(v=>n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium",children:v.label}),n.jsx("div",{className:"text-xs text-gray-500",children:v.desc})]}),n.jsx("input",{type:"number",value:a[v.key],onChange:S=>w(v.key,S.target.value),className:"w-24 bg-dark-700 border border-dark-600 rounded px-3 py-2 text-right"})]},v.key))})]},b.name))}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-orange-400",children:"Equity"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium",children:"Max Qty (Intraday)"}),n.jsx("div",{className:"text-xs text-gray-500",children:"MIS orders"})]}),n.jsx("input",{type:"number",value:a.equityMaxQtyIntraday,onChange:b=>w("equityMaxQtyIntraday",b.target.value),className:"w-24 bg-dark-700 border border-dark-600 rounded px-3 py-2 text-right"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium",children:"Max Qty (Delivery)"}),n.jsx("div",{className:"text-xs text-gray-500",children:"CNC orders"})]}),n.jsx("input",{type:"number",value:a.equityMaxQtyDelivery,onChange:b=>w("equityMaxQtyDelivery",b.target.value),className:"w-24 bg-dark-700 border border-dark-600 rounded px-3 py-2 text-right"})]})]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-400",children:"Global Limits"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium",children:"Max Open Positions"}),n.jsx("div",{className:"text-xs text-gray-500",children:"Per user"})]}),n.jsx("input",{type:"number",value:a.maxOpenPositions,onChange:b=>w("maxOpenPositions",b.target.value),className:"w-24 bg-dark-700 border border-dark-600 rounded px-3 py-2 text-right"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium",children:"Max Daily Trades"}),n.jsx("div",{className:"text-xs text-gray-500",children:"Per user"})]}),n.jsx("input",{type:"number",value:a.maxDailyTrades,onChange:b=>w("maxDailyTrades",b.target.value),className:"w-24 bg-dark-700 border border-dark-600 rounded px-3 py-2 text-right"})]})]})]})]}),n.jsxs("div",{className:"mt-6 bg-dark-800 rounded-lg p-4",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-purple-400",children:"Leverage Settings"}),n.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Select which leverage options to enable for users. Higher leverage = higher risk."}),n.jsx("div",{className:"flex flex-wrap gap-3",children:[1,2,5,10,20,50,100,200,500,800,1e3,1500,2e3].map(b=>{var S;const v=(S=a.enabledLeverages)==null?void 0:S.includes(b);return n.jsxs("button",{onClick:()=>{const N=a.enabledLeverages||[1,2,5,10],k=v?N.filter(j=>j!==b):[...N,b].sort((j,E)=>j-E);l(j=>({...j,enabledLeverages:k}))},className:`px-4 py-2 rounded-lg font-medium transition ${v?"bg-purple-600 text-white":"bg-dark-700 text-gray-400 hover:bg-dark-600"}`,children:[b,"x"]},b)})}),n.jsxs("div",{className:"mt-4 text-xs text-gray-500",children:["Enabled: ",(a.enabledLeverages||[1,2,5,10]).join("x, "),"x"]})]}),n.jsxs("div",{className:"mt-6 bg-dark-800 rounded-lg p-4",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-cyan-400",children:"Trading Settings"}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium",children:"Allow Trading Outside Market Hours"}),n.jsx("div",{className:"text-xs text-gray-500",children:"For LIMIT orders only"})]}),n.jsx("button",{onClick:()=>l(b=>({...b,allowTradingOutsideMarketHours:!b.allowTradingOutsideMarketHours})),className:`w-12 h-6 rounded-full transition ${a.allowTradingOutsideMarketHours?"bg-green-600":"bg-dark-600"}`,children:n.jsx("div",{className:`w-5 h-5 bg-white rounded-full transition transform ${a.allowTradingOutsideMarketHours?"translate-x-6":"translate-x-0.5"}`})})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium",children:"Margin Call %"}),n.jsx("div",{className:"text-xs text-gray-500",children:"Auto-close when loss reaches this %"})]}),n.jsx("input",{type:"number",value:a.marginCallPercentage||100,onChange:b=>l(v=>({...v,marginCallPercentage:parseInt(b.target.value)||100})),className:"w-20 bg-dark-700 border border-dark-600 rounded px-3 py-2 text-right"})]})]})]}),n.jsxs("div",{className:"mt-6 bg-blue-900/20 border border-blue-500/30 rounded-lg p-4",children:[n.jsx("h4",{className:"font-medium text-blue-400 mb-2",children:"How Settings Work"}),n.jsxs("ul",{className:"text-sm text-gray-400 space-y-1",children:[n.jsxs("li",{children:[" ",n.jsx("strong",{children:"Leverage"}),": Higher leverage = more buying power but higher risk"]}),n.jsxs("li",{children:[" ",n.jsx("strong",{children:"Margin Call"}),": Trades auto-close when loss reaches wallet balance"]}),n.jsxs("li",{children:[" ",n.jsx("strong",{children:"Intraday (MIS)"}),": Orders that must be squared off same day"]}),n.jsxs("li",{children:[" ",n.jsx("strong",{children:"Carry Forward (NRML)"}),": Orders that can be held till expiry"]})]})]})]})},ok=()=>{var p,b,v;const{admin:t,setAdmin:e}=we(),[s,r]=g.useState({name:(t==null?void 0:t.name)||"",email:(t==null?void 0:t.email)||"",phone:(t==null?void 0:t.phone)||""}),[i,a]=g.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[l,o]=g.useState({brandName:((p=t==null?void 0:t.branding)==null?void 0:p.brandName)||"",logoUrl:((b=t==null?void 0:t.branding)==null?void 0:b.logoUrl)||"",welcomeTitle:((v=t==null?void 0:t.branding)==null?void 0:v.welcomeTitle)||""}),[c,d]=g.useState(!1),[m,u]=g.useState({type:"",text:""}),[h,x]=g.useState(!1),y=async S=>{var N,k;S.preventDefault(),d(!0),u({type:"",text:""});try{const{data:j}=await I.put("/api/admin/manage/branding",l,{headers:{Authorization:`Bearer ${t.token}`}});e({...t,branding:j.branding}),u({type:"success",text:"Branding updated successfully"})}catch(j){u({type:"error",text:((k=(N=j.response)==null?void 0:N.data)==null?void 0:k.message)||"Error updating branding"})}finally{d(!1)}},f=async S=>{var N,k;S.preventDefault(),d(!0),u({type:"",text:""});try{const{data:j}=await I.put("/api/admin/manage/update-profile",s,{headers:{Authorization:`Bearer ${t.token}`}});e({...t,...j}),u({type:"success",text:"Profile updated successfully"})}catch(j){u({type:"error",text:((k=(N=j.response)==null?void 0:N.data)==null?void 0:k.message)||"Error updating profile"})}finally{d(!1)}},w=async S=>{var N,k;if(S.preventDefault(),i.newPassword!==i.confirmPassword){u({type:"error",text:"New passwords do not match"});return}if(i.newPassword.length<6){u({type:"error",text:"Password must be at least 6 characters"});return}d(!0),u({type:"",text:""});try{await I.put("/api/admin/manage/change-password",{currentPassword:i.currentPassword,newPassword:i.newPassword},{headers:{Authorization:`Bearer ${t.token}`}}),a({currentPassword:"",newPassword:"",confirmPassword:""}),u({type:"success",text:"Password changed successfully"})}catch(j){u({type:"error",text:((k=(N=j.response)==null?void 0:N.data)==null?void 0:k.message)||"Error changing password"})}finally{d(!1)}};return n.jsxs("div",{className:"p-4 md:p-6",children:[n.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Profile & Password"}),m.text&&n.jsx("div",{className:`mb-6 p-4 rounded ${m.type==="success"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:m.text}),n.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6",children:[n.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Update Profile"}),n.jsxs("form",{onSubmit:f,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Name"}),n.jsx("input",{type:"text",value:s.name,onChange:S=>r({...s,name:S.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Email"}),n.jsx("input",{type:"email",value:s.email,onChange:S=>r({...s,email:S.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Phone"}),n.jsx("input",{type:"text",value:s.phone,onChange:S=>r({...s,phone:S.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2"})]}),n.jsx("button",{type:"submit",disabled:c,className:"w-full bg-green-600 hover:bg-green-700 py-2 rounded",children:c?"Saving...":"Update Profile"})]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6",children:[n.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Change Password"}),n.jsxs("form",{onSubmit:w,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Current Password"}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:h?"text":"password",value:i.currentPassword,onChange:S=>a({...i,currentPassword:S.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 pr-10",required:!0}),n.jsx("button",{type:"button",onClick:()=>x(!h),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",children:h?n.jsx(Gn,{size:18}):n.jsx(wn,{size:18})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"New Password"}),n.jsx("input",{type:h?"text":"password",value:i.newPassword,onChange:S=>a({...i,newPassword:S.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",required:!0,minLength:6})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Confirm New Password"}),n.jsx("input",{type:h?"text":"password",value:i.confirmPassword,onChange:S=>a({...i,confirmPassword:S.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",required:!0,minLength:6})]}),n.jsx("button",{type:"submit",disabled:c,className:"w-full bg-yellow-600 hover:bg-yellow-700 py-2 rounded",children:c?"Changing...":"Change Password"})]})]})]}),(t==null?void 0:t.role)==="ADMIN"&&n.jsxs("div",{className:"mt-6 bg-dark-800 rounded-lg p-6",children:[n.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Branding Settings"}),n.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Customize your login page branding. Users who register via your referral link will see this branding."}),n.jsxs("form",{onSubmit:y,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Brand Name"}),n.jsx("input",{type:"text",value:l.brandName,onChange:S=>o({...l,brandName:S.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2",placeholder:"Your Brand Name (e.g., FKG)"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Welcome Title"}),n.jsx("input",{type:"text",value:l.welcomeTitle,onChange:S=>o({...l,welcomeTitle:S.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 text-lg",placeholder:"Welcome to FKG Trading"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This title will be displayed prominently on the login page"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Logo"}),n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("label",{className:"flex-1 cursor-pointer",children:[n.jsxs("div",{className:"flex items-center justify-center gap-2 bg-dark-700 border border-dark-600 border-dashed rounded px-4 py-3 hover:border-green-500 transition",children:[n.jsx(Ls,{size:18,className:"text-gray-400"}),n.jsx("span",{className:"text-gray-400",children:"Upload Logo"})]}),n.jsx("input",{type:"file",accept:"image/jpeg,image/png,image/gif,image/svg+xml,image/webp",className:"hidden",onChange:async S=>{var k,j;const N=S.target.files[0];if(N){if(N.size>5*1024*1024){u({type:"error",text:"File size must be less than 5MB"});return}d(!0),u({type:"",text:""});try{const E=new FormData;E.append("logo",N);const{data:_}=await I.post("/api/upload/logo",E,{headers:{Authorization:`Bearer ${t.token}`,"Content-Type":"multipart/form-data"}});o({...l,logoUrl:_.logoUrl}),e({...t,branding:_.branding}),u({type:"success",text:"Logo uploaded successfully"})}catch(E){u({type:"error",text:((j=(k=E.response)==null?void 0:k.data)==null?void 0:j.message)||"Error uploading logo"})}finally{d(!1)}}}})]}),l.logoUrl&&n.jsx("button",{type:"button",onClick:async()=>{d(!0);try{await I.delete("/api/upload/logo",{headers:{Authorization:`Bearer ${t.token}`}}),o({...l,logoUrl:""}),e({...t,branding:{...t.branding,logoUrl:""}}),u({type:"success",text:"Logo removed"})}catch{u({type:"error",text:"Error removing logo"})}finally{d(!1)}},className:"px-3 py-3 bg-red-600/20 text-red-400 rounded hover:bg-red-600/30",children:n.jsx(io,{size:18})})]}),n.jsx("p",{className:"text-xs text-gray-500",children:"Supported: JPEG, PNG, GIF, SVG, WebP (max 5MB)"})]})]}),l.logoUrl&&n.jsxs("div",{className:"p-3 bg-dark-700 rounded",children:[n.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Preview:"}),n.jsx("img",{src:l.logoUrl,alt:"Logo Preview",className:"h-16 object-contain",onError:S=>S.target.style.display="none"})]}),n.jsx("button",{type:"submit",disabled:c,className:"bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded",children:c?"Saving...":"Update Branding"})]}),(t==null?void 0:t.referralUrl)&&n.jsxs("div",{className:"mt-4 p-3 bg-dark-700 rounded",children:[n.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Your Referral Link:"}),n.jsx("code",{className:"text-green-400 text-sm break-all",children:t.referralUrl})]})]}),n.jsxs("div",{className:"mt-6 bg-dark-800 rounded-lg p-6",children:[n.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Account Information"}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[n.jsxs("div",{className:"p-3 bg-dark-700 rounded",children:[n.jsx("div",{className:"text-gray-400",children:"Role"}),n.jsx("div",{className:(t==null?void 0:t.role)==="SUPER_ADMIN"?"text-yellow-400 font-bold":"text-purple-400 font-bold",children:t==null?void 0:t.role})]}),n.jsxs("div",{className:"p-3 bg-dark-700 rounded",children:[n.jsx("div",{className:"text-gray-400",children:"Username"}),n.jsx("div",{children:t==null?void 0:t.username})]}),(t==null?void 0:t.adminCode)&&n.jsxs("div",{className:"p-3 bg-dark-700 rounded",children:[n.jsx("div",{className:"text-gray-400",children:"Admin Code"}),n.jsx("div",{className:"font-mono text-purple-400",children:t==null?void 0:t.adminCode})]}),n.jsxs("div",{className:"p-3 bg-dark-700 rounded",children:[n.jsx("div",{className:"text-gray-400",children:"Status"}),n.jsx("div",{className:"text-green-400",children:(t==null?void 0:t.status)||"ACTIVE"})]})]})]})]})},ck=()=>{var tt,qt,Ht,xt,Kt,ls,Ms,Rs,As,zs,Os,Is,$s,Bs,Ds,Fs,Us,Ws,Vs,qs,$,X,ne,he,ct,Ot,Nt,kn,Hr,Kr,Yr,Qr,Xr,Gr,Jr,Zr,ei,ti,si,ni,ri,ii,ai,li,oi,ci,di,ui,hi,mi,pi,xi,fi,gi,yi,z,K,Z,Ye,La,Sh;const{admin:t}=we(),[e,s]=g.useState([]),[r,i]=g.useState([]),[a,l]=g.useState(!0),[o,c]=g.useState(""),[d,m]=g.useState(""),[u,h]=g.useState(null),[x,y]=g.useState(!1),[f,w]=g.useState(!1),[p,b]=g.useState(!1),[v,S]=g.useState(!1),[N,k]=g.useState(!1),[j,E]=g.useState(!1),[_,M]=g.useState(!1),[V,B]=g.useState(""),[R,O]=g.useState(""),[P,W]=g.useState(!1),[D,T]=g.useState(!1),[L,F]=g.useState(!1),[C,H]=g.useState(null),[J,ce]=g.useState(null),[U,le]=g.useState(null),[G,Q]=g.useState(null),ge=["MCX","NSEINDEX","NSESTOCK","BSE","EQ"],ke={enabled:!1,fraction:!1,maxExchangeLots:100,commissionType:"PER_LOT",commissionLot:0,maxLots:50,minLots:1,orderLots:10,exposureIntraday:1,exposureCarryForward:1,optionBuy:{allowed:!0,fraction:!1,commissionType:"PER_LOT",commission:0,strikeSelection:50,maxExchangeLots:100},optionSell:{allowed:!0,fraction:!1,commissionType:"PER_LOT",commission:0,strikeSelection:50,maxExchangeLots:100}},[pe,De]=g.useState([]),qe=pe.length>0?pe.map(A=>A.id):ge,[Je,oe]=g.useState({}),[ue,Ce]=g.useState({MCX:["CRUDEOIL","CRUDEM","GOLD","SILVER","SILVERMIC","NATURALGAS","NATGASMINI","COPPER","ZINC","ZINCMINI","ALUMINIUM","LEAD","LEADMINI","NICKEL"],NSEINDEX:["NIFTY","BANKNIFTY","FINNIFTY","MIDCPNIFTY","NIFTYIT"],NSESTOCK:["RELIANCE","TCS","HDFCBANK","INFY","ICICIBANK","SBIN","BHARTIARTL","ITC","KOTAKBANK","LT"],BSE:["SENSEX","BANKEX"],EQ:["RELIANCE","TCS","HDFCBANK","INFY","ICICIBANK","SBIN","BHARTIARTL","ITC","KOTAKBANK","LT"]});g.useEffect(()=>{Ee(),Le(),Ne()},[]);const Ne=async()=>{try{const{data:A}=await I.get("/api/instruments/settings-data",{headers:{Authorization:`Bearer ${t.token}`}});De(A.segments||[]),oe(A.scripts||{});const Y={};for(const[se,st]of Object.entries(A.scripts||{}))Y[se]=st.map(_a=>_a.baseSymbol);Object.keys(Y).length>0&&Ce(Y)}catch(A){console.error("Error fetching market data:",A)}},Ee=async()=>{try{const{data:A}=await I.get("/api/admin/manage/all-users",{headers:{Authorization:`Bearer ${t.token}`}});s(A)}catch(A){console.error("Error fetching users:",A)}finally{l(!1)}},Le=async()=>{try{const{data:A}=await I.get("/api/admin/manage/admins",{headers:{Authorization:`Bearer ${t.token}`}});i(A)}catch(A){console.error("Error fetching admins:",A)}},lt=async()=>{var A,Y;if(!(!u||!V)){W(!0);try{await I.post(`/api/admin/manage/users/${u._id}/transfer`,{targetAdminId:V},{headers:{Authorization:`Bearer ${t.token}`}}),alert("User transferred successfully!"),y(!1),h(null),B(""),Ee()}catch(se){alert(((Y=(A=se.response)==null?void 0:A.data)==null?void 0:Y.message)||"Error transferring user")}finally{W(!1)}}},Te=A=>{h(A),Q({segmentPermissions:A.segmentPermissions||qe.reduce((Y,se)=>(Y[se]={...ke},Y),{}),scriptSettings:A.scriptSettings||{}}),H(null),ce(null),le(null),w(!0)},de=(A,Y,se)=>{Q(st=>({...st,segmentPermissions:{...st.segmentPermissions,[A]:{...st.segmentPermissions[A],[Y]:se}}}))},ot=async()=>{var A,Y;if(!(!u||!G)){T(!0);try{await I.put(`/api/admin/manage/users/${u._id}/settings`,{segmentPermissions:G.segmentPermissions,scriptSettings:G.scriptSettings},{headers:{Authorization:`Bearer ${t.token}`}}),alert("User settings updated successfully!"),w(!1),h(null),Q(null),Ee()}catch(se){alert(((Y=(A=se.response)==null?void 0:A.data)==null?void 0:Y.message)||"Error updating user settings")}finally{T(!1)}}},ae=async()=>{var A,Y;if(!(!u||!R)){F(!0);try{await I.post(`/api/admin/manage/users/${R}/copy-settings`,{sourceUserId:u._id,segmentPermissions:u.segmentPermissions,scriptSettings:u.scriptSettings},{headers:{Authorization:`Bearer ${t.token}`}}),alert("Settings copied successfully!"),b(!1),h(null),O(""),Ee()}catch(se){alert(((Y=(A=se.response)==null?void 0:A.data)==null?void 0:Y.message)||"Error copying settings")}finally{F(!1)}}},_e=e.filter(A=>{var Y,se,st,_a;return d&&A.adminCode!==d?!1:o?((Y=A.username)==null?void 0:Y.toLowerCase().includes(o.toLowerCase()))||((se=A.email)==null?void 0:se.toLowerCase().includes(o.toLowerCase()))||((st=A.fullName)==null?void 0:st.toLowerCase().includes(o.toLowerCase()))||((_a=A.adminCode)==null?void 0:_a.toLowerCase().includes(o.toLowerCase())):!0});return a?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx(fe,{className:"animate-spin",size:32})}):n.jsxs("div",{className:"p-4 md:p-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-6",children:[n.jsx("h1",{className:"text-2xl font-bold",children:"All Users"}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("button",{onClick:()=>M(!0),className:"flex items-center gap-2 bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg",children:[n.jsx(hn,{size:18}),"Send Notification"]}),n.jsxs("div",{className:"text-sm text-gray-400",children:["Total: ",e.length," users"]})]})]}),n.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[n.jsxs("div",{className:"flex-1 min-w-[200px]",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Filter by Admin"}),n.jsxs("select",{value:d,onChange:A=>m(A.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2",children:[n.jsx("option",{value:"",children:"All Admins"}),r.map(A=>n.jsxs("option",{value:A.adminCode,children:[A.name||A.username," (",A.adminCode,")"]},A._id))]})]}),n.jsxs("div",{className:"flex-1 min-w-[200px]",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Search"}),n.jsx("input",{type:"text",placeholder:"Search by username, email, name...",value:o,onChange:A=>c(A.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 text-white"})]})]}),n.jsx("div",{className:"bg-dark-800 rounded-lg overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-dark-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-sm",children:"User"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm",children:"Admin"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm",children:"Wallet"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm",children:"Status"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm",children:"Joined"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-dark-700",children:_e.map(A=>{var Y,se;return n.jsxs("tr",{className:"hover:bg-dark-700/50",children:[n.jsx("td",{className:"px-4 py-3",children:n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:A.fullName||A.username}),n.jsx("div",{className:"text-sm text-gray-400",children:A.email})]})}),n.jsx("td",{className:"px-4 py-3",children:n.jsxs("div",{className:"text-sm",children:[n.jsx("div",{className:"font-medium",children:((Y=A.admin)==null?void 0:Y.name)||"N/A"}),n.jsx("div",{className:"text-gray-400",children:A.adminCode})]})}),n.jsx("td",{className:"px-4 py-3",children:n.jsxs("span",{className:"text-green-400",children:["",(((se=A.wallet)==null?void 0:se.balance)||0).toLocaleString()]})}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("span",{className:`px-2 py-1 rounded text-xs ${A.isActive?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:A.isActive?"Active":"Inactive"})}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-400",children:new Date(A.createdAt).toLocaleDateString()}),n.jsx("td",{className:"px-4 py-3",children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsx("button",{onClick:()=>{h(A),S(!0)},className:"p-2 hover:bg-dark-600 rounded transition text-blue-400",title:"Edit User",children:n.jsx(Ud,{size:16})}),n.jsx("button",{onClick:()=>{h(A),k(!0)},className:"p-2 hover:bg-dark-600 rounded transition text-yellow-400",title:"Change Password",children:n.jsx(ro,{size:16})}),n.jsx("button",{onClick:()=>Te(A),className:"p-2 hover:bg-dark-600 rounded transition text-purple-400",title:"Edit Settings",children:n.jsx(ts,{size:16})}),n.jsx("button",{onClick:()=>{h(A),b(!0)},className:"p-2 hover:bg-dark-600 rounded transition text-cyan-400",title:"Copy Settings",children:n.jsx(Nr,{size:16})}),n.jsx("button",{onClick:()=>{h(A),E(!0)},className:"p-2 hover:bg-dark-600 rounded transition text-green-400",title:"Manage Wallet",children:n.jsx(Ge,{size:16})}),n.jsx("button",{onClick:()=>{h(A),y(!0)},className:"p-2 hover:bg-dark-600 rounded transition text-orange-400",title:"Transfer User",children:n.jsx(gg,{size:16})})]})})]},A._id)})})]})})}),x&&u&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6 w-full max-w-md mx-4",children:[n.jsx("h2",{className:"text-xl font-bold mb-4",children:"Transfer User"}),n.jsxs("div",{className:"mb-4 p-3 bg-dark-700 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"User"}),n.jsx("div",{className:"font-medium",children:u.fullName||u.username}),n.jsx("div",{className:"text-sm text-gray-400",children:u.email}),n.jsxs("div",{className:"text-sm text-gray-400 mt-1",children:["Current Admin: ",u.adminCode]})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Transfer to Admin"}),n.jsxs("select",{value:V,onChange:A=>B(A.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 text-white",children:[n.jsx("option",{value:"",children:"Select Admin"}),r.filter(A=>A.adminCode!==u.adminCode).map(A=>{var Y;return n.jsxs("option",{value:A._id,children:[A.name," (",A.adminCode,") - ",((Y=A.stats)==null?void 0:Y.totalUsers)||0," users"]},A._id)}),n.jsxs("option",{value:t._id,children:["Super Admin (",t.adminCode,")"]})]})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>{y(!1),h(null),B("")},className:"flex-1 bg-dark-600 hover:bg-dark-500 text-white py-2 rounded-lg",children:"Cancel"}),n.jsx("button",{onClick:lt,disabled:!V||P,className:"flex-1 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 text-white py-2 rounded-lg",children:P?"Transferring...":"Transfer"})]})]})}),p&&u&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6 w-full max-w-md mx-4",children:[n.jsx("h2",{className:"text-xl font-bold mb-4",children:"Copy User Settings"}),n.jsxs("div",{className:"mb-4 p-3 bg-dark-700 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Copy From"}),n.jsx("div",{className:"font-medium",children:u.fullName||u.username}),n.jsx("div",{className:"text-sm text-gray-400",children:u.email})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Copy To User"}),n.jsxs("select",{value:R,onChange:A=>O(A.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 text-white",children:[n.jsx("option",{value:"",children:"Select User"}),e.filter(A=>A._id!==u._id).map(A=>n.jsxs("option",{value:A._id,children:[A.fullName||A.username," (",A.email,") - ",A.adminCode]},A._id))]})]}),n.jsx("div",{className:"mb-4 p-3 bg-yellow-900/20 border border-yellow-600/50 rounded-lg",children:n.jsxs("div",{className:"text-sm text-yellow-400",children:[n.jsx("strong",{children:"Note:"})," This will copy segment permissions and script settings from the selected user to the target user. The target user's existing settings will be overwritten."]})}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>{b(!1),h(null),O("")},className:"flex-1 bg-dark-600 hover:bg-dark-500 text-white py-2 rounded-lg",children:"Cancel"}),n.jsx("button",{onClick:ae,disabled:!R||L,className:"flex-1 bg-green-600 hover:bg-green-700 disabled:opacity-50 text-white py-2 rounded-lg",children:L?"Copying...":"Copy Settings"})]})]})}),f&&u&&G&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 overflow-y-auto",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6 w-full max-w-4xl mx-4 my-8 max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Edit User Settings"}),n.jsx("button",{onClick:()=>{w(!1),h(null),Q(null)},className:"text-gray-400 hover:text-white",children:n.jsx(ve,{size:24})})]}),n.jsxs("div",{className:"mb-4 p-3 bg-dark-700 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"User"}),n.jsx("div",{className:"font-medium",children:u.fullName||u.username}),n.jsx("div",{className:"text-sm text-gray-400",children:u.email})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-blue-400 mb-3",children:"Segment Permissions"}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:qe.map(A=>{var Y,se;return n.jsx("button",{type:"button",onClick:()=>H(C===A?null:A),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${C===A?"bg-blue-600 text-white":(se=(Y=G.segmentPermissions)==null?void 0:Y[A])!=null&&se.enabled?"bg-green-600/20 text-green-400 border border-green-600":"bg-dark-600 text-gray-400 hover:bg-dark-500"}`,children:A},A)})}),C&&((tt=G.segmentPermissions)==null?void 0:tt[C])&&n.jsxs("div",{className:"bg-dark-700 rounded-lg p-4 border border-dark-600",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h4",{className:"text-md font-semibold text-blue-400",children:[C," Settings"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{type:"button",onClick:()=>de(C,"fraction",!G.segmentPermissions[C].fraction),className:`px-3 py-1 rounded text-xs font-medium ${G.segmentPermissions[C].fraction?"bg-purple-600 text-white":"bg-gray-600 text-white"}`,children:G.segmentPermissions[C].fraction?"Fraction On":"Fraction Off"}),n.jsx("button",{type:"button",onClick:()=>de(C,"enabled",!G.segmentPermissions[C].enabled),className:`px-3 py-1 rounded text-xs font-medium ${G.segmentPermissions[C].enabled?"bg-green-600 text-white":"bg-red-600 text-white"}`,children:G.segmentPermissions[C].enabled?"Enabled":"Disabled"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Max Exchange Lots"}),n.jsx("input",{type:"number",value:G.segmentPermissions[C].maxExchangeLots||100,onChange:A=>de(C,"maxExchangeLots",Number(A.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-2 py-1.5 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Max Lots"}),n.jsx("input",{type:"number",value:G.segmentPermissions[C].maxLots||50,onChange:A=>de(C,"maxLots",Number(A.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-2 py-1.5 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Min Lots"}),n.jsx("input",{type:"number",value:G.segmentPermissions[C].minLots||1,onChange:A=>de(C,"minLots",Number(A.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-2 py-1.5 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Order Lots"}),n.jsx("input",{type:"number",value:G.segmentPermissions[C].orderLots||10,onChange:A=>de(C,"orderLots",Number(A.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-2 py-1.5 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Commission Type"}),n.jsxs("select",{value:G.segmentPermissions[C].commissionType||"PER_LOT",onChange:A=>de(C,"commissionType",A.target.value),className:"w-full bg-dark-800 border border-dark-600 rounded px-2 py-1.5 text-sm",children:[n.jsx("option",{value:"PER_LOT",children:"Per Lot"}),n.jsx("option",{value:"PER_TRADE",children:"Per Trade"}),n.jsx("option",{value:"PER_CRORE",children:"Per Crore"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Commission ()"}),n.jsx("input",{type:"number",value:G.segmentPermissions[C].commissionLot||0,onChange:A=>de(C,"commissionLot",Number(A.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-2 py-1.5 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Exposure Intraday"}),n.jsx("input",{type:"number",value:G.segmentPermissions[C].exposureIntraday||1,onChange:A=>de(C,"exposureIntraday",Number(A.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-2 py-1.5 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Exposure Carry Forward"}),n.jsx("input",{type:"number",value:G.segmentPermissions[C].exposureCarryForward||1,onChange:A=>de(C,"exposureCarryForward",Number(A.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-2 py-1.5 text-sm"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"bg-dark-800 rounded-lg p-3 border border-green-900/50",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h5",{className:"text-sm font-medium text-green-400",children:"Option Buy"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{type:"button",onClick:()=>{var A;return de(C,"optionBuy",{...G.segmentPermissions[C].optionBuy,fraction:!((A=G.segmentPermissions[C].optionBuy)!=null&&A.fraction)})},className:`px-2 py-0.5 rounded text-xs font-medium ${(qt=G.segmentPermissions[C].optionBuy)!=null&&qt.fraction?"bg-purple-600 text-white":"bg-gray-600 text-white"}`,children:(Ht=G.segmentPermissions[C].optionBuy)!=null&&Ht.fraction?"Fraction On":"Fraction Off"}),n.jsx("button",{type:"button",onClick:()=>{var A;return de(C,"optionBuy",{...G.segmentPermissions[C].optionBuy,allowed:!((A=G.segmentPermissions[C].optionBuy)!=null&&A.allowed)})},className:`px-2 py-0.5 rounded text-xs font-medium ${(xt=G.segmentPermissions[C].optionBuy)!=null&&xt.allowed?"bg-green-600 text-white":"bg-red-600 text-white"}`,children:(Kt=G.segmentPermissions[C].optionBuy)!=null&&Kt.allowed?"Allowed":"Blocked"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Commission Type"}),n.jsxs("select",{value:((ls=G.segmentPermissions[C].optionBuy)==null?void 0:ls.commissionType)||"PER_LOT",onChange:A=>de(C,"optionBuy",{...G.segmentPermissions[C].optionBuy,commissionType:A.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1 text-xs",children:[n.jsx("option",{value:"PER_LOT",children:"Per Lot"}),n.jsx("option",{value:"PER_TRADE",children:"Per Trade"}),n.jsx("option",{value:"PER_CRORE",children:"Per Crore"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Commission ()"}),n.jsx("input",{type:"number",value:((Ms=G.segmentPermissions[C].optionBuy)==null?void 0:Ms.commission)||0,onChange:A=>de(C,"optionBuy",{...G.segmentPermissions[C].optionBuy,commission:Number(A.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Strike Selection ()"}),n.jsx("input",{type:"number",value:((Rs=G.segmentPermissions[C].optionBuy)==null?void 0:Rs.strikeSelection)||50,onChange:A=>de(C,"optionBuy",{...G.segmentPermissions[C].optionBuy,strikeSelection:Number(A.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Max Exchange Lots"}),n.jsx("input",{type:"number",value:((As=G.segmentPermissions[C].optionBuy)==null?void 0:As.maxExchangeLots)||100,onChange:A=>de(C,"optionBuy",{...G.segmentPermissions[C].optionBuy,maxExchangeLots:Number(A.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1 text-xs"})]})]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-3 border border-red-900/50",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h5",{className:"text-sm font-medium text-red-400",children:"Option Sell"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{type:"button",onClick:()=>{var A;return de(C,"optionSell",{...G.segmentPermissions[C].optionSell,fraction:!((A=G.segmentPermissions[C].optionSell)!=null&&A.fraction)})},className:`px-2 py-0.5 rounded text-xs font-medium ${(zs=G.segmentPermissions[C].optionSell)!=null&&zs.fraction?"bg-purple-600 text-white":"bg-gray-600 text-white"}`,children:(Os=G.segmentPermissions[C].optionSell)!=null&&Os.fraction?"Fraction On":"Fraction Off"}),n.jsx("button",{type:"button",onClick:()=>{var A;return de(C,"optionSell",{...G.segmentPermissions[C].optionSell,allowed:!((A=G.segmentPermissions[C].optionSell)!=null&&A.allowed)})},className:`px-2 py-0.5 rounded text-xs font-medium ${(Is=G.segmentPermissions[C].optionSell)!=null&&Is.allowed?"bg-green-600 text-white":"bg-red-600 text-white"}`,children:($s=G.segmentPermissions[C].optionSell)!=null&&$s.allowed?"Allowed":"Blocked"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Commission Type"}),n.jsxs("select",{value:((Bs=G.segmentPermissions[C].optionSell)==null?void 0:Bs.commissionType)||"PER_LOT",onChange:A=>de(C,"optionSell",{...G.segmentPermissions[C].optionSell,commissionType:A.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1 text-xs",children:[n.jsx("option",{value:"PER_LOT",children:"Per Lot"}),n.jsx("option",{value:"PER_TRADE",children:"Per Trade"}),n.jsx("option",{value:"PER_CRORE",children:"Per Crore"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Commission ()"}),n.jsx("input",{type:"number",value:((Ds=G.segmentPermissions[C].optionSell)==null?void 0:Ds.commission)||0,onChange:A=>de(C,"optionSell",{...G.segmentPermissions[C].optionSell,commission:Number(A.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Strike Selection ()"}),n.jsx("input",{type:"number",value:((Fs=G.segmentPermissions[C].optionSell)==null?void 0:Fs.strikeSelection)||50,onChange:A=>de(C,"optionSell",{...G.segmentPermissions[C].optionSell,strikeSelection:Number(A.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Max Exchange Lots"}),n.jsx("input",{type:"number",value:((Us=G.segmentPermissions[C].optionSell)==null?void 0:Us.maxExchangeLots)||100,onChange:A=>de(C,"optionSell",{...G.segmentPermissions[C].optionSell,maxExchangeLots:Number(A.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1 text-xs"})]})]})]})]})]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-purple-400 mb-3",children:"Script Settings"}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:qe.map(A=>n.jsx("button",{type:"button",onClick:()=>{ce(J===A?null:A),le(null)},className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${J===A?"bg-purple-600 text-white":"bg-dark-600 text-gray-400 hover:bg-dark-500"}`,children:A},A))}),J&&n.jsxs("div",{className:"bg-dark-700 rounded-lg p-4 border border-dark-600",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("h4",{className:"text-sm font-medium text-yellow-400",children:[J," Symbols"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-xs text-gray-500",children:[Object.keys(G.scriptSettings||{}).filter(A=>{var Y;return((Y=G.scriptSettings[A])==null?void 0:Y.segment)===J}).length," customized"]}),n.jsx("button",{type:"button",onClick:()=>{const A=ue[J]||[],Y={...G.scriptSettings};A.forEach(se=>{Y[se]||(Y[se]={segment:J,settingType:"LOT",lotSettings:{maxLots:50,minLots:1,perOrderLots:10},quantitySettings:{maxQuantity:1e3,minQuantity:1,perOrderQuantity:100}})}),Q(se=>({...se,scriptSettings:Y}))},className:"px-2 py-1 bg-green-600 hover:bg-green-700 rounded text-xs font-medium",children:"Select All"}),n.jsx("button",{type:"button",onClick:()=>{const A=ue[J]||[],Y={...G.scriptSettings};A.forEach(se=>{delete Y[se]}),Q(se=>({...se,scriptSettings:Y})),le(null)},className:"px-2 py-1 bg-red-600 hover:bg-red-700 rounded text-xs font-medium",children:"Unselect All"})]})]}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:(ue[J]||[]).map(A=>{var Y;return n.jsx("button",{type:"button",onClick:()=>{var se;(se=G.scriptSettings)!=null&&se[A]||Q(st=>({...st,scriptSettings:{...st.scriptSettings,[A]:{segment:J,settingType:"LOT",lotSettings:{maxLots:50,minLots:1,perOrderLots:10},quantitySettings:{maxQuantity:1e3,minQuantity:1,perOrderQuantity:100}}}})),le(A)},className:`px-3 py-1.5 rounded text-xs font-medium transition-all ${U===A?"bg-yellow-600 text-white":(Y=G.scriptSettings)!=null&&Y[A]?"bg-purple-600/30 text-purple-400 border border-purple-600":"bg-dark-600 text-gray-400 hover:bg-dark-500"}`,children:A},A)})}),U&&((Ws=G.scriptSettings)==null?void 0:Ws[U])&&n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-purple-600",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("span",{className:"text-sm font-medium text-yellow-400",children:[U," Settings"]}),n.jsx("button",{type:"button",onClick:()=>{const A={...G.scriptSettings};delete A[U],Q(Y=>({...Y,scriptSettings:A})),le(null)},className:"text-red-400 hover:text-red-300 text-xs",children:"Reset to Default"})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-xs text-gray-400 font-medium mb-2",children:"Setting Type"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:["LOT","QUANTITY","FIXED_MARGIN","BROKERAGE","SPREAD","BLOCK"].map(A=>{var Y;return n.jsx("button",{type:"button",onClick:()=>Q(se=>({...se,scriptSettings:{...se.scriptSettings,[U]:{...se.scriptSettings[U],settingType:A}}})),className:`px-3 py-1.5 rounded text-xs font-medium transition-all ${(((Y=G.scriptSettings[U])==null?void 0:Y.settingType)||"LOT")===A?"bg-purple-600 text-white":"bg-dark-600 text-gray-400 hover:bg-dark-500"}`,children:A==="LOT"?"Lot":A==="QUANTITY"?"Quantity":A==="FIXED_MARGIN"?"Fixed Margin":A==="BROKERAGE"?"Brokerage":A==="SPREAD"?"Spread":"Block"},A)})})]}),(((Vs=G.scriptSettings[U])==null?void 0:Vs.settingType)||"LOT")==="LOT"&&n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Max Lots"}),n.jsx("input",{type:"number",value:(($=(qs=G.scriptSettings[U])==null?void 0:qs.lotSettings)==null?void 0:$.maxLots)||50,onChange:A=>Q(Y=>{var se;return{...Y,scriptSettings:{...Y.scriptSettings,[U]:{...Y.scriptSettings[U],lotSettings:{...(se=Y.scriptSettings[U])==null?void 0:se.lotSettings,maxLots:Number(A.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Min Lots"}),n.jsx("input",{type:"number",value:((ne=(X=G.scriptSettings[U])==null?void 0:X.lotSettings)==null?void 0:ne.minLots)||1,onChange:A=>Q(Y=>{var se;return{...Y,scriptSettings:{...Y.scriptSettings,[U]:{...Y.scriptSettings[U],lotSettings:{...(se=Y.scriptSettings[U])==null?void 0:se.lotSettings,minLots:Number(A.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Per Order"}),n.jsx("input",{type:"number",value:((ct=(he=G.scriptSettings[U])==null?void 0:he.lotSettings)==null?void 0:ct.perOrderLots)||10,onChange:A=>Q(Y=>{var se;return{...Y,scriptSettings:{...Y.scriptSettings,[U]:{...Y.scriptSettings[U],lotSettings:{...(se=Y.scriptSettings[U])==null?void 0:se.lotSettings,perOrderLots:Number(A.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})]}),((Ot=G.scriptSettings[U])==null?void 0:Ot.settingType)==="QUANTITY"&&n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Max Qty"}),n.jsx("input",{type:"number",value:((kn=(Nt=G.scriptSettings[U])==null?void 0:Nt.quantitySettings)==null?void 0:kn.maxQuantity)||1e3,onChange:A=>Q(Y=>{var se;return{...Y,scriptSettings:{...Y.scriptSettings,[U]:{...Y.scriptSettings[U],quantitySettings:{...(se=Y.scriptSettings[U])==null?void 0:se.quantitySettings,maxQuantity:Number(A.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Min Qty"}),n.jsx("input",{type:"number",value:((Kr=(Hr=G.scriptSettings[U])==null?void 0:Hr.quantitySettings)==null?void 0:Kr.minQuantity)||1,onChange:A=>Q(Y=>{var se;return{...Y,scriptSettings:{...Y.scriptSettings,[U]:{...Y.scriptSettings[U],quantitySettings:{...(se=Y.scriptSettings[U])==null?void 0:se.quantitySettings,minQuantity:Number(A.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Per Order"}),n.jsx("input",{type:"number",value:((Qr=(Yr=G.scriptSettings[U])==null?void 0:Yr.quantitySettings)==null?void 0:Qr.perOrderQuantity)||100,onChange:A=>Q(Y=>{var se;return{...Y,scriptSettings:{...Y.scriptSettings,[U]:{...Y.scriptSettings[U],quantitySettings:{...(se=Y.scriptSettings[U])==null?void 0:se.quantitySettings,perOrderQuantity:Number(A.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})]}),((Xr=G.scriptSettings[U])==null?void 0:Xr.settingType)==="FIXED_MARGIN"&&n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"bg-dark-700 rounded p-3",children:[n.jsx("span",{className:"text-xs text-blue-400 font-medium block mb-2",children:"Future Margins"}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Intraday Future"}),n.jsx("input",{type:"number",value:((Jr=(Gr=G.scriptSettings[U])==null?void 0:Gr.fixedMargin)==null?void 0:Jr.intradayFuture)||0,onChange:A=>Q(Y=>{var se;return{...Y,scriptSettings:{...Y.scriptSettings,[U]:{...Y.scriptSettings[U],fixedMargin:{...(se=Y.scriptSettings[U])==null?void 0:se.fixedMargin,intradayFuture:Number(A.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Carry Future"}),n.jsx("input",{type:"number",value:((ei=(Zr=G.scriptSettings[U])==null?void 0:Zr.fixedMargin)==null?void 0:ei.carryFuture)||0,onChange:A=>Q(Y=>{var se;return{...Y,scriptSettings:{...Y.scriptSettings,[U]:{...Y.scriptSettings[U],fixedMargin:{...(se=Y.scriptSettings[U])==null?void 0:se.fixedMargin,carryFuture:Number(A.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})]})]}),n.jsxs("div",{className:"bg-dark-700 rounded p-3",children:[n.jsx("span",{className:"text-xs text-green-400 font-medium block mb-2",children:"Option Buy Margins"}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Option Buy Intraday"}),n.jsx("input",{type:"number",value:((si=(ti=G.scriptSettings[U])==null?void 0:ti.fixedMargin)==null?void 0:si.optionBuyIntraday)||0,onChange:A=>Q(Y=>{var se;return{...Y,scriptSettings:{...Y.scriptSettings,[U]:{...Y.scriptSettings[U],fixedMargin:{...(se=Y.scriptSettings[U])==null?void 0:se.fixedMargin,optionBuyIntraday:Number(A.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Option Buy Carry"}),n.jsx("input",{type:"number",value:((ri=(ni=G.scriptSettings[U])==null?void 0:ni.fixedMargin)==null?void 0:ri.optionBuyCarry)||0,onChange:A=>Q(Y=>{var se;return{...Y,scriptSettings:{...Y.scriptSettings,[U]:{...Y.scriptSettings[U],fixedMargin:{...(se=Y.scriptSettings[U])==null?void 0:se.fixedMargin,optionBuyCarry:Number(A.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})]})]}),n.jsxs("div",{className:"bg-dark-700 rounded p-3",children:[n.jsx("span",{className:"text-xs text-red-400 font-medium block mb-2",children:"Option Sell Margins"}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Option Sell Intraday"}),n.jsx("input",{type:"number",value:((ai=(ii=G.scriptSettings[U])==null?void 0:ii.fixedMargin)==null?void 0:ai.optionSellIntraday)||0,onChange:A=>Q(Y=>{var se;return{...Y,scriptSettings:{...Y.scriptSettings,[U]:{...Y.scriptSettings[U],fixedMargin:{...(se=Y.scriptSettings[U])==null?void 0:se.fixedMargin,optionSellIntraday:Number(A.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Option Sell Carry"}),n.jsx("input",{type:"number",value:((oi=(li=G.scriptSettings[U])==null?void 0:li.fixedMargin)==null?void 0:oi.optionSellCarry)||0,onChange:A=>Q(Y=>{var se;return{...Y,scriptSettings:{...Y.scriptSettings,[U]:{...Y.scriptSettings[U],fixedMargin:{...(se=Y.scriptSettings[U])==null?void 0:se.fixedMargin,optionSellCarry:Number(A.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})]})]})]}),((ci=G.scriptSettings[U])==null?void 0:ci.settingType)==="BROKERAGE"&&n.jsx("div",{className:"bg-dark-700 rounded p-3",children:n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Brokerage Type"}),n.jsxs("select",{value:((ui=(di=G.scriptSettings[U])==null?void 0:di.brokerage)==null?void 0:ui.type)||"PER_LOT",onChange:A=>Q(Y=>{var se;return{...Y,scriptSettings:{...Y.scriptSettings,[U]:{...Y.scriptSettings[U],brokerage:{...(se=Y.scriptSettings[U])==null?void 0:se.brokerage,type:A.target.value}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs",children:[n.jsx("option",{value:"PER_LOT",children:"Per Lot"}),n.jsx("option",{value:"PER_CRORE",children:"Per Crore"}),n.jsx("option",{value:"PER_TRADE",children:"Per Trade"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Brokerage Value"}),n.jsx("input",{type:"number",value:((mi=(hi=G.scriptSettings[U])==null?void 0:hi.brokerage)==null?void 0:mi.value)||0,onChange:A=>Q(Y=>{var se;return{...Y,scriptSettings:{...Y.scriptSettings,[U]:{...Y.scriptSettings[U],brokerage:{...(se=Y.scriptSettings[U])==null?void 0:se.brokerage,value:Number(A.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})]})}),((pi=G.scriptSettings[U])==null?void 0:pi.settingType)==="SPREAD"&&n.jsx("div",{className:"bg-dark-700 rounded p-3",children:n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Spread Value"}),n.jsx("input",{type:"number",step:"0.01",value:((xi=G.scriptSettings[U])==null?void 0:xi.spread)||0,onChange:A=>Q(Y=>({...Y,scriptSettings:{...Y.scriptSettings,[U]:{...Y.scriptSettings[U],spread:Number(A.target.value)}}})),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})}),((fi=G.scriptSettings[U])==null?void 0:fi.settingType)==="BLOCK"&&n.jsx("div",{className:"bg-dark-700 rounded p-3",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("label",{className:"text-xs text-gray-500",children:"Block Future"}),n.jsx("button",{type:"button",onClick:()=>Q(A=>{var Y,se,st;return{...A,scriptSettings:{...A.scriptSettings,[U]:{...A.scriptSettings[U],block:{...(Y=A.scriptSettings[U])==null?void 0:Y.block,future:!((st=(se=A.scriptSettings[U])==null?void 0:se.block)!=null&&st.future)}}}}}),className:`px-3 py-1 rounded text-xs font-medium ${(yi=(gi=G.scriptSettings[U])==null?void 0:gi.block)!=null&&yi.future?"bg-red-600 text-white":"bg-green-600 text-white"}`,children:(K=(z=G.scriptSettings[U])==null?void 0:z.block)!=null&&K.future?"Yes":"No"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("label",{className:"text-xs text-gray-500",children:"Block Option"}),n.jsx("button",{type:"button",onClick:()=>Q(A=>{var Y,se,st;return{...A,scriptSettings:{...A.scriptSettings,[U]:{...A.scriptSettings[U],block:{...(Y=A.scriptSettings[U])==null?void 0:Y.block,option:!((st=(se=A.scriptSettings[U])==null?void 0:se.block)!=null&&st.option)}}}}}),className:`px-3 py-1 rounded text-xs font-medium ${(Ye=(Z=G.scriptSettings[U])==null?void 0:Z.block)!=null&&Ye.option?"bg-red-600 text-white":"bg-green-600 text-white"}`,children:(Sh=(La=G.scriptSettings[U])==null?void 0:La.block)!=null&&Sh.option?"Yes":"No"})]})]})})]})]})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>{w(!1),h(null),Q(null)},className:"flex-1 bg-dark-600 hover:bg-dark-500 text-white py-2 rounded-lg",children:"Cancel"}),n.jsx("button",{onClick:ot,disabled:D,className:"flex-1 bg-purple-600 hover:bg-purple-700 disabled:opacity-50 text-white py-2 rounded-lg",children:D?"Saving...":"Save Settings"})]})]})}),v&&u&&n.jsx(dk,{user:u,onClose:()=>{S(!1),h(null)},onSuccess:()=>{S(!1),h(null),Ee()},token:t.token}),N&&u&&n.jsx(uk,{user:u,onClose:()=>{k(!1),h(null)},token:t.token}),j&&u&&n.jsx(hk,{user:u,onClose:()=>{E(!1),h(null)},onSuccess:()=>{Ee()},token:t.token}),_&&n.jsx(bg,{onClose:()=>M(!1),token:t.token,users:e,admins:r,isSuperAdmin:!0})]})},bg=({onClose:t,token:e,users:s,admins:r,isSuperAdmin:i})=>{const[a,l]=g.useState({title:"",subject:"",description:"",targetType:"ALL_USERS",targetUserIds:[],targetAdminCode:""}),[o,c]=g.useState(null),[d,m]=g.useState(null),[u,h]=g.useState(!1),[x,y]=g.useState(""),f=N=>{const k=N.target.files[0];k&&(c(k),m(URL.createObjectURL(k)))},w=N=>{l(k=>({...k,targetUserIds:k.targetUserIds.includes(N)?k.targetUserIds.filter(j=>j!==N):[...k.targetUserIds,N]}))},p=()=>{const N=S.map(k=>k._id);l(k=>({...k,targetUserIds:[...new Set([...k.targetUserIds,...N])]}))},b=()=>{l(N=>({...N,targetUserIds:[]}))},v=async N=>{var k,j;if(N.preventDefault(),!a.title||!a.subject||!a.description){alert("Please fill in all required fields");return}if(a.targetType==="SELECTED_USERS"&&a.targetUserIds.length===0){alert("Please select at least one user");return}h(!0);try{const E=new FormData;E.append("title",a.title),E.append("subject",a.subject),E.append("description",a.description),E.append("targetType",a.targetType),a.targetType==="SELECTED_USERS"&&E.append("targetUserIds",JSON.stringify(a.targetUserIds)),a.targetType==="ADMIN_USERS"&&E.append("targetAdminCode",a.targetAdminCode),o&&E.append("image",o),await I.post("/api/notifications",E,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"multipart/form-data"}}),alert("Notification sent successfully!"),t()}catch(E){alert(((j=(k=E.response)==null?void 0:k.data)==null?void 0:j.message)||"Error sending notification")}finally{h(!1)}},S=s.filter(N=>(N.fullName||N.username||"").toLowerCase().includes(x.toLowerCase())||(N.email||"").toLowerCase().includes(x.toLowerCase()));return[...new Set(s.map(N=>N.adminCode))].filter(Boolean),n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 overflow-y-auto",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6 w-full max-w-lg mx-4 my-8 max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Send Notification"}),n.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white",children:n.jsx(ve,{size:24})})]}),n.jsxs("form",{onSubmit:v,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Title *"}),n.jsx("input",{type:"text",value:a.title,onChange:N=>l({...a,title:N.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2",placeholder:"Notification title"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Subject *"}),n.jsx("input",{type:"text",value:a.subject,onChange:N=>l({...a,subject:N.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2",placeholder:"Notification subject"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Description *"}),n.jsx("textarea",{value:a.description,onChange:N=>l({...a,description:N.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 min-h-[100px]",placeholder:"Notification description"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Image (Optional)"}),n.jsx("input",{type:"file",accept:"image/*",onChange:f,className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 text-sm"}),d&&n.jsxs("div",{className:"mt-2 relative",children:[n.jsx("img",{src:d,alt:"Preview",className:"w-full max-h-40 object-cover rounded-lg"}),n.jsx("button",{type:"button",onClick:()=>{c(null),m(null)},className:"absolute top-2 right-2 bg-red-600 rounded-full p-1",children:n.jsx(ve,{size:16})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Send To *"}),n.jsxs("select",{value:a.targetType,onChange:N=>l({...a,targetType:N.target.value,targetUserIds:[],targetAdminCode:""}),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2",children:[i&&n.jsx("option",{value:"ALL_ADMINS_USERS",children:"All Users (All Admins)"}),n.jsx("option",{value:"ALL_USERS",children:"All My Users"}),n.jsx("option",{value:"SELECTED_USERS",children:"Selected Users"}),i&&n.jsx("option",{value:"ADMIN_USERS",children:"Specific Admin's Users"})]})]}),a.targetType==="SELECTED_USERS"&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm text-gray-400 mb-1",children:["Select Users * (",a.targetUserIds.length," selected)"]}),n.jsx("input",{type:"text",placeholder:"Search users...",value:x,onChange:N=>y(N.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 mb-2"}),n.jsxs("div",{className:"flex gap-2 mb-2",children:[n.jsx("button",{type:"button",onClick:p,className:"text-xs bg-green-600 hover:bg-green-700 px-2 py-1 rounded",children:"Select All Filtered"}),n.jsx("button",{type:"button",onClick:b,className:"text-xs bg-red-600 hover:bg-red-700 px-2 py-1 rounded",children:"Clear All"})]}),n.jsxs("div",{className:"max-h-48 overflow-y-auto bg-dark-700 border border-dark-600 rounded-lg",children:[S.map(N=>n.jsxs("label",{className:`flex items-center gap-2 px-3 py-2 cursor-pointer hover:bg-dark-600 ${a.targetUserIds.includes(N._id)?"bg-green-900/30":""}`,children:[n.jsx("input",{type:"checkbox",checked:a.targetUserIds.includes(N._id),onChange:()=>w(N._id),className:"rounded"}),n.jsxs("span",{className:"text-sm",children:[N.fullName||N.username," ",n.jsxs("span",{className:"text-gray-500",children:["(",N.email,")"]})]})]},N._id)),S.length===0&&n.jsx("div",{className:"px-3 py-4 text-center text-gray-500 text-sm",children:"No users found"})]})]}),a.targetType==="ADMIN_USERS"&&i&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Select Admin *"}),n.jsxs("select",{value:a.targetAdminCode,onChange:N=>l({...a,targetAdminCode:N.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2",children:[n.jsx("option",{value:"",children:"Select Admin"}),r&&r.map(N=>n.jsxs("option",{value:N.adminCode,children:[N.fullName||N.username," (",N.adminCode,")"]},N._id))]})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:t,className:"flex-1 bg-dark-600 hover:bg-dark-500 py-2 rounded-lg",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:u,className:"flex-1 bg-orange-600 hover:bg-orange-700 disabled:opacity-50 py-2 rounded-lg",children:u?"Sending...":"Send Notification"})]})]})]})})},dk=({user:t,onClose:e,onSuccess:s,token:r})=>{const[i,a]=g.useState({fullName:t.fullName||"",phone:t.phone||"",isActive:t.isActive}),[l,o]=g.useState(!1),c=async d=>{var m,u;d.preventDefault(),o(!0);try{await I.put(`/api/admin/manage/users/${t._id}`,i,{headers:{Authorization:`Bearer ${r}`}}),s()}catch(h){alert(((u=(m=h.response)==null?void 0:m.data)==null?void 0:u.message)||"Error updating user")}finally{o(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6 w-full max-w-md mx-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Edit User"}),n.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white",children:n.jsx(ve,{size:24})})]}),n.jsxs("form",{onSubmit:c,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Full Name"}),n.jsx("input",{type:"text",value:i.fullName,onChange:d=>a({...i,fullName:d.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Phone"}),n.jsx("input",{type:"text",value:i.phone,onChange:d=>a({...i,phone:d.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-gray-400",children:"Active Status"}),n.jsx("button",{type:"button",onClick:()=>a({...i,isActive:!i.isActive}),className:`px-4 py-2 rounded-lg ${i.isActive?"bg-green-600":"bg-red-600"}`,children:i.isActive?"Active":"Inactive"})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:e,className:"flex-1 bg-dark-600 hover:bg-dark-500 py-2 rounded-lg",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:l,className:"flex-1 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 py-2 rounded-lg",children:l?"Saving...":"Save"})]})]})]})})},uk=({user:t,onClose:e,token:s})=>{const[r,i]=g.useState(""),[a,l]=g.useState(!1),[o,c]=g.useState(!1),d=async m=>{var u,h;if(m.preventDefault(),r.length<6){alert("Password must be at least 6 characters");return}c(!0);try{await I.put(`/api/admin/manage/users/${t._id}/password`,{password:r},{headers:{Authorization:`Bearer ${s}`}}),alert("Password updated successfully"),e()}catch(x){alert(((h=(u=x.response)==null?void 0:u.data)==null?void 0:h.message)||"Error updating password")}finally{c(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6 w-full max-w-md mx-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Change Password"}),n.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white",children:n.jsx(ve,{size:24})})]}),n.jsxs("div",{className:"mb-4 p-3 bg-dark-700 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"User"}),n.jsx("div",{className:"font-medium",children:t.fullName||t.username})]}),n.jsxs("form",{onSubmit:d,className:"space-y-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"New Password"}),n.jsx("input",{type:a?"text":"password",value:r,onChange:m=>i(m.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 pr-10",placeholder:"Enter new password"}),n.jsx("button",{type:"button",onClick:()=>l(!a),className:"absolute right-3 top-8 text-gray-400",children:a?n.jsx(Gn,{size:20}):n.jsx(wn,{size:20})})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:e,className:"flex-1 bg-dark-600 hover:bg-dark-500 py-2 rounded-lg",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:o,className:"flex-1 bg-yellow-600 hover:bg-yellow-700 disabled:opacity-50 py-2 rounded-lg",children:o?"Updating...":"Update Password"})]})]})]})})},hk=({user:t,onClose:e,onSuccess:s,token:r})=>{var x,y;const[i,a]=g.useState(""),[l,o]=g.useState(""),[c,d]=g.useState("add"),[m,u]=g.useState(!1),h=async f=>{var w,p;if(f.preventDefault(),!i||parseFloat(i)<=0){alert("Please enter a valid amount");return}u(!0);try{const b=c==="add"?"add-funds":"deduct-funds";await I.post(`/api/admin/manage/users/${t._id}/${b}`,{amount:parseFloat(i),description:l},{headers:{Authorization:`Bearer ${r}`}}),alert(`Funds ${c==="add"?"added":"deducted"} successfully`),s(),e()}catch(b){alert(((p=(w=b.response)==null?void 0:w.data)==null?void 0:p.message)||"Error processing request")}finally{u(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6 w-full max-w-md mx-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Manage Wallet"}),n.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white",children:n.jsx(ve,{size:24})})]}),n.jsxs("div",{className:"mb-4 p-3 bg-dark-700 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"User"}),n.jsx("div",{className:"font-medium",children:t.fullName||t.username}),n.jsxs("div",{className:"text-lg font-bold text-green-400 mt-1",children:["",((y=(x=t.wallet)==null?void 0:x.cashBalance)==null?void 0:y.toLocaleString())||"0"]})]}),n.jsxs("form",{onSubmit:h,className:"space-y-4",children:[n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{type:"button",onClick:()=>d("add"),className:`flex-1 py-2 rounded-lg ${c==="add"?"bg-green-600":"bg-dark-600"}`,children:"Add Funds"}),n.jsx("button",{type:"button",onClick:()=>d("deduct"),className:`flex-1 py-2 rounded-lg ${c==="deduct"?"bg-red-600":"bg-dark-600"}`,children:"Deduct Funds"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Amount ()"}),n.jsx("input",{type:"number",value:i,onChange:f=>a(f.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2",placeholder:"Enter amount"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Description (Optional)"}),n.jsx("input",{type:"text",value:l,onChange:f=>o(f.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2",placeholder:"Enter description"})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:e,className:"flex-1 bg-dark-600 hover:bg-dark-500 py-2 rounded-lg",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:m,className:`flex-1 ${c==="add"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"} disabled:opacity-50 py-2 rounded-lg`,children:m?"Processing...":c==="add"?"Add Funds":"Deduct Funds"})]})]})]})})},mk=()=>{var Ne,Ee,Le,lt,Te,de,ot,ae,_e,tt,qt,Ht,xt,Kt,ls,Ms,Rs,As,zs,Os,Is,$s,Bs,Ds,Fs,Us,Ws,Vs,qs,$,X,ne,he,ct,Ot,Nt,kn,Hr,Kr,Yr,Qr,Xr,Gr,Jr,Zr,ei,ti,si,ni,ri,ii,ai,li,oi,ci,di,ui,hi,mi,pi,xi,fi,gi,yi;const{admin:t}=we(),[e,s]=g.useState([]),[r,i]=g.useState(!0),[a,l]=g.useState(""),[o,c]=g.useState(!1),[d,m]=g.useState(!1),[u,h]=g.useState(!1),[x,y]=g.useState(!1),[f,w]=g.useState(!1),[p,b]=g.useState(!1),[v,S]=g.useState(!1),[N,k]=g.useState(null),[j,E]=g.useState(!1),[_,M]=g.useState(!1),[V,B]=g.useState(""),[R,O]=g.useState(null),[P,W]=g.useState(null),[D,T]=g.useState(null),[L,F]=g.useState(null),C=["MCX","NSEINDEX","NSESTOCK","BSE","EQ"],[H,J]=g.useState([]),[ce,U]=g.useState({}),le=H.length>0?H.map(z=>z.id):C,G={enabled:!1,fraction:!1,maxExchangeLots:100,commissionType:"PER_LOT",commissionLot:0,maxLots:50,minLots:1,orderLots:10,exposureIntraday:1,exposureCarryForward:1,optionBuy:{allowed:!0,fraction:!1,commissionType:"PER_LOT",commission:0,strikeSelection:50,maxExchangeLots:100},optionSell:{allowed:!0,fraction:!1,commissionType:"PER_LOT",commission:0,strikeSelection:50,maxExchangeLots:100}},[Q,ge]=g.useState({MCX:["CRUDEOIL","CRUDEM","GOLD","SILVER","SILVERMIC","NATURALGAS","NATGASMINI","COPPER","ZINC","ZINCMINI","ALUMINIUM","LEAD","LEADMINI","NICKEL"],NSEINDEX:["NIFTY","BANKNIFTY","FINNIFTY","MIDCPNIFTY","NIFTYIT"],NSESTOCK:["RELIANCE","TCS","HDFCBANK","INFY","ICICIBANK","SBIN","BHARTIARTL","ITC","KOTAKBANK","LT"],BSE:["SENSEX","BANKEX"],EQ:["RELIANCE","TCS","HDFCBANK","INFY","ICICIBANK","SBIN","BHARTIARTL","ITC","KOTAKBANK","LT"]}),ke=async()=>{try{const{data:z}=await I.get("/api/instruments/settings-data",{headers:{Authorization:`Bearer ${t.token}`}});J(z.segments||[]),U(z.scripts||{});const K={};for(const[Z,Ye]of Object.entries(z.scripts||{}))K[Z]=Ye.map(La=>La.baseSymbol);Object.keys(K).length>0&&ge(K)}catch(z){console.error("Error fetching market data:",z)}},pe=async()=>{try{const{data:z}=await I.get("/api/admin/users",{headers:{Authorization:`Bearer ${t.token}`}});s(z)}catch(z){console.error("Error fetching users:",z)}finally{i(!1)}};g.useEffect(()=>{pe(),ke()},[]);const De=e.filter(z=>{var K;return z.username.toLowerCase().includes(a.toLowerCase())||z.email.toLowerCase().includes(a.toLowerCase())||((K=z.fullName)==null?void 0:K.toLowerCase().includes(a.toLowerCase()))}),qe=async z=>{var K,Z;if(confirm("Are you sure you want to delete this user?"))try{await I.delete(`/api/admin/users/${z}`,{headers:{Authorization:`Bearer ${t.token}`}}),pe()}catch(Ye){alert(((Z=(K=Ye.response)==null?void 0:K.data)==null?void 0:Z.message)||"Error deleting user")}},Je=z=>{k(z),F({segmentPermissions:z.segmentPermissions||le.reduce((K,Z)=>(K[Z]={...G},K),{}),scriptSettings:z.scriptSettings||{}}),O(null),W(null),T(null),w(!0)},oe=(z,K,Z)=>{F(Ye=>({...Ye,segmentPermissions:{...Ye.segmentPermissions,[z]:{...Ye.segmentPermissions[z],[K]:Z}}}))},ue=async()=>{var z,K;if(!(!N||!L)){E(!0);try{await I.put(`/api/admin/users/${N._id}/settings`,{segmentPermissions:L.segmentPermissions,scriptSettings:L.scriptSettings},{headers:{Authorization:`Bearer ${t.token}`}}),alert("User settings updated successfully!"),w(!1),k(null),F(null),pe()}catch(Z){alert(((K=(z=Z.response)==null?void 0:z.data)==null?void 0:K.message)||"Error updating user settings")}finally{E(!1)}}},Ce=async()=>{var z,K;if(!(!N||!V)){M(!0);try{await I.post(`/api/admin/manage/users/${V}/copy-settings`,{sourceUserId:N._id,segmentPermissions:N.segmentPermissions,scriptSettings:N.scriptSettings},{headers:{Authorization:`Bearer ${t.token}`}}),alert("Settings copied successfully!"),b(!1),k(null),B(""),pe()}catch(Z){alert(((K=(z=Z.response)==null?void 0:z.data)==null?void 0:K.message)||"Error copying settings")}finally{M(!1)}}};return n.jsxs("div",{className:"p-4 md:p-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6",children:[n.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:"User Management"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:()=>S(!0),className:"flex items-center justify-center gap-2 bg-orange-600 hover:bg-orange-700 px-4 py-2 rounded-lg transition",children:[n.jsx(hn,{size:20}),n.jsx("span",{children:"Send Notification"})]}),n.jsxs("button",{onClick:()=>c(!0),className:"flex items-center justify-center gap-2 bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded-lg transition",children:[n.jsx(Ls,{size:20}),n.jsx("span",{children:"Create User"})]})]})]}),n.jsxs("div",{className:"relative mb-6",children:[n.jsx(Jn,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),n.jsx("input",{type:"text",placeholder:"Search users...",value:a,onChange:z=>l(z.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg pl-10 pr-4 py-2 focus:outline-none focus:border-purple-500"})]}),n.jsx("div",{className:"md:hidden space-y-4",children:r?n.jsxs("div",{className:"text-center py-8 text-gray-400",children:[n.jsx(fe,{className:"animate-spin inline mr-2",size:20}),"Loading..."]}):De.length===0?n.jsx("div",{className:"text-center py-8 text-gray-400",children:"No users found"}):De.map(z=>{var K,Z;return n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:z.fullName||z.username}),n.jsxs("div",{className:"text-sm text-gray-400",children:["@",z.username]})]}),n.jsx("span",{className:`px-2 py-1 rounded text-xs ${z.isActive?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:z.isActive?"Active":"Inactive"})]}),n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:z.email}),n.jsx("div",{className:"text-sm text-gray-400 mb-3",children:z.phone||"No phone"}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-green-400 font-bold",children:["",((Z=(K=z.wallet)==null?void 0:K.balance)==null?void 0:Z.toLocaleString())||"0"]}),n.jsxs("div",{className:"flex gap-2 flex-wrap",children:[n.jsx("button",{onClick:()=>{k(z),m(!0)},className:"p-2 bg-dark-700 rounded text-blue-400",children:n.jsx(Ud,{size:16})}),n.jsx("button",{onClick:()=>{k(z),h(!0)},className:"p-2 bg-dark-700 rounded text-yellow-400",children:n.jsx(ro,{size:16})}),n.jsx("button",{onClick:()=>Je(z),className:"p-2 bg-dark-700 rounded text-purple-400",children:n.jsx(ts,{size:16})}),n.jsx("button",{onClick:()=>{k(z),b(!0)},className:"p-2 bg-dark-700 rounded text-cyan-400",children:n.jsx(Nr,{size:16})}),n.jsx("button",{onClick:()=>{k(z),y(!0)},className:"p-2 bg-dark-700 rounded text-green-400",children:n.jsx(Ge,{size:16})}),n.jsx("button",{onClick:()=>qe(z._id),className:"p-2 bg-dark-700 rounded text-red-400",children:n.jsx(io,{size:16})})]})]})]},z._id)})}),n.jsx("div",{className:"hidden md:block bg-dark-800 rounded-lg overflow-hidden overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-dark-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"text-left px-4 py-3 text-gray-400 font-medium",children:"User"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400 font-medium",children:"Email"}),n.jsx("th",{className:"text-left px-4 py-3 text-gray-400 font-medium",children:"Phone"}),n.jsx("th",{className:"text-right px-4 py-3 text-gray-400 font-medium",children:"Balance"}),n.jsx("th",{className:"text-center px-4 py-3 text-gray-400 font-medium",children:"Status"}),n.jsx("th",{className:"text-center px-4 py-3 text-gray-400 font-medium",children:"Actions"})]})}),n.jsx("tbody",{children:r?n.jsx("tr",{children:n.jsxs("td",{colSpan:"6",className:"text-center py-8 text-gray-400",children:[n.jsx(fe,{className:"animate-spin inline mr-2",size:20}),"Loading..."]})}):De.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:"6",className:"text-center py-8 text-gray-400",children:"No users found"})}):De.map(z=>{var K,Z;return n.jsxs("tr",{className:"border-t border-dark-600 hover:bg-dark-700",children:[n.jsx("td",{className:"px-4 py-3",children:n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:z.fullName||z.username}),n.jsxs("div",{className:"text-sm text-gray-400",children:["@",z.username]})]})}),n.jsx("td",{className:"px-4 py-3 text-gray-300",children:z.email}),n.jsx("td",{className:"px-4 py-3 text-gray-300",children:z.phone||"-"}),n.jsx("td",{className:"px-4 py-3 text-right",children:n.jsxs("span",{className:"text-green-400 font-medium",children:["",((Z=(K=z.wallet)==null?void 0:K.balance)==null?void 0:Z.toLocaleString())||"0"]})}),n.jsx("td",{className:"px-4 py-3 text-center",children:n.jsx("span",{className:`px-2 py-1 rounded text-xs ${z.isActive?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:z.isActive?"Active":"Inactive"})}),n.jsx("td",{className:"px-4 py-3",children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsx("button",{onClick:()=>{k(z),m(!0)},className:"p-2 hover:bg-dark-600 rounded transition text-blue-400",title:"Edit User",children:n.jsx(Ud,{size:16})}),n.jsx("button",{onClick:()=>{k(z),h(!0)},className:"p-2 hover:bg-dark-600 rounded transition text-yellow-400",title:"Change Password",children:n.jsx(ro,{size:16})}),n.jsx("button",{onClick:()=>Je(z),className:"p-2 hover:bg-dark-600 rounded transition text-purple-400",title:"Edit Settings",children:n.jsx(ts,{size:16})}),n.jsx("button",{onClick:()=>{k(z),b(!0)},className:"p-2 hover:bg-dark-600 rounded transition text-cyan-400",title:"Copy Settings",children:n.jsx(Nr,{size:16})}),n.jsx("button",{onClick:()=>{k(z),y(!0)},className:"p-2 hover:bg-dark-600 rounded transition text-green-400",title:"Manage Wallet",children:n.jsx(Ge,{size:16})}),n.jsx("button",{onClick:()=>qe(z._id),className:"p-2 hover:bg-dark-600 rounded transition text-red-400",title:"Delete User",children:n.jsx(io,{size:16})})]})})]},z._id)})})]})}),o&&n.jsx(pk,{onClose:()=>c(!1),onSuccess:()=>{c(!1),pe()},token:t.token}),d&&N&&n.jsx(xk,{user:N,onClose:()=>{m(!1),k(null)},onSuccess:()=>{m(!1),k(null),pe()},token:t.token}),u&&N&&n.jsx(fk,{user:N,onClose:()=>{h(!1),k(null)},token:t.token}),x&&N&&n.jsx(gk,{user:N,onClose:()=>{y(!1),k(null)},onSuccess:()=>{pe()},token:t.token}),p&&N&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6 w-full max-w-md mx-4",children:[n.jsx("h2",{className:"text-xl font-bold mb-4",children:"Copy User Settings"}),n.jsxs("div",{className:"mb-4 p-3 bg-dark-700 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Copy From"}),n.jsx("div",{className:"font-medium",children:N.fullName||N.username}),n.jsx("div",{className:"text-sm text-gray-400",children:N.email})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Copy To User"}),n.jsxs("select",{value:V,onChange:z=>B(z.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 text-white",children:[n.jsx("option",{value:"",children:"Select User"}),e.filter(z=>z._id!==N._id).map(z=>n.jsxs("option",{value:z._id,children:[z.fullName||z.username," (",z.email,")"]},z._id))]})]}),n.jsx("div",{className:"mb-4 p-3 bg-yellow-900/20 border border-yellow-600/50 rounded-lg",children:n.jsxs("div",{className:"text-sm text-yellow-400",children:[n.jsx("strong",{children:"Note:"})," This will copy segment permissions and script settings from the selected user to the target user."]})}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>{b(!1),k(null),B("")},className:"flex-1 bg-dark-600 hover:bg-dark-500 text-white py-2 rounded-lg",children:"Cancel"}),n.jsx("button",{onClick:Ce,disabled:!V||_,className:"flex-1 bg-green-600 hover:bg-green-700 disabled:opacity-50 text-white py-2 rounded-lg",children:_?"Copying...":"Copy Settings"})]})]})}),f&&N&&L&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 overflow-y-auto",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6 w-full max-w-4xl mx-4 my-8 max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Edit User Settings"}),n.jsx("button",{onClick:()=>{w(!1),k(null),F(null)},className:"text-gray-400 hover:text-white",children:n.jsx(ve,{size:24})})]}),n.jsxs("div",{className:"mb-4 p-3 bg-dark-700 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"User"}),n.jsx("div",{className:"font-medium",children:N.fullName||N.username}),n.jsx("div",{className:"text-sm text-gray-400",children:N.email})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-blue-400 mb-3",children:"Segment Permissions"}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:le.map(z=>{var K,Z;return n.jsx("button",{type:"button",onClick:()=>O(R===z?null:z),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${R===z?"bg-blue-600 text-white":(Z=(K=L.segmentPermissions)==null?void 0:K[z])!=null&&Z.enabled?"bg-green-600/20 text-green-400 border border-green-600":"bg-dark-600 text-gray-400 hover:bg-dark-500"}`,children:z},z)})}),R&&((Ne=L.segmentPermissions)==null?void 0:Ne[R])&&n.jsxs("div",{className:"bg-dark-700 rounded-lg p-4 border border-dark-600",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h4",{className:"text-md font-semibold text-blue-400",children:[R," Settings"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{type:"button",onClick:()=>oe(R,"fraction",!L.segmentPermissions[R].fraction),className:`px-3 py-1 rounded text-xs font-medium ${L.segmentPermissions[R].fraction?"bg-purple-600 text-white":"bg-gray-600 text-white"}`,children:L.segmentPermissions[R].fraction?"Fraction On":"Fraction Off"}),n.jsx("button",{type:"button",onClick:()=>oe(R,"enabled",!L.segmentPermissions[R].enabled),className:`px-3 py-1 rounded text-xs font-medium ${L.segmentPermissions[R].enabled?"bg-green-600 text-white":"bg-red-600 text-white"}`,children:L.segmentPermissions[R].enabled?"Enabled":"Disabled"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Max Exchange Lots"}),n.jsx("input",{type:"number",value:L.segmentPermissions[R].maxExchangeLots||100,onChange:z=>oe(R,"maxExchangeLots",Number(z.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-2 py-1.5 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Max Lots"}),n.jsx("input",{type:"number",value:L.segmentPermissions[R].maxLots||50,onChange:z=>oe(R,"maxLots",Number(z.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-2 py-1.5 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Min Lots"}),n.jsx("input",{type:"number",value:L.segmentPermissions[R].minLots||1,onChange:z=>oe(R,"minLots",Number(z.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-2 py-1.5 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Order Lots"}),n.jsx("input",{type:"number",value:L.segmentPermissions[R].orderLots||10,onChange:z=>oe(R,"orderLots",Number(z.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-2 py-1.5 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Commission Type"}),n.jsxs("select",{value:L.segmentPermissions[R].commissionType||"PER_LOT",onChange:z=>oe(R,"commissionType",z.target.value),className:"w-full bg-dark-800 border border-dark-600 rounded px-2 py-1.5 text-sm",children:[n.jsx("option",{value:"PER_LOT",children:"Per Lot"}),n.jsx("option",{value:"PER_TRADE",children:"Per Trade"}),n.jsx("option",{value:"PER_CRORE",children:"Per Crore"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Commission ()"}),n.jsx("input",{type:"number",value:L.segmentPermissions[R].commissionLot||0,onChange:z=>oe(R,"commissionLot",Number(z.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-2 py-1.5 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Exposure Intraday"}),n.jsx("input",{type:"number",value:L.segmentPermissions[R].exposureIntraday||1,onChange:z=>oe(R,"exposureIntraday",Number(z.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-2 py-1.5 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Exposure Carry Forward"}),n.jsx("input",{type:"number",value:L.segmentPermissions[R].exposureCarryForward||1,onChange:z=>oe(R,"exposureCarryForward",Number(z.target.value)),className:"w-full bg-dark-800 border border-dark-600 rounded px-2 py-1.5 text-sm"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"bg-dark-800 rounded-lg p-3 border border-green-900/50",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h5",{className:"text-sm font-medium text-green-400",children:"Option Buy"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{type:"button",onClick:()=>{var z;return oe(R,"optionBuy",{...L.segmentPermissions[R].optionBuy,fraction:!((z=L.segmentPermissions[R].optionBuy)!=null&&z.fraction)})},className:`px-2 py-0.5 rounded text-xs font-medium ${(Ee=L.segmentPermissions[R].optionBuy)!=null&&Ee.fraction?"bg-purple-600 text-white":"bg-gray-600 text-white"}`,children:(Le=L.segmentPermissions[R].optionBuy)!=null&&Le.fraction?"Fraction On":"Fraction Off"}),n.jsx("button",{type:"button",onClick:()=>{var z;return oe(R,"optionBuy",{...L.segmentPermissions[R].optionBuy,allowed:!((z=L.segmentPermissions[R].optionBuy)!=null&&z.allowed)})},className:`px-2 py-0.5 rounded text-xs font-medium ${(lt=L.segmentPermissions[R].optionBuy)!=null&&lt.allowed?"bg-green-600 text-white":"bg-red-600 text-white"}`,children:(Te=L.segmentPermissions[R].optionBuy)!=null&&Te.allowed?"Allowed":"Blocked"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Commission Type"}),n.jsxs("select",{value:((de=L.segmentPermissions[R].optionBuy)==null?void 0:de.commissionType)||"PER_LOT",onChange:z=>oe(R,"optionBuy",{...L.segmentPermissions[R].optionBuy,commissionType:z.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1 text-xs",children:[n.jsx("option",{value:"PER_LOT",children:"Per Lot"}),n.jsx("option",{value:"PER_TRADE",children:"Per Trade"}),n.jsx("option",{value:"PER_CRORE",children:"Per Crore"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Commission ()"}),n.jsx("input",{type:"number",value:((ot=L.segmentPermissions[R].optionBuy)==null?void 0:ot.commission)||0,onChange:z=>oe(R,"optionBuy",{...L.segmentPermissions[R].optionBuy,commission:Number(z.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Strike Selection ()"}),n.jsx("input",{type:"number",value:((ae=L.segmentPermissions[R].optionBuy)==null?void 0:ae.strikeSelection)||50,onChange:z=>oe(R,"optionBuy",{...L.segmentPermissions[R].optionBuy,strikeSelection:Number(z.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Max Exchange Lots"}),n.jsx("input",{type:"number",value:((_e=L.segmentPermissions[R].optionBuy)==null?void 0:_e.maxExchangeLots)||100,onChange:z=>oe(R,"optionBuy",{...L.segmentPermissions[R].optionBuy,maxExchangeLots:Number(z.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1 text-xs"})]})]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-3 border border-red-900/50",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h5",{className:"text-sm font-medium text-red-400",children:"Option Sell"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{type:"button",onClick:()=>{var z;return oe(R,"optionSell",{...L.segmentPermissions[R].optionSell,fraction:!((z=L.segmentPermissions[R].optionSell)!=null&&z.fraction)})},className:`px-2 py-0.5 rounded text-xs font-medium ${(tt=L.segmentPermissions[R].optionSell)!=null&&tt.fraction?"bg-purple-600 text-white":"bg-gray-600 text-white"}`,children:(qt=L.segmentPermissions[R].optionSell)!=null&&qt.fraction?"Fraction On":"Fraction Off"}),n.jsx("button",{type:"button",onClick:()=>{var z;return oe(R,"optionSell",{...L.segmentPermissions[R].optionSell,allowed:!((z=L.segmentPermissions[R].optionSell)!=null&&z.allowed)})},className:`px-2 py-0.5 rounded text-xs font-medium ${(Ht=L.segmentPermissions[R].optionSell)!=null&&Ht.allowed?"bg-green-600 text-white":"bg-red-600 text-white"}`,children:(xt=L.segmentPermissions[R].optionSell)!=null&&xt.allowed?"Allowed":"Blocked"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Commission Type"}),n.jsxs("select",{value:((Kt=L.segmentPermissions[R].optionSell)==null?void 0:Kt.commissionType)||"PER_LOT",onChange:z=>oe(R,"optionSell",{...L.segmentPermissions[R].optionSell,commissionType:z.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1 text-xs",children:[n.jsx("option",{value:"PER_LOT",children:"Per Lot"}),n.jsx("option",{value:"PER_TRADE",children:"Per Trade"}),n.jsx("option",{value:"PER_CRORE",children:"Per Crore"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Commission ()"}),n.jsx("input",{type:"number",value:((ls=L.segmentPermissions[R].optionSell)==null?void 0:ls.commission)||0,onChange:z=>oe(R,"optionSell",{...L.segmentPermissions[R].optionSell,commission:Number(z.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Strike Selection ()"}),n.jsx("input",{type:"number",value:((Ms=L.segmentPermissions[R].optionSell)==null?void 0:Ms.strikeSelection)||50,onChange:z=>oe(R,"optionSell",{...L.segmentPermissions[R].optionSell,strikeSelection:Number(z.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Max Exchange Lots"}),n.jsx("input",{type:"number",value:((Rs=L.segmentPermissions[R].optionSell)==null?void 0:Rs.maxExchangeLots)||100,onChange:z=>oe(R,"optionSell",{...L.segmentPermissions[R].optionSell,maxExchangeLots:Number(z.target.value)}),className:"w-full bg-dark-700 border border-dark-600 rounded px-2 py-1 text-xs"})]})]})]})]})]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-purple-400 mb-3",children:"Script Settings"}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:le.map(z=>n.jsx("button",{type:"button",onClick:()=>{W(P===z?null:z),T(null)},className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${P===z?"bg-purple-600 text-white":"bg-dark-600 text-gray-400 hover:bg-dark-500"}`,children:z},z))}),P&&n.jsxs("div",{className:"bg-dark-700 rounded-lg p-4 border border-dark-600",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("h4",{className:"text-sm font-medium text-yellow-400",children:[P," Symbols"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{type:"button",onClick:()=>{const z=Q[P]||[],K={...L.scriptSettings};z.forEach(Z=>{K[Z]||(K[Z]={segment:P,settingType:"LOT",lotSettings:{maxLots:50,minLots:1,perOrderLots:10},quantitySettings:{maxQuantity:1e3,minQuantity:1,perOrderQuantity:100}})}),F(Z=>({...Z,scriptSettings:K}))},className:"px-2 py-1 bg-green-600 hover:bg-green-700 rounded text-xs font-medium",children:"Select All"}),n.jsx("button",{type:"button",onClick:()=>{const z=Q[P]||[],K={...L.scriptSettings};z.forEach(Z=>{delete K[Z]}),F(Z=>({...Z,scriptSettings:K})),T(null)},className:"px-2 py-1 bg-red-600 hover:bg-red-700 rounded text-xs font-medium",children:"Unselect All"})]})]}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:(Q[P]||[]).map(z=>{var K;return n.jsx("button",{type:"button",onClick:()=>{var Z;(Z=L.scriptSettings)!=null&&Z[z]||F(Ye=>({...Ye,scriptSettings:{...Ye.scriptSettings,[z]:{segment:P,settingType:"LOT",lotSettings:{maxLots:50,minLots:1,perOrderLots:10},quantitySettings:{maxQuantity:1e3,minQuantity:1,perOrderQuantity:100}}}})),T(z)},className:`px-3 py-1.5 rounded text-xs font-medium transition-all ${D===z?"bg-yellow-600 text-white":(K=L.scriptSettings)!=null&&K[z]?"bg-purple-600/30 text-purple-400 border border-purple-600":"bg-dark-600 text-gray-400 hover:bg-dark-500"}`,children:z},z)})}),D&&((As=L.scriptSettings)==null?void 0:As[D])&&n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-purple-600",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("span",{className:"text-sm font-medium text-yellow-400",children:[D," Settings"]}),n.jsx("button",{type:"button",onClick:()=>{const z={...L.scriptSettings};delete z[D],F(K=>({...K,scriptSettings:z})),T(null)},className:"text-red-400 hover:text-red-300 text-xs",children:"Reset to Default"})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-xs text-gray-400 font-medium mb-2",children:"Setting Type"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:["LOT","QUANTITY","FIXED_MARGIN","BROKERAGE","SPREAD","BLOCK"].map(z=>{var K;return n.jsx("button",{type:"button",onClick:()=>F(Z=>({...Z,scriptSettings:{...Z.scriptSettings,[D]:{...Z.scriptSettings[D],settingType:z}}})),className:`px-3 py-1.5 rounded text-xs font-medium transition-all ${(((K=L.scriptSettings[D])==null?void 0:K.settingType)||"LOT")===z?"bg-purple-600 text-white":"bg-dark-600 text-gray-400 hover:bg-dark-500"}`,children:z==="LOT"?"Lot":z==="QUANTITY"?"Quantity":z==="FIXED_MARGIN"?"Fixed Margin":z==="BROKERAGE"?"Brokerage":z==="SPREAD"?"Spread":"Block"},z)})})]}),(((zs=L.scriptSettings[D])==null?void 0:zs.settingType)||"LOT")==="LOT"&&n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Max Lots"}),n.jsx("input",{type:"number",value:((Is=(Os=L.scriptSettings[D])==null?void 0:Os.lotSettings)==null?void 0:Is.maxLots)||50,onChange:z=>F(K=>{var Z;return{...K,scriptSettings:{...K.scriptSettings,[D]:{...K.scriptSettings[D],lotSettings:{...(Z=K.scriptSettings[D])==null?void 0:Z.lotSettings,maxLots:Number(z.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Min Lots"}),n.jsx("input",{type:"number",value:((Bs=($s=L.scriptSettings[D])==null?void 0:$s.lotSettings)==null?void 0:Bs.minLots)||1,onChange:z=>F(K=>{var Z;return{...K,scriptSettings:{...K.scriptSettings,[D]:{...K.scriptSettings[D],lotSettings:{...(Z=K.scriptSettings[D])==null?void 0:Z.lotSettings,minLots:Number(z.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Per Order"}),n.jsx("input",{type:"number",value:((Fs=(Ds=L.scriptSettings[D])==null?void 0:Ds.lotSettings)==null?void 0:Fs.perOrderLots)||10,onChange:z=>F(K=>{var Z;return{...K,scriptSettings:{...K.scriptSettings,[D]:{...K.scriptSettings[D],lotSettings:{...(Z=K.scriptSettings[D])==null?void 0:Z.lotSettings,perOrderLots:Number(z.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})]}),((Us=L.scriptSettings[D])==null?void 0:Us.settingType)==="QUANTITY"&&n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Max Qty"}),n.jsx("input",{type:"number",value:((Vs=(Ws=L.scriptSettings[D])==null?void 0:Ws.quantitySettings)==null?void 0:Vs.maxQuantity)||1e3,onChange:z=>F(K=>{var Z;return{...K,scriptSettings:{...K.scriptSettings,[D]:{...K.scriptSettings[D],quantitySettings:{...(Z=K.scriptSettings[D])==null?void 0:Z.quantitySettings,maxQuantity:Number(z.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Min Qty"}),n.jsx("input",{type:"number",value:(($=(qs=L.scriptSettings[D])==null?void 0:qs.quantitySettings)==null?void 0:$.minQuantity)||1,onChange:z=>F(K=>{var Z;return{...K,scriptSettings:{...K.scriptSettings,[D]:{...K.scriptSettings[D],quantitySettings:{...(Z=K.scriptSettings[D])==null?void 0:Z.quantitySettings,minQuantity:Number(z.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Per Order"}),n.jsx("input",{type:"number",value:((ne=(X=L.scriptSettings[D])==null?void 0:X.quantitySettings)==null?void 0:ne.perOrderQuantity)||100,onChange:z=>F(K=>{var Z;return{...K,scriptSettings:{...K.scriptSettings,[D]:{...K.scriptSettings[D],quantitySettings:{...(Z=K.scriptSettings[D])==null?void 0:Z.quantitySettings,perOrderQuantity:Number(z.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})]}),((he=L.scriptSettings[D])==null?void 0:he.settingType)==="FIXED_MARGIN"&&n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"bg-dark-700 rounded p-3",children:[n.jsx("span",{className:"text-xs text-blue-400 font-medium block mb-2",children:"Future Margins"}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Intraday Future"}),n.jsx("input",{type:"number",value:((Ot=(ct=L.scriptSettings[D])==null?void 0:ct.fixedMargin)==null?void 0:Ot.intradayFuture)||0,onChange:z=>F(K=>{var Z;return{...K,scriptSettings:{...K.scriptSettings,[D]:{...K.scriptSettings[D],fixedMargin:{...(Z=K.scriptSettings[D])==null?void 0:Z.fixedMargin,intradayFuture:Number(z.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Carry Future"}),n.jsx("input",{type:"number",value:((kn=(Nt=L.scriptSettings[D])==null?void 0:Nt.fixedMargin)==null?void 0:kn.carryFuture)||0,onChange:z=>F(K=>{var Z;return{...K,scriptSettings:{...K.scriptSettings,[D]:{...K.scriptSettings[D],fixedMargin:{...(Z=K.scriptSettings[D])==null?void 0:Z.fixedMargin,carryFuture:Number(z.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})]})]}),n.jsxs("div",{className:"bg-dark-700 rounded p-3",children:[n.jsx("span",{className:"text-xs text-green-400 font-medium block mb-2",children:"Option Buy Margins"}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Option Buy Intraday"}),n.jsx("input",{type:"number",value:((Kr=(Hr=L.scriptSettings[D])==null?void 0:Hr.fixedMargin)==null?void 0:Kr.optionBuyIntraday)||0,onChange:z=>F(K=>{var Z;return{...K,scriptSettings:{...K.scriptSettings,[D]:{...K.scriptSettings[D],fixedMargin:{...(Z=K.scriptSettings[D])==null?void 0:Z.fixedMargin,optionBuyIntraday:Number(z.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Option Buy Carry"}),n.jsx("input",{type:"number",value:((Qr=(Yr=L.scriptSettings[D])==null?void 0:Yr.fixedMargin)==null?void 0:Qr.optionBuyCarry)||0,onChange:z=>F(K=>{var Z;return{...K,scriptSettings:{...K.scriptSettings,[D]:{...K.scriptSettings[D],fixedMargin:{...(Z=K.scriptSettings[D])==null?void 0:Z.fixedMargin,optionBuyCarry:Number(z.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})]})]}),n.jsxs("div",{className:"bg-dark-700 rounded p-3",children:[n.jsx("span",{className:"text-xs text-red-400 font-medium block mb-2",children:"Option Sell Margins"}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Option Sell Intraday"}),n.jsx("input",{type:"number",value:((Gr=(Xr=L.scriptSettings[D])==null?void 0:Xr.fixedMargin)==null?void 0:Gr.optionSellIntraday)||0,onChange:z=>F(K=>{var Z;return{...K,scriptSettings:{...K.scriptSettings,[D]:{...K.scriptSettings[D],fixedMargin:{...(Z=K.scriptSettings[D])==null?void 0:Z.fixedMargin,optionSellIntraday:Number(z.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Option Sell Carry"}),n.jsx("input",{type:"number",value:((Zr=(Jr=L.scriptSettings[D])==null?void 0:Jr.fixedMargin)==null?void 0:Zr.optionSellCarry)||0,onChange:z=>F(K=>{var Z;return{...K,scriptSettings:{...K.scriptSettings,[D]:{...K.scriptSettings[D],fixedMargin:{...(Z=K.scriptSettings[D])==null?void 0:Z.fixedMargin,optionSellCarry:Number(z.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})]})]})]}),((ei=L.scriptSettings[D])==null?void 0:ei.settingType)==="BROKERAGE"&&n.jsx("div",{className:"bg-dark-700 rounded p-3",children:n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Brokerage Type"}),n.jsxs("select",{value:((si=(ti=L.scriptSettings[D])==null?void 0:ti.brokerage)==null?void 0:si.type)||"PER_LOT",onChange:z=>F(K=>{var Z;return{...K,scriptSettings:{...K.scriptSettings,[D]:{...K.scriptSettings[D],brokerage:{...(Z=K.scriptSettings[D])==null?void 0:Z.brokerage,type:z.target.value}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs",children:[n.jsx("option",{value:"PER_LOT",children:"Per Lot"}),n.jsx("option",{value:"PER_CRORE",children:"Per Crore"}),n.jsx("option",{value:"PER_TRADE",children:"Per Trade"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Brokerage Value"}),n.jsx("input",{type:"number",value:((ri=(ni=L.scriptSettings[D])==null?void 0:ni.brokerage)==null?void 0:ri.value)||0,onChange:z=>F(K=>{var Z;return{...K,scriptSettings:{...K.scriptSettings,[D]:{...K.scriptSettings[D],brokerage:{...(Z=K.scriptSettings[D])==null?void 0:Z.brokerage,value:Number(z.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})]})}),((ii=L.scriptSettings[D])==null?void 0:ii.settingType)==="SPREAD"&&n.jsx("div",{className:"bg-dark-700 rounded p-3",children:n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Buy Spread"}),n.jsx("input",{type:"number",step:"0.01",value:((li=(ai=L.scriptSettings[D])==null?void 0:ai.spread)==null?void 0:li.buy)||0,onChange:z=>F(K=>{var Z;return{...K,scriptSettings:{...K.scriptSettings,[D]:{...K.scriptSettings[D],spread:{...(Z=K.scriptSettings[D])==null?void 0:Z.spread,buy:Number(z.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500",children:"Sell Spread"}),n.jsx("input",{type:"number",step:"0.01",value:((ci=(oi=L.scriptSettings[D])==null?void 0:oi.spread)==null?void 0:ci.sell)||0,onChange:z=>F(K=>{var Z;return{...K,scriptSettings:{...K.scriptSettings,[D]:{...K.scriptSettings[D],spread:{...(Z=K.scriptSettings[D])==null?void 0:Z.spread,sell:Number(z.target.value)}}}}}),className:"w-full bg-dark-600 border border-dark-500 rounded px-2 py-1 text-xs"})]})]})}),((di=L.scriptSettings[D])==null?void 0:di.settingType)==="BLOCK"&&n.jsx("div",{className:"bg-dark-700 rounded p-3",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("label",{className:"text-xs text-gray-500",children:"Block Future"}),n.jsx("button",{type:"button",onClick:()=>F(z=>{var K,Z,Ye;return{...z,scriptSettings:{...z.scriptSettings,[D]:{...z.scriptSettings[D],block:{...(K=z.scriptSettings[D])==null?void 0:K.block,future:!((Ye=(Z=z.scriptSettings[D])==null?void 0:Z.block)!=null&&Ye.future)}}}}}),className:`px-3 py-1 rounded text-xs font-medium ${(hi=(ui=L.scriptSettings[D])==null?void 0:ui.block)!=null&&hi.future?"bg-red-600 text-white":"bg-green-600 text-white"}`,children:(pi=(mi=L.scriptSettings[D])==null?void 0:mi.block)!=null&&pi.future?"Yes":"No"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("label",{className:"text-xs text-gray-500",children:"Block Option"}),n.jsx("button",{type:"button",onClick:()=>F(z=>{var K,Z,Ye;return{...z,scriptSettings:{...z.scriptSettings,[D]:{...z.scriptSettings[D],block:{...(K=z.scriptSettings[D])==null?void 0:K.block,option:!((Ye=(Z=z.scriptSettings[D])==null?void 0:Z.block)!=null&&Ye.option)}}}}}),className:`px-3 py-1 rounded text-xs font-medium ${(fi=(xi=L.scriptSettings[D])==null?void 0:xi.block)!=null&&fi.option?"bg-red-600 text-white":"bg-green-600 text-white"}`,children:(yi=(gi=L.scriptSettings[D])==null?void 0:gi.block)!=null&&yi.option?"Yes":"No"})]})]})})]})]})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>{w(!1),k(null),F(null)},className:"flex-1 bg-dark-600 hover:bg-dark-500 text-white py-2 rounded-lg",children:"Cancel"}),n.jsx("button",{onClick:ue,disabled:j,className:"flex-1 bg-purple-600 hover:bg-purple-700 disabled:opacity-50 text-white py-2 rounded-lg",children:j?"Saving...":"Save Settings"})]})]})}),v&&n.jsx(bg,{onClose:()=>S(!1),token:t.token,users:e,admins:[],isSuperAdmin:!1})]})},pk=({onClose:t,onSuccess:e,token:s})=>{const[r,i]=g.useState({username:"",email:"",password:"",fullName:"",phone:"",isActive:!0,isReadOnly:!1}),[a,l]=g.useState(!1),[o,c]=g.useState(!1),[d,m]=g.useState(""),u=async h=>{var x,y;h.preventDefault(),c(!0),m("");try{await I.post("/api/admin/users",r,{headers:{Authorization:`Bearer ${s}`}}),e()}catch(f){m(((y=(x=f.response)==null?void 0:x.data)==null?void 0:y.message)||"Error creating user")}finally{c(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg w-full max-w-md p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Create New User"}),n.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white",children:n.jsx(ve,{size:24})})]}),d&&n.jsx("div",{className:"bg-red-500/20 border border-red-500 text-red-400 px-4 py-2 rounded mb-4",children:d}),n.jsxs("form",{onSubmit:u,children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Username *"}),n.jsx("input",{type:"text",value:r.username,onChange:h=>i({...r,username:h.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 focus:outline-none focus:border-green-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Email *"}),n.jsx("input",{type:"email",value:r.email,onChange:h=>i({...r,email:h.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 focus:outline-none focus:border-green-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Password *"}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:a?"text":"password",value:r.password,onChange:h=>i({...r,password:h.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 pr-10 focus:outline-none focus:border-green-500",required:!0}),n.jsx("button",{type:"button",onClick:()=>l(!a),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",children:a?n.jsx(Gn,{size:18}):n.jsx(wn,{size:18})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Full Name"}),n.jsx("input",{type:"text",value:r.fullName,onChange:h=>i({...r,fullName:h.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 focus:outline-none focus:border-green-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Phone"}),n.jsx("input",{type:"text",value:r.phone,onChange:h=>i({...r,phone:h.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 focus:outline-none focus:border-green-500"})]}),n.jsxs("div",{className:"border-t border-dark-600 pt-4 mt-4",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Account Controls"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-sm font-medium",children:"Account Active"}),n.jsx("p",{className:"text-xs text-gray-500",children:"If disabled, user cannot login"})]}),n.jsx("button",{type:"button",onClick:()=>i({...r,isActive:!r.isActive}),className:`w-12 h-6 rounded-full transition-colors ${r.isActive?"bg-green-600":"bg-dark-600"}`,children:n.jsx("div",{className:`w-5 h-5 bg-white rounded-full transition-transform ${r.isActive?"translate-x-6":"translate-x-0.5"}`})})]}),n.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-sm font-medium",children:"Read Only Mode"}),n.jsx("p",{className:"text-xs text-gray-500",children:"User can only view & close trades, cannot open new"})]}),n.jsx("button",{type:"button",onClick:()=>i({...r,isReadOnly:!r.isReadOnly}),className:`w-12 h-6 rounded-full transition-colors ${r.isReadOnly?"bg-orange-600":"bg-dark-600"}`,children:n.jsx("div",{className:`w-5 h-5 bg-white rounded-full transition-transform ${r.isReadOnly?"translate-x-6":"translate-x-0.5"}`})})]})]})]})]}),n.jsxs("div",{className:"flex gap-3 mt-6",children:[n.jsx("button",{type:"button",onClick:t,className:"flex-1 bg-dark-600 hover:bg-dark-500 py-2 rounded transition",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:o,className:"flex-1 bg-green-600 hover:bg-green-700 py-2 rounded transition disabled:opacity-50",children:o?"Creating...":"Create User"})]})]})]})})},xk=({user:t,onClose:e,onSuccess:s,token:r})=>{const[i,a]=g.useState({username:t.username,email:t.email,fullName:t.fullName||"",phone:t.phone||"",isActive:t.isActive,isReadOnly:t.isReadOnly||!1}),[l,o]=g.useState(!1),[c,d]=g.useState(""),m=async u=>{var h,x;u.preventDefault(),o(!0),d("");try{await I.put(`/api/admin/users/${t._id}`,i,{headers:{Authorization:`Bearer ${r}`}}),s()}catch(y){d(((x=(h=y.response)==null?void 0:h.data)==null?void 0:x.message)||"Error updating user")}finally{o(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg w-full max-w-md p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Edit User"}),n.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white",children:n.jsx(ve,{size:24})})]}),c&&n.jsx("div",{className:"bg-red-500/20 border border-red-500 text-red-400 px-4 py-2 rounded mb-4",children:c}),n.jsxs("form",{onSubmit:m,children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Username"}),n.jsx("input",{type:"text",value:i.username,onChange:u=>a({...i,username:u.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 focus:outline-none focus:border-green-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Email"}),n.jsx("input",{type:"email",value:i.email,onChange:u=>a({...i,email:u.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 focus:outline-none focus:border-green-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Full Name"}),n.jsx("input",{type:"text",value:i.fullName,onChange:u=>a({...i,fullName:u.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 focus:outline-none focus:border-green-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Phone"}),n.jsx("input",{type:"text",value:i.phone,onChange:u=>a({...i,phone:u.target.value}),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 focus:outline-none focus:border-green-500"})]}),n.jsxs("div",{className:"border-t border-dark-600 pt-4 mt-4",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Account Controls"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-sm font-medium",children:"Account Active"}),n.jsx("p",{className:"text-xs text-gray-500",children:"If disabled, user cannot login"})]}),n.jsx("button",{type:"button",onClick:()=>a({...i,isActive:!i.isActive}),className:`w-12 h-6 rounded-full transition-colors ${i.isActive?"bg-green-600":"bg-dark-600"}`,children:n.jsx("div",{className:`w-5 h-5 bg-white rounded-full transition-transform ${i.isActive?"translate-x-6":"translate-x-0.5"}`})})]}),n.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-sm font-medium",children:"Read Only Mode"}),n.jsx("p",{className:"text-xs text-gray-500",children:"User can only view & close trades, cannot open new"})]}),n.jsx("button",{type:"button",onClick:()=>a({...i,isReadOnly:!i.isReadOnly}),className:`w-12 h-6 rounded-full transition-colors ${i.isReadOnly?"bg-orange-600":"bg-dark-600"}`,children:n.jsx("div",{className:`w-5 h-5 bg-white rounded-full transition-transform ${i.isReadOnly?"translate-x-6":"translate-x-0.5"}`})})]})]})]})]}),n.jsxs("div",{className:"flex gap-3 mt-6",children:[n.jsx("button",{type:"button",onClick:e,className:"flex-1 bg-dark-600 hover:bg-dark-500 py-2 rounded transition",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:l,className:"flex-1 bg-green-600 hover:bg-green-700 py-2 rounded transition disabled:opacity-50",children:l?"Saving...":"Save Changes"})]})]})]})})},fk=({user:t,onClose:e,token:s})=>{const[r,i]=g.useState(""),[a,l]=g.useState(!1),[o,c]=g.useState(!1),[d,m]=g.useState(""),[u,h]=g.useState(!1),x=async y=>{var f,w;y.preventDefault(),c(!0),m("");try{await I.put(`/api/admin/users/${t._id}/password`,{newPassword:r},{headers:{Authorization:`Bearer ${s}`}}),h(!0),setTimeout(e,1500)}catch(p){m(((w=(f=p.response)==null?void 0:f.data)==null?void 0:w.message)||"Error changing password")}finally{c(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg w-full max-w-md p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Change Password"}),n.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white",children:n.jsx(ve,{size:24})})]}),n.jsxs("p",{className:"text-gray-400 mb-4",children:["Changing password for: ",n.jsx("span",{className:"text-white",children:t.username})]}),d&&n.jsx("div",{className:"bg-red-500/20 border border-red-500 text-red-400 px-4 py-2 rounded mb-4",children:d}),u&&n.jsx("div",{className:"bg-green-500/20 border border-green-500 text-green-400 px-4 py-2 rounded mb-4",children:"Password changed successfully!"}),n.jsxs("form",{onSubmit:x,children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"New Password"}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:a?"text":"password",value:r,onChange:y=>i(y.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 pr-10 focus:outline-none focus:border-green-500",required:!0,minLength:6}),n.jsx("button",{type:"button",onClick:()=>l(!a),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",children:a?n.jsx(Gn,{size:18}):n.jsx(wn,{size:18})})]})]}),n.jsxs("div",{className:"flex gap-3 mt-6",children:[n.jsx("button",{type:"button",onClick:e,className:"flex-1 bg-dark-600 hover:bg-dark-500 py-2 rounded transition",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:o||u,className:"flex-1 bg-yellow-600 hover:bg-yellow-700 py-2 rounded transition disabled:opacity-50",children:o?"Changing...":"Change Password"})]})]})]})})},gk=({user:t,onClose:e,onSuccess:s,token:r})=>{var S,N,k,j,E,_;const{admin:i,updateAdmin:a}=we(),[l,o]=g.useState(""),[c,d]=g.useState(""),[m,u]=g.useState(!1),[h,x]=g.useState(""),[y,f]=g.useState(null),[w,p]=g.useState(((S=i==null?void 0:i.wallet)==null?void 0:S.balance)||0);g.useEffect(()=>{b()},[]);const b=async()=>{try{const{data:M}=await I.get(`/api/admin/manage/users/${t._id}`,{headers:{Authorization:`Bearer ${r}`}});f(M)}catch(M){console.error("Error fetching wallet:",M)}},v=async M=>{var V,B;if(!l||Number(l)<=0){x("Please enter a valid amount");return}u(!0),x("");try{const R=M==="deposit"?`/api/admin/manage/users/${t._id}/add-funds`:`/api/admin/manage/users/${t._id}/deduct-funds`,{data:O}=await I.post(R,{amount:Number(l),description:c},{headers:{Authorization:`Bearer ${r}`}});o(""),d(""),b(),s(),O.adminWallet&&(p(O.adminWallet.balance),a({wallet:O.adminWallet}))}catch(R){x(((B=(V=R.response)==null?void 0:V.data)==null?void 0:B.message)||`Error ${M}ing funds`)}finally{u(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-dark-800 rounded-lg w-full max-w-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Manage Wallet"}),n.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white",children:n.jsx(ve,{size:24})})]}),(i==null?void 0:i.role)==="ADMIN"&&n.jsxs("div",{className:"bg-purple-500/10 border border-purple-500/30 rounded-lg p-3 mb-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-sm text-purple-400",children:"Your Wallet Balance"}),n.jsxs("span",{className:"text-lg font-bold text-purple-400",children:["",w.toLocaleString()]})]}),n.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Funds will be deducted from your wallet when depositing to user"})]}),n.jsxs("div",{className:"bg-dark-700 rounded-lg p-4 mb-4",children:[n.jsxs("p",{className:"text-gray-400 text-sm",children:["User: ",t.fullName||t.username]}),n.jsxs("p",{className:"text-2xl font-bold text-green-400 mt-1",children:["",(((N=y==null?void 0:y.wallet)==null?void 0:N.cashBalance)||((k=y==null?void 0:y.wallet)==null?void 0:k.balance)||0).toLocaleString()]}),n.jsxs("p",{className:"text-sm text-gray-400",children:["Cash Balance: ",(((j=y==null?void 0:y.wallet)==null?void 0:j.cashBalance)||0).toLocaleString()]})]}),h&&n.jsx("div",{className:"bg-red-500/20 border border-red-500 text-red-400 px-4 py-2 rounded mb-4",children:h}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Amount ()"}),n.jsx("input",{type:"number",value:l,onChange:M=>o(M.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 focus:outline-none focus:border-green-500",placeholder:"Enter amount",min:"0"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Description (Optional)"}),n.jsx("input",{type:"text",value:c,onChange:M=>d(M.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 focus:outline-none focus:border-green-500",placeholder:"Transaction note"})]})]}),n.jsxs("div",{className:"flex gap-3 mt-6",children:[n.jsxs("button",{onClick:()=>v("deposit"),disabled:m,className:"flex-1 flex items-center justify-center gap-2 bg-green-600 hover:bg-green-700 py-2 rounded transition disabled:opacity-50",children:[n.jsx(Vn,{size:18}),"Deposit"]}),n.jsxs("button",{onClick:()=>v("withdraw"),disabled:m,className:"flex-1 flex items-center justify-center gap-2 bg-red-600 hover:bg-red-700 py-2 rounded transition disabled:opacity-50",children:[n.jsx(Wn,{size:18}),"Withdraw"]})]}),((_=(E=y==null?void 0:y.wallet)==null?void 0:E.transactions)==null?void 0:_.length)>0&&n.jsxs("div",{className:"mt-6",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Recent Transactions"}),n.jsx("div",{className:"max-h-40 overflow-y-auto space-y-2",children:y.wallet.transactions.slice(-5).reverse().map((M,V)=>n.jsxs("div",{className:"flex items-center justify-between bg-dark-700 rounded px-3 py-2 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:M.type==="deposit"||M.type==="credit"?"text-green-400":"text-red-400",children:M.type.toUpperCase()}),n.jsx("span",{className:"text-gray-400 ml-2",children:M.description})]}),n.jsxs("span",{className:M.type==="deposit"||M.type==="credit"?"text-green-400":"text-red-400",children:[M.type==="deposit"||M.type==="credit"?"+":"-","",M.amount]})]},V))})]}),n.jsx("button",{onClick:e,className:"w-full mt-4 bg-dark-600 hover:bg-dark-500 py-2 rounded transition",children:"Close"})]})})},yk=()=>{const[t]=$N(),e=t.get("ref")||"",[s,r]=g.useState(t.get("register")==="true"||!!e),[i,a]=g.useState({username:"",email:"",password:"",fullName:"",phone:"",adminCode:"",referralCode:e}),[l,o]=g.useState({brandName:"",logoUrl:"",welcomeTitle:""});g.useEffect(()=>{(async()=>{if(e)try{const{data:S}=await I.get(`/api/admin/branding/${e}`);o(S)}catch(S){console.error("Failed to fetch branding:",S)}})()},[e]);const[c,d]=g.useState(!1),[m,u]=g.useState(""),[h,x]=g.useState(!1),{loginUser:y,registerUser:f}=we(),w=rs(),p=async v=>{var S,N;v.preventDefault(),u(""),x(!0);try{s?await f(i):await y(i.email,i.password),w("/user/home")}catch(k){u(((N=(S=k.response)==null?void 0:S.data)==null?void 0:N.message)||"Something went wrong")}finally{x(!1)}},b=()=>{r(!s),u(""),a({username:"",email:"",password:"",fullName:"",phone:"",adminCode:"",referralCode:e})};return n.jsxs("div",{className:"min-h-screen bg-dark-900 flex",children:[n.jsxs("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-8 relative",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-green-900/20 to-dark-900"}),n.jsxs("div",{className:"w-full max-w-md relative z-10",children:[n.jsxs("div",{className:"text-center mb-8",children:[l.logoUrl&&n.jsx("img",{src:l.logoUrl,alt:"Logo",className:"h-20 mx-auto mb-4 object-contain"}),l.welcomeTitle?n.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:l.welcomeTitle}):l.brandName?n.jsxs("h1",{className:"text-2xl font-bold text-white mb-2",children:["Welcome to ",l.brandName]}):n.jsx("p",{className:"text-gray-400",children:"Welcome back, trader!"})]}),n.jsxs("div",{className:"bg-dark-800/90 backdrop-blur-xl p-8 rounded-2xl border border-green-500/20 shadow-2xl",children:[n.jsxs("div",{className:"text-center mb-6",children:[n.jsx("h2",{className:"text-2xl font-bold text-white",children:s?"Create Account":"Sign In"}),n.jsx("p",{className:"text-gray-400 mt-2",children:s?"Start your trading journey":"Access your trading dashboard"})]}),m&&n.jsx("div",{className:"bg-red-500/20 border border-red-500 text-red-400 px-4 py-3 rounded-lg mb-6",children:m}),n.jsxs("form",{onSubmit:p,children:[s&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Full Name"}),n.jsx("input",{type:"text",value:i.fullName,onChange:v=>a({...i,fullName:v.target.value}),className:"w-full bg-dark-700 border border-green-500/30 rounded-lg px-4 py-3 focus:outline-none focus:border-green-500 transition",placeholder:"John Doe",required:!0})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Username"}),n.jsx("input",{type:"text",value:i.username,onChange:v=>a({...i,username:v.target.value}),className:"w-full bg-dark-700 border border-green-500/30 rounded-lg px-4 py-3 focus:outline-none focus:border-green-500 transition",placeholder:"johndoe",required:!0})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Phone Number"}),n.jsx("input",{type:"tel",value:i.phone,onChange:v=>a({...i,phone:v.target.value}),className:"w-full bg-dark-700 border border-green-500/30 rounded-lg px-4 py-3 focus:outline-none focus:border-green-500 transition",placeholder:"+91 9876543210"})]})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Email Address"}),n.jsx("input",{type:"email",value:i.email,onChange:v=>a({...i,email:v.target.value}),className:"w-full bg-dark-700 border border-green-500/30 rounded-lg px-4 py-3 focus:outline-none focus:border-green-500 transition",placeholder:"trader@example.com",required:!0})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Password"}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:c?"text":"password",value:i.password,onChange:v=>a({...i,password:v.target.value}),className:"w-full bg-dark-700 border border-green-500/30 rounded-lg px-4 py-3 pr-12 focus:outline-none focus:border-green-500 transition",placeholder:s?"Create password":"Enter password",required:!0,minLength:s?6:void 0}),n.jsx("button",{type:"button",onClick:()=>d(!c),className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white",children:c?n.jsx(Gn,{size:20}):n.jsx(wn,{size:20})})]})]}),n.jsx("button",{type:"submit",disabled:h,className:"w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 py-3 rounded-lg font-semibold transition disabled:opacity-50 shadow-lg shadow-green-500/25",children:h?"Please wait...":s?"Create Account":"Start Trading"}),n.jsx("button",{type:"button",onClick:b,className:"w-full mt-4 text-sm text-green-400 hover:text-green-300 transition",children:s?"Already have an account? Sign In":"Don't have an account? Create one"})]})]})]})]}),n.jsxs("div",{className:"hidden lg:flex lg:w-1/2 flex-col justify-center items-center p-12 relative overflow-hidden bg-gradient-to-br from-dark-800 to-dark-900",children:[n.jsx("div",{className:"absolute top-10 right-10 w-96 h-96 bg-green-500/10 rounded-full blur-3xl"}),n.jsx("div",{className:"absolute bottom-10 left-10 w-72 h-72 bg-emerald-500/10 rounded-full blur-3xl"}),n.jsx("div",{className:"absolute inset-0 opacity-10",children:n.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 800 600",children:[n.jsx("path",{d:"M0,300 Q100,250 200,280 T400,260 T600,300 T800,250",fill:"none",stroke:"#22c55e",strokeWidth:"2"}),n.jsx("path",{d:"M0,350 Q150,300 300,330 T500,310 T700,350 T800,300",fill:"none",stroke:"#10b981",strokeWidth:"2"})]})}),n.jsxs("div",{className:"relative z-10 text-center",children:[n.jsx("h1",{className:"text-4xl font-bold text-white mb-4",children:"Trade Smarter"}),n.jsx("p",{className:"text-xl text-gray-400 mb-12",children:"NSE  BSE  MCX  F&O"}),n.jsxs("div",{className:"grid grid-cols-2 gap-6 max-w-md",children:[n.jsxs("div",{className:"bg-dark-700/50 backdrop-blur-sm rounded-xl p-6 text-left border border-green-500/10",children:[n.jsx(mg,{className:"w-8 h-8 text-green-400 mb-3"}),n.jsx("h3",{className:"font-semibold text-white mb-1",children:"Live Charts"}),n.jsx("p",{className:"text-sm text-gray-400",children:"Real-time TradingView charts"})]}),n.jsxs("div",{className:"bg-dark-700/50 backdrop-blur-sm rounded-xl p-6 text-left border border-green-500/10",children:[n.jsx(yg,{className:"w-8 h-8 text-yellow-400 mb-3"}),n.jsx("h3",{className:"font-semibold text-white mb-1",children:"Fast Execution"}),n.jsx("p",{className:"text-sm text-gray-400",children:"Lightning fast orders"})]}),n.jsxs("div",{className:"bg-dark-700/50 backdrop-blur-sm rounded-xl p-6 text-left border border-green-500/10",children:[n.jsx(ah,{className:"w-8 h-8 text-blue-400 mb-3"}),n.jsx("h3",{className:"font-semibold text-white mb-1",children:"All Segments"}),n.jsx("p",{className:"text-sm text-gray-400",children:"Equity, F&O, Commodities"})]}),n.jsxs("div",{className:"bg-dark-700/50 backdrop-blur-sm rounded-xl p-6 text-left border border-green-500/10",children:[n.jsx(Ge,{className:"w-8 h-8 text-purple-400 mb-3"}),n.jsx("h3",{className:"font-semibold text-white mb-1",children:"Secure Wallet"}),n.jsx("p",{className:"text-sm text-gray-400",children:"Safe fund management"})]})]}),n.jsxs("div",{className:"mt-12 flex items-center justify-center gap-8 text-sm",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-gray-500",children:"NIFTY 50"}),n.jsx("div",{className:"text-green-400 font-mono",children:"--"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-gray-500",children:"BANKNIFTY"}),n.jsx("div",{className:"text-green-400 font-mono",children:"--"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-gray-500",children:"SENSEX"}),n.jsx("div",{className:"text-red-400 font-mono",children:"--"})]})]})]})]})]})},bk=({trades:t=[],walletData:e})=>{const s=t.filter(m=>m.status==="CLOSED"),r=s.length,i=s.filter(m=>(m.pnl||0)>0).length,a=r>0?Math.round(i/r*100):0,l=s.reduce((m,u)=>m+Math.max(0,u.pnl||0),0),o=s.reduce((m,u)=>m+Math.abs(Math.min(0,u.pnl||0)),0),c=i>0?l/i:0,d=r-i>0?o/(r-i):0;return n.jsxs("div",{className:"bg-dark-800 rounded-xl p-4",children:[n.jsx("h3",{className:"font-semibold mb-4",children:"Quick Stats"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-gray-400 text-sm",children:"Total Trades"}),n.jsx("span",{className:"font-medium",children:r})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-gray-400 text-sm",children:"Win Rate"}),n.jsxs("span",{className:`font-medium ${a>=50?"text-green-400":"text-red-400"}`,children:[a,"%"]})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-gray-400 text-sm",children:"Avg. Profit"}),n.jsxs("span",{className:"font-medium text-green-400",children:["+",c.toLocaleString()]})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-gray-400 text-sm",children:"Avg. Loss"}),n.jsxs("span",{className:"font-medium text-red-400",children:["",d.toLocaleString()]})]})]})]})},vk=()=>{const[t,e]=g.useState([]),[s,r]=g.useState(!0);g.useEffect(()=>{e([{id:1,title:"Fed Officials Signal Cautious Approach to Rate Cuts in 2026",source:"Reuters",time:"2h ago",impact:"high"},{id:2,title:"Asian Markets Mixed Ahead of US Jobs Data",source:"Bloomberg",time:"3h ago",impact:"medium"},{id:3,title:"Gold Prices Steady as Dollar Weakens",source:"CNBC",time:"4h ago",impact:"low"},{id:4,title:"Oil Rises on Supply Concerns",source:"Reuters",time:"5h ago",impact:"medium"},{id:5,title:"Tech Stocks Lead Wall Street Higher",source:"MarketWatch",time:"6h ago",impact:"high"}]),r(!1)},[]);const i=a=>{switch(a){case"high":return"bg-red-500";case"medium":return"bg-yellow-500";default:return"bg-green-500"}};return n.jsxs("div",{className:"bg-dark-800 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Rw,{size:18,className:"text-blue-400"}),n.jsx("h3",{className:"font-semibold",children:"Market News"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-xs text-gray-400",children:[t.length," articles today"]}),n.jsxs("span",{className:"flex items-center gap-1 text-xs bg-green-500/20 text-green-400 px-2 py-0.5 rounded",children:[n.jsx("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),"Live"]})]})]}),s?n.jsx("div",{className:"flex items-center justify-center py-8",children:n.jsx(fe,{className:"animate-spin text-gray-400",size:24})}):n.jsx("div",{className:"space-y-3 max-h-[300px] overflow-y-auto",children:t.map(a=>n.jsxs("div",{className:"flex items-start gap-3 p-2 hover:bg-dark-700 rounded-lg cursor-pointer transition",children:[n.jsx("div",{className:`w-1 h-full min-h-[40px] rounded ${i(a.impact)}`}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-sm font-medium line-clamp-2",children:a.title}),n.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-500",children:[n.jsx("span",{children:a.source}),n.jsx("span",{children:""}),n.jsx("span",{children:a.time})]})]}),n.jsx(Sw,{size:14,className:"text-gray-500 flex-shrink-0 mt-1"})]},a.id))})]})},Nk=()=>{const[t,e]=g.useState([]),s=new Date;return g.useEffect(()=>{e([{id:1,time:"09:00",currency:"USD",event:"Non-Farm Payrolls",impact:"high",forecast:"180K",previous:"175K"},{id:2,time:"14:30",currency:"EUR",event:"ECB Interest Rate Decision",impact:"high",forecast:"4.25%",previous:"4.25%"},{id:3,time:"16:00",currency:"GBP",event:"Manufacturing PMI",impact:"medium",forecast:"52.1",previous:"51.8"},{id:4,time:"18:30",currency:"USD",event:"ISM Services PMI",impact:"medium",forecast:"54.0",previous:"53.8"}])},[]),n.jsxs("div",{className:"bg-dark-800 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Cw,{size:18,className:"text-purple-400"}),n.jsx("h3",{className:"font-semibold",children:"Economic Calendar"})]}),n.jsx("span",{className:"text-xs bg-purple-500/20 text-purple-400 px-2 py-1 rounded",children:s.toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),n.jsxs("div",{className:"text-xs text-gray-500 mb-3",children:[t.length," events today"]}),n.jsxs("div",{className:"space-y-2 max-h-[250px] overflow-y-auto",children:[n.jsxs("div",{className:"grid grid-cols-5 gap-2 text-xs text-gray-500 pb-2 border-b border-dark-600",children:[n.jsx("span",{children:"Time"}),n.jsx("span",{children:"Cur"}),n.jsx("span",{className:"col-span-2",children:"Event"}),n.jsx("span",{children:"Forecast"})]}),t.map(r=>n.jsxs("div",{className:"grid grid-cols-5 gap-2 text-sm items-center py-2 hover:bg-dark-700 rounded px-1",children:[n.jsx("span",{className:"text-gray-400",children:r.time}),n.jsx("span",{className:"font-medium",children:r.currency}),n.jsx("span",{className:"col-span-2 truncate",children:r.event}),n.jsx("span",{className:"text-gray-300",children:r.forecast})]},r.id))]})]})},jk=()=>(g.useEffect(()=>{const t=document.createElement("script");t.src="https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js",t.async=!0,t.innerHTML=JSON.stringify({symbols:[{proName:"FOREXCOM:SPXUSD",title:"S&P 500"},{proName:"FOREXCOM:NSXUSD",title:"US 100"},{proName:"FX_IDC:EURUSD",title:"EUR/USD"},{proName:"BITSTAMP:BTCUSD",title:"Bitcoin"},{proName:"BITSTAMP:ETHUSD",title:"Ethereum"},{proName:"NSE:NIFTY",title:"NIFTY 50"},{proName:"NSE:BANKNIFTY",title:"BANK NIFTY"}],showSymbolLogo:!0,colorTheme:"dark",isTransparent:!0,displayMode:"adaptive",locale:"en"});const e=document.getElementById("tradingview-widget");if(e){e.innerHTML="";const s=document.createElement("div");s.className="tradingview-widget-container";const r=document.createElement("div");r.className="tradingview-widget-container__widget",s.appendChild(r),s.appendChild(t),e.appendChild(s)}return()=>{const s=document.getElementById("tradingview-widget");s&&(s.innerHTML="")}},[]),n.jsx("div",{id:"tradingview-widget",className:"h-[50px] overflow-hidden rounded-lg bg-dark-800"})),dp=()=>{var S;const{user:t}=we(),[e,s]=g.useState(null),[r,i]=g.useState([]),[a,l]=g.useState(!0),[o,c]=g.useState(new Date);g.useEffect(()=>{d();const N=setInterval(()=>c(new Date),1e3);return()=>clearInterval(N)},[]);const d=async()=>{try{const[N,k]=await Promise.all([I.get("/api/user/wallet",{headers:{Authorization:`Bearer ${t.token}`}}),I.get("/api/trade/history",{headers:{Authorization:`Bearer ${t.token}`}})]);s(N.data),i(k.data||[])}catch(N){console.error("Error fetching data:",N)}finally{l(!1)}},m=r.filter(N=>N.status==="CLOSED"),h=m.filter(N=>{const k=new Date(N.exitTime),j=new Date;return k.toDateString()===j.toDateString()}).reduce((N,k)=>N+(k.pnl||0),0),x=new Date;x.setDate(x.getDate()-7);const f=m.filter(N=>new Date(N.exitTime)>=x).reduce((N,k)=>N+(k.pnl||0),0),w=new Date;w.setDate(1);const b=m.filter(N=>new Date(N.exitTime)>=w).reduce((N,k)=>N+(k.pnl||0),0),v=()=>{const N=o.getHours();return N<12?"Good Morning":N<17?"Good Afternoon":"Good Evening"};return a?n.jsx("div",{className:"flex items-center justify-center h-full",children:n.jsx(fe,{className:"animate-spin text-green-400",size:32})}):n.jsxs("div",{className:"p-4 md:p-6 overflow-y-auto h-full",children:[n.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"text-2xl font-bold",children:[v(),", ",(t==null?void 0:t.fullName)||(t==null?void 0:t.username),"! "]}),n.jsx("p",{className:"text-gray-400",children:"Here's your trading overview"})]}),n.jsxs("div",{className:"flex items-center gap-4 mt-4 md:mt-0",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[n.jsx(lh,{size:16}),n.jsx("span",{children:o.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})]}),n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(dg,{size:16,className:"text-gray-400"}),n.jsx("span",{className:"font-mono",children:o.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"})})]})]})]}),n.jsx("div",{className:"mb-6",children:n.jsx(jk,{})}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[n.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl p-4 relative overflow-hidden",children:[n.jsx("div",{className:"absolute top-2 right-2",children:n.jsx("button",{className:"text-xs bg-white/20 hover:bg-white/30 px-2 py-1 rounded transition",children:"Deposit"})}),n.jsx("div",{className:"flex items-center gap-2 mb-2",children:n.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center",children:n.jsx(Ge,{size:20})})}),n.jsx("div",{className:"text-sm text-white/70",children:"Wallet Balance"}),n.jsxs("div",{className:"text-2xl font-bold",children:["",(((S=e==null?void 0:e.wallet)==null?void 0:S.balance)||0).toLocaleString()]})]}),n.jsxs("div",{className:"bg-gradient-to-br from-green-600 to-emerald-600 rounded-xl p-4 relative overflow-hidden",children:[n.jsx("div",{className:"absolute top-2 right-2",children:n.jsxs("span",{className:"text-xs bg-white/20 px-2 py-1 rounded flex items-center gap-1",children:[n.jsx("span",{className:"w-1.5 h-1.5 bg-white rounded-full animate-pulse"}),"Today"]})}),n.jsx("div",{className:"flex items-center gap-2 mb-2",children:n.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center",children:h>=0?n.jsx(gs,{size:20}):n.jsx(fg,{size:20})})}),n.jsx("div",{className:"text-sm text-white/70",children:"Today's P&L"}),n.jsxs("div",{className:"text-2xl font-bold",children:[h>=0?"+":"","",h.toLocaleString()]})]}),n.jsxs("div",{className:"bg-gradient-to-br from-purple-600 to-violet-600 rounded-xl p-4 relative overflow-hidden",children:[n.jsx("div",{className:"absolute top-2 right-2",children:n.jsxs("span",{className:"text-xs bg-white/20 px-2 py-1 rounded flex items-center gap-1",children:[n.jsx(Mr,{size:12}),"7 Days"]})}),n.jsx("div",{className:"flex items-center gap-2 mb-2",children:n.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center",children:f>=0?n.jsx(vw,{size:20}):n.jsx(yw,{size:20})})}),n.jsx("div",{className:"text-sm text-white/70",children:"Weekly P&L"}),n.jsxs("div",{className:"text-2xl font-bold",children:[f>=0?"+":"","",f.toLocaleString()]})]}),n.jsxs("div",{className:"bg-gradient-to-br from-yellow-600 to-orange-600 rounded-xl p-4 relative overflow-hidden",children:[n.jsx("div",{className:"absolute top-2 right-2",children:n.jsxs("span",{className:"text-xs bg-white/20 px-2 py-1 rounded flex items-center gap-1",children:[n.jsx(Aw,{size:12}),"30 Days"]})}),n.jsx("div",{className:"flex items-center gap-2 mb-2",children:n.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center",children:n.jsx(kw,{size:20})})}),n.jsx("div",{className:"text-sm text-white/70",children:"Monthly P&L"}),n.jsxs("div",{className:"text-2xl font-bold",children:[b>=0?"+":"","",b.toLocaleString()]})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsx("div",{className:"md:col-span-1 space-y-6",children:n.jsx(vk,{})}),n.jsxs("div",{className:"md:col-span-1 space-y-6",children:[n.jsx(bk,{trades:r,walletData:e}),n.jsx(Nk,{})]})]})]})},wk=()=>{var p,b,v,S,N,k,j,E,_,M,V;const{user:t}=we(),e=rs(),[s,r]=g.useState(null),[i,a]=g.useState(!0),[l,o]=g.useState(!1),[c,d]=g.useState("toAccount");g.useEffect(()=>{m()},[]);const m=async()=>{try{const{data:B}=await I.get("/api/user/wallet",{headers:{Authorization:`Bearer ${t.token}`}});r(B)}catch(B){console.error("Error fetching wallet:",B)}finally{a(!1)}},u=()=>{e("/user/trader-room")},h=B=>{d(B),o(!0)},x=(s==null?void 0:s.cashBalance)||((p=s==null?void 0:s.wallet)==null?void 0:p.cashBalance)||((b=s==null?void 0:s.wallet)==null?void 0:b.balance)||0,y=(s==null?void 0:s.tradingBalance)||((v=s==null?void 0:s.wallet)==null?void 0:v.tradingBalance)||0,f=(s==null?void 0:s.usedMargin)||((S=s==null?void 0:s.wallet)==null?void 0:S.usedMargin)||((N=s==null?void 0:s.wallet)==null?void 0:N.blocked)||0,w=y-f;return i?n.jsx("div",{className:"flex items-center justify-center h-full",children:n.jsx(fe,{className:"animate-spin text-green-400",size:32})}):n.jsxs("div",{className:"p-4 md:p-6 overflow-y-auto h-full",children:[n.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("h1",{className:"text-2xl font-bold",children:"My Accounts"}),n.jsx("button",{onClick:m,className:"text-gray-400 hover:text-white",children:n.jsx(fe,{size:18})})]})}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.jsxs("div",{className:"bg-dark-800 rounded-xl overflow-hidden",children:[n.jsx("div",{className:"p-4 border-b border-dark-600",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-dark-700 rounded-lg flex items-center justify-center",children:n.jsx(Ge,{size:20,className:"text-gray-400"})}),n.jsxs("div",{children:[n.jsxs("div",{className:"font-semibold",children:["IND-",((k=t==null?void 0:t.userId)==null?void 0:k.slice(-5))||"00000"]}),n.jsx("div",{className:"text-xs text-gray-500",children:"STANDARD"})]})]}),n.jsx("button",{className:"text-gray-400 hover:text-white",children:n.jsx(xg,{size:20})})]})}),n.jsxs("div",{className:"p-6 bg-gradient-to-br from-dark-900 to-dark-800",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx("span",{className:"w-2 h-2 bg-green-400 rounded-full"}),n.jsx("span",{className:"text-sm text-green-400",children:"Trading Account"})]}),n.jsxs("div",{className:"text-4xl font-bold mb-1",children:["",y.toLocaleString("en-IN",{minimumFractionDigits:2})]}),n.jsx("div",{className:"text-sm text-gray-500",children:"Trading Balance"}),f>0&&n.jsxs("div",{className:"text-xs text-yellow-400 mt-1",children:["Margin Used: ",f.toLocaleString()," | Available: ",w.toLocaleString()]})]}),n.jsxs("div",{className:"p-4 flex gap-2",children:[n.jsxs("button",{onClick:u,className:"flex-1 flex items-center justify-center gap-2 bg-orange-600 hover:bg-orange-700 py-3 rounded-lg font-medium transition",children:[n.jsx(Ew,{size:18}),"Trade"]}),n.jsxs("button",{onClick:()=>h("toAccount"),className:"flex items-center justify-center gap-2 bg-green-600 hover:bg-green-700 px-4 py-3 rounded-lg transition",title:"Transfer from Wallet to Trading Account",children:[n.jsx(Ls,{size:18}),"Deposit"]}),n.jsxs("button",{onClick:()=>h("toWallet"),className:"flex items-center justify-center gap-2 bg-red-600 hover:bg-red-700 px-4 py-3 rounded-lg transition",title:"Transfer from Trading Account to Wallet",children:[n.jsx(_w,{size:18}),"Withdraw"]})]})]})}),n.jsxs("div",{className:"mt-8 bg-dark-800 rounded-xl p-6",children:[n.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Account Summary"}),n.jsxs("div",{className:"grid md:grid-cols-5 gap-6",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Main Wallet"}),n.jsxs("div",{className:"text-2xl font-bold text-blue-400",children:["",x.toLocaleString("en-IN",{minimumFractionDigits:2})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Trading Account"}),n.jsxs("div",{className:"text-2xl font-bold text-green-400",children:["",y.toLocaleString("en-IN",{minimumFractionDigits:2})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Total Deposited"}),n.jsxs("div",{className:"text-2xl font-bold",children:["",(((j=s==null?void 0:s.wallet)==null?void 0:j.totalDeposited)||0).toLocaleString("en-IN",{minimumFractionDigits:2})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Total Withdrawn"}),n.jsxs("div",{className:"text-2xl font-bold",children:["",(((E=s==null?void 0:s.wallet)==null?void 0:E.totalWithdrawn)||0).toLocaleString("en-IN",{minimumFractionDigits:2})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Total P&L"}),n.jsxs("div",{className:`text-2xl font-bold ${(((_=s==null?void 0:s.wallet)==null?void 0:_.totalPnL)||0)>=0?"text-green-400":"text-red-400"}`,children:[(((M=s==null?void 0:s.wallet)==null?void 0:M.totalPnL)||0)>=0?"+":"","",(((V=s==null?void 0:s.wallet)==null?void 0:V.totalPnL)||0).toLocaleString("en-IN",{minimumFractionDigits:2})]})]})]})]}),l&&n.jsx(kk,{user:t,walletBalance:x,tradingBalance:w,direction:c,onClose:()=>o(!1),onSuccess:()=>{m(),o(!1)}})]})},kk=({user:t,walletBalance:e,tradingBalance:s,direction:r,onClose:i,onSuccess:a})=>{const[l,o]=g.useState(""),[c,d]=g.useState(!1),[m,u]=g.useState(""),h=r==="toAccount",x=h?e:s,y=h?"Main Wallet":"Trading Account",f=h?"Trading Account":"Main Wallet",w=async p=>{var v,S;p.preventDefault();const b=parseFloat(l);if(!b||b<=0){u("Please enter a valid amount");return}if(b>x){u(`Insufficient balance in ${y}`);return}d(!0),u("");try{await I.post("/api/user/funds/internal-transfer",{amount:b,direction:r},{headers:{Authorization:`Bearer ${t.token}`}}),a()}catch(N){u(((S=(v=N.response)==null?void 0:v.data)==null?void 0:S.message)||"Transfer failed")}finally{d(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-dark-800 rounded-xl w-full max-w-md p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[n.jsx(bw,{size:20,className:"text-blue-400"}),"Internal Transfer"]}),n.jsx("button",{onClick:i,className:"text-gray-400 hover:text-white",children:n.jsx(ve,{size:20})})]}),n.jsx("div",{className:"bg-dark-700 rounded-lg p-4 mb-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"text-center flex-1",children:[n.jsx("div",{className:"text-xs text-gray-400 mb-1",children:y}),n.jsxs("div",{className:"text-lg font-bold text-green-400",children:["",x.toLocaleString()]})]}),n.jsx("div",{className:"px-4",children:n.jsx(og,{size:24,className:"text-blue-400"})}),n.jsxs("div",{className:"text-center flex-1",children:[n.jsx("div",{className:"text-xs text-gray-400 mb-1",children:f}),n.jsxs("div",{className:"text-lg font-bold text-blue-400",children:["",(h?s:e).toLocaleString()]})]})]})}),m&&n.jsx("div",{className:"bg-red-500/20 text-red-400 p-3 rounded-lg mb-4 text-sm",children:m}),n.jsxs("form",{onSubmit:w,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Amount ()"}),n.jsx("input",{type:"number",value:l,onChange:p=>o(p.target.value),placeholder:"Enter amount to transfer",className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-3 focus:outline-none focus:border-blue-500 text-lg"})]}),n.jsxs("div",{className:"flex gap-2 flex-wrap",children:[[1e3,5e3,1e4,5e4].map(p=>n.jsxs("button",{type:"button",onClick:()=>o(String(x>0?Math.min(p,x):p)),className:"flex-1 min-w-[60px] bg-dark-700 hover:bg-dark-600 py-2 rounded text-sm transition",children:["",p.toLocaleString()]},p)),n.jsx("button",{type:"button",onClick:()=>o(String(Math.max(x,0))),className:"flex-1 min-w-[60px] bg-green-600 hover:bg-green-700 py-2 rounded text-sm font-medium transition",children:"Max"})]}),n.jsx("button",{type:"submit",disabled:c,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:opacity-50 py-3 rounded-lg font-medium transition",children:c?"Transferring...":`Transfer to ${f}`})]})]})})},Sk=()=>{var k,j,E,_,M,V,B,R,O;const{user:t}=we(),[e,s]=g.useState(null),[r,i]=g.useState([]),[a,l]=g.useState([]),[o,c]=g.useState([]),[d,m]=g.useState(null),[u,h]=g.useState(!0),[x,y]=g.useState(!1),[f,w]=g.useState(!1),[p,b]=g.useState("transactions");g.useEffect(()=>{v()},[]);const v=async()=>{try{const P={Authorization:`Bearer ${t.token}`},[W,D,T,L,F]=await Promise.all([I.get("/api/user/wallet",{headers:P}),I.get("/api/user/funds/ledger?limit=50",{headers:P}).catch(()=>({data:[]})),I.get("/api/user/funds/fund-requests",{headers:P}).catch(()=>({data:[]})),I.get("/api/user/funds/admin-bank-accounts",{headers:P}).catch(()=>({data:[]})),I.get("/api/user/funds/my-admin",{headers:P}).catch(()=>({data:null}))]);s(W.data),i(D.data||[]),l(T.data||[]),c(L.data||[]),m(F.data)}catch(P){console.error("Error:",P)}finally{h(!1)}},S=(e==null?void 0:e.cashBalance)||((k=e==null?void 0:e.wallet)==null?void 0:k.cashBalance)||((j=e==null?void 0:e.wallet)==null?void 0:j.balance)||0;e!=null&&e.tradingBalance||(E=e==null?void 0:e.wallet)!=null&&E.tradingBalance,e!=null&&e.usedMargin||(_=e==null?void 0:e.wallet)!=null&&_.usedMargin||(M=e==null?void 0:e.wallet)!=null&&M.blocked;const N=S;return u?n.jsx("div",{className:"p-6 text-center text-gray-400",children:"Loading..."}):n.jsxs("div",{className:"p-4 md:p-6 overflow-y-auto h-full",children:[n.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Wallet"}),n.jsxs("div",{className:"bg-gradient-to-r from-green-600 to-emerald-600 rounded-xl p-6 mb-6",children:[n.jsx("div",{className:"text-white/70 text-sm mb-1",children:"Main Wallet Balance"}),n.jsxs("div",{className:"text-4xl font-bold text-white mb-4",children:["",S.toLocaleString("en-IN",{minimumFractionDigits:2})]}),n.jsxs("div",{className:"flex gap-4",children:[n.jsx("button",{onClick:()=>y(!0),className:"bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg text-sm font-medium transition",children:"+ Deposit"}),n.jsx("button",{onClick:()=>w(!0),className:"bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg text-sm font-medium transition",children:"- Withdraw"})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total Deposited"}),n.jsxs("div",{className:"text-xl font-bold text-green-400",children:["",(((V=e==null?void 0:e.wallet)==null?void 0:V.totalDeposited)||0).toLocaleString()]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total Withdrawn"}),n.jsxs("div",{className:"text-xl font-bold text-red-400",children:["",(((B=e==null?void 0:e.wallet)==null?void 0:B.totalWithdrawn)||0).toLocaleString()]})]}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total P&L"}),n.jsxs("div",{className:`text-xl font-bold ${(((R=e==null?void 0:e.wallet)==null?void 0:R.totalPnL)||0)>=0?"text-green-400":"text-red-400"}`,children:["",(((O=e==null?void 0:e.wallet)==null?void 0:O.totalPnL)||0).toLocaleString()]})]})]}),n.jsx("div",{className:"flex gap-4 mb-4 border-b border-dark-600",children:["transactions","requests","bank"].map(P=>n.jsx("button",{onClick:()=>b(P),className:`px-4 py-2 text-sm font-medium capitalize transition ${p===P?"text-green-400 border-b-2 border-green-400":"text-gray-400 hover:text-white"}`,children:P==="bank"?"Admin Bank Accounts":P},P))}),n.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[p==="transactions"&&n.jsxs(n.Fragment,{children:[n.jsx("h2",{className:"font-semibold mb-4",children:"Recent Transactions"}),r.length===0?n.jsx("div",{className:"text-center py-4 text-gray-400",children:"No transactions yet"}):n.jsx("div",{className:"space-y-2",children:r.map((P,W)=>n.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-dark-600 last:border-0",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:P.description||P.type}),n.jsx("div",{className:"text-xs text-gray-500",children:new Date(P.createdAt).toLocaleString()})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:P.amount>=0?"text-green-400":"text-red-400",children:[P.amount>=0?"+":"","",Math.abs(P.amount||0).toLocaleString()]}),n.jsxs("div",{className:"text-xs text-gray-500",children:["Bal: ",(P.balanceAfter||0).toLocaleString()]})]})]},W))})]}),p==="requests"&&n.jsxs(n.Fragment,{children:[n.jsx("h2",{className:"font-semibold mb-4",children:"Fund Requests"}),a.length===0?n.jsx("div",{className:"text-center py-4 text-gray-400",children:"No fund requests yet"}):n.jsx("div",{className:"space-y-3",children:a.map((P,W)=>n.jsxs("div",{className:"bg-dark-700 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:`text-xs px-2 py-1 rounded ${P.type==="DEPOSIT"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:P.type}),n.jsx("span",{className:`text-xs px-2 py-1 rounded ${P.status==="APPROVED"?"bg-green-500/20 text-green-400":P.status==="REJECTED"?"bg-red-500/20 text-red-400":P.status==="CANCELLED"?"bg-gray-500/20 text-gray-400":"bg-yellow-500/20 text-yellow-400"}`,children:P.status})]}),n.jsxs("div",{className:"text-2xl font-bold",children:["",(P.amount||0).toLocaleString()]}),n.jsx("div",{className:"text-xs text-gray-500 mt-1",children:new Date(P.createdAt).toLocaleString()}),P.referenceId&&n.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Ref: ",P.referenceId]}),P.adminRemarks&&n.jsxs("div",{className:"text-xs text-gray-400 mt-2 p-2 bg-dark-600 rounded",children:["Admin: ",P.adminRemarks]})]},W))})]}),p==="bank"&&n.jsxs(n.Fragment,{children:[n.jsx("h2",{className:"font-semibold mb-4",children:"Admin Bank Accounts (for Deposit)"}),o.length===0?n.jsx("div",{className:"text-center py-4 text-gray-400",children:"No bank accounts available"}):n.jsx("div",{className:"space-y-3",children:o.map((P,W)=>n.jsxs("div",{className:"bg-dark-700 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[P.type==="UPI"?n.jsx(Ar,{size:18,className:"text-purple-400"}):n.jsx(Rr,{size:18,className:"text-blue-400"}),n.jsx("span",{className:"font-medium",children:P.type==="UPI"?"UPI":P.bankName})]}),P.type==="UPI"?n.jsxs("div",{className:"flex items-center justify-between bg-dark-600 rounded p-3",children:[n.jsx("span",{className:"font-mono text-lg",children:P.upiId}),n.jsx("button",{onClick:()=>{navigator.clipboard.writeText(P.upiId),alert("Copied!")},className:"text-xs bg-dark-500 hover:bg-dark-400 px-2 py-1 rounded",children:"Copy"})]}):n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex justify-between bg-dark-600 rounded p-2",children:[n.jsx("span",{className:"text-gray-400",children:"Account Number"}),n.jsx("span",{className:"font-mono",children:P.accountNumber})]}),n.jsxs("div",{className:"flex justify-between bg-dark-600 rounded p-2",children:[n.jsx("span",{className:"text-gray-400",children:"IFSC Code"}),n.jsx("span",{className:"font-mono",children:P.ifscCode})]}),n.jsxs("div",{className:"flex justify-between bg-dark-600 rounded p-2",children:[n.jsx("span",{className:"text-gray-400",children:"Account Holder"}),n.jsx("span",{children:P.accountHolderName})]})]})]},W))})]})]}),x&&n.jsx(Ck,{user:t,bankAccounts:o,onClose:()=>y(!1),onSuccess:()=>{v(),y(!1)}}),f&&n.jsx(Ek,{user:t,balance:N,adminInfo:d,onClose:()=>w(!1),onSuccess:()=>{v(),w(!1)}})]})},Ck=({user:t,bankAccounts:e,onClose:s,onSuccess:r})=>{const[i,a]=g.useState(""),[l,o]=g.useState("UPI"),[c,d]=g.useState(""),[m,u]=g.useState(""),[h,x]=g.useState(""),[y,f]=g.useState(!1),[w,p]=g.useState(""),b=async v=>{var S,N;if(v.preventDefault(),!i||parseFloat(i)<=0){p("Please enter a valid amount");return}f(!0),p("");try{await I.post("/api/user/funds/fund-request/deposit",{amount:parseFloat(i),paymentMethod:l,bankAccountId:c||null,referenceId:m,remarks:h},{headers:{Authorization:`Bearer ${t.token}`}}),r()}catch(k){p(((N=(S=k.response)==null?void 0:S.data)==null?void 0:N.message)||"Failed to submit deposit request")}finally{f(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-dark-800 rounded-xl w-full max-w-md p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-bold",children:"Deposit Funds"}),n.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:n.jsx(ve,{size:20})})]}),w&&n.jsx("div",{className:"bg-red-500/20 text-red-400 p-3 rounded-lg mb-4 text-sm",children:w}),n.jsxs("form",{onSubmit:b,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Amount ()"}),n.jsx("input",{type:"number",value:i,onChange:v=>a(v.target.value),placeholder:"Enter amount",className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 focus:outline-none focus:border-green-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Payment Method"}),n.jsxs("select",{value:l,onChange:v=>o(v.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 focus:outline-none focus:border-green-500",children:[n.jsx("option",{value:"UPI",children:"UPI"}),n.jsx("option",{value:"BANK_TRANSFER",children:"Bank Transfer (NEFT/IMPS)"}),n.jsx("option",{value:"CASH",children:"Cash"})]})]}),e.length>0&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Pay to Account"}),n.jsxs("select",{value:c,onChange:v=>d(v.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 focus:outline-none focus:border-green-500",children:[n.jsx("option",{value:"",children:"Select account"}),e.map(v=>n.jsx("option",{value:v._id,children:v.type==="UPI"?`UPI: ${v.upiId}`:`${v.bankName} - ${v.accountNumber}`},v._id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Reference/UTR Number"}),n.jsx("input",{type:"text",value:m,onChange:v=>u(v.target.value),placeholder:"Enter transaction reference",className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 focus:outline-none focus:border-green-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Remarks (Optional)"}),n.jsx("textarea",{value:h,onChange:v=>x(v.target.value),placeholder:"Any additional notes",rows:2,className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 focus:outline-none focus:border-green-500"})]}),n.jsx("button",{type:"submit",disabled:y,className:"w-full bg-green-600 hover:bg-green-700 disabled:opacity-50 py-3 rounded-lg font-medium transition",children:y?"Submitting...":"Submit Deposit Request"})]})]})})},Ek=({user:t,balance:e,adminInfo:s,onClose:r,onSuccess:i})=>{var k,j;const[a,l]=g.useState(""),[o,c]=g.useState("UPI"),[d,m]=g.useState(""),[u,h]=g.useState({bankName:"",accountNumber:"",ifscCode:"",accountHolderName:""}),[x,y]=g.useState(""),[f,w]=g.useState(!1),[p,b]=g.useState(""),v=((k=s==null?void 0:s.charges)==null?void 0:k.minWithdrawal)||100,S=((j=s==null?void 0:s.charges)==null?void 0:j.maxWithdrawal)||1e5,N=async E=>{var M,V;E.preventDefault();const _=parseFloat(a);if(!_||_<=0){b("Please enter a valid amount");return}if(_>e){b("Insufficient balance");return}if(_<v){b(`Minimum withdrawal is ${v}`);return}if(_>S){b(`Maximum withdrawal is ${S}`);return}w(!0),b("");try{const B=o==="UPI"?{upiId:d}:u;await I.post("/api/user/funds/fund-request/withdraw",{amount:_,paymentMethod:o,withdrawalDetails:B,remarks:x},{headers:{Authorization:`Bearer ${t.token}`}}),i()}catch(B){b(((V=(M=B.response)==null?void 0:M.data)==null?void 0:V.message)||"Failed to submit withdrawal request")}finally{w(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-dark-800 rounded-xl w-full max-w-md p-6 max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-bold",children:"Withdraw Funds"}),n.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white",children:n.jsx(ve,{size:20})})]}),n.jsxs("div",{className:"bg-dark-700 rounded-lg p-3 mb-4",children:[n.jsx("div",{className:"text-xs text-gray-400",children:"Available Balance"}),n.jsxs("div",{className:"text-xl font-bold text-green-400",children:["",e.toLocaleString()]}),n.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Min: ",v," | Max: ",S]})]}),p&&n.jsx("div",{className:"bg-red-500/20 text-red-400 p-3 rounded-lg mb-4 text-sm",children:p}),n.jsxs("form",{onSubmit:N,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Amount ()"}),n.jsx("input",{type:"number",value:a,onChange:E=>l(E.target.value),placeholder:"Enter amount",className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 focus:outline-none focus:border-red-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Receive via"}),n.jsxs("select",{value:o,onChange:E=>c(E.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 focus:outline-none focus:border-red-500",children:[n.jsx("option",{value:"UPI",children:"UPI"}),n.jsx("option",{value:"BANK_TRANSFER",children:"Bank Transfer"})]})]}),o==="UPI"?n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Your UPI ID"}),n.jsx("input",{type:"text",value:d,onChange:E=>m(E.target.value),placeholder:"yourname@upi",className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 focus:outline-none focus:border-red-500"})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Bank Name"}),n.jsx("input",{type:"text",value:u.bankName,onChange:E=>h({...u,bankName:E.target.value}),placeholder:"Bank name",className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 focus:outline-none focus:border-red-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Account Number"}),n.jsx("input",{type:"text",value:u.accountNumber,onChange:E=>h({...u,accountNumber:E.target.value}),placeholder:"Account number",className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 focus:outline-none focus:border-red-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"IFSC Code"}),n.jsx("input",{type:"text",value:u.ifscCode,onChange:E=>h({...u,ifscCode:E.target.value}),placeholder:"IFSC code",className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 focus:outline-none focus:border-red-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Account Holder Name"}),n.jsx("input",{type:"text",value:u.accountHolderName,onChange:E=>h({...u,accountHolderName:E.target.value}),placeholder:"Name as per bank",className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 focus:outline-none focus:border-red-500"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Remarks (Optional)"}),n.jsx("textarea",{value:x,onChange:E=>y(E.target.value),placeholder:"Any additional notes",rows:2,className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 focus:outline-none focus:border-red-500"})]}),n.jsx("button",{type:"submit",disabled:f,className:"w-full bg-red-600 hover:bg-red-700 disabled:opacity-50 py-3 rounded-lg font-medium transition",children:f?"Submitting...":"Submit Withdrawal Request"})]})]})})},Tk=()=>{var e,s;const{user:t}=we();return n.jsxs("div",{className:"p-4 md:p-6 overflow-y-auto h-full",children:[n.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Profile"}),n.jsxs("div",{className:"max-w-2xl",children:[n.jsxs("div",{className:"bg-dark-800 rounded-lg p-6 mb-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full flex items-center justify-center text-3xl font-bold",children:((e=t==null?void 0:t.fullName)==null?void 0:e[0])||((s=t==null?void 0:t.username)==null?void 0:s[0])||"U"}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold",children:(t==null?void 0:t.fullName)||(t==null?void 0:t.username)}),n.jsxs("p",{className:"text-gray-400",children:["@",t==null?void 0:t.username]}),n.jsxs("p",{className:"text-sm text-gray-500",children:["User ID: ",t==null?void 0:t.userId]})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between py-2 border-b border-dark-600",children:[n.jsx("span",{className:"text-gray-400",children:"Email"}),n.jsx("span",{children:(t==null?void 0:t.email)||"Not set"})]}),n.jsxs("div",{className:"flex justify-between py-2 border-b border-dark-600",children:[n.jsx("span",{className:"text-gray-400",children:"Phone"}),n.jsx("span",{children:(t==null?void 0:t.phone)||"Not set"})]}),n.jsxs("div",{className:"flex justify-between py-2 border-b border-dark-600",children:[n.jsx("span",{className:"text-gray-400",children:"Member Since"}),n.jsx("span",{children:t!=null&&t.createdAt?new Date(t.createdAt).toLocaleDateString():"N/A"})]}),n.jsxs("div",{className:"flex justify-between py-2",children:[n.jsx("span",{className:"text-gray-400",children:"Status"}),n.jsx("span",{className:"text-green-400",children:"Active"})]})]})]}),n.jsx("button",{className:"w-full bg-dark-700 hover:bg-dark-600 py-3 rounded-lg transition",children:"Edit Profile"})]})]})},Pk=()=>n.jsx("div",{className:"p-4 md:p-6 flex items-center justify-center h-full",children:n.jsxs("div",{className:"text-center max-w-md",children:[n.jsx(Fd,{size:48,className:"mx-auto text-gray-600 mb-4"}),n.jsx("h2",{className:"text-xl font-bold mb-2",children:"Support"}),n.jsx("p",{className:"text-gray-400 mb-6",children:"Need help? Contact our support team"}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("button",{className:"w-full bg-green-600 hover:bg-green-700 py-3 rounded-lg transition",children:"Chat with Support"}),n.jsx("button",{className:"w-full bg-dark-700 hover:bg-dark-600 py-3 rounded-lg transition",children:"View FAQ"})]})]})}),Lk=()=>{var v,S;const{user:t,logoutUser:e}=we(),s=rs(),r=jn(),[i,a]=g.useState(!1),[l,o]=g.useState(!1),[c,d]=g.useState(!1),[m,u]=g.useState(0),[h,x]=g.useState(!0);g.useEffect(()=>{y()},[]);const y=async()=>{var N;try{const{data:k}=await I.get("/api/user/wallet",{headers:{Authorization:`Bearer ${t.token}`}});u(((N=k==null?void 0:k.wallet)==null?void 0:N.balance)||0)}catch(k){console.error("Error:",k)}},f=()=>{e(),s("/login")},w=[{path:"/user/home",icon:no,label:"Dashboard"},{path:"/user/accounts",icon:zr,label:"Accounts"},{path:"/user/wallet",icon:Ge,label:"Wallet"},{path:"/user/profile",icon:ao,label:"Profile"},{path:"/user/support",icon:Fd,label:"Support"}],p=[{path:"/user/home",icon:no,label:"Home"},{path:"/user/accounts",icon:zr,label:"Accounts"},{path:"/user/wallet",icon:Ge,label:"Wallet"}],b=N=>r.pathname===N||r.pathname.startsWith(N+"/");return n.jsxs("div",{className:"h-screen bg-dark-900 flex overflow-hidden",children:[n.jsxs("aside",{className:`hidden md:flex flex-col bg-dark-800 border-r border-dark-600 transition-all duration-300 ease-in-out ${i?"w-64":"w-[70px]"}`,children:[n.jsxs("div",{className:"p-4 border-b border-dark-600 flex items-center justify-between",children:[n.jsxs(ze,{to:"/user/home",className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center font-bold text-lg flex-shrink-0",children:"FX"}),n.jsx("span",{className:`font-bold text-lg whitespace-nowrap overflow-hidden transition-all duration-300 ${i?"w-auto opacity-100":"w-0 opacity-0"}`,children:"THEFX"})]}),n.jsx("button",{onClick:()=>a(!i),className:`p-1.5 rounded-lg hover:bg-dark-700 text-gray-400 hover:text-white transition-all ${i?"":"absolute left-[70px] -translate-x-1/2 bg-dark-800 border border-dark-600 z-10"}`,children:n.jsx(Nw,{size:18,className:`transform transition-transform duration-300 ${i?"rotate-90":"-rotate-90"}`})})]}),n.jsx("nav",{className:"flex-1 p-2 space-y-1 overflow-y-auto overflow-x-hidden",children:w.map(N=>n.jsxs(ze,{to:N.path,title:i?"":N.label,className:`flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all duration-200 ${b(N.path)?"bg-green-600 text-white":"text-gray-400 hover:bg-dark-700 hover:text-white"} ${i?"":"justify-center"}`,children:[n.jsx(N.icon,{size:20,className:"flex-shrink-0"}),n.jsx("span",{className:`whitespace-nowrap overflow-hidden transition-all duration-300 ${i?"w-auto opacity-100":"w-0 opacity-0"}`,children:N.label})]},N.path))}),n.jsx("div",{className:"p-2 border-t border-dark-600",children:n.jsxs("button",{onClick:()=>x(!h),title:i?"":h?"Light Mode":"Dark Mode",className:`flex items-center gap-3 w-full px-3 py-2.5 rounded-lg text-gray-400 hover:bg-dark-700 hover:text-white transition ${i?"":"justify-center"}`,children:[h?n.jsx(Iw,{size:20,className:"flex-shrink-0"}):n.jsx(Mw,{size:20,className:"flex-shrink-0"}),n.jsx("span",{className:`whitespace-nowrap overflow-hidden transition-all duration-300 ${i?"w-auto opacity-100":"w-0 opacity-0"}`,children:h?"Light Mode":"Dark Mode"})]})})]}),n.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[n.jsxs("header",{className:"bg-dark-800 border-b border-dark-600 px-4 py-3 flex items-center justify-between",children:[n.jsx("div",{className:"flex items-center gap-4",children:n.jsx("button",{onClick:()=>o(!l),className:"md:hidden text-gray-400 hover:text-white",children:n.jsx(pg,{size:24})})}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("button",{className:"text-gray-400 hover:text-white",children:n.jsx(ts,{size:20})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full flex items-center justify-center text-sm font-bold",children:((v=t==null?void 0:t.fullName)==null?void 0:v[0])||((S=t==null?void 0:t.username)==null?void 0:S[0])||"U"}),n.jsx("button",{onClick:f,className:"text-gray-400 hover:text-red-400",children:n.jsx(jr,{size:18})})]})]})]}),l&&n.jsx("div",{className:"md:hidden fixed inset-0 z-50 bg-black/50",onClick:()=>o(!1),children:n.jsxs("div",{className:"w-64 h-full bg-dark-800 p-4",onClick:N=>N.stopPropagation(),children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center font-bold",children:"FX"}),n.jsx("span",{className:"font-bold text-lg",children:"THEFX"})]}),n.jsx("button",{onClick:()=>o(!1),children:n.jsx(ve,{size:24})})]}),n.jsx("nav",{className:"space-y-1",children:w.map(N=>n.jsxs(ze,{to:N.path,onClick:()=>o(!1),className:`flex items-center gap-3 px-3 py-2.5 rounded-lg transition ${b(N.path)?"bg-green-600 text-white":"text-gray-400 hover:bg-dark-700 hover:text-white"}`,children:[n.jsx(N.icon,{size:20}),n.jsx("span",{children:N.label})]},N.path))}),n.jsx("div",{className:"mt-6 pt-6 border-t border-dark-600",children:n.jsxs("button",{onClick:f,className:"flex items-center gap-3 w-full px-3 py-2.5 rounded-lg text-red-400 hover:bg-dark-700 transition",children:[n.jsx(jr,{size:20}),n.jsx("span",{children:"Logout"})]})})]})}),n.jsx("main",{className:"flex-1 overflow-hidden bg-dark-900 pb-16 md:pb-0",children:n.jsxs(th,{children:[n.jsx(ye,{path:"home",element:n.jsx(dp,{})}),n.jsx(ye,{path:"accounts",element:n.jsx(wk,{})}),n.jsx(ye,{path:"wallet",element:n.jsx(Sk,{})}),n.jsx(ye,{path:"profile",element:n.jsx(Tk,{})}),n.jsx(ye,{path:"support",element:n.jsx(Pk,{})}),n.jsx(ye,{path:"*",element:n.jsx(dp,{})})]})}),n.jsx("nav",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-dark-800 border-t border-dark-600 z-40",children:n.jsxs("div",{className:"flex items-center justify-around py-2",children:[p.map(N=>n.jsxs(ze,{to:N.path,className:`flex flex-col items-center gap-1 px-4 py-2 rounded-lg transition ${b(N.path)?"text-green-400":"text-gray-400"}`,children:[n.jsx(N.icon,{size:22}),n.jsx("span",{className:"text-xs",children:N.label})]},N.path)),n.jsxs("button",{onClick:()=>d(!0),className:"flex flex-col items-center gap-1 px-4 py-2 rounded-lg text-gray-400",children:[n.jsx(xg,{size:22}),n.jsx("span",{className:"text-xs",children:"More"})]})]})}),c&&n.jsx("div",{className:"md:hidden fixed inset-0 z-50 bg-black/60",onClick:()=>d(!1),children:n.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-dark-800 rounded-t-2xl animate-slide-up",onClick:N=>N.stopPropagation(),children:[n.jsx("div",{className:"flex justify-center py-3",children:n.jsx("div",{className:"w-12 h-1 bg-dark-600 rounded-full"})}),n.jsxs("div",{className:"px-4 pb-8 space-y-1",children:[n.jsxs(ze,{to:"/user/transactions",onClick:()=>d(!1),className:"flex items-center gap-4 px-4 py-3 rounded-lg hover:bg-dark-700 transition",children:[n.jsx(zw,{size:22,className:"text-blue-400"}),n.jsx("span",{className:"font-medium",children:"Transactions"})]}),n.jsxs(ze,{to:"/user/profile",onClick:()=>d(!1),className:"flex items-center gap-4 px-4 py-3 rounded-lg hover:bg-dark-700 transition",children:[n.jsx(ao,{size:22,className:"text-purple-400"}),n.jsx("span",{className:"font-medium",children:"Profile"})]}),n.jsxs("button",{onClick:()=>{d(!1)},className:"flex items-center gap-4 px-4 py-3 rounded-lg hover:bg-dark-700 transition w-full text-left",children:[n.jsx(ts,{size:22,className:"text-gray-400"}),n.jsx("span",{className:"font-medium",children:"Settings"})]}),n.jsxs(ze,{to:"/user/support",onClick:()=>d(!1),className:"flex items-center gap-4 px-4 py-3 rounded-lg hover:bg-dark-700 transition",children:[n.jsx(Fd,{size:22,className:"text-yellow-400"}),n.jsx("span",{className:"font-medium",children:"Support"})]}),n.jsx("div",{className:"border-t border-dark-600 my-2"}),n.jsxs("button",{onClick:()=>{d(!1),f()},className:"flex items-center gap-4 px-4 py-3 rounded-lg hover:bg-dark-700 transition w-full text-left text-red-400",children:[n.jsx(jr,{size:22}),n.jsx("span",{className:"font-medium",children:"Logout"})]})]})]})})]})]})};function Re(t){var e=t.width,s=t.height;if(e<0)throw new Error("Negative width is not allowed for Size");if(s<0)throw new Error("Negative height is not allowed for Size");return{width:e,height:s}}function On(t,e){return t.width===e.width&&t.height===e.height}var _k=function(){function t(e){var s=this;this._resolutionListener=function(){return s._onResolutionChanged()},this._resolutionMediaQueryList=null,this._observers=[],this._window=e,this._installResolutionListener()}return t.prototype.dispose=function(){this._uninstallResolutionListener(),this._window=null},Object.defineProperty(t.prototype,"value",{get:function(){return this._window.devicePixelRatio},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(e){var s=this,r={next:e};return this._observers.push(r),{unsubscribe:function(){s._observers=s._observers.filter(function(i){return i!==r})}}},t.prototype._installResolutionListener=function(){if(this._resolutionMediaQueryList!==null)throw new Error("Resolution listener is already installed");var e=this._window.devicePixelRatio;this._resolutionMediaQueryList=this._window.matchMedia("all and (resolution: ".concat(e,"dppx)")),this._resolutionMediaQueryList.addListener(this._resolutionListener)},t.prototype._uninstallResolutionListener=function(){this._resolutionMediaQueryList!==null&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},t.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},t.prototype._onResolutionChanged=function(){var e=this;this._observers.forEach(function(s){return s.next(e._window.devicePixelRatio)}),this._reinstallResolutionListener()},t}();function Mk(t){return new _k(t)}var Rk=function(){function t(e,s,r){var i;this._canvasElement=null,this._bitmapSizeChangedListeners=[],this._suggestedBitmapSize=null,this._suggestedBitmapSizeChangedListeners=[],this._devicePixelRatioObservable=null,this._canvasElementResizeObserver=null,this._canvasElement=e,this._canvasElementClientSize=Re({width:this._canvasElement.clientWidth,height:this._canvasElement.clientHeight}),this._transformBitmapSize=s??function(a){return a},this._allowResizeObserver=(i=r==null?void 0:r.allowResizeObserver)!==null&&i!==void 0?i:!0,this._chooseAndInitObserver()}return t.prototype.dispose=function(){var e,s;if(this._canvasElement===null)throw new Error("Object is disposed");(e=this._canvasElementResizeObserver)===null||e===void 0||e.disconnect(),this._canvasElementResizeObserver=null,(s=this._devicePixelRatioObservable)===null||s===void 0||s.dispose(),this._devicePixelRatioObservable=null,this._suggestedBitmapSizeChangedListeners.length=0,this._bitmapSizeChangedListeners.length=0,this._canvasElement=null},Object.defineProperty(t.prototype,"canvasElement",{get:function(){if(this._canvasElement===null)throw new Error("Object is disposed");return this._canvasElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canvasElementClientSize",{get:function(){return this._canvasElementClientSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bitmapSize",{get:function(){return Re({width:this.canvasElement.width,height:this.canvasElement.height})},enumerable:!1,configurable:!0}),t.prototype.resizeCanvasElement=function(e){this._canvasElementClientSize=Re(e),this.canvasElement.style.width="".concat(this._canvasElementClientSize.width,"px"),this.canvasElement.style.height="".concat(this._canvasElementClientSize.height,"px"),this._invalidateBitmapSize()},t.prototype.subscribeBitmapSizeChanged=function(e){this._bitmapSizeChangedListeners.push(e)},t.prototype.unsubscribeBitmapSizeChanged=function(e){this._bitmapSizeChangedListeners=this._bitmapSizeChangedListeners.filter(function(s){return s!==e})},Object.defineProperty(t.prototype,"suggestedBitmapSize",{get:function(){return this._suggestedBitmapSize},enumerable:!1,configurable:!0}),t.prototype.subscribeSuggestedBitmapSizeChanged=function(e){this._suggestedBitmapSizeChangedListeners.push(e)},t.prototype.unsubscribeSuggestedBitmapSizeChanged=function(e){this._suggestedBitmapSizeChangedListeners=this._suggestedBitmapSizeChangedListeners.filter(function(s){return s!==e})},t.prototype.applySuggestedBitmapSize=function(){if(this._suggestedBitmapSize!==null){var e=this._suggestedBitmapSize;this._suggestedBitmapSize=null,this._resizeBitmap(e),this._emitSuggestedBitmapSizeChanged(e,this._suggestedBitmapSize)}},t.prototype._resizeBitmap=function(e){var s=this.bitmapSize;On(s,e)||(this.canvasElement.width=e.width,this.canvasElement.height=e.height,this._emitBitmapSizeChanged(s,e))},t.prototype._emitBitmapSizeChanged=function(e,s){var r=this;this._bitmapSizeChangedListeners.forEach(function(i){return i.call(r,e,s)})},t.prototype._suggestNewBitmapSize=function(e){var s=this._suggestedBitmapSize,r=Re(this._transformBitmapSize(e,this._canvasElementClientSize)),i=On(this.bitmapSize,r)?null:r;s===null&&i===null||s!==null&&i!==null&&On(s,i)||(this._suggestedBitmapSize=i,this._emitSuggestedBitmapSizeChanged(s,i))},t.prototype._emitSuggestedBitmapSizeChanged=function(e,s){var r=this;this._suggestedBitmapSizeChangedListeners.forEach(function(i){return i.call(r,e,s)})},t.prototype._chooseAndInitObserver=function(){var e=this;if(!this._allowResizeObserver){this._initDevicePixelRatioObservable();return}zk().then(function(s){return s?e._initResizeObserver():e._initDevicePixelRatioObservable()})},t.prototype._initDevicePixelRatioObservable=function(){var e=this;if(this._canvasElement!==null){var s=up(this._canvasElement);if(s===null)throw new Error("No window is associated with the canvas");this._devicePixelRatioObservable=Mk(s),this._devicePixelRatioObservable.subscribe(function(){return e._invalidateBitmapSize()}),this._invalidateBitmapSize()}},t.prototype._invalidateBitmapSize=function(){var e,s;if(this._canvasElement!==null){var r=up(this._canvasElement);if(r!==null){var i=(s=(e=this._devicePixelRatioObservable)===null||e===void 0?void 0:e.value)!==null&&s!==void 0?s:r.devicePixelRatio,a=this._canvasElement.getClientRects(),l=a[0]!==void 0?Ok(a[0],i):Re({width:this._canvasElementClientSize.width*i,height:this._canvasElementClientSize.height*i});this._suggestNewBitmapSize(l)}}},t.prototype._initResizeObserver=function(){var e=this;this._canvasElement!==null&&(this._canvasElementResizeObserver=new ResizeObserver(function(s){var r=s.find(function(l){return l.target===e._canvasElement});if(!(!r||!r.devicePixelContentBoxSize||!r.devicePixelContentBoxSize[0])){var i=r.devicePixelContentBoxSize[0],a=Re({width:i.inlineSize,height:i.blockSize});e._suggestNewBitmapSize(a)}}),this._canvasElementResizeObserver.observe(this._canvasElement,{box:"device-pixel-content-box"}))},t}();function Ak(t,e){return new Rk(t,e.transform,e.options)}function up(t){return t.ownerDocument.defaultView}function zk(){return new Promise(function(t){var e=new ResizeObserver(function(s){t(s.every(function(r){return"devicePixelContentBoxSize"in r})),e.disconnect()});e.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1})}function Ok(t,e){return Re({width:Math.round(t.left*e+t.width*e)-Math.round(t.left*e),height:Math.round(t.top*e+t.height*e)-Math.round(t.top*e)})}var Ik=function(){function t(e,s,r){if(s.width===0||s.height===0)throw new TypeError("Rendering target could only be created on a media with positive width and height");if(this._mediaSize=s,r.width===0||r.height===0)throw new TypeError("Rendering target could only be created using a bitmap with positive integer width and height");this._bitmapSize=r,this._context=e}return t.prototype.useMediaCoordinateSpace=function(e){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),this._context.scale(this._horizontalPixelRatio,this._verticalPixelRatio),e({context:this._context,mediaSize:this._mediaSize})}finally{this._context.restore()}},t.prototype.useBitmapCoordinateSpace=function(e){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),e({context:this._context,mediaSize:this._mediaSize,bitmapSize:this._bitmapSize,horizontalPixelRatio:this._horizontalPixelRatio,verticalPixelRatio:this._verticalPixelRatio})}finally{this._context.restore()}},Object.defineProperty(t.prototype,"_horizontalPixelRatio",{get:function(){return this._bitmapSize.width/this._mediaSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_verticalPixelRatio",{get:function(){return this._bitmapSize.height/this._mediaSize.height},enumerable:!1,configurable:!0}),t}();function qn(t,e){var s=t.canvasElementClientSize;if(s.width===0||s.height===0)return null;var r=t.bitmapSize;if(r.width===0||r.height===0)return null;var i=t.canvasElement.getContext("2d",e);return i===null?null:new Ik(i,s,r)}/*!
 * @license
 * TradingView Lightweight Charts v4.2.3
 * Copyright (c) 2025 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */const $k={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},Bk={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},Dk={color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},Fk={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",invertFilledArea:!1,lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},Uk={baseValue:{type:"price",price:0},topFillColor1:"rgba(38, 166, 154, 0.28)",topFillColor2:"rgba(38, 166, 154, 0.05)",topLineColor:"rgba(38, 166, 154, 1)",bottomFillColor1:"rgba(239, 83, 80, 0.05)",bottomFillColor2:"rgba(239, 83, 80, 0.28)",bottomLineColor:"rgba(239, 83, 80, 1)",lineWidth:3,lineStyle:0,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},Wk={color:"#26a69a",base:0},vg={color:"#2196f3"},Ng={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};var hp,mp;function Hn(t,e){const s={0:[],1:[t.lineWidth,t.lineWidth],2:[2*t.lineWidth,2*t.lineWidth],3:[6*t.lineWidth,6*t.lineWidth],4:[t.lineWidth,4*t.lineWidth]}[e];t.setLineDash(s)}function jg(t,e,s,r){t.beginPath();const i=t.lineWidth%2?.5:0;t.moveTo(s,e+i),t.lineTo(r,e+i),t.stroke()}function fn(t,e){if(!t)throw new Error("Assertion failed"+(e?": "+e:""))}function yt(t){if(t===void 0)throw new Error("Value is undefined");return t}function ee(t){if(t===null)throw new Error("Value is null");return t}function mr(t){return ee(yt(t))}(function(t){t[t.Simple=0]="Simple",t[t.WithSteps=1]="WithSteps",t[t.Curved=2]="Curved"})(hp||(hp={})),function(t){t[t.Solid=0]="Solid",t[t.Dotted=1]="Dotted",t[t.Dashed=2]="Dashed",t[t.LargeDashed=3]="LargeDashed",t[t.SparseDotted=4]="SparseDotted"}(mp||(mp={}));const pp={khaki:"#f0e68c",azure:"#f0ffff",aliceblue:"#f0f8ff",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",gray:"#808080",green:"#008000",honeydew:"#f0fff0",floralwhite:"#fffaf0",lightblue:"#add8e6",lightcoral:"#f08080",lemonchiffon:"#fffacd",hotpink:"#ff69b4",lightyellow:"#ffffe0",greenyellow:"#adff2f",lightgoldenrodyellow:"#fafad2",limegreen:"#32cd32",linen:"#faf0e6",lightcyan:"#e0ffff",magenta:"#f0f",maroon:"#800000",olive:"#808000",orange:"#ffa500",oldlace:"#fdf5e6",mediumblue:"#0000cd",transparent:"#0000",lime:"#0f0",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",midnightblue:"#191970",orchid:"#da70d6",mediumorchid:"#ba55d3",mediumturquoise:"#48d1cc",orangered:"#ff4500",royalblue:"#4169e1",powderblue:"#b0e0e6",red:"#f00",coral:"#ff7f50",turquoise:"#40e0d0",white:"#fff",whitesmoke:"#f5f5f5",wheat:"#f5deb3",teal:"#008080",steelblue:"#4682b4",bisque:"#ffe4c4",aquamarine:"#7fffd4",aqua:"#0ff",sienna:"#a0522d",silver:"#c0c0c0",springgreen:"#00ff7f",antiquewhite:"#faebd7",burlywood:"#deb887",brown:"#a52a2a",beige:"#f5f5dc",chocolate:"#d2691e",chartreuse:"#7fff00",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cadetblue:"#5f9ea0",tomato:"#ff6347",fuchsia:"#f0f",blue:"#00f",salmon:"#fa8072",blanchedalmond:"#ffebcd",slateblue:"#6a5acd",slategray:"#708090",thistle:"#d8bfd8",tan:"#d2b48c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",blueviolet:"#8a2be2",black:"#000",darkmagenta:"#8b008b",darkslateblue:"#483d8b",darkkhaki:"#bdb76b",darkorchid:"#9932cc",darkorange:"#ff8c00",darkgreen:"#006400",darkred:"#8b0000",dodgerblue:"#1e90ff",darkslategray:"#2f4f4f",dimgray:"#696969",deepskyblue:"#00bfff",firebrick:"#b22222",forestgreen:"#228b22",indigo:"#4b0082",ivory:"#fffff0",lavenderblush:"#fff0f5",feldspar:"#d19275",indianred:"#cd5c5c",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightskyblue:"#87cefa",lightslategray:"#789",lightslateblue:"#8470ff",snow:"#fffafa",lightseagreen:"#20b2aa",lightsalmon:"#ffa07a",darksalmon:"#e9967a",darkviolet:"#9400d3",mediumpurple:"#9370d8",mediumaquamarine:"#66cdaa",skyblue:"#87ceeb",lavender:"#e6e6fa",lightsteelblue:"#b0c4de",mediumvioletred:"#c71585",mintcream:"#f5fffa",navajowhite:"#ffdead",navy:"#000080",olivedrab:"#6b8e23",palevioletred:"#d87093",violetred:"#d02090",yellow:"#ff0",yellowgreen:"#9acd32",lawngreen:"#7cfc00",pink:"#ffc0cb",paleturquoise:"#afeeee",palegoldenrod:"#eee8aa",darkolivegreen:"#556b2f",darkseagreen:"#8fbc8f",darkturquoise:"#00ced1",peachpuff:"#ffdab9",deeppink:"#ff1493",violet:"#ee82ee",palegreen:"#98fb98",mediumseagreen:"#3cb371",peru:"#cd853f",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",purple:"#800080",seagreen:"#2e8b57",seashell:"#fff5ee",papayawhip:"#ffefd5",mediumslateblue:"#7b68ee",plum:"#dda0dd",mediumspringgreen:"#00fa9a"};function It(t){return t<0?0:t>255?255:Math.round(t)||0}function wg(t){return t<=0||t>1?Math.min(Math.max(t,0),1):Math.round(1e4*t)/1e4}const Vk=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,qk=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,Hk=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,Kk=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d*\.?\d+)\s*\)$/;function pa(t){(t=t.toLowerCase())in pp&&(t=pp[t]);{const e=Kk.exec(t)||Hk.exec(t);if(e)return[It(parseInt(e[1],10)),It(parseInt(e[2],10)),It(parseInt(e[3],10)),wg(e.length<5?1:parseFloat(e[4]))]}{const e=qk.exec(t);if(e)return[It(parseInt(e[1],16)),It(parseInt(e[2],16)),It(parseInt(e[3],16)),1]}{const e=Vk.exec(t);if(e)return[It(17*parseInt(e[1],16)),It(17*parseInt(e[2],16)),It(17*parseInt(e[3],16)),1]}throw new Error(`Cannot parse color: ${t}`)}function kg(t){return .199*t[0]+.687*t[1]+.114*t[2]}function Ro(t){const e=pa(t);return{t:`rgb(${e[0]}, ${e[1]}, ${e[2]})`,i:kg(e)>160?"black":"white"}}class Ve{constructor(){this.h=[]}l(e,s,r){const i={o:e,_:s,u:r===!0};this.h.push(i)}v(e){const s=this.h.findIndex(r=>e===r.o);s>-1&&this.h.splice(s,1)}p(e){this.h=this.h.filter(s=>s._!==e)}m(e,s,r){const i=[...this.h];this.h=this.h.filter(a=>!a.u),i.forEach(a=>a.o(e,s,r))}M(){return this.h.length>0}S(){this.h=[]}}function ns(t,...e){for(const s of e)for(const r in s)s[r]!==void 0&&Object.prototype.hasOwnProperty.call(s,r)&&!["__proto__","constructor","prototype"].includes(r)&&(typeof s[r]!="object"||t[r]===void 0||Array.isArray(s[r])?t[r]=s[r]:ns(t[r],s[r]));return t}function ms(t){return typeof t=="number"&&isFinite(t)}function xa(t){return typeof t=="number"&&t%1==0}function Ta(t){return typeof t=="string"}function Xa(t){return typeof t=="boolean"}function ws(t){const e=t;if(!e||typeof e!="object")return e;let s,r,i;for(r in s=Array.isArray(e)?[]:{},e)e.hasOwnProperty(r)&&(i=e[r],s[r]=i&&typeof i=="object"?ws(i):i);return s}function Yk(t){return t!==null}function fa(t){return t===null?void 0:t}const oh="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";function Or(t,e,s){return e===void 0&&(e=oh),`${s=s!==void 0?`${s} `:""}${t}px ${e}`}class Qk{constructor(e){this.k={C:1,T:5,P:NaN,R:"",D:"",V:"",O:"",B:0,A:0,I:0,L:0,N:0},this.F=e}W(){const e=this.k,s=this.j(),r=this.H();return e.P===s&&e.D===r||(e.P=s,e.D=r,e.R=Or(s,r),e.L=2.5/12*s,e.B=e.L,e.A=s/12*e.T,e.I=s/12*e.T,e.N=0),e.V=this.$(),e.O=this.U(),this.k}$(){return this.F.W().layout.textColor}U(){return this.F.q()}j(){return this.F.W().layout.fontSize}H(){return this.F.W().layout.fontFamily}}class ch{constructor(){this.Y=[]}Z(e){this.Y=e}X(e,s,r){this.Y.forEach(i=>{i.X(e,s,r)})}}class as{X(e,s,r){e.useBitmapCoordinateSpace(i=>this.K(i,s,r))}}class Xk extends as{constructor(){super(...arguments),this.G=null}J(e){this.G=e}K({context:e,horizontalPixelRatio:s,verticalPixelRatio:r}){if(this.G===null||this.G.tt===null)return;const i=this.G.tt,a=this.G,l=Math.max(1,Math.floor(s))%2/2,o=c=>{e.beginPath();for(let d=i.to-1;d>=i.from;--d){const m=a.it[d],u=Math.round(m.nt*s)+l,h=m.st*r,x=c*r+l;e.moveTo(u,h),e.arc(u,h,x,0,2*Math.PI)}e.fill()};a.et>0&&(e.fillStyle=a.rt,o(a.ht+a.et)),e.fillStyle=a.lt,o(a.ht)}}function Gk(){return{it:[{nt:0,st:0,ot:0,_t:0}],lt:"",rt:"",ht:0,et:0,tt:null}}const Jk={from:0,to:1};class Zk{constructor(e,s){this.ut=new ch,this.ct=[],this.dt=[],this.ft=!0,this.F=e,this.vt=s,this.ut.Z(this.ct)}bt(e){const s=this.F.wt();s.length!==this.ct.length&&(this.dt=s.map(Gk),this.ct=this.dt.map(r=>{const i=new Xk;return i.J(r),i}),this.ut.Z(this.ct)),this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.ut}Mt(){const e=this.vt.W().mode===2,s=this.F.wt(),r=this.vt.xt(),i=this.F.St();s.forEach((a,l)=>{var o;const c=this.dt[l],d=a.kt(r);if(e||d===null||!a.yt())return void(c.tt=null);const m=ee(a.Ct());c.lt=d.Tt,c.ht=d.ht,c.et=d.Pt,c.it[0]._t=d._t,c.it[0].st=a.Dt().Rt(d._t,m.Vt),c.rt=(o=d.Ot)!==null&&o!==void 0?o:this.F.Bt(c.it[0].st/a.Dt().At()),c.it[0].ot=r,c.it[0].nt=i.It(r),c.tt=Jk})}}class eS extends as{constructor(e){super(),this.zt=e}K({context:e,bitmapSize:s,horizontalPixelRatio:r,verticalPixelRatio:i}){if(this.zt===null)return;const a=this.zt.Lt.yt,l=this.zt.Et.yt;if(!a&&!l)return;const o=Math.round(this.zt.nt*r),c=Math.round(this.zt.st*i);e.lineCap="butt",a&&o>=0&&(e.lineWidth=Math.floor(this.zt.Lt.et*r),e.strokeStyle=this.zt.Lt.V,e.fillStyle=this.zt.Lt.V,Hn(e,this.zt.Lt.Nt),function(d,m,u,h){d.beginPath();const x=d.lineWidth%2?.5:0;d.moveTo(m+x,u),d.lineTo(m+x,h),d.stroke()}(e,o,0,s.height)),l&&c>=0&&(e.lineWidth=Math.floor(this.zt.Et.et*i),e.strokeStyle=this.zt.Et.V,e.fillStyle=this.zt.Et.V,Hn(e,this.zt.Et.Nt),jg(e,c,0,s.width))}}class tS{constructor(e){this.ft=!0,this.Ft={Lt:{et:1,Nt:0,V:"",yt:!1},Et:{et:1,Nt:0,V:"",yt:!1},nt:0,st:0},this.Wt=new eS(this.Ft),this.jt=e}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt}Mt(){const e=this.jt.yt(),s=ee(this.jt.Ht()),r=s.$t().W().crosshair,i=this.Ft;if(r.mode===2)return i.Et.yt=!1,void(i.Lt.yt=!1);i.Et.yt=e&&this.jt.Ut(s),i.Lt.yt=e&&this.jt.qt(),i.Et.et=r.horzLine.width,i.Et.Nt=r.horzLine.style,i.Et.V=r.horzLine.color,i.Lt.et=r.vertLine.width,i.Lt.Nt=r.vertLine.style,i.Lt.V=r.vertLine.color,i.nt=this.jt.Yt(),i.st=this.jt.Zt()}}function sS(t,e,s,r,i,a){t.fillRect(e+a,s,r-2*a,a),t.fillRect(e+a,s+i-a,r-2*a,a),t.fillRect(e,s,a,i),t.fillRect(e+r-a,s,a,i)}function Ao(t,e,s,r,i,a){t.save(),t.globalCompositeOperation="copy",t.fillStyle=a,t.fillRect(e,s,r,i),t.restore()}function xp(t,e,s,r,i,a){t.beginPath(),t.roundRect?t.roundRect(e,s,r,i,a):(t.lineTo(e+r-a[1],s),a[1]!==0&&t.arcTo(e+r,s,e+r,s+a[1],a[1]),t.lineTo(e+r,s+i-a[2]),a[2]!==0&&t.arcTo(e+r,s+i,e+r-a[2],s+i,a[2]),t.lineTo(e+a[3],s+i),a[3]!==0&&t.arcTo(e,s+i,e,s+i-a[3],a[3]),t.lineTo(e,s+a[0]),a[0]!==0&&t.arcTo(e,s,e+a[0],s,a[0]))}function fp(t,e,s,r,i,a,l=0,o=[0,0,0,0],c=""){if(t.save(),!l||!c||c===a)return xp(t,e,s,r,i,o),t.fillStyle=a,t.fill(),void t.restore();const d=l/2;var m;xp(t,e+d,s+d,r-l,i-l,(m=-d,o.map(u=>u===0?u:u+m))),a!=="transparent"&&(t.fillStyle=a,t.fill()),c!=="transparent"&&(t.lineWidth=l,t.strokeStyle=c,t.closePath(),t.stroke()),t.restore()}function Sg(t,e,s,r,i,a,l){t.save(),t.globalCompositeOperation="copy";const o=t.createLinearGradient(0,0,0,i);o.addColorStop(0,a),o.addColorStop(1,l),t.fillStyle=o,t.fillRect(e,s,r,i),t.restore()}class gp{constructor(e,s){this.J(e,s)}J(e,s){this.zt=e,this.Xt=s}At(e,s){return this.zt.yt?e.P+e.L+e.B:0}X(e,s,r,i){if(!this.zt.yt||this.zt.Kt.length===0)return;const a=this.zt.V,l=this.Xt.t,o=e.useBitmapCoordinateSpace(c=>{const d=c.context;d.font=s.R;const m=this.Gt(c,s,r,i),u=m.Jt;return m.Qt?fp(d,u.ti,u.ii,u.ni,u.si,l,u.ei,[u.ht,0,0,u.ht],l):fp(d,u.ri,u.ii,u.ni,u.si,l,u.ei,[0,u.ht,u.ht,0],l),this.zt.hi&&(d.fillStyle=a,d.fillRect(u.ri,u.li,u.ai-u.ri,u.oi)),this.zt._i&&(d.fillStyle=s.O,d.fillRect(m.Qt?u.ui-u.ei:0,u.ii,u.ei,u.ci-u.ii)),m});e.useMediaCoordinateSpace(({context:c})=>{const d=o.di;c.font=s.R,c.textAlign=o.Qt?"right":"left",c.textBaseline="middle",c.fillStyle=a,c.fillText(this.zt.Kt,d.fi,(d.ii+d.ci)/2+d.pi)})}Gt(e,s,r,i){var a;const{context:l,bitmapSize:o,mediaSize:c,horizontalPixelRatio:d,verticalPixelRatio:m}=e,u=this.zt.hi||!this.zt.mi?s.T:0,h=this.zt.bi?s.C:0,x=s.L+this.Xt.wi,y=s.B+this.Xt.gi,f=s.A,w=s.I,p=this.zt.Kt,b=s.P,v=r.Mi(l,p),S=Math.ceil(r.xi(l,p)),N=b+x+y,k=s.C+f+w+S+u,j=Math.max(1,Math.floor(m));let E=Math.round(N*m);E%2!=j%2&&(E+=1);const _=h>0?Math.max(1,Math.floor(h*d)):0,M=Math.round(k*d),V=Math.round(u*d),B=(a=this.Xt.Si)!==null&&a!==void 0?a:this.Xt.ki,R=Math.round(B*m)-Math.floor(.5*m),O=Math.floor(R+j/2-E/2),P=O+E,W=i==="right",D=W?c.width-h:h,T=W?o.width-_:_;let L,F,C;return W?(L=T-M,F=T-V,C=D-u-f-h):(L=T+M,F=T+V,C=D+u+f),{Qt:W,Jt:{ii:O,li:R,ci:P,ni:M,si:E,ht:2*d,ei:_,ti:L,ri:T,ai:F,oi:j,ui:o.width},di:{ii:O/m,ci:P/m,fi:C,pi:v}}}}class zo{constructor(e){this.yi={ki:0,t:"#000",gi:0,wi:0},this.Ci={Kt:"",yt:!1,hi:!0,mi:!1,Ot:"",V:"#FFF",_i:!1,bi:!1},this.Ti={Kt:"",yt:!1,hi:!1,mi:!0,Ot:"",V:"#FFF",_i:!0,bi:!0},this.ft=!0,this.Pi=new(e||gp)(this.Ci,this.yi),this.Ri=new(e||gp)(this.Ti,this.yi)}Kt(){return this.Di(),this.Ci.Kt}ki(){return this.Di(),this.yi.ki}bt(){this.ft=!0}At(e,s=!1){return Math.max(this.Pi.At(e,s),this.Ri.At(e,s))}Vi(){return this.yi.Si||0}Oi(e){this.yi.Si=e}Bi(){return this.Di(),this.Ci.yt||this.Ti.yt}Ai(){return this.Di(),this.Ci.yt}gt(e){return this.Di(),this.Ci.hi=this.Ci.hi&&e.W().ticksVisible,this.Ti.hi=this.Ti.hi&&e.W().ticksVisible,this.Pi.J(this.Ci,this.yi),this.Ri.J(this.Ti,this.yi),this.Pi}Ii(){return this.Di(),this.Pi.J(this.Ci,this.yi),this.Ri.J(this.Ti,this.yi),this.Ri}Di(){this.ft&&(this.Ci.hi=!0,this.Ti.hi=!1,this.zi(this.Ci,this.Ti,this.yi))}}class nS extends zo{constructor(e,s,r){super(),this.jt=e,this.Li=s,this.Ei=r}zi(e,s,r){if(e.yt=!1,this.jt.W().mode===2)return;const i=this.jt.W().horzLine;if(!i.labelVisible)return;const a=this.Li.Ct();if(!this.jt.yt()||this.Li.Ni()||a===null)return;const l=Ro(i.labelBackgroundColor);r.t=l.t,e.V=l.i;const o=2/12*this.Li.P();r.wi=o,r.gi=o;const c=this.Ei(this.Li);r.ki=c.ki,e.Kt=this.Li.Fi(c._t,a),e.yt=!0}}const rS=/[1-9]/g;class Cg{constructor(){this.zt=null}J(e){this.zt=e}X(e,s){if(this.zt===null||this.zt.yt===!1||this.zt.Kt.length===0)return;const r=e.useMediaCoordinateSpace(({context:h})=>(h.font=s.R,Math.round(s.Wi.xi(h,ee(this.zt).Kt,rS))));if(r<=0)return;const i=s.ji,a=r+2*i,l=a/2,o=this.zt.Hi;let c=this.zt.ki,d=Math.floor(c-l)+.5;d<0?(c+=Math.abs(0-d),d=Math.floor(c-l)+.5):d+a>o&&(c-=Math.abs(o-(d+a)),d=Math.floor(c-l)+.5);const m=d+a,u=Math.ceil(0+s.C+s.T+s.L+s.P+s.B);e.useBitmapCoordinateSpace(({context:h,horizontalPixelRatio:x,verticalPixelRatio:y})=>{const f=ee(this.zt);h.fillStyle=f.t;const w=Math.round(d*x),p=Math.round(0*y),b=Math.round(m*x),v=Math.round(u*y),S=Math.round(2*x);if(h.beginPath(),h.moveTo(w,p),h.lineTo(w,v-S),h.arcTo(w,v,w+S,v,S),h.lineTo(b-S,v),h.arcTo(b,v,b,v-S,S),h.lineTo(b,p),h.fill(),f.hi){const N=Math.round(f.ki*x),k=p,j=Math.round((k+s.T)*y);h.fillStyle=f.V;const E=Math.max(1,Math.floor(x)),_=Math.floor(.5*x);h.fillRect(N-_,k,E,j-k)}}),e.useMediaCoordinateSpace(({context:h})=>{const x=ee(this.zt),y=0+s.C+s.T+s.L+s.P/2;h.font=s.R,h.textAlign="left",h.textBaseline="middle",h.fillStyle=x.V;const f=s.Wi.Mi(h,"Apr0");h.translate(d+i,y+f),h.fillText(x.Kt,0,0)})}}class iS{constructor(e,s,r){this.ft=!0,this.Wt=new Cg,this.Ft={yt:!1,t:"#4c525e",V:"white",Kt:"",Hi:0,ki:NaN,hi:!0},this.vt=e,this.$i=s,this.Ei=r}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt.J(this.Ft),this.Wt}Mt(){const e=this.Ft;if(e.yt=!1,this.vt.W().mode===2)return;const s=this.vt.W().vertLine;if(!s.labelVisible)return;const r=this.$i.St();if(r.Ni())return;e.Hi=r.Hi();const i=this.Ei();if(i===null)return;e.ki=i.ki;const a=r.Ui(this.vt.xt());e.Kt=r.qi(ee(a)),e.yt=!0;const l=Ro(s.labelBackgroundColor);e.t=l.t,e.V=l.i,e.hi=r.W().ticksVisible}}class dh{constructor(){this.Yi=null,this.Zi=0}Xi(){return this.Zi}Ki(e){this.Zi=e}Dt(){return this.Yi}Gi(e){this.Yi=e}Ji(e){return[]}Qi(){return[]}yt(){return!0}}var yp;(function(t){t[t.Normal=0]="Normal",t[t.Magnet=1]="Magnet",t[t.Hidden=2]="Hidden"})(yp||(yp={}));class aS extends dh{constructor(e,s){super(),this.tn=null,this.nn=NaN,this.sn=0,this.en=!0,this.rn=new Map,this.hn=!1,this.ln=NaN,this.an=NaN,this._n=NaN,this.un=NaN,this.$i=e,this.cn=s,this.dn=new Zk(e,this),this.fn=((i,a)=>l=>{const o=a(),c=i();if(l===ee(this.tn).vn())return{_t:c,ki:o};{const d=ee(l.Ct());return{_t:l.pn(o,d),ki:o}}})(()=>this.nn,()=>this.an);const r=((i,a)=>()=>{const l=this.$i.St().mn(i()),o=a();return l&&Number.isFinite(o)?{ot:l,ki:o}:null})(()=>this.sn,()=>this.Yt());this.bn=new iS(this,e,r),this.wn=new tS(this)}W(){return this.cn}gn(e,s){this._n=e,this.un=s}Mn(){this._n=NaN,this.un=NaN}xn(){return this._n}Sn(){return this.un}kn(e,s,r){this.hn||(this.hn=!0),this.en=!0,this.yn(e,s,r)}xt(){return this.sn}Yt(){return this.ln}Zt(){return this.an}yt(){return this.en}Cn(){this.en=!1,this.Tn(),this.nn=NaN,this.ln=NaN,this.an=NaN,this.tn=null,this.Mn()}Pn(e){return this.tn!==null?[this.wn,this.dn]:[]}Ut(e){return e===this.tn&&this.cn.horzLine.visible}qt(){return this.cn.vertLine.visible}Rn(e,s){this.en&&this.tn===e||this.rn.clear();const r=[];return this.tn===e&&r.push(this.Dn(this.rn,s,this.fn)),r}Qi(){return this.en?[this.bn]:[]}Ht(){return this.tn}Vn(){this.wn.bt(),this.rn.forEach(e=>e.bt()),this.bn.bt(),this.dn.bt()}On(e){return e&&!e.vn().Ni()?e.vn():null}yn(e,s,r){this.Bn(e,s,r)&&this.Vn()}Bn(e,s,r){const i=this.ln,a=this.an,l=this.nn,o=this.sn,c=this.tn,d=this.On(r);this.sn=e,this.ln=isNaN(e)?NaN:this.$i.St().It(e),this.tn=r;const m=d!==null?d.Ct():null;return d!==null&&m!==null?(this.nn=s,this.an=d.Rt(s,m)):(this.nn=NaN,this.an=NaN),i!==this.ln||a!==this.an||o!==this.sn||l!==this.nn||c!==this.tn}Tn(){const e=this.$i.wt().map(r=>r.In().An()).filter(Yk),s=e.length===0?null:Math.max(...e);this.sn=s!==null?s:NaN}Dn(e,s,r){let i=e.get(s);return i===void 0&&(i=new nS(this,s,r),e.set(s,i)),i}}function Oo(t){return t==="left"||t==="right"}class rt{constructor(e){this.zn=new Map,this.Ln=[],this.En=e}Nn(e,s){const r=function(i,a){return i===void 0?a:{Fn:Math.max(i.Fn,a.Fn),Wn:i.Wn||a.Wn}}(this.zn.get(e),s);this.zn.set(e,r)}jn(){return this.En}Hn(e){const s=this.zn.get(e);return s===void 0?{Fn:this.En}:{Fn:Math.max(this.En,s.Fn),Wn:s.Wn}}$n(){this.Un(),this.Ln=[{qn:0}]}Yn(e){this.Un(),this.Ln=[{qn:1,Vt:e}]}Zn(e){this.Xn(),this.Ln.push({qn:5,Vt:e})}Un(){this.Xn(),this.Ln.push({qn:6})}Kn(){this.Un(),this.Ln=[{qn:4}]}Gn(e){this.Un(),this.Ln.push({qn:2,Vt:e})}Jn(e){this.Un(),this.Ln.push({qn:3,Vt:e})}Qn(){return this.Ln}ts(e){for(const s of e.Ln)this.ns(s);this.En=Math.max(this.En,e.En),e.zn.forEach((s,r)=>{this.Nn(r,s)})}static ss(){return new rt(2)}static es(){return new rt(3)}ns(e){switch(e.qn){case 0:this.$n();break;case 1:this.Yn(e.Vt);break;case 2:this.Gn(e.Vt);break;case 3:this.Jn(e.Vt);break;case 4:this.Kn();break;case 5:this.Zn(e.Vt);break;case 6:this.Xn()}}Xn(){const e=this.Ln.findIndex(s=>s.qn===5);e!==-1&&this.Ln.splice(e,1)}}const bp=".";function ks(t,e){if(!ms(t))return"n/a";if(!xa(e))throw new TypeError("invalid length");if(e<0||e>16)throw new TypeError("invalid length");return e===0?t.toString():("0000000000000000"+t.toString()).slice(-e)}class Io{constructor(e,s){if(s||(s=1),ms(e)&&xa(e)||(e=100),e<0)throw new TypeError("invalid base");this.Li=e,this.rs=s,this.hs()}format(e){const s=e<0?"":"";return e=Math.abs(e),s+this.ls(e)}hs(){if(this._s=0,this.Li>0&&this.rs>0){let e=this.Li;for(;e>1;)e/=10,this._s++}}ls(e){const s=this.Li/this.rs;let r=Math.floor(e),i="";const a=this._s!==void 0?this._s:NaN;if(s>1){let l=+(Math.round(e*s)-r*s).toFixed(this._s);l>=s&&(l-=s,r+=1),i=bp+ks(+l.toFixed(this._s)*this.rs,a)}else r=Math.round(r*s)/s,a>0&&(i=bp+ks(0,a));return r.toFixed(0)+i}}class Eg extends Io{constructor(e=100){super(e)}format(e){return`${super.format(e)}%`}}class lS{constructor(e){this.us=e}format(e){let s="";return e<0&&(s="-",e=-e),e<995?s+this.cs(e):e<999995?s+this.cs(e/1e3)+"K":e<999999995?(e=1e3*Math.round(e/1e3),s+this.cs(e/1e6)+"M"):(e=1e6*Math.round(e/1e6),s+this.cs(e/1e9)+"B")}cs(e){let s;const r=Math.pow(10,this.us);return s=(e=Math.round(e*r)/r)>=1e-15&&e<1?e.toFixed(this.us).replace(/\.?0+$/,""):String(e),s.replace(/(\.[1-9]*)0+$/,(i,a)=>a)}}function Tg(t,e,s,r,i,a,l){if(e.length===0||r.from>=e.length||r.to<=0)return;const{context:o,horizontalPixelRatio:c,verticalPixelRatio:d}=t,m=e[r.from];let u=a(t,m),h=m;if(r.to-r.from<2){const x=i/2;o.beginPath();const y={nt:m.nt-x,st:m.st},f={nt:m.nt+x,st:m.st};o.moveTo(y.nt*c,y.st*d),o.lineTo(f.nt*c,f.st*d),l(t,u,y,f)}else{const x=(f,w)=>{l(t,u,h,w),o.beginPath(),u=f,h=w};let y=h;o.beginPath(),o.moveTo(m.nt*c,m.st*d);for(let f=r.from+1;f<r.to;++f){y=e[f];const w=a(t,y);switch(s){case 0:o.lineTo(y.nt*c,y.st*d);break;case 1:o.lineTo(y.nt*c,e[f-1].st*d),w!==u&&(x(w,y),o.lineTo(y.nt*c,e[f-1].st*d)),o.lineTo(y.nt*c,y.st*d);break;case 2:{const[p,b]=oS(e,f-1,f);o.bezierCurveTo(p.nt*c,p.st*d,b.nt*c,b.st*d,y.nt*c,y.st*d);break}}s!==1&&w!==u&&(x(w,y),o.moveTo(y.nt*c,y.st*d))}(h!==y||h===y&&s===1)&&l(t,u,h,y)}}const vp=6;function yc(t,e){return{nt:t.nt-e.nt,st:t.st-e.st}}function Np(t,e){return{nt:t.nt/e,st:t.st/e}}function oS(t,e,s){const r=Math.max(0,e-1),i=Math.min(t.length-1,s+1);var a,l;return[(a=t[e],l=Np(yc(t[s],t[r]),vp),{nt:a.nt+l.nt,st:a.st+l.st}),yc(t[s],Np(yc(t[i],t[e]),vp))]}function cS(t,e,s,r,i){const{context:a,horizontalPixelRatio:l,verticalPixelRatio:o}=e;a.lineTo(i.nt*l,t*o),a.lineTo(r.nt*l,t*o),a.closePath(),a.fillStyle=s,a.fill()}class Pg extends as{constructor(){super(...arguments),this.G=null}J(e){this.G=e}K(e){var s;if(this.G===null)return;const{it:r,tt:i,ds:a,et:l,Nt:o,fs:c}=this.G,d=(s=this.G.vs)!==null&&s!==void 0?s:this.G.ps?0:e.mediaSize.height;if(i===null)return;const m=e.context;m.lineCap="butt",m.lineJoin="round",m.lineWidth=l,Hn(m,o),m.lineWidth=1,Tg(e,r,c,i,a,this.bs.bind(this),cS.bind(null,d))}}function Wd(t,e,s){return Math.min(Math.max(t,e),s)}function Ga(t,e,s){return e-t<=s}function Lg(t){const e=Math.ceil(t);return e%2==0?e-1:e}class uh{ws(e,s){const r=this.gs,{Ms:i,xs:a,Ss:l,ks:o,ys:c,vs:d}=s;if(this.Cs===void 0||r===void 0||r.Ms!==i||r.xs!==a||r.Ss!==l||r.ks!==o||r.vs!==d||r.ys!==c){const m=e.context.createLinearGradient(0,0,0,c);if(m.addColorStop(0,i),d!=null){const u=Wd(d*e.verticalPixelRatio/c,0,1);m.addColorStop(u,a),m.addColorStop(u,l)}m.addColorStop(1,o),this.Cs=m,this.gs=s}return this.Cs}}class dS extends Pg{constructor(){super(...arguments),this.Ts=new uh}bs(e,s){return this.Ts.ws(e,{Ms:s.Ps,xs:"",Ss:"",ks:s.Rs,ys:e.bitmapSize.height})}}function uS(t,e){const s=t.context;s.strokeStyle=e,s.stroke()}class _g extends as{constructor(){super(...arguments),this.G=null}J(e){this.G=e}K(e){if(this.G===null)return;const{it:s,tt:r,ds:i,fs:a,et:l,Nt:o,Ds:c}=this.G;if(r===null)return;const d=e.context;d.lineCap="butt",d.lineWidth=l*e.verticalPixelRatio,Hn(d,o),d.lineJoin="round";const m=this.Vs.bind(this);a!==void 0&&Tg(e,s,a,r,i,m,uS),c&&function(u,h,x,y,f){const{horizontalPixelRatio:w,verticalPixelRatio:p,context:b}=u;let v=null;const S=Math.max(1,Math.floor(w))%2/2,N=x*p+S;for(let k=y.to-1;k>=y.from;--k){const j=h[k];if(j){const E=f(u,j);E!==v&&(b.beginPath(),v!==null&&b.fill(),b.fillStyle=E,v=E);const _=Math.round(j.nt*w)+S,M=j.st*p;b.moveTo(_,M),b.arc(_,M,N,0,2*Math.PI)}}b.fill()}(e,s,c,r,m)}}class Mg extends _g{Vs(e,s){return s.lt}}function Rg(t,e,s,r,i=0,a=e.length){let l=a-i;for(;0<l;){const o=l>>1,c=i+o;r(e[c],s)===t?(i=c+1,l-=o+1):l=o}return i}const Pa=Rg.bind(null,!0),Ag=Rg.bind(null,!1);function hS(t,e){return t.ot<e}function mS(t,e){return e<t.ot}function zg(t,e,s){const r=e.Os(),i=e.ui(),a=Pa(t,r,hS),l=Ag(t,i,mS);if(!s)return{from:a,to:l};let o=a,c=l;return a>0&&a<t.length&&t[a].ot>=r&&(o=a-1),l>0&&l<t.length&&t[l-1].ot<=i&&(c=l+1),{from:o,to:c}}class hh{constructor(e,s,r){this.Bs=!0,this.As=!0,this.Is=!0,this.zs=[],this.Ls=null,this.Es=e,this.Ns=s,this.Fs=r}bt(e){this.Bs=!0,e==="data"&&(this.As=!0),e==="options"&&(this.Is=!0)}gt(){return this.Es.yt()?(this.Ws(),this.Ls===null?null:this.js):null}Hs(){this.zs=this.zs.map(e=>Object.assign(Object.assign({},e),this.Es.Us().$s(e.ot)))}qs(){this.Ls=null}Ws(){this.As&&(this.Ys(),this.As=!1),this.Is&&(this.Hs(),this.Is=!1),this.Bs&&(this.Zs(),this.Bs=!1)}Zs(){const e=this.Es.Dt(),s=this.Ns.St();if(this.qs(),s.Ni()||e.Ni())return;const r=s.Xs();if(r===null||this.Es.In().Ks()===0)return;const i=this.Es.Ct();i!==null&&(this.Ls=zg(this.zs,r,this.Fs),this.Gs(e,s,i.Vt),this.Js())}}class $o extends hh{constructor(e,s){super(e,s,!0)}Gs(e,s,r){s.Qs(this.zs,fa(this.Ls)),e.te(this.zs,r,fa(this.Ls))}ie(e,s){return{ot:e,_t:s,nt:NaN,st:NaN}}Ys(){const e=this.Es.Us();this.zs=this.Es.In().ne().map(s=>{const r=s.Vt[3];return this.se(s.ee,r,e)})}}class pS extends $o{constructor(e,s){super(e,s),this.js=new ch,this.re=new dS,this.he=new Mg,this.js.Z([this.re,this.he])}se(e,s,r){return Object.assign(Object.assign({},this.ie(e,s)),r.$s(e))}Js(){const e=this.Es.W();this.re.J({fs:e.lineType,it:this.zs,Nt:e.lineStyle,et:e.lineWidth,vs:null,ps:e.invertFilledArea,tt:this.Ls,ds:this.Ns.St().le()}),this.he.J({fs:e.lineVisible?e.lineType:void 0,it:this.zs,Nt:e.lineStyle,et:e.lineWidth,tt:this.Ls,ds:this.Ns.St().le(),Ds:e.pointMarkersVisible?e.pointMarkersRadius||e.lineWidth/2+2:void 0})}}class xS extends as{constructor(){super(...arguments),this.zt=null,this.ae=0,this.oe=0}J(e){this.zt=e}K({context:e,horizontalPixelRatio:s,verticalPixelRatio:r}){if(this.zt===null||this.zt.In.length===0||this.zt.tt===null)return;this.ae=this._e(s),this.ae>=2&&Math.max(1,Math.floor(s))%2!=this.ae%2&&this.ae--,this.oe=this.zt.ue?Math.min(this.ae,Math.floor(s)):this.ae;let i=null;const a=this.oe<=this.ae&&this.zt.le>=Math.floor(1.5*s);for(let l=this.zt.tt.from;l<this.zt.tt.to;++l){const o=this.zt.In[l];i!==o.ce&&(e.fillStyle=o.ce,i=o.ce);const c=Math.floor(.5*this.oe),d=Math.round(o.nt*s),m=d-c,u=this.oe,h=m+u-1,x=Math.min(o.de,o.fe),y=Math.max(o.de,o.fe),f=Math.round(x*r)-c,w=Math.round(y*r)+c,p=Math.max(w-f,this.oe);e.fillRect(m,f,u,p);const b=Math.ceil(1.5*this.ae);if(a){if(this.zt.ve){const k=d-b;let j=Math.max(f,Math.round(o.pe*r)-c),E=j+u-1;E>f+p-1&&(E=f+p-1,j=E-u+1),e.fillRect(k,j,m-k,E-j+1)}const v=d+b;let S=Math.max(f,Math.round(o.me*r)-c),N=S+u-1;N>f+p-1&&(N=f+p-1,S=N-u+1),e.fillRect(h+1,S,v-h,N-S+1)}}}_e(e){const s=Math.floor(e);return Math.max(s,Math.floor(function(r,i){return Math.floor(.3*r*i)}(ee(this.zt).le,e)))}}class Og extends hh{constructor(e,s){super(e,s,!1)}Gs(e,s,r){s.Qs(this.zs,fa(this.Ls)),e.be(this.zs,r,fa(this.Ls))}we(e,s,r){return{ot:e,ge:s.Vt[0],Me:s.Vt[1],xe:s.Vt[2],Se:s.Vt[3],nt:NaN,pe:NaN,de:NaN,fe:NaN,me:NaN}}Ys(){const e=this.Es.Us();this.zs=this.Es.In().ne().map(s=>this.se(s.ee,s,e))}}class fS extends Og{constructor(){super(...arguments),this.js=new xS}se(e,s,r){return Object.assign(Object.assign({},this.we(e,s,r)),r.$s(e))}Js(){const e=this.Es.W();this.js.J({In:this.zs,le:this.Ns.St().le(),ve:e.openVisible,ue:e.thinBars,tt:this.Ls})}}class gS extends Pg{constructor(){super(...arguments),this.Ts=new uh}bs(e,s){const r=this.G;return this.Ts.ws(e,{Ms:s.ke,xs:s.ye,Ss:s.Ce,ks:s.Te,ys:e.bitmapSize.height,vs:r.vs})}}class yS extends _g{constructor(){super(...arguments),this.Pe=new uh}Vs(e,s){const r=this.G;return this.Pe.ws(e,{Ms:s.Re,xs:s.Re,Ss:s.De,ks:s.De,ys:e.bitmapSize.height,vs:r.vs})}}class bS extends $o{constructor(e,s){super(e,s),this.js=new ch,this.Ve=new gS,this.Oe=new yS,this.js.Z([this.Ve,this.Oe])}se(e,s,r){return Object.assign(Object.assign({},this.ie(e,s)),r.$s(e))}Js(){const e=this.Es.Ct();if(e===null)return;const s=this.Es.W(),r=this.Es.Dt().Rt(s.baseValue.price,e.Vt),i=this.Ns.St().le();this.Ve.J({it:this.zs,et:s.lineWidth,Nt:s.lineStyle,fs:s.lineType,vs:r,ps:!1,tt:this.Ls,ds:i}),this.Oe.J({it:this.zs,et:s.lineWidth,Nt:s.lineStyle,fs:s.lineVisible?s.lineType:void 0,Ds:s.pointMarkersVisible?s.pointMarkersRadius||s.lineWidth/2+2:void 0,vs:r,tt:this.Ls,ds:i})}}class vS extends as{constructor(){super(...arguments),this.zt=null,this.ae=0}J(e){this.zt=e}K(e){if(this.zt===null||this.zt.In.length===0||this.zt.tt===null)return;const{horizontalPixelRatio:s}=e;this.ae=function(a,l){if(a>=2.5&&a<=4)return Math.floor(3*l);const o=1-.2*Math.atan(Math.max(4,a)-4)/(.5*Math.PI),c=Math.floor(a*o*l),d=Math.floor(a*l),m=Math.min(c,d);return Math.max(Math.floor(l),m)}(this.zt.le,s),this.ae>=2&&Math.floor(s)%2!=this.ae%2&&this.ae--;const r=this.zt.In;this.zt.Be&&this.Ae(e,r,this.zt.tt),this.zt._i&&this.Ie(e,r,this.zt.tt);const i=this.ze(s);(!this.zt._i||this.ae>2*i)&&this.Le(e,r,this.zt.tt)}Ae(e,s,r){if(this.zt===null)return;const{context:i,horizontalPixelRatio:a,verticalPixelRatio:l}=e;let o="",c=Math.min(Math.floor(a),Math.floor(this.zt.le*a));c=Math.max(Math.floor(a),Math.min(c,this.ae));const d=Math.floor(.5*c);let m=null;for(let u=r.from;u<r.to;u++){const h=s[u];h.Ee!==o&&(i.fillStyle=h.Ee,o=h.Ee);const x=Math.round(Math.min(h.pe,h.me)*l),y=Math.round(Math.max(h.pe,h.me)*l),f=Math.round(h.de*l),w=Math.round(h.fe*l);let p=Math.round(a*h.nt)-d;const b=p+c-1;m!==null&&(p=Math.max(m+1,p),p=Math.min(p,b));const v=b-p+1;i.fillRect(p,f,v,x-f),i.fillRect(p,y+1,v,w-y),m=b}}ze(e){let s=Math.floor(1*e);this.ae<=2*s&&(s=Math.floor(.5*(this.ae-1)));const r=Math.max(Math.floor(e),s);return this.ae<=2*r?Math.max(Math.floor(e),Math.floor(1*e)):r}Ie(e,s,r){if(this.zt===null)return;const{context:i,horizontalPixelRatio:a,verticalPixelRatio:l}=e;let o="";const c=this.ze(a);let d=null;for(let m=r.from;m<r.to;m++){const u=s[m];u.Ne!==o&&(i.fillStyle=u.Ne,o=u.Ne);let h=Math.round(u.nt*a)-Math.floor(.5*this.ae);const x=h+this.ae-1,y=Math.round(Math.min(u.pe,u.me)*l),f=Math.round(Math.max(u.pe,u.me)*l);if(d!==null&&(h=Math.max(d+1,h),h=Math.min(h,x)),this.zt.le*a>2*c)sS(i,h,y,x-h+1,f-y+1,c);else{const w=x-h+1;i.fillRect(h,y,w,f-y+1)}d=x}}Le(e,s,r){if(this.zt===null)return;const{context:i,horizontalPixelRatio:a,verticalPixelRatio:l}=e;let o="";const c=this.ze(a);for(let d=r.from;d<r.to;d++){const m=s[d];let u=Math.round(Math.min(m.pe,m.me)*l),h=Math.round(Math.max(m.pe,m.me)*l),x=Math.round(m.nt*a)-Math.floor(.5*this.ae),y=x+this.ae-1;if(m.ce!==o){const f=m.ce;i.fillStyle=f,o=f}this.zt._i&&(x+=c,u+=c,y-=c,h-=c),u>h||i.fillRect(x,u,y-x+1,h-u+1)}}}class NS extends Og{constructor(){super(...arguments),this.js=new vS}se(e,s,r){return Object.assign(Object.assign({},this.we(e,s,r)),r.$s(e))}Js(){const e=this.Es.W();this.js.J({In:this.zs,le:this.Ns.St().le(),Be:e.wickVisible,_i:e.borderVisible,tt:this.Ls})}}class jS{constructor(e,s){this.Fe=e,this.Li=s}X(e,s,r){this.Fe.draw(e,this.Li,s,r)}}class bc extends hh{constructor(e,s,r){super(e,s,!1),this.wn=r,this.js=new jS(this.wn.renderer(),i=>{const a=e.Ct();return a===null?null:e.Dt().Rt(i,a.Vt)})}We(e){return this.wn.priceValueBuilder(e)}je(e){return this.wn.isWhitespace(e)}Ys(){const e=this.Es.Us();this.zs=this.Es.In().ne().map(s=>Object.assign(Object.assign({ot:s.ee,nt:NaN},e.$s(s.ee)),{He:s.$e}))}Gs(e,s){s.Qs(this.zs,fa(this.Ls))}Js(){this.wn.update({bars:this.zs.map(wS),barSpacing:this.Ns.St().le(),visibleRange:this.Ls},this.Es.W())}}function wS(t){return{x:t.nt,time:t.ot,originalData:t.He,barColor:t.ce}}class kS extends as{constructor(){super(...arguments),this.zt=null,this.Ue=[]}J(e){this.zt=e,this.Ue=[]}K({context:e,horizontalPixelRatio:s,verticalPixelRatio:r}){if(this.zt===null||this.zt.it.length===0||this.zt.tt===null)return;this.Ue.length||this.qe(s);const i=Math.max(1,Math.floor(r)),a=Math.round(this.zt.Ye*r)-Math.floor(i/2),l=a+i;for(let o=this.zt.tt.from;o<this.zt.tt.to;o++){const c=this.zt.it[o],d=this.Ue[o-this.zt.tt.from],m=Math.round(c.st*r);let u,h;e.fillStyle=c.ce,m<=a?(u=m,h=l):(u=a,h=m-Math.floor(i/2)+i),e.fillRect(d.Os,u,d.ui-d.Os+1,h-u)}}qe(e){if(this.zt===null||this.zt.it.length===0||this.zt.tt===null)return void(this.Ue=[]);const s=Math.ceil(this.zt.le*e)<=1?0:Math.max(1,Math.floor(e)),r=Math.round(this.zt.le*e)-s;this.Ue=new Array(this.zt.tt.to-this.zt.tt.from);for(let a=this.zt.tt.from;a<this.zt.tt.to;a++){const l=this.zt.it[a],o=Math.round(l.nt*e);let c,d;if(r%2){const m=(r-1)/2;c=o-m,d=o+m}else{const m=r/2;c=o-m,d=o+m-1}this.Ue[a-this.zt.tt.from]={Os:c,ui:d,Ze:o,Xe:l.nt*e,ot:l.ot}}for(let a=this.zt.tt.from+1;a<this.zt.tt.to;a++){const l=this.Ue[a-this.zt.tt.from],o=this.Ue[a-this.zt.tt.from-1];l.ot===o.ot+1&&l.Os-o.ui!==s+1&&(o.Ze>o.Xe?o.ui=l.Os-s-1:l.Os=o.ui+s+1)}let i=Math.ceil(this.zt.le*e);for(let a=this.zt.tt.from;a<this.zt.tt.to;a++){const l=this.Ue[a-this.zt.tt.from];l.ui<l.Os&&(l.ui=l.Os);const o=l.ui-l.Os+1;i=Math.min(o,i)}if(s>0&&i<4)for(let a=this.zt.tt.from;a<this.zt.tt.to;a++){const l=this.Ue[a-this.zt.tt.from];l.ui-l.Os+1>i&&(l.Ze>l.Xe?l.ui-=1:l.Os+=1)}}}class SS extends $o{constructor(){super(...arguments),this.js=new kS}se(e,s,r){return Object.assign(Object.assign({},this.ie(e,s)),r.$s(e))}Js(){const e={it:this.zs,le:this.Ns.St().le(),tt:this.Ls,Ye:this.Es.Dt().Rt(this.Es.W().base,ee(this.Es.Ct()).Vt)};this.js.J(e)}}class CS extends $o{constructor(){super(...arguments),this.js=new Mg}se(e,s,r){return Object.assign(Object.assign({},this.ie(e,s)),r.$s(e))}Js(){const e=this.Es.W(),s={it:this.zs,Nt:e.lineStyle,fs:e.lineVisible?e.lineType:void 0,et:e.lineWidth,Ds:e.pointMarkersVisible?e.pointMarkersRadius||e.lineWidth/2+2:void 0,tt:this.Ls,ds:this.Ns.St().le()};this.js.J(s)}}const ES=/[2-9]/g;class ga{constructor(e=50){this.Ke=0,this.Ge=1,this.Je=1,this.Qe={},this.tr=new Map,this.ir=e}nr(){this.Ke=0,this.tr.clear(),this.Ge=1,this.Je=1,this.Qe={}}xi(e,s,r){return this.sr(e,s,r).width}Mi(e,s,r){const i=this.sr(e,s,r);return((i.actualBoundingBoxAscent||0)-(i.actualBoundingBoxDescent||0))/2}sr(e,s,r){const i=r||ES,a=String(s).replace(i,"0");if(this.tr.has(a))return yt(this.tr.get(a)).er;if(this.Ke===this.ir){const o=this.Qe[this.Je];delete this.Qe[this.Je],this.tr.delete(o),this.Je++,this.Ke--}e.save(),e.textBaseline="middle";const l=e.measureText(a);return e.restore(),l.width===0&&s.length||(this.tr.set(a,{er:l,rr:this.Ge}),this.Qe[this.Ge]=a,this.Ke++,this.Ge++),l}}class TS{constructor(e){this.hr=null,this.k=null,this.lr="right",this.ar=e}_r(e,s,r){this.hr=e,this.k=s,this.lr=r}X(e){this.k!==null&&this.hr!==null&&this.hr.X(e,this.k,this.ar,this.lr)}}class Ig{constructor(e,s,r){this.ur=e,this.ar=new ga(50),this.cr=s,this.F=r,this.j=-1,this.Wt=new TS(this.ar)}gt(){const e=this.F.dr(this.cr);if(e===null)return null;const s=e.vr(this.cr)?e.pr():this.cr.Dt();if(s===null)return null;const r=e.mr(s);if(r==="overlay")return null;const i=this.F.br();return i.P!==this.j&&(this.j=i.P,this.ar.nr()),this.Wt._r(this.ur.Ii(),i,r),this.Wt}}class PS extends as{constructor(){super(...arguments),this.zt=null}J(e){this.zt=e}wr(e,s){var r;if(!(!((r=this.zt)===null||r===void 0)&&r.yt))return null;const{st:i,et:a,gr:l}=this.zt;return s>=i-a-7&&s<=i+a+7?{Mr:this.zt,gr:l}:null}K({context:e,bitmapSize:s,horizontalPixelRatio:r,verticalPixelRatio:i}){if(this.zt===null||this.zt.yt===!1)return;const a=Math.round(this.zt.st*i);a<0||a>s.height||(e.lineCap="butt",e.strokeStyle=this.zt.V,e.lineWidth=Math.floor(this.zt.et*r),Hn(e,this.zt.Nt),jg(e,a,0,s.width))}}class mh{constructor(e){this.Sr={st:0,V:"rgba(0, 0, 0, 0)",et:1,Nt:0,yt:!1},this.kr=new PS,this.ft=!0,this.Es=e,this.Ns=e.$t(),this.kr.J(this.Sr)}bt(){this.ft=!0}gt(){return this.Es.yt()?(this.ft&&(this.yr(),this.ft=!1),this.kr):null}}class LS extends mh{constructor(e){super(e)}yr(){this.Sr.yt=!1;const e=this.Es.Dt(),s=e.Cr().Cr;if(s!==2&&s!==3)return;const r=this.Es.W();if(!r.baseLineVisible||!this.Es.yt())return;const i=this.Es.Ct();i!==null&&(this.Sr.yt=!0,this.Sr.st=e.Rt(i.Vt,i.Vt),this.Sr.V=r.baseLineColor,this.Sr.et=r.baseLineWidth,this.Sr.Nt=r.baseLineStyle)}}class _S extends as{constructor(){super(...arguments),this.zt=null}J(e){this.zt=e}$e(){return this.zt}K({context:e,horizontalPixelRatio:s,verticalPixelRatio:r}){const i=this.zt;if(i===null)return;const a=Math.max(1,Math.floor(s)),l=a%2/2,o=Math.round(i.Xe.x*s)+l,c=i.Xe.y*r;e.fillStyle=i.Tr,e.beginPath();const d=Math.max(2,1.5*i.Pr)*s;e.arc(o,c,d,0,2*Math.PI,!1),e.fill(),e.fillStyle=i.Rr,e.beginPath(),e.arc(o,c,i.ht*s,0,2*Math.PI,!1),e.fill(),e.lineWidth=a,e.strokeStyle=i.Dr,e.beginPath(),e.arc(o,c,i.ht*s+a/2,0,2*Math.PI,!1),e.stroke()}}const MS=[{Vr:0,Or:.25,Br:4,Ar:10,Ir:.25,zr:0,Lr:.4,Er:.8},{Vr:.25,Or:.525,Br:10,Ar:14,Ir:0,zr:0,Lr:.8,Er:0},{Vr:.525,Or:1,Br:14,Ar:14,Ir:0,zr:0,Lr:0,Er:0}];function jp(t,e,s,r){return function(i,a){if(i==="transparent")return i;const l=pa(i),o=l[3];return`rgba(${l[0]}, ${l[1]}, ${l[2]}, ${a*o})`}(t,s+(r-s)*e)}function wp(t,e){const s=t%2600/2600;let r;for(const c of MS)if(s>=c.Vr&&s<=c.Or){r=c;break}fn(r!==void 0,"Last price animation internal logic error");const i=(s-r.Vr)/(r.Or-r.Vr);return{Rr:jp(e,i,r.Ir,r.zr),Dr:jp(e,i,r.Lr,r.Er),ht:(a=i,l=r.Br,o=r.Ar,l+(o-l)*a)};var a,l,o}class RS{constructor(e){this.Wt=new _S,this.ft=!0,this.Nr=!0,this.Fr=performance.now(),this.Wr=this.Fr-1,this.jr=e}Hr(){this.Wr=this.Fr-1,this.bt()}$r(){if(this.bt(),this.jr.W().lastPriceAnimation===2){const e=performance.now(),s=this.Wr-e;if(s>0)return void(s<650&&(this.Wr+=2600));this.Fr=e,this.Wr=e+2600}}bt(){this.ft=!0}Ur(){this.Nr=!0}yt(){return this.jr.W().lastPriceAnimation!==0}qr(){switch(this.jr.W().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.Wr}}gt(){return this.ft?(this.Mt(),this.ft=!1,this.Nr=!1):this.Nr&&(this.Yr(),this.Nr=!1),this.Wt}Mt(){this.Wt.J(null);const e=this.jr.$t().St(),s=e.Xs(),r=this.jr.Ct();if(s===null||r===null)return;const i=this.jr.Zr(!0);if(i.Xr||!s.Kr(i.ee))return;const a={x:e.It(i.ee),y:this.jr.Dt().Rt(i._t,r.Vt)},l=i.V,o=this.jr.W().lineWidth,c=wp(this.Gr(),l);this.Wt.J({Tr:l,Pr:o,Rr:c.Rr,Dr:c.Dr,ht:c.ht,Xe:a})}Yr(){const e=this.Wt.$e();if(e!==null){const s=wp(this.Gr(),e.Tr);e.Rr=s.Rr,e.Dr=s.Dr,e.ht=s.ht}}Gr(){return this.qr()?performance.now()-this.Fr:2599}}function Vi(t,e){return Lg(Math.min(Math.max(t,12),30)*e)}function ya(t,e){switch(t){case"arrowDown":case"arrowUp":return Vi(e,1);case"circle":return Vi(e,.8);case"square":return Vi(e,.7)}}function $g(t){return function(e){const s=Math.ceil(e);return s%2!=0?s-1:s}(Vi(t,1))}function kp(t){return Math.max(Vi(t,.1),3)}function Sp(t,e,s){return e?t:s?Math.ceil(t/2):0}function Bg(t,e,s,r,i){const a=ya("square",s),l=(a-1)/2,o=t-l,c=e-l;return r>=o&&r<=o+a&&i>=c&&i<=c+a}function Cp(t,e,s,r){const i=(ya("arrowUp",r)-1)/2*s.Jr,a=(Lg(r/2)-1)/2*s.Jr;e.beginPath(),t?(e.moveTo(s.nt-i,s.st),e.lineTo(s.nt,s.st-i),e.lineTo(s.nt+i,s.st),e.lineTo(s.nt+a,s.st),e.lineTo(s.nt+a,s.st+i),e.lineTo(s.nt-a,s.st+i),e.lineTo(s.nt-a,s.st)):(e.moveTo(s.nt-i,s.st),e.lineTo(s.nt,s.st+i),e.lineTo(s.nt+i,s.st),e.lineTo(s.nt+a,s.st),e.lineTo(s.nt+a,s.st-i),e.lineTo(s.nt-a,s.st-i),e.lineTo(s.nt-a,s.st)),e.fill()}function AS(t,e,s,r,i,a){return Bg(e,s,r,i,a)}class zS extends as{constructor(){super(...arguments),this.zt=null,this.ar=new ga,this.j=-1,this.H="",this.Qr=""}J(e){this.zt=e}_r(e,s){this.j===e&&this.H===s||(this.j=e,this.H=s,this.Qr=Or(e,s),this.ar.nr())}wr(e,s){if(this.zt===null||this.zt.tt===null)return null;for(let r=this.zt.tt.from;r<this.zt.tt.to;r++){const i=this.zt.it[r];if(IS(i,e,s))return{Mr:i.th,gr:i.gr}}return null}K({context:e,horizontalPixelRatio:s,verticalPixelRatio:r},i,a){if(this.zt!==null&&this.zt.tt!==null){e.textBaseline="middle",e.font=this.Qr;for(let l=this.zt.tt.from;l<this.zt.tt.to;l++){const o=this.zt.it[l];o.Kt!==void 0&&(o.Kt.Hi=this.ar.xi(e,o.Kt.ih),o.Kt.At=this.j,o.Kt.nt=o.nt-o.Kt.Hi/2),OS(o,e,s,r)}}}}function OS(t,e,s,r){e.fillStyle=t.V,t.Kt!==void 0&&function(i,a,l,o,c,d){i.save(),i.scale(c,d),i.fillText(a,l,o),i.restore()}(e,t.Kt.ih,t.Kt.nt,t.Kt.st,s,r),function(i,a,l){if(i.Ks!==0){switch(i.nh){case"arrowDown":return void Cp(!1,a,l,i.Ks);case"arrowUp":return void Cp(!0,a,l,i.Ks);case"circle":return void function(o,c,d){const m=(ya("circle",d)-1)/2;o.beginPath(),o.arc(c.nt,c.st,m*c.Jr,0,2*Math.PI,!1),o.fill()}(a,l,i.Ks);case"square":return void function(o,c,d){const m=ya("square",d),u=(m-1)*c.Jr/2,h=c.nt-u,x=c.st-u;o.fillRect(h,x,m*c.Jr,m*c.Jr)}(a,l,i.Ks)}i.nh}}(t,e,function(i,a,l){const o=Math.max(1,Math.floor(a))%2/2;return{nt:Math.round(i.nt*a)+o,st:i.st*l,Jr:a}}(t,s,r))}function IS(t,e,s){return!(t.Kt===void 0||!function(r,i,a,l,o,c){const d=l/2;return o>=r&&o<=r+a&&c>=i-d&&c<=i+d}(t.Kt.nt,t.Kt.st,t.Kt.Hi,t.Kt.At,e,s))||function(r,i,a){if(r.Ks===0)return!1;switch(r.nh){case"arrowDown":case"arrowUp":return AS(0,r.nt,r.st,r.Ks,i,a);case"circle":return function(l,o,c,d,m){const u=2+ya("circle",c)/2,h=l-d,x=o-m;return Math.sqrt(h*h+x*x)<=u}(r.nt,r.st,r.Ks,i,a);case"square":return Bg(r.nt,r.st,r.Ks,i,a)}}(t,e,s)}function $S(t,e,s,r,i,a,l,o,c){const d=ms(s)?s:s.Se,m=ms(s)?s:s.Me,u=ms(s)?s:s.xe,h=ms(e.size)?Math.max(e.size,0):1,x=$g(o.le())*h,y=x/2;switch(t.Ks=x,e.position){case"inBar":return t.st=l.Rt(d,c),void(t.Kt!==void 0&&(t.Kt.st=t.st+y+a+.6*i));case"aboveBar":return t.st=l.Rt(m,c)-y-r.sh,t.Kt!==void 0&&(t.Kt.st=t.st-y-.6*i,r.sh+=1.2*i),void(r.sh+=x+a);case"belowBar":return t.st=l.Rt(u,c)+y+r.eh,t.Kt!==void 0&&(t.Kt.st=t.st+y+a+.6*i,r.eh+=1.2*i),void(r.eh+=x+a)}e.position}class BS{constructor(e,s){this.ft=!0,this.rh=!0,this.hh=!0,this.ah=null,this.oh=null,this.Wt=new zS,this.jr=e,this.$i=s,this.zt={it:[],tt:null}}bt(e){this.ft=!0,this.hh=!0,e==="data"&&(this.rh=!0,this.oh=null)}gt(e){if(!this.jr.yt())return null;this.ft&&this._h();const s=this.$i.W().layout;return this.Wt._r(s.fontSize,s.fontFamily),this.Wt.J(this.zt),this.Wt}uh(){if(this.hh){if(this.jr.dh().length>0){const e=this.$i.St().le(),s=kp(e),r=1.5*$g(e)+2*s,i=this.fh();this.ah={above:Sp(r,i.aboveBar,i.inBar),below:Sp(r,i.belowBar,i.inBar)}}else this.ah=null;this.hh=!1}return this.ah}fh(){return this.oh===null&&(this.oh=this.jr.dh().reduce((e,s)=>(e[s.position]||(e[s.position]=!0),e),{inBar:!1,aboveBar:!1,belowBar:!1})),this.oh}_h(){const e=this.jr.Dt(),s=this.$i.St(),r=this.jr.dh();this.rh&&(this.zt.it=r.map(m=>({ot:m.time,nt:0,st:0,Ks:0,nh:m.shape,V:m.color,th:m.th,gr:m.id,Kt:void 0})),this.rh=!1);const i=this.$i.W().layout;this.zt.tt=null;const a=s.Xs();if(a===null)return;const l=this.jr.Ct();if(l===null||this.zt.it.length===0)return;let o=NaN;const c=kp(s.le()),d={sh:c,eh:c};this.zt.tt=zg(this.zt.it,a,!0);for(let m=this.zt.tt.from;m<this.zt.tt.to;m++){const u=r[m];u.time!==o&&(d.sh=c,d.eh=c,o=u.time);const h=this.zt.it[m];h.nt=s.It(u.time),u.text!==void 0&&u.text.length>0&&(h.Kt={ih:u.text,nt:0,st:0,Hi:0,At:0});const x=this.jr.ph(u.time);x!==null&&$S(h,u,x,d,i.fontSize,c,e,s,l.Vt)}this.ft=!1}}class DS extends mh{constructor(e){super(e)}yr(){const e=this.Sr;e.yt=!1;const s=this.Es.W();if(!s.priceLineVisible||!this.Es.yt())return;const r=this.Es.Zr(s.priceLineSource===0);r.Xr||(e.yt=!0,e.st=r.ki,e.V=this.Es.mh(r.V),e.et=s.priceLineWidth,e.Nt=s.priceLineStyle)}}class FS extends zo{constructor(e){super(),this.jt=e}zi(e,s,r){e.yt=!1,s.yt=!1;const i=this.jt;if(!i.yt())return;const a=i.W(),l=a.lastValueVisible,o=i.bh()!=="",c=a.seriesLastValueMode===0,d=i.Zr(!1);if(d.Xr)return;l&&(e.Kt=this.wh(d,l,c),e.yt=e.Kt.length!==0),(o||c)&&(s.Kt=this.gh(d,l,o,c),s.yt=s.Kt.length>0);const m=i.mh(d.V),u=Ro(m);r.t=u.t,r.ki=d.ki,s.Ot=i.$t().Bt(d.ki/i.Dt().At()),e.Ot=m,e.V=u.i,s.V=u.i}gh(e,s,r,i){let a="";const l=this.jt.bh();return r&&l.length!==0&&(a+=`${l} `),s&&i&&(a+=this.jt.Dt().Mh()?e.xh:e.Sh),a.trim()}wh(e,s,r){return s?r?this.jt.Dt().Mh()?e.Sh:e.xh:e.Kt:""}}function Ep(t,e,s,r){const i=Number.isFinite(e),a=Number.isFinite(s);return i&&a?t(e,s):i||a?i?e:s:r}class Pt{constructor(e,s){this.kh=e,this.yh=s}Ch(e){return e!==null&&this.kh===e.kh&&this.yh===e.yh}Th(){return new Pt(this.kh,this.yh)}Ph(){return this.kh}Rh(){return this.yh}Dh(){return this.yh-this.kh}Ni(){return this.yh===this.kh||Number.isNaN(this.yh)||Number.isNaN(this.kh)}ts(e){return e===null?this:new Pt(Ep(Math.min,this.Ph(),e.Ph(),-1/0),Ep(Math.max,this.Rh(),e.Rh(),1/0))}Vh(e){if(!ms(e)||this.yh-this.kh===0)return;const s=.5*(this.yh+this.kh);let r=this.yh-s,i=this.kh-s;r*=e,i*=e,this.yh=s+r,this.kh=s+i}Oh(e){ms(e)&&(this.yh+=e,this.kh+=e)}Bh(){return{minValue:this.kh,maxValue:this.yh}}static Ah(e){return e===null?null:new Pt(e.minValue,e.maxValue)}}class lo{constructor(e,s){this.Ih=e,this.zh=s||null}Lh(){return this.Ih}Eh(){return this.zh}Bh(){return this.Ih===null?null:{priceRange:this.Ih.Bh(),margins:this.zh||void 0}}static Ah(e){return e===null?null:new lo(Pt.Ah(e.priceRange),e.margins)}}class US extends mh{constructor(e,s){super(e),this.Nh=s}yr(){const e=this.Sr;e.yt=!1;const s=this.Nh.W();if(!this.Es.yt()||!s.lineVisible)return;const r=this.Nh.Fh();r!==null&&(e.yt=!0,e.st=r,e.V=s.color,e.et=s.lineWidth,e.Nt=s.lineStyle,e.gr=this.Nh.W().id)}}class WS extends zo{constructor(e,s){super(),this.jr=e,this.Nh=s}zi(e,s,r){e.yt=!1,s.yt=!1;const i=this.Nh.W(),a=i.axisLabelVisible,l=i.title!=="",o=this.jr;if(!a||!o.yt())return;const c=this.Nh.Fh();if(c===null)return;l&&(s.Kt=i.title,s.yt=!0),s.Ot=o.$t().Bt(c/o.Dt().At()),e.Kt=this.Wh(i.price),e.yt=!0;const d=Ro(i.axisLabelColor||i.color);r.t=d.t;const m=i.axisLabelTextColor||d.i;e.V=m,s.V=m,r.ki=c}Wh(e){const s=this.jr.Ct();return s===null?"":this.jr.Dt().Fi(e,s.Vt)}}class VS{constructor(e,s){this.jr=e,this.cn=s,this.jh=new US(e,this),this.ur=new WS(e,this),this.Hh=new Ig(this.ur,e,e.$t())}$h(e){ns(this.cn,e),this.bt(),this.jr.$t().Uh()}W(){return this.cn}qh(){return this.jh}Yh(){return this.Hh}Zh(){return this.ur}bt(){this.jh.bt(),this.ur.bt()}Fh(){const e=this.jr,s=e.Dt();if(e.$t().St().Ni()||s.Ni())return null;const r=e.Ct();return r===null?null:s.Rt(this.cn.price,r.Vt)}}class qS extends dh{constructor(e){super(),this.$i=e}$t(){return this.$i}}const HS={Bar:(t,e,s,r)=>{var i;const a=e.upColor,l=e.downColor,o=ee(t(s,r)),c=mr(o.Vt[0])<=mr(o.Vt[3]);return{ce:(i=o.V)!==null&&i!==void 0?i:c?a:l}},Candlestick:(t,e,s,r)=>{var i,a,l;const o=e.upColor,c=e.downColor,d=e.borderUpColor,m=e.borderDownColor,u=e.wickUpColor,h=e.wickDownColor,x=ee(t(s,r)),y=mr(x.Vt[0])<=mr(x.Vt[3]);return{ce:(i=x.V)!==null&&i!==void 0?i:y?o:c,Ne:(a=x.Ot)!==null&&a!==void 0?a:y?d:m,Ee:(l=x.Xh)!==null&&l!==void 0?l:y?u:h}},Custom:(t,e,s,r)=>{var i;return{ce:(i=ee(t(s,r)).V)!==null&&i!==void 0?i:e.color}},Area:(t,e,s,r)=>{var i,a,l,o;const c=ee(t(s,r));return{ce:(i=c.lt)!==null&&i!==void 0?i:e.lineColor,lt:(a=c.lt)!==null&&a!==void 0?a:e.lineColor,Ps:(l=c.Ps)!==null&&l!==void 0?l:e.topColor,Rs:(o=c.Rs)!==null&&o!==void 0?o:e.bottomColor}},Baseline:(t,e,s,r)=>{var i,a,l,o,c,d;const m=ee(t(s,r));return{ce:m.Vt[3]>=e.baseValue.price?e.topLineColor:e.bottomLineColor,Re:(i=m.Re)!==null&&i!==void 0?i:e.topLineColor,De:(a=m.De)!==null&&a!==void 0?a:e.bottomLineColor,ke:(l=m.ke)!==null&&l!==void 0?l:e.topFillColor1,ye:(o=m.ye)!==null&&o!==void 0?o:e.topFillColor2,Ce:(c=m.Ce)!==null&&c!==void 0?c:e.bottomFillColor1,Te:(d=m.Te)!==null&&d!==void 0?d:e.bottomFillColor2}},Line:(t,e,s,r)=>{var i,a;const l=ee(t(s,r));return{ce:(i=l.V)!==null&&i!==void 0?i:e.color,lt:(a=l.V)!==null&&a!==void 0?a:e.color}},Histogram:(t,e,s,r)=>{var i;return{ce:(i=ee(t(s,r)).V)!==null&&i!==void 0?i:e.color}}};class KS{constructor(e){this.Kh=(s,r)=>r!==void 0?r.Vt:this.jr.In().Gh(s),this.jr=e,this.Jh=HS[e.Qh()]}$s(e,s){return this.Jh(this.Kh,this.jr.W(),e,s)}}var Tp;(function(t){t[t.NearestLeft=-1]="NearestLeft",t[t.None=0]="None",t[t.NearestRight=1]="NearestRight"})(Tp||(Tp={}));const Ks=30;class YS{constructor(){this.tl=[],this.il=new Map,this.nl=new Map}sl(){return this.Ks()>0?this.tl[this.tl.length-1]:null}el(){return this.Ks()>0?this.rl(0):null}An(){return this.Ks()>0?this.rl(this.tl.length-1):null}Ks(){return this.tl.length}Ni(){return this.Ks()===0}Kr(e){return this.hl(e,0)!==null}Gh(e){return this.ll(e)}ll(e,s=0){const r=this.hl(e,s);return r===null?null:Object.assign(Object.assign({},this.al(r)),{ee:this.rl(r)})}ne(){return this.tl}ol(e,s,r){if(this.Ni())return null;let i=null;for(const a of r)i=Ja(i,this._l(e,s,a));return i}J(e){this.nl.clear(),this.il.clear(),this.tl=e}rl(e){return this.tl[e].ee}al(e){return this.tl[e]}hl(e,s){const r=this.ul(e);if(r===null&&s!==0)switch(s){case-1:return this.cl(e);case 1:return this.dl(e);default:throw new TypeError("Unknown search mode")}return r}cl(e){let s=this.fl(e);return s>0&&(s-=1),s!==this.tl.length&&this.rl(s)<e?s:null}dl(e){const s=this.vl(e);return s!==this.tl.length&&e<this.rl(s)?s:null}ul(e){const s=this.fl(e);return s===this.tl.length||e<this.tl[s].ee?null:s}fl(e){return Pa(this.tl,e,(s,r)=>s.ee<r)}vl(e){return Ag(this.tl,e,(s,r)=>s.ee>r)}pl(e,s,r){let i=null;for(let a=e;a<s;a++){const l=this.tl[a].Vt[r];Number.isNaN(l)||(i===null?i={ml:l,bl:l}:(l<i.ml&&(i.ml=l),l>i.bl&&(i.bl=l)))}return i}_l(e,s,r){if(this.Ni())return null;let i=null;const a=ee(this.el()),l=ee(this.An()),o=Math.max(e,a),c=Math.min(s,l),d=Math.ceil(o/Ks)*Ks,m=Math.max(d,Math.floor(c/Ks)*Ks);{const h=this.fl(o),x=this.vl(Math.min(c,d,s));i=Ja(i,this.pl(h,x,r))}let u=this.il.get(r);u===void 0&&(u=new Map,this.il.set(r,u));for(let h=Math.max(d+1,o);h<m;h+=Ks){const x=Math.floor(h/Ks);let y=u.get(x);if(y===void 0){const f=this.fl(x*Ks),w=this.vl((x+1)*Ks-1);y=this.pl(f,w,r),u.set(x,y)}i=Ja(i,y)}{const h=this.fl(m),x=this.vl(c);i=Ja(i,this.pl(h,x,r))}return i}}function Ja(t,e){return t===null?e:e===null?t:{ml:Math.min(t.ml,e.ml),bl:Math.max(t.bl,e.bl)}}class QS{constructor(e){this.wl=e}X(e,s,r){this.wl.draw(e)}gl(e,s,r){var i,a;(a=(i=this.wl).drawBackground)===null||a===void 0||a.call(i,e)}}class vc{constructor(e){this.tr=null,this.wn=e}gt(){var e;const s=this.wn.renderer();if(s===null)return null;if(((e=this.tr)===null||e===void 0?void 0:e.Ml)===s)return this.tr.xl;const r=new QS(s);return this.tr={Ml:s,xl:r},r}Sl(){var e,s,r;return(r=(s=(e=this.wn).zOrder)===null||s===void 0?void 0:s.call(e))!==null&&r!==void 0?r:"normal"}}function Dg(t){var e,s,r,i,a;return{Kt:t.text(),ki:t.coordinate(),Si:(e=t.fixedCoordinate)===null||e===void 0?void 0:e.call(t),V:t.textColor(),t:t.backColor(),yt:(r=(s=t.visible)===null||s===void 0?void 0:s.call(t))===null||r===void 0||r,hi:(a=(i=t.tickVisible)===null||i===void 0?void 0:i.call(t))===null||a===void 0||a}}class XS{constructor(e,s){this.Wt=new Cg,this.kl=e,this.yl=s}gt(){return this.Wt.J(Object.assign({Hi:this.yl.Hi()},Dg(this.kl))),this.Wt}}class GS extends zo{constructor(e,s){super(),this.kl=e,this.Li=s}zi(e,s,r){const i=Dg(this.kl);r.t=i.t,e.V=i.V;const a=2/12*this.Li.P();r.wi=a,r.gi=a,r.ki=i.ki,r.Si=i.Si,e.Kt=i.Kt,e.yt=i.yt,e.hi=i.hi}}class JS{constructor(e,s){this.Cl=null,this.Tl=null,this.Pl=null,this.Rl=null,this.Dl=null,this.Vl=e,this.jr=s}Ol(){return this.Vl}Vn(){var e,s;(s=(e=this.Vl).updateAllViews)===null||s===void 0||s.call(e)}Pn(){var e,s,r,i;const a=(r=(s=(e=this.Vl).paneViews)===null||s===void 0?void 0:s.call(e))!==null&&r!==void 0?r:[];if(((i=this.Cl)===null||i===void 0?void 0:i.Ml)===a)return this.Cl.xl;const l=a.map(o=>new vc(o));return this.Cl={Ml:a,xl:l},l}Qi(){var e,s,r,i;const a=(r=(s=(e=this.Vl).timeAxisViews)===null||s===void 0?void 0:s.call(e))!==null&&r!==void 0?r:[];if(((i=this.Tl)===null||i===void 0?void 0:i.Ml)===a)return this.Tl.xl;const l=this.jr.$t().St(),o=a.map(c=>new XS(c,l));return this.Tl={Ml:a,xl:o},o}Rn(){var e,s,r,i;const a=(r=(s=(e=this.Vl).priceAxisViews)===null||s===void 0?void 0:s.call(e))!==null&&r!==void 0?r:[];if(((i=this.Pl)===null||i===void 0?void 0:i.Ml)===a)return this.Pl.xl;const l=this.jr.Dt(),o=a.map(c=>new GS(c,l));return this.Pl={Ml:a,xl:o},o}Bl(){var e,s,r,i;const a=(r=(s=(e=this.Vl).priceAxisPaneViews)===null||s===void 0?void 0:s.call(e))!==null&&r!==void 0?r:[];if(((i=this.Rl)===null||i===void 0?void 0:i.Ml)===a)return this.Rl.xl;const l=a.map(o=>new vc(o));return this.Rl={Ml:a,xl:l},l}Al(){var e,s,r,i;const a=(r=(s=(e=this.Vl).timeAxisPaneViews)===null||s===void 0?void 0:s.call(e))!==null&&r!==void 0?r:[];if(((i=this.Dl)===null||i===void 0?void 0:i.Ml)===a)return this.Dl.xl;const l=a.map(o=>new vc(o));return this.Dl={Ml:a,xl:l},l}Il(e,s){var r,i,a;return(a=(i=(r=this.Vl).autoscaleInfo)===null||i===void 0?void 0:i.call(r,e,s))!==null&&a!==void 0?a:null}wr(e,s){var r,i,a;return(a=(i=(r=this.Vl).hitTest)===null||i===void 0?void 0:i.call(r,e,s))!==null&&a!==void 0?a:null}}function Nc(t,e,s,r){t.forEach(i=>{e(i).forEach(a=>{a.Sl()===s&&r.push(a)})})}function jc(t){return t.Pn()}function ZS(t){return t.Bl()}function e1(t){return t.Al()}class ph extends qS{constructor(e,s,r,i,a){super(e),this.zt=new YS,this.jh=new DS(this),this.zl=[],this.Ll=new LS(this),this.El=null,this.Nl=null,this.Fl=[],this.Wl=[],this.jl=null,this.Hl=[],this.cn=s,this.$l=r;const l=new FS(this);this.rn=[l],this.Hh=new Ig(l,this,e),r!=="Area"&&r!=="Line"&&r!=="Baseline"||(this.El=new RS(this)),this.Ul(),this.ql(a)}S(){this.jl!==null&&clearTimeout(this.jl)}mh(e){return this.cn.priceLineColor||e}Zr(e){const s={Xr:!0},r=this.Dt();if(this.$t().St().Ni()||r.Ni()||this.zt.Ni())return s;const i=this.$t().St().Xs(),a=this.Ct();if(i===null||a===null)return s;let l,o;if(e){const u=this.zt.sl();if(u===null)return s;l=u,o=u.ee}else{const u=this.zt.ll(i.ui(),-1);if(u===null||(l=this.zt.Gh(u.ee),l===null))return s;o=u.ee}const c=l.Vt[3],d=this.Us().$s(o,{Vt:l}),m=r.Rt(c,a.Vt);return{Xr:!1,_t:c,Kt:r.Fi(c,a.Vt),xh:r.Yl(c),Sh:r.Zl(c,a.Vt),V:d.ce,ki:m,ee:o}}Us(){return this.Nl!==null||(this.Nl=new KS(this)),this.Nl}W(){return this.cn}$h(e){const s=e.priceScaleId;s!==void 0&&s!==this.cn.priceScaleId&&this.$t().Xl(this,s),ns(this.cn,e),e.priceFormat!==void 0&&(this.Ul(),this.$t().Kl()),this.$t().Gl(this),this.$t().Jl(),this.wn.bt("options")}J(e,s){this.zt.J(e),this.Ql(),this.wn.bt("data"),this.dn.bt("data"),this.El!==null&&(s&&s.ta?this.El.$r():e.length===0&&this.El.Hr());const r=this.$t().dr(this);this.$t().ia(r),this.$t().Gl(this),this.$t().Jl(),this.$t().Uh()}na(e){this.Fl=e,this.Ql();const s=this.$t().dr(this);this.dn.bt("data"),this.$t().ia(s),this.$t().Gl(this),this.$t().Jl(),this.$t().Uh()}sa(){return this.Fl}dh(){return this.Wl}ea(e){const s=new VS(this,e);return this.zl.push(s),this.$t().Gl(this),s}ra(e){const s=this.zl.indexOf(e);s!==-1&&this.zl.splice(s,1),this.$t().Gl(this)}Qh(){return this.$l}Ct(){const e=this.ha();return e===null?null:{Vt:e.Vt[3],la:e.ot}}ha(){const e=this.$t().St().Xs();if(e===null)return null;const s=e.Os();return this.zt.ll(s,1)}In(){return this.zt}ph(e){const s=this.zt.Gh(e);return s===null?null:this.$l==="Bar"||this.$l==="Candlestick"||this.$l==="Custom"?{ge:s.Vt[0],Me:s.Vt[1],xe:s.Vt[2],Se:s.Vt[3]}:s.Vt[3]}aa(e){const s=[];Nc(this.Hl,jc,"top",s);const r=this.El;return r!==null&&r.yt()&&(this.jl===null&&r.qr()&&(this.jl=setTimeout(()=>{this.jl=null,this.$t().oa()},0)),r.Ur(),s.unshift(r)),s}Pn(){const e=[];this._a()||e.push(this.Ll),e.push(this.wn,this.jh,this.dn);const s=this.zl.map(r=>r.qh());return e.push(...s),Nc(this.Hl,jc,"normal",e),e}ua(){return this.ca(jc,"bottom")}da(e){return this.ca(ZS,e)}fa(e){return this.ca(e1,e)}va(e,s){return this.Hl.map(r=>r.wr(e,s)).filter(r=>r!==null)}Ji(e){return[this.Hh,...this.zl.map(s=>s.Yh())]}Rn(e,s){if(s!==this.Yi&&!this._a())return[];const r=[...this.rn];for(const i of this.zl)r.push(i.Zh());return this.Hl.forEach(i=>{r.push(...i.Rn())}),r}Qi(){const e=[];return this.Hl.forEach(s=>{e.push(...s.Qi())}),e}Il(e,s){if(this.cn.autoscaleInfoProvider!==void 0){const r=this.cn.autoscaleInfoProvider(()=>{const i=this.pa(e,s);return i===null?null:i.Bh()});return lo.Ah(r)}return this.pa(e,s)}ma(){return this.cn.priceFormat.minMove}ba(){return this.wa}Vn(){var e;this.wn.bt(),this.dn.bt();for(const s of this.rn)s.bt();for(const s of this.zl)s.bt();this.jh.bt(),this.Ll.bt(),(e=this.El)===null||e===void 0||e.bt(),this.Hl.forEach(s=>s.Vn())}Dt(){return ee(super.Dt())}kt(e){if(!((this.$l==="Line"||this.$l==="Area"||this.$l==="Baseline")&&this.cn.crosshairMarkerVisible))return null;const s=this.zt.Gh(e);return s===null?null:{_t:s.Vt[3],ht:this.ga(),Ot:this.Ma(),Pt:this.xa(),Tt:this.Sa(e)}}bh(){return this.cn.title}yt(){return this.cn.visible}ka(e){this.Hl.push(new JS(e,this))}ya(e){this.Hl=this.Hl.filter(s=>s.Ol()!==e)}Ca(){if(this.wn instanceof bc)return e=>this.wn.We(e)}Ta(){if(this.wn instanceof bc)return e=>this.wn.je(e)}_a(){return!Oo(this.Dt().Pa())}pa(e,s){if(!xa(e)||!xa(s)||this.zt.Ni())return null;const r=this.$l==="Line"||this.$l==="Area"||this.$l==="Baseline"||this.$l==="Histogram"?[3]:[2,1],i=this.zt.ol(e,s,r);let a=i!==null?new Pt(i.ml,i.bl):null;if(this.Qh()==="Histogram"){const o=this.cn.base,c=new Pt(o,o);a=a!==null?a.ts(c):c}let l=this.dn.uh();return this.Hl.forEach(o=>{const c=o.Il(e,s);if(c!=null&&c.priceRange){const x=new Pt(c.priceRange.minValue,c.priceRange.maxValue);a=a!==null?a.ts(x):x}var d,m,u,h;c!=null&&c.margins&&(d=l,m=c.margins,l={above:Math.max((u=d==null?void 0:d.above)!==null&&u!==void 0?u:0,m.above),below:Math.max((h=d==null?void 0:d.below)!==null&&h!==void 0?h:0,m.below)})}),new lo(a,l)}ga(){switch(this.$l){case"Line":case"Area":case"Baseline":return this.cn.crosshairMarkerRadius}return 0}Ma(){switch(this.$l){case"Line":case"Area":case"Baseline":{const e=this.cn.crosshairMarkerBorderColor;if(e.length!==0)return e}}return null}xa(){switch(this.$l){case"Line":case"Area":case"Baseline":return this.cn.crosshairMarkerBorderWidth}return 0}Sa(e){switch(this.$l){case"Line":case"Area":case"Baseline":{const s=this.cn.crosshairMarkerBackgroundColor;if(s.length!==0)return s}}return this.Us().$s(e).ce}Ul(){switch(this.cn.priceFormat.type){case"custom":this.wa={format:this.cn.priceFormat.formatter};break;case"volume":this.wa=new lS(this.cn.priceFormat.precision);break;case"percent":this.wa=new Eg(this.cn.priceFormat.precision);break;default:{const e=Math.pow(10,this.cn.priceFormat.precision);this.wa=new Io(e,this.cn.priceFormat.minMove*e)}}this.Yi!==null&&this.Yi.Ra()}Ql(){const e=this.$t().St();if(!e.Da()||this.zt.Ni())return void(this.Wl=[]);const s=ee(this.zt.el());this.Wl=this.Fl.map((r,i)=>{const a=ee(e.Va(r.time,!0)),l=a<s?1:-1;return{time:ee(this.zt.ll(a,l)).ee,position:r.position,shape:r.shape,color:r.color,id:r.id,th:i,text:r.text,size:r.size,originalTime:r.originalTime}})}ql(e){switch(this.dn=new BS(this,this.$t()),this.$l){case"Bar":this.wn=new fS(this,this.$t());break;case"Candlestick":this.wn=new NS(this,this.$t());break;case"Line":this.wn=new CS(this,this.$t());break;case"Custom":this.wn=new bc(this,this.$t(),yt(e));break;case"Area":this.wn=new pS(this,this.$t());break;case"Baseline":this.wn=new bS(this,this.$t());break;case"Histogram":this.wn=new SS(this,this.$t());break;default:throw Error("Unknown chart style assigned: "+this.$l)}}ca(e,s){const r=[];return Nc(this.Hl,e,s,r),r}}class t1{constructor(e){this.cn=e}Oa(e,s,r){let i=e;if(this.cn.mode===0)return i;const a=r.vn(),l=a.Ct();if(l===null)return i;const o=a.Rt(e,l),c=r.Ba().filter(m=>m instanceof ph).reduce((m,u)=>{if(r.vr(u)||!u.yt())return m;const h=u.Dt(),x=u.In();if(h.Ni()||!x.Kr(s))return m;const y=x.Gh(s);if(y===null)return m;const f=mr(u.Ct());return m.concat([h.Rt(y.Vt[3],f.Vt)])},[]);if(c.length===0)return i;c.sort((m,u)=>Math.abs(m-o)-Math.abs(u-o));const d=c[0];return i=a.pn(d,l),i}}class s1 extends as{constructor(){super(...arguments),this.zt=null}J(e){this.zt=e}K({context:e,bitmapSize:s,horizontalPixelRatio:r,verticalPixelRatio:i}){if(this.zt===null)return;const a=Math.max(1,Math.floor(r));e.lineWidth=a,function(l,o){l.save(),l.lineWidth%2&&l.translate(.5,.5),o(),l.restore()}(e,()=>{const l=ee(this.zt);if(l.Aa){e.strokeStyle=l.Ia,Hn(e,l.za),e.beginPath();for(const o of l.La){const c=Math.round(o.Ea*r);e.moveTo(c,-a),e.lineTo(c,s.height+a)}e.stroke()}if(l.Na){e.strokeStyle=l.Fa,Hn(e,l.Wa),e.beginPath();for(const o of l.ja){const c=Math.round(o.Ea*i);e.moveTo(-a,c),e.lineTo(s.width+a,c)}e.stroke()}})}}class n1{constructor(e){this.Wt=new s1,this.ft=!0,this.tn=e}bt(){this.ft=!0}gt(){if(this.ft){const e=this.tn.$t().W().grid,s={Na:e.horzLines.visible,Aa:e.vertLines.visible,Fa:e.horzLines.color,Ia:e.vertLines.color,Wa:e.horzLines.style,za:e.vertLines.style,ja:this.tn.vn().Ha(),La:(this.tn.$t().St().Ha()||[]).map(r=>({Ea:r.coord}))};this.Wt.J(s),this.ft=!1}return this.Wt}}class r1{constructor(e){this.wn=new n1(e)}qh(){return this.wn}}const wc={$a:4,Ua:1e-4};function pr(t,e){const s=100*(t-e)/e;return e<0?-s:s}function i1(t,e){const s=pr(t.Ph(),e),r=pr(t.Rh(),e);return new Pt(s,r)}function qi(t,e){const s=100*(t-e)/e+100;return e<0?-s:s}function a1(t,e){const s=qi(t.Ph(),e),r=qi(t.Rh(),e);return new Pt(s,r)}function oo(t,e){const s=Math.abs(t);if(s<1e-15)return 0;const r=Math.log10(s+e.Ua)+e.$a;return t<0?-r:r}function Hi(t,e){const s=Math.abs(t);if(s<1e-15)return 0;const r=Math.pow(10,s-e.$a)-e.Ua;return t<0?-r:r}function Ti(t,e){if(t===null)return null;const s=oo(t.Ph(),e),r=oo(t.Rh(),e);return new Pt(s,r)}function Za(t,e){if(t===null)return null;const s=Hi(t.Ph(),e),r=Hi(t.Rh(),e);return new Pt(s,r)}function kc(t){if(t===null)return wc;const e=Math.abs(t.Rh()-t.Ph());if(e>=1||e<1e-15)return wc;const s=Math.ceil(Math.abs(Math.log10(e))),r=wc.$a+s;return{$a:r,Ua:1/Math.pow(10,r)}}class Sc{constructor(e,s){if(this.qa=e,this.Ya=s,function(r){if(r<0)return!1;for(let i=r;i>1;i/=10)if(i%10!=0)return!1;return!0}(this.qa))this.Za=[2,2.5,2];else{this.Za=[];for(let r=this.qa;r!==1;){if(r%2==0)this.Za.push(2),r/=2;else{if(r%5!=0)throw new Error("unexpected base");this.Za.push(2,2.5),r/=5}if(this.Za.length>100)throw new Error("something wrong with base")}}}Xa(e,s,r){const i=this.qa===0?0:1/this.qa;let a=Math.pow(10,Math.max(0,Math.ceil(Math.log10(e-s)))),l=0,o=this.Ya[0];for(;;){const u=Ga(a,i,1e-14)&&a>i+1e-14,h=Ga(a,r*o,1e-14),x=Ga(a,1,1e-14);if(!(u&&h&&x))break;a/=o,o=this.Ya[++l%this.Ya.length]}if(a<=i+1e-14&&(a=i),a=Math.max(1,a),this.Za.length>0&&(c=a,d=1,m=1e-14,Math.abs(c-d)<m))for(l=0,o=this.Za[0];Ga(a,r*o,1e-14)&&a>i+1e-14;)a/=o,o=this.Za[++l%this.Za.length];var c,d,m;return a}}class Pp{constructor(e,s,r,i){this.Ka=[],this.Li=e,this.qa=s,this.Ga=r,this.Ja=i}Xa(e,s){if(e<s)throw new Error("high < low");const r=this.Li.At(),i=(e-s)*this.Qa()/r,a=new Sc(this.qa,[2,2.5,2]),l=new Sc(this.qa,[2,2,2.5]),o=new Sc(this.qa,[2.5,2,2]),c=[];return c.push(a.Xa(e,s,i),l.Xa(e,s,i),o.Xa(e,s,i)),function(d){if(d.length<1)throw Error("array is empty");let m=d[0];for(let u=1;u<d.length;++u)d[u]<m&&(m=d[u]);return m}(c)}io(){const e=this.Li,s=e.Ct();if(s===null)return void(this.Ka=[]);const r=e.At(),i=this.Ga(r-1,s),a=this.Ga(0,s),l=this.Li.W().entireTextOnly?this.no()/2:0,o=l,c=r-1-l,d=Math.max(i,a),m=Math.min(i,a);if(d===m)return void(this.Ka=[]);let u=this.Xa(d,m),h=d%u;h+=h<0?u:0;const x=d>=m?1:-1;let y=null,f=0;for(let w=d-h;w>m;w-=u){const p=this.Ja(w,s,!0);y!==null&&Math.abs(p-y)<this.Qa()||p<o||p>c||(f<this.Ka.length?(this.Ka[f].Ea=p,this.Ka[f].so=e.eo(w)):this.Ka.push({Ea:p,so:e.eo(w)}),f++,y=p,e.ro()&&(u=this.Xa(w*x,m)))}this.Ka.length=f}Ha(){return this.Ka}no(){return this.Li.P()}Qa(){return Math.ceil(2.5*this.no())}}function Fg(t){return t.slice().sort((e,s)=>ee(e.Xi())-ee(s.Xi()))}var Lp;(function(t){t[t.Normal=0]="Normal",t[t.Logarithmic=1]="Logarithmic",t[t.Percentage=2]="Percentage",t[t.IndexedTo100=3]="IndexedTo100"})(Lp||(Lp={}));const _p=new Eg,Mp=new Io(100,1);class l1{constructor(e,s,r,i){this.ho=0,this.lo=null,this.Ih=null,this.ao=null,this.oo={_o:!1,uo:null},this.co=0,this.do=0,this.fo=new Ve,this.vo=new Ve,this.po=[],this.mo=null,this.bo=null,this.wo=null,this.Mo=null,this.wa=Mp,this.xo=kc(null),this.So=e,this.cn=s,this.ko=r,this.yo=i,this.Co=new Pp(this,100,this.To.bind(this),this.Po.bind(this))}Pa(){return this.So}W(){return this.cn}$h(e){if(ns(this.cn,e),this.Ra(),e.mode!==void 0&&this.Ro({Cr:e.mode}),e.scaleMargins!==void 0){const s=yt(e.scaleMargins.top),r=yt(e.scaleMargins.bottom);if(s<0||s>1)throw new Error(`Invalid top margin - expect value between 0 and 1, given=${s}`);if(r<0||r>1)throw new Error(`Invalid bottom margin - expect value between 0 and 1, given=${r}`);if(s+r>1)throw new Error(`Invalid margins - sum of margins must be less than 1, given=${s+r}`);this.Do(),this.bo=null}}Vo(){return this.cn.autoScale}ro(){return this.cn.mode===1}Mh(){return this.cn.mode===2}Oo(){return this.cn.mode===3}Cr(){return{Wn:this.cn.autoScale,Bo:this.cn.invertScale,Cr:this.cn.mode}}Ro(e){const s=this.Cr();let r=null;e.Wn!==void 0&&(this.cn.autoScale=e.Wn),e.Cr!==void 0&&(this.cn.mode=e.Cr,e.Cr!==2&&e.Cr!==3||(this.cn.autoScale=!0),this.oo._o=!1),s.Cr===1&&e.Cr!==s.Cr&&(function(a,l){if(a===null)return!1;const o=Hi(a.Ph(),l),c=Hi(a.Rh(),l);return isFinite(o)&&isFinite(c)}(this.Ih,this.xo)?(r=Za(this.Ih,this.xo),r!==null&&this.Ao(r)):this.cn.autoScale=!0),e.Cr===1&&e.Cr!==s.Cr&&(r=Ti(this.Ih,this.xo),r!==null&&this.Ao(r));const i=s.Cr!==this.cn.mode;i&&(s.Cr===2||this.Mh())&&this.Ra(),i&&(s.Cr===3||this.Oo())&&this.Ra(),e.Bo!==void 0&&s.Bo!==e.Bo&&(this.cn.invertScale=e.Bo,this.Io()),this.vo.m(s,this.Cr())}zo(){return this.vo}P(){return this.ko.fontSize}At(){return this.ho}Lo(e){this.ho!==e&&(this.ho=e,this.Do(),this.bo=null)}Eo(){if(this.lo)return this.lo;const e=this.At()-this.No()-this.Fo();return this.lo=e,e}Lh(){return this.Wo(),this.Ih}Ao(e,s){const r=this.Ih;(s||r===null&&e!==null||r!==null&&!r.Ch(e))&&(this.bo=null,this.Ih=e)}Ni(){return this.Wo(),this.ho===0||!this.Ih||this.Ih.Ni()}jo(e){return this.Bo()?e:this.At()-1-e}Rt(e,s){return this.Mh()?e=pr(e,s):this.Oo()&&(e=qi(e,s)),this.Po(e,s)}te(e,s,r){this.Wo();const i=this.Fo(),a=ee(this.Lh()),l=a.Ph(),o=a.Rh(),c=this.Eo()-1,d=this.Bo(),m=c/(o-l),u=r===void 0?0:r.from,h=r===void 0?e.length:r.to,x=this.Ho();for(let y=u;y<h;y++){const f=e[y],w=f._t;if(isNaN(w))continue;let p=w;x!==null&&(p=x(f._t,s));const b=i+m*(p-l),v=d?b:this.ho-1-b;f.st=v}}be(e,s,r){this.Wo();const i=this.Fo(),a=ee(this.Lh()),l=a.Ph(),o=a.Rh(),c=this.Eo()-1,d=this.Bo(),m=c/(o-l),u=r===void 0?0:r.from,h=r===void 0?e.length:r.to,x=this.Ho();for(let y=u;y<h;y++){const f=e[y];let w=f.ge,p=f.Me,b=f.xe,v=f.Se;x!==null&&(w=x(f.ge,s),p=x(f.Me,s),b=x(f.xe,s),v=x(f.Se,s));let S=i+m*(w-l),N=d?S:this.ho-1-S;f.pe=N,S=i+m*(p-l),N=d?S:this.ho-1-S,f.de=N,S=i+m*(b-l),N=d?S:this.ho-1-S,f.fe=N,S=i+m*(v-l),N=d?S:this.ho-1-S,f.me=N}}pn(e,s){const r=this.To(e,s);return this.$o(r,s)}$o(e,s){let r=e;return this.Mh()?r=function(i,a){return a<0&&(i=-i),i/100*a+a}(r,s):this.Oo()&&(r=function(i,a){return i-=100,a<0&&(i=-i),i/100*a+a}(r,s)),r}Ba(){return this.po}Uo(){if(this.mo)return this.mo;let e=[];for(let s=0;s<this.po.length;s++){const r=this.po[s];r.Xi()===null&&r.Ki(s+1),e.push(r)}return e=Fg(e),this.mo=e,this.mo}qo(e){this.po.indexOf(e)===-1&&(this.po.push(e),this.Ra(),this.Yo())}Zo(e){const s=this.po.indexOf(e);if(s===-1)throw new Error("source is not attached to scale");this.po.splice(s,1),this.po.length===0&&(this.Ro({Wn:!0}),this.Ao(null)),this.Ra(),this.Yo()}Ct(){let e=null;for(const s of this.po){const r=s.Ct();r!==null&&(e===null||r.la<e.la)&&(e=r)}return e===null?null:e.Vt}Bo(){return this.cn.invertScale}Ha(){const e=this.Ct()===null;if(this.bo!==null&&(e||this.bo.Xo===e))return this.bo.Ha;this.Co.io();const s=this.Co.Ha();return this.bo={Ha:s,Xo:e},this.fo.m(),s}Ko(){return this.fo}Go(e){this.Mh()||this.Oo()||this.wo===null&&this.ao===null&&(this.Ni()||(this.wo=this.ho-e,this.ao=ee(this.Lh()).Th()))}Jo(e){if(this.Mh()||this.Oo()||this.wo===null)return;this.Ro({Wn:!1}),(e=this.ho-e)<0&&(e=0);let s=(this.wo+.2*(this.ho-1))/(e+.2*(this.ho-1));const r=ee(this.ao).Th();s=Math.max(s,.1),r.Vh(s),this.Ao(r)}Qo(){this.Mh()||this.Oo()||(this.wo=null,this.ao=null)}t_(e){this.Vo()||this.Mo===null&&this.ao===null&&(this.Ni()||(this.Mo=e,this.ao=ee(this.Lh()).Th()))}i_(e){if(this.Vo()||this.Mo===null)return;const s=ee(this.Lh()).Dh()/(this.Eo()-1);let r=e-this.Mo;this.Bo()&&(r*=-1);const i=r*s,a=ee(this.ao).Th();a.Oh(i),this.Ao(a,!0),this.bo=null}n_(){this.Vo()||this.Mo!==null&&(this.Mo=null,this.ao=null)}ba(){return this.wa||this.Ra(),this.wa}Fi(e,s){switch(this.cn.mode){case 2:return this.s_(pr(e,s));case 3:return this.ba().format(qi(e,s));default:return this.Wh(e)}}eo(e){switch(this.cn.mode){case 2:return this.s_(e);case 3:return this.ba().format(e);default:return this.Wh(e)}}Yl(e){return this.Wh(e,ee(this.e_()).ba())}Zl(e,s){return e=pr(e,s),this.s_(e,_p)}r_(){return this.po}h_(e){this.oo={uo:e,_o:!1}}Vn(){this.po.forEach(e=>e.Vn())}Ra(){this.bo=null;const e=this.e_();let s=100;e!==null&&(s=Math.round(1/e.ma())),this.wa=Mp,this.Mh()?(this.wa=_p,s=100):this.Oo()?(this.wa=new Io(100,1),s=100):e!==null&&(this.wa=e.ba()),this.Co=new Pp(this,s,this.To.bind(this),this.Po.bind(this)),this.Co.io()}Yo(){this.mo=null}e_(){return this.po[0]||null}No(){return this.Bo()?this.cn.scaleMargins.bottom*this.At()+this.do:this.cn.scaleMargins.top*this.At()+this.co}Fo(){return this.Bo()?this.cn.scaleMargins.top*this.At()+this.co:this.cn.scaleMargins.bottom*this.At()+this.do}Wo(){this.oo._o||(this.oo._o=!0,this.l_())}Do(){this.lo=null}Po(e,s){if(this.Wo(),this.Ni())return 0;e=this.ro()&&e?oo(e,this.xo):e;const r=ee(this.Lh()),i=this.Fo()+(this.Eo()-1)*(e-r.Ph())/r.Dh();return this.jo(i)}To(e,s){if(this.Wo(),this.Ni())return 0;const r=this.jo(e),i=ee(this.Lh()),a=i.Ph()+i.Dh()*((r-this.Fo())/(this.Eo()-1));return this.ro()?Hi(a,this.xo):a}Io(){this.bo=null,this.Co.io()}l_(){const e=this.oo.uo;if(e===null)return;let s=null;const r=this.r_();let i=0,a=0;for(const c of r){if(!c.yt())continue;const d=c.Ct();if(d===null)continue;const m=c.Il(e.Os(),e.ui());let u=m&&m.Lh();if(u!==null){switch(this.cn.mode){case 1:u=Ti(u,this.xo);break;case 2:u=i1(u,d.Vt);break;case 3:u=a1(u,d.Vt)}if(s=s===null?u:s.ts(ee(u)),m!==null){const h=m.Eh();h!==null&&(i=Math.max(i,h.above),a=Math.max(a,h.below))}}}if(i===this.co&&a===this.do||(this.co=i,this.do=a,this.bo=null,this.Do()),s!==null){if(s.Ph()===s.Rh()){const c=this.e_(),d=5*(c===null||this.Mh()||this.Oo()?1:c.ma());this.ro()&&(s=Za(s,this.xo)),s=new Pt(s.Ph()-d,s.Rh()+d),this.ro()&&(s=Ti(s,this.xo))}if(this.ro()){const c=Za(s,this.xo),d=kc(c);if(l=d,o=this.xo,l.$a!==o.$a||l.Ua!==o.Ua){const m=this.ao!==null?Za(this.ao,this.xo):null;this.xo=d,s=Ti(c,d),m!==null&&(this.ao=Ti(m,d))}}this.Ao(s)}else this.Ih===null&&(this.Ao(new Pt(-.5,.5)),this.xo=kc(null));var l,o;this.oo._o=!0}Ho(){return this.Mh()?pr:this.Oo()?qi:this.ro()?e=>oo(e,this.xo):null}a_(e,s,r){return s===void 0?(r===void 0&&(r=this.ba()),r.format(e)):s(e)}Wh(e,s){return this.a_(e,this.yo.priceFormatter,s)}s_(e,s){return this.a_(e,this.yo.percentageFormatter,s)}}class o1{constructor(e,s){this.po=[],this.o_=new Map,this.ho=0,this.__=0,this.u_=1e3,this.mo=null,this.c_=new Ve,this.yl=e,this.$i=s,this.d_=new r1(this);const r=s.W();this.f_=this.v_("left",r.leftPriceScale),this.p_=this.v_("right",r.rightPriceScale),this.f_.zo().l(this.m_.bind(this,this.f_),this),this.p_.zo().l(this.m_.bind(this,this.p_),this),this.b_(r)}b_(e){if(e.leftPriceScale&&this.f_.$h(e.leftPriceScale),e.rightPriceScale&&this.p_.$h(e.rightPriceScale),e.localization&&(this.f_.Ra(),this.p_.Ra()),e.overlayPriceScales){const s=Array.from(this.o_.values());for(const r of s){const i=ee(r[0].Dt());i.$h(e.overlayPriceScales),e.localization&&i.Ra()}}}w_(e){switch(e){case"left":return this.f_;case"right":return this.p_}return this.o_.has(e)?yt(this.o_.get(e))[0].Dt():null}S(){this.$t().g_().p(this),this.f_.zo().p(this),this.p_.zo().p(this),this.po.forEach(e=>{e.S&&e.S()}),this.c_.m()}M_(){return this.u_}x_(e){this.u_=e}$t(){return this.$i}Hi(){return this.__}At(){return this.ho}S_(e){this.__=e,this.k_()}Lo(e){this.ho=e,this.f_.Lo(e),this.p_.Lo(e),this.po.forEach(s=>{if(this.vr(s)){const r=s.Dt();r!==null&&r.Lo(e)}}),this.k_()}Ba(){return this.po}vr(e){const s=e.Dt();return s===null||this.f_!==s&&this.p_!==s}qo(e,s,r){const i=r!==void 0?r:this.C_().y_+1;this.T_(e,s,i)}Zo(e){const s=this.po.indexOf(e);fn(s!==-1,"removeDataSource: invalid data source"),this.po.splice(s,1);const r=ee(e.Dt()).Pa();if(this.o_.has(r)){const a=yt(this.o_.get(r)),l=a.indexOf(e);l!==-1&&(a.splice(l,1),a.length===0&&this.o_.delete(r))}const i=e.Dt();i&&i.Ba().indexOf(e)>=0&&i.Zo(e),i!==null&&(i.Yo(),this.P_(i)),this.mo=null}mr(e){return e===this.f_?"left":e===this.p_?"right":"overlay"}R_(){return this.f_}D_(){return this.p_}V_(e,s){e.Go(s)}O_(e,s){e.Jo(s),this.k_()}B_(e){e.Qo()}A_(e,s){e.t_(s)}I_(e,s){e.i_(s),this.k_()}z_(e){e.n_()}k_(){this.po.forEach(e=>{e.Vn()})}vn(){let e=null;return this.$i.W().rightPriceScale.visible&&this.p_.Ba().length!==0?e=this.p_:this.$i.W().leftPriceScale.visible&&this.f_.Ba().length!==0?e=this.f_:this.po.length!==0&&(e=this.po[0].Dt()),e===null&&(e=this.p_),e}pr(){let e=null;return this.$i.W().rightPriceScale.visible?e=this.p_:this.$i.W().leftPriceScale.visible&&(e=this.f_),e}P_(e){e!==null&&e.Vo()&&this.L_(e)}E_(e){const s=this.yl.Xs();e.Ro({Wn:!0}),s!==null&&e.h_(s),this.k_()}N_(){this.L_(this.f_),this.L_(this.p_)}F_(){this.P_(this.f_),this.P_(this.p_),this.po.forEach(e=>{this.vr(e)&&this.P_(e.Dt())}),this.k_(),this.$i.Uh()}Uo(){return this.mo===null&&(this.mo=Fg(this.po)),this.mo}W_(){return this.c_}j_(){return this.d_}L_(e){const s=e.r_();if(s&&s.length>0&&!this.yl.Ni()){const r=this.yl.Xs();r!==null&&e.h_(r)}e.Vn()}C_(){const e=this.Uo();if(e.length===0)return{H_:0,y_:0};let s=0,r=0;for(let i=0;i<e.length;i++){const a=e[i].Xi();a!==null&&(a<s&&(s=a),a>r&&(r=a))}return{H_:s,y_:r}}T_(e,s,r){let i=this.w_(s);if(i===null&&(i=this.v_(s,this.$i.W().overlayPriceScales)),this.po.push(e),!Oo(s)){const a=this.o_.get(s)||[];a.push(e),this.o_.set(s,a)}i.qo(e),e.Gi(i),e.Ki(r),this.P_(i),this.mo=null}m_(e,s,r){s.Cr!==r.Cr&&this.L_(e)}v_(e,s){const r=Object.assign({visible:!0,autoScale:!0},ws(s)),i=new l1(e,r,this.$i.W().layout,this.$i.W().localization);return i.Lo(this.At()),i}}class c1{constructor(e,s,r=50){this.Ke=0,this.Ge=1,this.Je=1,this.tr=new Map,this.Qe=new Map,this.U_=e,this.q_=s,this.ir=r}Y_(e){const s=e.time,r=this.q_.cacheKey(s),i=this.tr.get(r);if(i!==void 0)return i.Z_;if(this.Ke===this.ir){const l=this.Qe.get(this.Je);this.Qe.delete(this.Je),this.tr.delete(yt(l)),this.Je++,this.Ke--}const a=this.U_(e);return this.tr.set(r,{Z_:a,rr:this.Ge}),this.Qe.set(this.Ge,r),this.Ke++,this.Ge++,a}}class Ki{constructor(e,s){fn(e<=s,"right should be >= left"),this.X_=e,this.K_=s}Os(){return this.X_}ui(){return this.K_}G_(){return this.K_-this.X_+1}Kr(e){return this.X_<=e&&e<=this.K_}Ch(e){return this.X_===e.Os()&&this.K_===e.ui()}}function Rp(t,e){return t===null||e===null?t===e:t.Ch(e)}class d1{constructor(){this.J_=new Map,this.tr=null,this.Q_=!1}tu(e){this.Q_=e,this.tr=null}iu(e,s){this.nu(s),this.tr=null;for(let r=s;r<e.length;++r){const i=e[r];let a=this.J_.get(i.timeWeight);a===void 0&&(a=[],this.J_.set(i.timeWeight,a)),a.push({index:r,time:i.time,weight:i.timeWeight,originalTime:i.originalTime})}}su(e,s){const r=Math.ceil(s/e);return this.tr!==null&&this.tr.eu===r||(this.tr={Ha:this.ru(r),eu:r}),this.tr.Ha}nu(e){if(e===0)return void this.J_.clear();const s=[];this.J_.forEach((r,i)=>{e<=r[0].index?s.push(i):r.splice(Pa(r,e,a=>a.index<e),1/0)});for(const r of s)this.J_.delete(r)}ru(e){let s=[];for(const r of Array.from(this.J_.keys()).sort((i,a)=>a-i)){if(!this.J_.get(r))continue;const i=s;s=[];const a=i.length;let l=0;const o=yt(this.J_.get(r)),c=o.length;let d=1/0,m=-1/0;for(let u=0;u<c;u++){const h=o[u],x=h.index;for(;l<a;){const y=i[l],f=y.index;if(!(f<x)){d=f;break}l++,s.push(y),m=f,d=1/0}if(d-x>=e&&x-m>=e)s.push(h),m=x;else if(this.Q_)return i}for(;l<a;l++)s.push(i[l])}return s}}class wr{constructor(e){this.hu=e}lu(){return this.hu===null?null:new Ki(Math.floor(this.hu.Os()),Math.ceil(this.hu.ui()))}au(){return this.hu}static ou(){return new wr(null)}}function u1(t,e){return t.weight>e.weight?t:e}class h1{constructor(e,s,r,i){this.__=0,this._u=null,this.uu=[],this.Mo=null,this.wo=null,this.cu=new d1,this.du=new Map,this.fu=wr.ou(),this.vu=!0,this.pu=new Ve,this.mu=new Ve,this.bu=new Ve,this.wu=null,this.gu=null,this.Mu=[],this.cn=s,this.yo=r,this.xu=s.rightOffset,this.Su=s.barSpacing,this.$i=e,this.q_=i,this.ku(),this.cu.tu(s.uniformDistribution)}W(){return this.cn}yu(e){ns(this.yo,e),this.Cu(),this.ku()}$h(e,s){var r;ns(this.cn,e),this.cn.fixLeftEdge&&this.Tu(),this.cn.fixRightEdge&&this.Pu(),e.barSpacing!==void 0&&this.$i.Gn(e.barSpacing),e.rightOffset!==void 0&&this.$i.Jn(e.rightOffset),e.minBarSpacing!==void 0&&this.$i.Gn((r=e.barSpacing)!==null&&r!==void 0?r:this.Su),this.Cu(),this.ku(),this.bu.m()}mn(e){var s,r;return(r=(s=this.uu[e])===null||s===void 0?void 0:s.time)!==null&&r!==void 0?r:null}Ui(e){var s;return(s=this.uu[e])!==null&&s!==void 0?s:null}Va(e,s){if(this.uu.length<1)return null;if(this.q_.key(e)>this.q_.key(this.uu[this.uu.length-1].time))return s?this.uu.length-1:null;const r=Pa(this.uu,this.q_.key(e),(i,a)=>this.q_.key(i.time)<a);return this.q_.key(e)<this.q_.key(this.uu[r].time)?s?r:null:r}Ni(){return this.__===0||this.uu.length===0||this._u===null}Da(){return this.uu.length>0}Xs(){return this.Ru(),this.fu.lu()}Du(){return this.Ru(),this.fu.au()}Vu(){const e=this.Xs();if(e===null)return null;const s={from:e.Os(),to:e.ui()};return this.Ou(s)}Ou(e){const s=Math.round(e.from),r=Math.round(e.to),i=ee(this.Bu()),a=ee(this.Au());return{from:ee(this.Ui(Math.max(i,s))),to:ee(this.Ui(Math.min(a,r)))}}Iu(e){return{from:ee(this.Va(e.from,!0)),to:ee(this.Va(e.to,!0))}}Hi(){return this.__}S_(e){if(!isFinite(e)||e<=0||this.__===e)return;const s=this.Du(),r=this.__;if(this.__=e,this.vu=!0,this.cn.lockVisibleTimeRangeOnResize&&r!==0){const i=this.Su*e/r;this.Su=i}if(this.cn.fixLeftEdge&&s!==null&&s.Os()<=0){const i=r-e;this.xu-=Math.round(i/this.Su)+1,this.vu=!0}this.zu(),this.Lu()}It(e){if(this.Ni()||!xa(e))return 0;const s=this.Eu()+this.xu-e;return this.__-(s+.5)*this.Su-1}Qs(e,s){const r=this.Eu(),i=s===void 0?0:s.from,a=s===void 0?e.length:s.to;for(let l=i;l<a;l++){const o=e[l].ot,c=r+this.xu-o,d=this.__-(c+.5)*this.Su-1;e[l].nt=d}}Nu(e){return Math.ceil(this.Fu(e))}Jn(e){this.vu=!0,this.xu=e,this.Lu(),this.$i.Wu(),this.$i.Uh()}le(){return this.Su}Gn(e){this.ju(e),this.Lu(),this.$i.Wu(),this.$i.Uh()}Hu(){return this.xu}Ha(){if(this.Ni())return null;if(this.gu!==null)return this.gu;const e=this.Su,s=5*(this.$i.W().layout.fontSize+4)/8*(this.cn.tickMarkMaxCharacterLength||8),r=Math.round(s/e),i=ee(this.Xs()),a=Math.max(i.Os(),i.Os()-r),l=Math.max(i.ui(),i.ui()-r),o=this.cu.su(e,s),c=this.Bu()+r,d=this.Au()-r,m=this.$u(),u=this.cn.fixLeftEdge||m,h=this.cn.fixRightEdge||m;let x=0;for(const y of o){if(!(a<=y.index&&y.index<=l))continue;let f;x<this.Mu.length?(f=this.Mu[x],f.coord=this.It(y.index),f.label=this.Uu(y),f.weight=y.weight):(f={needAlignCoordinate:!1,coord:this.It(y.index),label:this.Uu(y),weight:y.weight},this.Mu.push(f)),this.Su>s/2&&!m?f.needAlignCoordinate=!1:f.needAlignCoordinate=u&&y.index<=c||h&&y.index>=d,x++}return this.Mu.length=x,this.gu=this.Mu,this.Mu}qu(){this.vu=!0,this.Gn(this.cn.barSpacing),this.Jn(this.cn.rightOffset)}Yu(e){this.vu=!0,this._u=e,this.Lu(),this.Tu()}Zu(e,s){const r=this.Fu(e),i=this.le(),a=i+s*(i/10);this.Gn(a),this.cn.rightBarStaysOnScroll||this.Jn(this.Hu()+(r-this.Fu(e)))}Go(e){this.Mo&&this.n_(),this.wo===null&&this.wu===null&&(this.Ni()||(this.wo=e,this.Xu()))}Jo(e){if(this.wu===null)return;const s=Wd(this.__-e,0,this.__),r=Wd(this.__-ee(this.wo),0,this.__);s!==0&&r!==0&&this.Gn(this.wu.le*s/r)}Qo(){this.wo!==null&&(this.wo=null,this.Ku())}t_(e){this.Mo===null&&this.wu===null&&(this.Ni()||(this.Mo=e,this.Xu()))}i_(e){if(this.Mo===null)return;const s=(this.Mo-e)/this.le();this.xu=ee(this.wu).Hu+s,this.vu=!0,this.Lu()}n_(){this.Mo!==null&&(this.Mo=null,this.Ku())}Gu(){this.Ju(this.cn.rightOffset)}Ju(e,s=400){if(!isFinite(e))throw new RangeError("offset is required and must be finite number");if(!isFinite(s)||s<=0)throw new RangeError("animationDuration (optional) must be finite positive number");const r=this.xu,i=performance.now();this.$i.Zn({Qu:a=>(a-i)/s>=1,tc:a=>{const l=(a-i)/s;return l>=1?e:r+(e-r)*l}})}bt(e,s){this.vu=!0,this.uu=e,this.cu.iu(e,s),this.Lu()}nc(){return this.pu}sc(){return this.mu}ec(){return this.bu}Eu(){return this._u||0}rc(e){const s=e.G_();this.ju(this.__/s),this.xu=e.ui()-this.Eu(),this.Lu(),this.vu=!0,this.$i.Wu(),this.$i.Uh()}hc(){const e=this.Bu(),s=this.Au();e!==null&&s!==null&&this.rc(new Ki(e,s+this.cn.rightOffset))}lc(e){const s=new Ki(e.from,e.to);this.rc(s)}qi(e){return this.yo.timeFormatter!==void 0?this.yo.timeFormatter(e.originalTime):this.q_.formatHorzItem(e.time)}$u(){const{handleScroll:e,handleScale:s}=this.$i.W();return!(e.horzTouchDrag||e.mouseWheel||e.pressedMouseMove||e.vertTouchDrag||s.axisDoubleClickReset.time||s.axisPressedMouseMove.time||s.mouseWheel||s.pinch)}Bu(){return this.uu.length===0?null:0}Au(){return this.uu.length===0?null:this.uu.length-1}ac(e){return(this.__-1-e)/this.Su}Fu(e){const s=this.ac(e),r=this.Eu()+this.xu-s;return Math.round(1e6*r)/1e6}ju(e){const s=this.Su;this.Su=e,this.zu(),s!==this.Su&&(this.vu=!0,this.oc())}Ru(){if(!this.vu)return;if(this.vu=!1,this.Ni())return void this._c(wr.ou());const e=this.Eu(),s=this.__/this.Su,r=this.xu+e,i=new Ki(r-s+1,r);this._c(new wr(i))}zu(){const e=this.uc();if(this.Su<e&&(this.Su=e,this.vu=!0),this.__!==0){const s=.5*this.__;this.Su>s&&(this.Su=s,this.vu=!0)}}uc(){return this.cn.fixLeftEdge&&this.cn.fixRightEdge&&this.uu.length!==0?this.__/this.uu.length:this.cn.minBarSpacing}Lu(){const e=this.cc();e!==null&&this.xu<e&&(this.xu=e,this.vu=!0);const s=this.dc();this.xu>s&&(this.xu=s,this.vu=!0)}cc(){const e=this.Bu(),s=this._u;return e===null||s===null?null:e-s-1+(this.cn.fixLeftEdge?this.__/this.Su:Math.min(2,this.uu.length))}dc(){return this.cn.fixRightEdge?0:this.__/this.Su-Math.min(2,this.uu.length)}Xu(){this.wu={le:this.le(),Hu:this.Hu()}}Ku(){this.wu=null}Uu(e){let s=this.du.get(e.weight);return s===void 0&&(s=new c1(r=>this.fc(r),this.q_),this.du.set(e.weight,s)),s.Y_(e)}fc(e){return this.q_.formatTickmark(e,this.yo)}_c(e){const s=this.fu;this.fu=e,Rp(s.lu(),this.fu.lu())||this.pu.m(),Rp(s.au(),this.fu.au())||this.mu.m(),this.oc()}oc(){this.gu=null}Cu(){this.oc(),this.du.clear()}ku(){this.q_.updateFormatter(this.yo)}Tu(){if(!this.cn.fixLeftEdge)return;const e=this.Bu();if(e===null)return;const s=this.Xs();if(s===null)return;const r=s.Os()-e;if(r<0){const i=this.xu-r-1;this.Jn(i)}this.zu()}Pu(){this.Lu(),this.zu()}}class m1{X(e,s,r){e.useMediaCoordinateSpace(i=>this.K(i,s,r))}gl(e,s,r){e.useMediaCoordinateSpace(i=>this.vc(i,s,r))}vc(e,s,r){}}class p1 extends m1{constructor(e){super(),this.mc=new Map,this.zt=e}K(e){}vc(e){if(!this.zt.yt)return;const{context:s,mediaSize:r}=e;let i=0;for(const l of this.zt.bc){if(l.Kt.length===0)continue;s.font=l.R;const o=this.wc(s,l.Kt);o>r.width?l.Zu=r.width/o:l.Zu=1,i+=l.gc*l.Zu}let a=0;switch(this.zt.Mc){case"top":a=0;break;case"center":a=Math.max((r.height-i)/2,0);break;case"bottom":a=Math.max(r.height-i,0)}s.fillStyle=this.zt.V;for(const l of this.zt.bc){s.save();let o=0;switch(this.zt.xc){case"left":s.textAlign="left",o=l.gc/2;break;case"center":s.textAlign="center",o=r.width/2;break;case"right":s.textAlign="right",o=r.width-1-l.gc/2}s.translate(o,a),s.textBaseline="top",s.font=l.R,s.scale(l.Zu,l.Zu),s.fillText(l.Kt,0,l.Sc),s.restore(),a+=l.gc*l.Zu}}wc(e,s){const r=this.kc(e.font);let i=r.get(s);return i===void 0&&(i=e.measureText(s).width,r.set(s,i)),i}kc(e){let s=this.mc.get(e);return s===void 0&&(s=new Map,this.mc.set(e,s)),s}}class x1{constructor(e){this.ft=!0,this.Ft={yt:!1,V:"",bc:[],Mc:"center",xc:"center"},this.Wt=new p1(this.Ft),this.jt=e}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt}Mt(){const e=this.jt.W(),s=this.Ft;s.yt=e.visible,s.yt&&(s.V=e.color,s.xc=e.horzAlign,s.Mc=e.vertAlign,s.bc=[{Kt:e.text,R:Or(e.fontSize,e.fontFamily,e.fontStyle),gc:1.2*e.fontSize,Sc:0,Zu:0}])}}class f1 extends dh{constructor(e,s){super(),this.cn=s,this.wn=new x1(this)}Rn(){return[]}Pn(){return[this.wn]}W(){return this.cn}Vn(){this.wn.bt()}}var Ap,zp,Op,Ip,$p;(function(t){t[t.OnTouchEnd=0]="OnTouchEnd",t[t.OnNextTap=1]="OnNextTap"})(Ap||(Ap={}));class g1{constructor(e,s,r){this.yc=[],this.Cc=[],this.__=0,this.Tc=null,this.Pc=new Ve,this.Rc=new Ve,this.Dc=null,this.Vc=e,this.cn=s,this.q_=r,this.Oc=new Qk(this),this.yl=new h1(this,s.timeScale,this.cn.localization,r),this.vt=new aS(this,s.crosshair),this.Bc=new t1(s.crosshair),this.Ac=new f1(this,s.watermark),this.Ic(),this.yc[0].x_(2e3),this.zc=this.Lc(0),this.Ec=this.Lc(1)}Kl(){this.Nc(rt.es())}Uh(){this.Nc(rt.ss())}oa(){this.Nc(new rt(1))}Gl(e){const s=this.Fc(e);this.Nc(s)}Wc(){return this.Tc}jc(e){const s=this.Tc;this.Tc=e,s!==null&&this.Gl(s.Hc),e!==null&&this.Gl(e.Hc)}W(){return this.cn}$h(e){ns(this.cn,e),this.yc.forEach(s=>s.b_(e)),e.timeScale!==void 0&&this.yl.$h(e.timeScale),e.localization!==void 0&&this.yl.yu(e.localization),(e.leftPriceScale||e.rightPriceScale)&&this.Pc.m(),this.zc=this.Lc(0),this.Ec=this.Lc(1),this.Kl()}$c(e,s){if(e==="left")return void this.$h({leftPriceScale:s});if(e==="right")return void this.$h({rightPriceScale:s});const r=this.Uc(e);r!==null&&(r.Dt.$h(s),this.Pc.m())}Uc(e){for(const s of this.yc){const r=s.w_(e);if(r!==null)return{Ht:s,Dt:r}}return null}St(){return this.yl}qc(){return this.yc}Yc(){return this.Ac}Zc(){return this.vt}Xc(){return this.Rc}Kc(e,s){e.Lo(s),this.Wu()}S_(e){this.__=e,this.yl.S_(this.__),this.yc.forEach(s=>s.S_(e)),this.Wu()}Ic(e){const s=new o1(this.yl,this);e!==void 0?this.yc.splice(e,0,s):this.yc.push(s);const r=e===void 0?this.yc.length-1:e,i=rt.es();return i.Nn(r,{Fn:0,Wn:!0}),this.Nc(i),s}V_(e,s,r){e.V_(s,r)}O_(e,s,r){e.O_(s,r),this.Jl(),this.Nc(this.Gc(e,2))}B_(e,s){e.B_(s),this.Nc(this.Gc(e,2))}A_(e,s,r){s.Vo()||e.A_(s,r)}I_(e,s,r){s.Vo()||(e.I_(s,r),this.Jl(),this.Nc(this.Gc(e,2)))}z_(e,s){s.Vo()||(e.z_(s),this.Nc(this.Gc(e,2)))}E_(e,s){e.E_(s),this.Nc(this.Gc(e,2))}Jc(e){this.yl.Go(e)}Qc(e,s){const r=this.St();if(r.Ni()||s===0)return;const i=r.Hi();e=Math.max(1,Math.min(e,i)),r.Zu(e,s),this.Wu()}td(e){this.nd(0),this.sd(e),this.ed()}rd(e){this.yl.Jo(e),this.Wu()}hd(){this.yl.Qo(),this.Uh()}nd(e){this.yl.t_(e)}sd(e){this.yl.i_(e),this.Wu()}ed(){this.yl.n_(),this.Uh()}wt(){return this.Cc}ld(e,s,r,i,a){this.vt.gn(e,s);let l=NaN,o=this.yl.Nu(e);const c=this.yl.Xs();c!==null&&(o=Math.min(Math.max(c.Os(),o),c.ui()));const d=i.vn(),m=d.Ct();m!==null&&(l=d.pn(s,m)),l=this.Bc.Oa(l,o,i),this.vt.kn(o,l,i),this.oa(),a||this.Rc.m(this.vt.xt(),{x:e,y:s},r)}ad(e,s,r){const i=r.vn(),a=i.Ct(),l=i.Rt(e,ee(a)),o=this.yl.Va(s,!0),c=this.yl.It(ee(o));this.ld(c,l,null,r,!0)}od(e){this.Zc().Cn(),this.oa(),e||this.Rc.m(null,null,null)}Jl(){const e=this.vt.Ht();if(e!==null){const s=this.vt.xn(),r=this.vt.Sn();this.ld(s,r,null,e)}this.vt.Vn()}_d(e,s,r){const i=this.yl.mn(0);s!==void 0&&r!==void 0&&this.yl.bt(s,r);const a=this.yl.mn(0),l=this.yl.Eu(),o=this.yl.Xs();if(o!==null&&i!==null&&a!==null){const c=o.Kr(l),d=this.q_.key(i)>this.q_.key(a),m=e!==null&&e>l&&!d,u=this.yl.W().allowShiftVisibleRangeOnWhitespaceReplacement,h=c&&(r!==void 0||u)&&this.yl.W().shiftVisibleRangeOnNewBar;if(m&&!h){const x=e-l;this.yl.Jn(this.yl.Hu()-x)}}this.yl.Yu(e)}ia(e){e!==null&&e.F_()}dr(e){const s=this.yc.find(r=>r.Uo().includes(e));return s===void 0?null:s}Wu(){this.Ac.Vn(),this.yc.forEach(e=>e.F_()),this.Jl()}S(){this.yc.forEach(e=>e.S()),this.yc.length=0,this.cn.localization.priceFormatter=void 0,this.cn.localization.percentageFormatter=void 0,this.cn.localization.timeFormatter=void 0}ud(){return this.Oc}br(){return this.Oc.W()}g_(){return this.Pc}dd(e,s,r){const i=this.yc[0],a=this.fd(s,e,i,r);return this.Cc.push(a),this.Cc.length===1?this.Kl():this.Uh(),a}vd(e){const s=this.dr(e),r=this.Cc.indexOf(e);fn(r!==-1,"Series not found"),this.Cc.splice(r,1),ee(s).Zo(e),e.S&&e.S()}Xl(e,s){const r=ee(this.dr(e));r.Zo(e);const i=this.Uc(s);if(i===null){const a=e.Xi();r.qo(e,s,a)}else{const a=i.Ht===r?e.Xi():void 0;i.Ht.qo(e,s,a)}}hc(){const e=rt.ss();e.$n(),this.Nc(e)}pd(e){const s=rt.ss();s.Yn(e),this.Nc(s)}Kn(){const e=rt.ss();e.Kn(),this.Nc(e)}Gn(e){const s=rt.ss();s.Gn(e),this.Nc(s)}Jn(e){const s=rt.ss();s.Jn(e),this.Nc(s)}Zn(e){const s=rt.ss();s.Zn(e),this.Nc(s)}Un(){const e=rt.ss();e.Un(),this.Nc(e)}md(){return this.cn.rightPriceScale.visible?"right":"left"}bd(){return this.Ec}q(){return this.zc}Bt(e){const s=this.Ec,r=this.zc;if(s===r)return s;if(e=Math.max(0,Math.min(100,Math.round(100*e))),this.Dc===null||this.Dc.Ps!==r||this.Dc.Rs!==s)this.Dc={Ps:r,Rs:s,wd:new Map};else{const a=this.Dc.wd.get(e);if(a!==void 0)return a}const i=function(a,l,o){const[c,d,m,u]=pa(a),[h,x,y,f]=pa(l),w=[It(c+o*(h-c)),It(d+o*(x-d)),It(m+o*(y-m)),wg(u+o*(f-u))];return`rgba(${w[0]}, ${w[1]}, ${w[2]}, ${w[3]})`}(r,s,e/100);return this.Dc.wd.set(e,i),i}Gc(e,s){const r=new rt(s);if(e!==null){const i=this.yc.indexOf(e);r.Nn(i,{Fn:s})}return r}Fc(e,s){return s===void 0&&(s=2),this.Gc(this.dr(e),s)}Nc(e){this.Vc&&this.Vc(e),this.yc.forEach(s=>s.j_().qh().bt())}fd(e,s,r,i){const a=new ph(this,e,s,r,i),l=e.priceScaleId!==void 0?e.priceScaleId:this.md();return r.qo(a,l),Oo(l)||a.$h(e),a}Lc(e){const s=this.cn.layout;return s.background.type==="gradient"?e===0?s.background.topColor:s.background.bottomColor:s.background.color}}function Vd(t){return!ms(t)&&!Ta(t)}function Ug(t){return ms(t)}(function(t){t[t.Disabled=0]="Disabled",t[t.Continuous=1]="Continuous",t[t.OnDataUpdate=2]="OnDataUpdate"})(zp||(zp={})),function(t){t[t.LastBar=0]="LastBar",t[t.LastVisible=1]="LastVisible"}(Op||(Op={})),function(t){t.Solid="solid",t.VerticalGradient="gradient"}(Ip||(Ip={})),function(t){t[t.Year=0]="Year",t[t.Month=1]="Month",t[t.DayOfMonth=2]="DayOfMonth",t[t.Time=3]="Time",t[t.TimeWithSeconds=4]="TimeWithSeconds"}($p||($p={}));const Bp=t=>t.getUTCFullYear();function y1(t,e,s){return e.replace(/yyyy/g,(r=>ks(Bp(r),4))(t)).replace(/yy/g,(r=>ks(Bp(r)%100,2))(t)).replace(/MMMM/g,((r,i)=>new Date(r.getUTCFullYear(),r.getUTCMonth(),1).toLocaleString(i,{month:"long"}))(t,s)).replace(/MMM/g,((r,i)=>new Date(r.getUTCFullYear(),r.getUTCMonth(),1).toLocaleString(i,{month:"short"}))(t,s)).replace(/MM/g,(r=>ks((i=>i.getUTCMonth()+1)(r),2))(t)).replace(/dd/g,(r=>ks((i=>i.getUTCDate())(r),2))(t))}class Wg{constructor(e="yyyy-MM-dd",s="default"){this.gd=e,this.Md=s}Y_(e){return y1(e,this.gd,this.Md)}}class b1{constructor(e){this.xd=e||"%h:%m:%s"}Y_(e){return this.xd.replace("%h",ks(e.getUTCHours(),2)).replace("%m",ks(e.getUTCMinutes(),2)).replace("%s",ks(e.getUTCSeconds(),2))}}const v1={Sd:"yyyy-MM-dd",kd:"%h:%m:%s",yd:" ",Cd:"default"};class N1{constructor(e={}){const s=Object.assign(Object.assign({},v1),e);this.Td=new Wg(s.Sd,s.Cd),this.Pd=new b1(s.kd),this.Rd=s.yd}Y_(e){return`${this.Td.Y_(e)}${this.Rd}${this.Pd.Y_(e)}`}}function el(t){return 60*t*60*1e3}function Cc(t){return 60*t*1e3}const tl=[{Dd:(Dp=1,1e3*Dp),Vd:10},{Dd:Cc(1),Vd:20},{Dd:Cc(5),Vd:21},{Dd:Cc(30),Vd:22},{Dd:el(1),Vd:30},{Dd:el(3),Vd:31},{Dd:el(6),Vd:32},{Dd:el(12),Vd:33}];var Dp;function Fp(t,e){if(t.getUTCFullYear()!==e.getUTCFullYear())return 70;if(t.getUTCMonth()!==e.getUTCMonth())return 60;if(t.getUTCDate()!==e.getUTCDate())return 50;for(let s=tl.length-1;s>=0;--s)if(Math.floor(e.getTime()/tl[s].Dd)!==Math.floor(t.getTime()/tl[s].Dd))return tl[s].Vd;return 0}function Ec(t){let e=t;if(Ta(t)&&(e=xh(t)),!Vd(e))throw new Error("time must be of type BusinessDay");const s=new Date(Date.UTC(e.year,e.month-1,e.day,0,0,0,0));return{Od:Math.round(s.getTime()/1e3),Bd:e}}function Up(t){if(!Ug(t))throw new Error("time must be of type isUTCTimestamp");return{Od:t}}function xh(t){const e=new Date(t);if(isNaN(e.getTime()))throw new Error(`Invalid date string=${t}, expected format=yyyy-mm-dd`);return{day:e.getUTCDate(),month:e.getUTCMonth()+1,year:e.getUTCFullYear()}}function Wp(t){Ta(t.time)&&(t.time=xh(t.time))}class Vp{options(){return this.cn}setOptions(e){this.cn=e,this.updateFormatter(e.localization)}preprocessData(e){Array.isArray(e)?function(s){s.forEach(Wp)}(e):Wp(e)}createConverterToInternalObj(e){return ee(function(s){return s.length===0?null:Vd(s[0].time)||Ta(s[0].time)?Ec:Up}(e))}key(e){return typeof e=="object"&&"Od"in e?e.Od:this.key(this.convertHorzItemToInternal(e))}cacheKey(e){const s=e;return s.Bd===void 0?new Date(1e3*s.Od).getTime():new Date(Date.UTC(s.Bd.year,s.Bd.month-1,s.Bd.day)).getTime()}convertHorzItemToInternal(e){return Ug(s=e)?Up(s):Vd(s)?Ec(s):Ec(xh(s));var s}updateFormatter(e){if(!this.cn)return;const s=e.dateFormat;this.cn.timeScale.timeVisible?this.Ad=new N1({Sd:s,kd:this.cn.timeScale.secondsVisible?"%h:%m:%s":"%h:%m",yd:"   ",Cd:e.locale}):this.Ad=new Wg(s,e.locale)}formatHorzItem(e){const s=e;return this.Ad.Y_(new Date(1e3*s.Od))}formatTickmark(e,s){const r=function(a,l,o){switch(a){case 0:case 10:return l?o?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return l?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(e.weight,this.cn.timeScale.timeVisible,this.cn.timeScale.secondsVisible),i=this.cn.timeScale;if(i.tickMarkFormatter!==void 0){const a=i.tickMarkFormatter(e.originalTime,r,s.locale);if(a!==null)return a}return function(a,l,o){const c={};switch(l){case 0:c.year="numeric";break;case 1:c.month="short";break;case 2:c.day="numeric";break;case 3:c.hour12=!1,c.hour="2-digit",c.minute="2-digit";break;case 4:c.hour12=!1,c.hour="2-digit",c.minute="2-digit",c.second="2-digit"}const d=a.Bd===void 0?new Date(1e3*a.Od):new Date(Date.UTC(a.Bd.year,a.Bd.month-1,a.Bd.day));return new Date(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate(),d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()).toLocaleString(o,c)}(e.time,r,s.locale)}maxTickMarkWeight(e){let s=e.reduce(u1,e[0]).weight;return s>30&&s<50&&(s=30),s}fillWeightsForPoints(e,s){(function(r,i=0){if(r.length===0)return;let a=i===0?null:r[i-1].time.Od,l=a!==null?new Date(1e3*a):null,o=0;for(let c=i;c<r.length;++c){const d=r[c],m=new Date(1e3*d.time.Od);l!==null&&(d.timeWeight=Fp(m,l)),o+=d.time.Od-(a||d.time.Od),a=d.time.Od,l=m}if(i===0&&r.length>1){const c=Math.ceil(o/(r.length-1)),d=new Date(1e3*(r[0].time.Od-c));r[0].timeWeight=Fp(new Date(1e3*r[0].time.Od),d)}})(e,s)}static Id(e){return ns({localization:{dateFormat:"dd MMM 'yy"}},e??{})}}const Ir=typeof window<"u";function qp(){return!!Ir&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function Tc(){return!!Ir&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function qd(t){return t+t%2}function Pc(t,e){return t.zd-e.zd}function Lc(t,e,s){const r=(t.zd-e.zd)/(t.ot-e.ot);return Math.sign(r)*Math.min(Math.abs(r),s)}class j1{constructor(e,s,r,i){this.Ld=null,this.Ed=null,this.Nd=null,this.Fd=null,this.Wd=null,this.jd=0,this.Hd=0,this.$d=e,this.Ud=s,this.qd=r,this.rs=i}Yd(e,s){if(this.Ld!==null){if(this.Ld.ot===s)return void(this.Ld.zd=e);if(Math.abs(this.Ld.zd-e)<this.rs)return}this.Fd=this.Nd,this.Nd=this.Ed,this.Ed=this.Ld,this.Ld={ot:s,zd:e}}Vr(e,s){if(this.Ld===null||this.Ed===null||s-this.Ld.ot>50)return;let r=0;const i=Lc(this.Ld,this.Ed,this.Ud),a=Pc(this.Ld,this.Ed),l=[i],o=[a];if(r+=a,this.Nd!==null){const d=Lc(this.Ed,this.Nd,this.Ud);if(Math.sign(d)===Math.sign(i)){const m=Pc(this.Ed,this.Nd);if(l.push(d),o.push(m),r+=m,this.Fd!==null){const u=Lc(this.Nd,this.Fd,this.Ud);if(Math.sign(u)===Math.sign(i)){const h=Pc(this.Nd,this.Fd);l.push(u),o.push(h),r+=h}}}}let c=0;for(let d=0;d<l.length;++d)c+=o[d]/r*l[d];Math.abs(c)<this.$d||(this.Wd={zd:e,ot:s},this.Hd=c,this.jd=function(d,m){const u=Math.log(m);return Math.log(1*u/-d)/u}(Math.abs(c),this.qd))}tc(e){const s=ee(this.Wd),r=e-s.ot;return s.zd+this.Hd*(Math.pow(this.qd,r)-1)/Math.log(this.qd)}Qu(e){return this.Wd===null||this.Zd(e)===this.jd}Zd(e){const s=e-ee(this.Wd).ot;return Math.min(s,this.jd)}}class w1{constructor(e,s){this.Xd=void 0,this.Kd=void 0,this.Gd=void 0,this.en=!1,this.Jd=e,this.Qd=s,this.tf()}bt(){this.tf()}if(){this.Xd&&this.Jd.removeChild(this.Xd),this.Kd&&this.Jd.removeChild(this.Kd),this.Xd=void 0,this.Kd=void 0}nf(){return this.en!==this.sf()||this.Gd!==this.ef()}ef(){return kg(pa(this.Qd.W().layout.textColor))>160?"dark":"light"}sf(){return this.Qd.W().layout.attributionLogo}rf(){const e=new URL(location.href);return e.hostname?"&utm_source="+e.hostname+e.pathname:""}tf(){this.nf()&&(this.if(),this.en=this.sf(),this.en&&(this.Gd=this.ef(),this.Kd=document.createElement("style"),this.Kd.innerText="a#tv-attr-logo{--fill:#131722;--stroke:#fff;position:absolute;left:10px;bottom:10px;height:19px;width:35px;margin:0;padding:0;border:0;z-index:3;}a#tv-attr-logo[data-dark]{--fill:#D1D4DC;--stroke:#131722;}",this.Xd=document.createElement("a"),this.Xd.href=`https://www.tradingview.com/?utm_medium=lwc-link&utm_campaign=lwc-chart${this.rf()}`,this.Xd.title="Charting by TradingView",this.Xd.id="tv-attr-logo",this.Xd.target="_blank",this.Xd.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35 19" width="35" height="19" fill="none"><g fill-rule="evenodd" clip-path="url(#a)" clip-rule="evenodd"><path fill="var(--stroke)" d="M2 0H0v10h6v9h21.4l.5-1.3 6-15 1-2.7H23.7l-.5 1.3-.2.6a5 5 0 0 0-7-.9V0H2Zm20 17h4l5.2-13 .8-2h-7l-1 2.5-.2.5-1.5 3.8-.3.7V17Zm-.8-10a3 3 0 0 0 .7-2.7A3 3 0 1 0 16.8 7h4.4ZM14 7V2H2v6h6v9h4V7h2Z"/><path fill="var(--fill)" d="M14 2H2v6h6v9h6V2Zm12 15h-7l6-15h7l-6 15Zm-7-9a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/></g><defs><clipPath id="a"><path fill="var(--stroke)" d="M0 0h35v19H0z"/></clipPath></defs></svg>',this.Xd.toggleAttribute("data-dark",this.Gd==="dark"),this.Jd.appendChild(this.Kd),this.Jd.appendChild(this.Xd)))}}function Kn(t,e){const s=ee(t.ownerDocument).createElement("canvas");t.appendChild(s);const r=Ak(s,{options:{allowResizeObserver:!1},transform:(i,a)=>({width:Math.max(i.width,a.width),height:Math.max(i.height,a.height)})});return r.resizeCanvasElement(e),r}function Yn(t){var e;t.width=1,t.height=1,(e=t.getContext("2d"))===null||e===void 0||e.clearRect(0,0,1,1)}function Hd(t,e,s,r){t.gl&&t.gl(e,s,r)}function kl(t,e,s,r){t.X(e,s,r)}function Kd(t,e,s,r){const i=t(s,r);for(const a of i){const l=a.gt();l!==null&&e(l)}}function k1(t){Ir&&window.chrome!==void 0&&t.addEventListener("mousedown",e=>{if(e.button===1)return e.preventDefault(),!1})}class fh{constructor(e,s,r){this.hf=0,this.lf=null,this.af={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY},this._f=0,this.uf=null,this.cf={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY},this.df=null,this.ff=!1,this.vf=null,this.pf=null,this.mf=!1,this.bf=!1,this.wf=!1,this.gf=null,this.Mf=null,this.xf=null,this.Sf=null,this.kf=null,this.yf=null,this.Cf=null,this.Tf=0,this.Pf=!1,this.Rf=!1,this.Df=!1,this.Vf=0,this.Of=null,this.Bf=!Tc(),this.Af=i=>{this.If(i)},this.zf=i=>{if(this.Lf(i)){const a=this.Ef(i);if(++this._f,this.uf&&this._f>1){const{Nf:l}=this.Ff(ds(i),this.cf);l<30&&!this.wf&&this.Wf(a,this.Hf.jf),this.$f()}}else{const a=this.Ef(i);if(++this.hf,this.lf&&this.hf>1){const{Nf:l}=this.Ff(ds(i),this.af);l<5&&!this.bf&&this.Uf(a,this.Hf.qf),this.Yf()}}},this.Zf=e,this.Hf=s,this.cn=r,this.Xf()}S(){this.gf!==null&&(this.gf(),this.gf=null),this.Mf!==null&&(this.Mf(),this.Mf=null),this.Sf!==null&&(this.Sf(),this.Sf=null),this.kf!==null&&(this.kf(),this.kf=null),this.yf!==null&&(this.yf(),this.yf=null),this.xf!==null&&(this.xf(),this.xf=null),this.Kf(),this.Yf()}Gf(e){this.Sf&&this.Sf();const s=this.Jf.bind(this);if(this.Sf=()=>{this.Zf.removeEventListener("mousemove",s)},this.Zf.addEventListener("mousemove",s),this.Lf(e))return;const r=this.Ef(e);this.Uf(r,this.Hf.Qf),this.Bf=!0}Yf(){this.lf!==null&&clearTimeout(this.lf),this.hf=0,this.lf=null,this.af={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY}}$f(){this.uf!==null&&clearTimeout(this.uf),this._f=0,this.uf=null,this.cf={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY}}Jf(e){if(this.Df||this.pf!==null||this.Lf(e))return;const s=this.Ef(e);this.Uf(s,this.Hf.tv),this.Bf=!0}iv(e){const s=_c(e.changedTouches,ee(this.Of));if(s===null||(this.Vf=sl(e),this.Cf!==null)||this.Rf)return;this.Pf=!0;const r=this.Ff(ds(s),ee(this.pf)),{nv:i,sv:a,Nf:l}=r;if(this.mf||!(l<5)){if(!this.mf){const o=.5*i,c=a>=o&&!this.cn.ev(),d=o>a&&!this.cn.rv();c||d||(this.Rf=!0),this.mf=!0,this.wf=!0,this.Kf(),this.$f()}if(!this.Rf){const o=this.Ef(e,s);this.Wf(o,this.Hf.hv),er(e)}}}lv(e){if(e.button!==0)return;const s=this.Ff(ds(e),ee(this.vf)),{Nf:r}=s;if(r>=5&&(this.bf=!0,this.Yf()),this.bf){const i=this.Ef(e);this.Uf(i,this.Hf.av)}}Ff(e,s){const r=Math.abs(s.nt-e.nt),i=Math.abs(s.st-e.st);return{nv:r,sv:i,Nf:r+i}}ov(e){let s=_c(e.changedTouches,ee(this.Of));if(s===null&&e.touches.length===0&&(s=e.changedTouches[0]),s===null)return;this.Of=null,this.Vf=sl(e),this.Kf(),this.pf=null,this.yf&&(this.yf(),this.yf=null);const r=this.Ef(e,s);if(this.Wf(r,this.Hf._v),++this._f,this.uf&&this._f>1){const{Nf:i}=this.Ff(ds(s),this.cf);i<30&&!this.wf&&this.Wf(r,this.Hf.jf),this.$f()}else this.wf||(this.Wf(r,this.Hf.uv),this.Hf.uv&&er(e));this._f===0&&er(e),e.touches.length===0&&this.ff&&(this.ff=!1,er(e))}If(e){if(e.button!==0)return;const s=this.Ef(e);if(this.vf=null,this.Df=!1,this.kf&&(this.kf(),this.kf=null),qp()&&this.Zf.ownerDocument.documentElement.removeEventListener("mouseleave",this.Af),!this.Lf(e))if(this.Uf(s,this.Hf.cv),++this.hf,this.lf&&this.hf>1){const{Nf:r}=this.Ff(ds(e),this.af);r<5&&!this.bf&&this.Uf(s,this.Hf.qf),this.Yf()}else this.bf||this.Uf(s,this.Hf.dv)}Kf(){this.df!==null&&(clearTimeout(this.df),this.df=null)}fv(e){if(this.Of!==null)return;const s=e.changedTouches[0];this.Of=s.identifier,this.Vf=sl(e);const r=this.Zf.ownerDocument.documentElement;this.wf=!1,this.mf=!1,this.Rf=!1,this.pf=ds(s),this.yf&&(this.yf(),this.yf=null);{const a=this.iv.bind(this),l=this.ov.bind(this);this.yf=()=>{r.removeEventListener("touchmove",a),r.removeEventListener("touchend",l)},r.addEventListener("touchmove",a,{passive:!1}),r.addEventListener("touchend",l,{passive:!1}),this.Kf(),this.df=setTimeout(this.vv.bind(this,e),240)}const i=this.Ef(e,s);this.Wf(i,this.Hf.pv),this.uf||(this._f=0,this.uf=setTimeout(this.$f.bind(this),500),this.cf=ds(s))}mv(e){if(e.button!==0)return;const s=this.Zf.ownerDocument.documentElement;qp()&&s.addEventListener("mouseleave",this.Af),this.bf=!1,this.vf=ds(e),this.kf&&(this.kf(),this.kf=null);{const i=this.lv.bind(this),a=this.If.bind(this);this.kf=()=>{s.removeEventListener("mousemove",i),s.removeEventListener("mouseup",a)},s.addEventListener("mousemove",i),s.addEventListener("mouseup",a)}if(this.Df=!0,this.Lf(e))return;const r=this.Ef(e);this.Uf(r,this.Hf.bv),this.lf||(this.hf=0,this.lf=setTimeout(this.Yf.bind(this),500),this.af=ds(e))}Xf(){this.Zf.addEventListener("mouseenter",this.Gf.bind(this)),this.Zf.addEventListener("touchcancel",this.Kf.bind(this));{const e=this.Zf.ownerDocument,s=r=>{this.Hf.wv&&(r.composed&&this.Zf.contains(r.composedPath()[0])||r.target&&this.Zf.contains(r.target)||this.Hf.wv())};this.Mf=()=>{e.removeEventListener("touchstart",s)},this.gf=()=>{e.removeEventListener("mousedown",s)},e.addEventListener("mousedown",s),e.addEventListener("touchstart",s,{passive:!0})}Tc()&&(this.xf=()=>{this.Zf.removeEventListener("dblclick",this.zf)},this.Zf.addEventListener("dblclick",this.zf)),this.Zf.addEventListener("mouseleave",this.gv.bind(this)),this.Zf.addEventListener("touchstart",this.fv.bind(this),{passive:!0}),k1(this.Zf),this.Zf.addEventListener("mousedown",this.mv.bind(this)),this.Mv(),this.Zf.addEventListener("touchmove",()=>{},{passive:!1})}Mv(){this.Hf.xv===void 0&&this.Hf.Sv===void 0&&this.Hf.kv===void 0||(this.Zf.addEventListener("touchstart",e=>this.yv(e.touches),{passive:!0}),this.Zf.addEventListener("touchmove",e=>{if(e.touches.length===2&&this.Cf!==null&&this.Hf.Sv!==void 0){const s=Hp(e.touches[0],e.touches[1])/this.Tf;this.Hf.Sv(this.Cf,s),er(e)}},{passive:!1}),this.Zf.addEventListener("touchend",e=>{this.yv(e.touches)}))}yv(e){e.length===1&&(this.Pf=!1),e.length!==2||this.Pf||this.ff?this.Cv():this.Tv(e)}Tv(e){const s=this.Zf.getBoundingClientRect()||{left:0,top:0};this.Cf={nt:(e[0].clientX-s.left+(e[1].clientX-s.left))/2,st:(e[0].clientY-s.top+(e[1].clientY-s.top))/2},this.Tf=Hp(e[0],e[1]),this.Hf.xv!==void 0&&this.Hf.xv(),this.Kf()}Cv(){this.Cf!==null&&(this.Cf=null,this.Hf.kv!==void 0&&this.Hf.kv())}gv(e){if(this.Sf&&this.Sf(),this.Lf(e)||!this.Bf)return;const s=this.Ef(e);this.Uf(s,this.Hf.Pv),this.Bf=!Tc()}vv(e){const s=_c(e.touches,ee(this.Of));if(s===null)return;const r=this.Ef(e,s);this.Wf(r,this.Hf.Rv),this.wf=!0,this.ff=!0}Lf(e){return e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents!==void 0?e.sourceCapabilities.firesTouchEvents:sl(e)<this.Vf+500}Wf(e,s){s&&s.call(this.Hf,e)}Uf(e,s){s&&s.call(this.Hf,e)}Ef(e,s){const r=s||e,i=this.Zf.getBoundingClientRect()||{left:0,top:0};return{clientX:r.clientX,clientY:r.clientY,pageX:r.pageX,pageY:r.pageY,screenX:r.screenX,screenY:r.screenY,localX:r.clientX-i.left,localY:r.clientY-i.top,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey,Dv:!e.type.startsWith("mouse")&&e.type!=="contextmenu"&&e.type!=="click",Vv:e.type,Ov:r.target,Bv:e.view,Av:()=>{e.type!=="touchstart"&&er(e)}}}}function Hp(t,e){const s=t.clientX-e.clientX,r=t.clientY-e.clientY;return Math.sqrt(s*s+r*r)}function er(t){t.cancelable&&t.preventDefault()}function ds(t){return{nt:t.pageX,st:t.pageY}}function sl(t){return t.timeStamp||performance.now()}function _c(t,e){for(let s=0;s<t.length;++s)if(t[s].identifier===e)return t[s];return null}function nl(t){return{Hc:t.Hc,Iv:{gr:t.zv.externalId},Lv:t.zv.cursorStyle}}function S1(t,e,s){for(const r of t){const i=r.gt();if(i!==null&&i.wr){const a=i.wr(e,s);if(a!==null)return{Bv:r,Iv:a}}}return null}function Mc(t,e){return s=>{var r,i,a,l;return((i=(r=s.Dt())===null||r===void 0?void 0:r.Pa())!==null&&i!==void 0?i:"")!==e?[]:(l=(a=s.da)===null||a===void 0?void 0:a.call(s,t))!==null&&l!==void 0?l:[]}}function Kp(t,e,s,r){if(!t.length)return;let i=0;const a=s/2,l=t[0].At(r,!0);let o=e===1?a-(t[0].Vi()-l/2):t[0].Vi()-l/2-a;o=Math.max(0,o);for(let c=1;c<t.length;c++){const d=t[c],m=t[c-1],u=m.At(r,!1),h=d.Vi(),x=m.Vi();if(e===1?h>x-u:h<x+u){const y=x-u*e;d.Oi(y);const f=y-e*u/2;if((e===1?f<0:f>s)&&o>0){const w=e===1?-1-f:f-s,p=Math.min(w,o);for(let b=i;b<t.length;b++)t[b].Oi(t[b].Vi()+e*p);o-=p}}else i=c,o=e===1?x-u-h:h-(x+u)}}class Yp{constructor(e,s,r,i){this.Li=null,this.Ev=null,this.Nv=!1,this.Fv=new ga(200),this.Qr=null,this.Wv=0,this.jv=!1,this.Hv=()=>{this.jv||this.tn.$v().$t().Uh()},this.Uv=()=>{this.jv||this.tn.$v().$t().Uh()},this.tn=e,this.cn=s,this.ko=s.layout,this.Oc=r,this.qv=i==="left",this.Yv=Mc("normal",i),this.Zv=Mc("top",i),this.Xv=Mc("bottom",i),this.Kv=document.createElement("div"),this.Kv.style.height="100%",this.Kv.style.overflow="hidden",this.Kv.style.width="25px",this.Kv.style.left="0",this.Kv.style.position="relative",this.Gv=Kn(this.Kv,Re({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.Hv);const a=this.Gv.canvasElement;a.style.position="absolute",a.style.zIndex="1",a.style.left="0",a.style.top="0",this.Jv=Kn(this.Kv,Re({width:16,height:16})),this.Jv.subscribeSuggestedBitmapSizeChanged(this.Uv);const l=this.Jv.canvasElement;l.style.position="absolute",l.style.zIndex="2",l.style.left="0",l.style.top="0";const o={bv:this.Qv.bind(this),pv:this.Qv.bind(this),av:this.tp.bind(this),hv:this.tp.bind(this),wv:this.ip.bind(this),cv:this.np.bind(this),_v:this.np.bind(this),qf:this.sp.bind(this),jf:this.sp.bind(this),Qf:this.ep.bind(this),Pv:this.rp.bind(this)};this.hp=new fh(this.Jv.canvasElement,o,{ev:()=>!this.cn.handleScroll.vertTouchDrag,rv:()=>!0})}S(){this.hp.S(),this.Jv.unsubscribeSuggestedBitmapSizeChanged(this.Uv),Yn(this.Jv.canvasElement),this.Jv.dispose(),this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.Hv),Yn(this.Gv.canvasElement),this.Gv.dispose(),this.Li!==null&&this.Li.Ko().p(this),this.Li=null}lp(){return this.Kv}P(){return this.ko.fontSize}ap(){const e=this.Oc.W();return this.Qr!==e.R&&(this.Fv.nr(),this.Qr=e.R),e}op(){if(this.Li===null)return 0;let e=0;const s=this.ap(),r=ee(this.Gv.canvasElement.getContext("2d"));r.save();const i=this.Li.Ha();r.font=this._p(),i.length>0&&(e=Math.max(this.Fv.xi(r,i[0].so),this.Fv.xi(r,i[i.length-1].so)));const a=this.up();for(let d=a.length;d--;){const m=this.Fv.xi(r,a[d].Kt());m>e&&(e=m)}const l=this.Li.Ct();if(l!==null&&this.Ev!==null&&(o=this.cn.crosshair).mode!==2&&o.horzLine.visible&&o.horzLine.labelVisible){const d=this.Li.pn(1,l),m=this.Li.pn(this.Ev.height-2,l);e=Math.max(e,this.Fv.xi(r,this.Li.Fi(Math.floor(Math.min(d,m))+.11111111111111,l)),this.Fv.xi(r,this.Li.Fi(Math.ceil(Math.max(d,m))-.11111111111111,l)))}var o;r.restore();const c=e||34;return qd(Math.ceil(s.C+s.T+s.A+s.I+5+c))}cp(e){this.Ev!==null&&On(this.Ev,e)||(this.Ev=e,this.jv=!0,this.Gv.resizeCanvasElement(e),this.Jv.resizeCanvasElement(e),this.jv=!1,this.Kv.style.width=`${e.width}px`,this.Kv.style.height=`${e.height}px`)}dp(){return ee(this.Ev).width}Gi(e){this.Li!==e&&(this.Li!==null&&this.Li.Ko().p(this),this.Li=e,e.Ko().l(this.fo.bind(this),this))}Dt(){return this.Li}nr(){const e=this.tn.fp();this.tn.$v().$t().E_(e,ee(this.Dt()))}vp(e){if(this.Ev===null)return;if(e!==1){this.pp(),this.Gv.applySuggestedBitmapSize();const r=qn(this.Gv);r!==null&&(r.useBitmapCoordinateSpace(i=>{this.mp(i),this.Ie(i)}),this.tn.bp(r,this.Xv),this.wp(r),this.tn.bp(r,this.Yv),this.gp(r))}this.Jv.applySuggestedBitmapSize();const s=qn(this.Jv);s!==null&&(s.useBitmapCoordinateSpace(({context:r,bitmapSize:i})=>{r.clearRect(0,0,i.width,i.height)}),this.Mp(s),this.tn.bp(s,this.Zv))}xp(){return this.Gv.bitmapSize}Sp(e,s,r){const i=this.xp();i.width>0&&i.height>0&&e.drawImage(this.Gv.canvasElement,s,r)}bt(){var e;(e=this.Li)===null||e===void 0||e.Ha()}Qv(e){if(this.Li===null||this.Li.Ni()||!this.cn.handleScale.axisPressedMouseMove.price)return;const s=this.tn.$v().$t(),r=this.tn.fp();this.Nv=!0,s.V_(r,this.Li,e.localY)}tp(e){if(this.Li===null||!this.cn.handleScale.axisPressedMouseMove.price)return;const s=this.tn.$v().$t(),r=this.tn.fp(),i=this.Li;s.O_(r,i,e.localY)}ip(){if(this.Li===null||!this.cn.handleScale.axisPressedMouseMove.price)return;const e=this.tn.$v().$t(),s=this.tn.fp(),r=this.Li;this.Nv&&(this.Nv=!1,e.B_(s,r))}np(e){if(this.Li===null||!this.cn.handleScale.axisPressedMouseMove.price)return;const s=this.tn.$v().$t(),r=this.tn.fp();this.Nv=!1,s.B_(r,this.Li)}sp(e){this.cn.handleScale.axisDoubleClickReset.price&&this.nr()}ep(e){this.Li!==null&&(!this.tn.$v().$t().W().handleScale.axisPressedMouseMove.price||this.Li.Mh()||this.Li.Oo()||this.kp(1))}rp(e){this.kp(0)}up(){const e=[],s=this.Li===null?void 0:this.Li;return(r=>{for(let i=0;i<r.length;++i){const a=r[i].Rn(this.tn.fp(),s);for(let l=0;l<a.length;l++)e.push(a[l])}})(this.tn.fp().Uo()),e}mp({context:e,bitmapSize:s}){const{width:r,height:i}=s,a=this.tn.fp().$t(),l=a.q(),o=a.bd();l===o?Ao(e,0,0,r,i,l):Sg(e,0,0,r,i,l,o)}Ie({context:e,bitmapSize:s,horizontalPixelRatio:r}){if(this.Ev===null||this.Li===null||!this.Li.W().borderVisible)return;e.fillStyle=this.Li.W().borderColor;const i=Math.max(1,Math.floor(this.ap().C*r));let a;a=this.qv?s.width-i:0,e.fillRect(a,0,i,s.height)}wp(e){if(this.Ev===null||this.Li===null)return;const s=this.Li.Ha(),r=this.Li.W(),i=this.ap(),a=this.qv?this.Ev.width-i.T:0;r.borderVisible&&r.ticksVisible&&e.useBitmapCoordinateSpace(({context:l,horizontalPixelRatio:o,verticalPixelRatio:c})=>{l.fillStyle=r.borderColor;const d=Math.max(1,Math.floor(c)),m=Math.floor(.5*c),u=Math.round(i.T*o);l.beginPath();for(const h of s)l.rect(Math.floor(a*o),Math.round(h.Ea*c)-m,u,d);l.fill()}),e.useMediaCoordinateSpace(({context:l})=>{var o;l.font=this._p(),l.fillStyle=(o=r.textColor)!==null&&o!==void 0?o:this.ko.textColor,l.textAlign=this.qv?"right":"left",l.textBaseline="middle";const c=this.qv?Math.round(a-i.A):Math.round(a+i.T+i.A),d=s.map(m=>this.Fv.Mi(l,m.so));for(let m=s.length;m--;){const u=s[m];l.fillText(u.so,c,u.Ea+d[m])}})}pp(){if(this.Ev===null||this.Li===null)return;const e=[],s=this.Li.Uo().slice(),r=this.tn.fp(),i=this.ap();this.Li===r.pr()&&this.tn.fp().Uo().forEach(l=>{r.vr(l)&&s.push(l)});const a=this.Li;s.forEach(l=>{l.Rn(r,a).forEach(o=>{o.Oi(null),o.Bi()&&e.push(o)})}),e.forEach(l=>l.Oi(l.ki())),this.Li.W().alignLabels&&this.yp(e,i)}yp(e,s){if(this.Ev===null)return;const r=this.Ev.height/2,i=e.filter(l=>l.ki()<=r),a=e.filter(l=>l.ki()>r);i.sort((l,o)=>o.ki()-l.ki()),a.sort((l,o)=>l.ki()-o.ki());for(const l of e){const o=Math.floor(l.At(s)/2),c=l.ki();c>-o&&c<o&&l.Oi(o),c>this.Ev.height-o&&c<this.Ev.height+o&&l.Oi(this.Ev.height-o)}Kp(i,1,this.Ev.height,s),Kp(a,-1,this.Ev.height,s)}gp(e){if(this.Ev===null)return;const s=this.up(),r=this.ap(),i=this.qv?"right":"left";s.forEach(a=>{a.Ai()&&a.gt(ee(this.Li)).X(e,r,this.Fv,i)})}Mp(e){if(this.Ev===null||this.Li===null)return;const s=this.tn.$v().$t(),r=[],i=this.tn.fp(),a=s.Zc().Rn(i,this.Li);a.length&&r.push(a);const l=this.ap(),o=this.qv?"right":"left";r.forEach(c=>{c.forEach(d=>{d.gt(ee(this.Li)).X(e,l,this.Fv,o)})})}kp(e){this.Kv.style.cursor=e===1?"ns-resize":"default"}fo(){const e=this.op();this.Wv<e&&this.tn.$v().$t().Kl(),this.Wv=e}_p(){return Or(this.ko.fontSize,this.ko.fontFamily)}}function C1(t,e){var s,r;return(r=(s=t.ua)===null||s===void 0?void 0:s.call(t,e))!==null&&r!==void 0?r:[]}function rl(t,e){var s,r;return(r=(s=t.Pn)===null||s===void 0?void 0:s.call(t,e))!==null&&r!==void 0?r:[]}function E1(t,e){var s,r;return(r=(s=t.Ji)===null||s===void 0?void 0:s.call(t,e))!==null&&r!==void 0?r:[]}function T1(t,e){var s,r;return(r=(s=t.aa)===null||s===void 0?void 0:s.call(t,e))!==null&&r!==void 0?r:[]}class gh{constructor(e,s){this.Ev=Re({width:0,height:0}),this.Cp=null,this.Tp=null,this.Pp=null,this.Rp=null,this.Dp=!1,this.Vp=new Ve,this.Op=new Ve,this.Bp=0,this.Ap=!1,this.Ip=null,this.zp=!1,this.Lp=null,this.Ep=null,this.jv=!1,this.Hv=()=>{this.jv||this.Np===null||this.$i().Uh()},this.Uv=()=>{this.jv||this.Np===null||this.$i().Uh()},this.Qd=e,this.Np=s,this.Np.W_().l(this.Fp.bind(this),this,!0),this.Wp=document.createElement("td"),this.Wp.style.padding="0",this.Wp.style.position="relative";const r=document.createElement("div");r.style.width="100%",r.style.height="100%",r.style.position="relative",r.style.overflow="hidden",this.jp=document.createElement("td"),this.jp.style.padding="0",this.Hp=document.createElement("td"),this.Hp.style.padding="0",this.Wp.appendChild(r),this.Gv=Kn(r,Re({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.Hv);const i=this.Gv.canvasElement;i.style.position="absolute",i.style.zIndex="1",i.style.left="0",i.style.top="0",this.Jv=Kn(r,Re({width:16,height:16})),this.Jv.subscribeSuggestedBitmapSizeChanged(this.Uv);const a=this.Jv.canvasElement;a.style.position="absolute",a.style.zIndex="2",a.style.left="0",a.style.top="0",this.$p=document.createElement("tr"),this.$p.appendChild(this.jp),this.$p.appendChild(this.Wp),this.$p.appendChild(this.Hp),this.Up(),this.hp=new fh(this.Jv.canvasElement,this,{ev:()=>this.Ip===null&&!this.Qd.W().handleScroll.vertTouchDrag,rv:()=>this.Ip===null&&!this.Qd.W().handleScroll.horzTouchDrag})}S(){this.Cp!==null&&this.Cp.S(),this.Tp!==null&&this.Tp.S(),this.Pp=null,this.Jv.unsubscribeSuggestedBitmapSizeChanged(this.Uv),Yn(this.Jv.canvasElement),this.Jv.dispose(),this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.Hv),Yn(this.Gv.canvasElement),this.Gv.dispose(),this.Np!==null&&this.Np.W_().p(this),this.hp.S()}fp(){return ee(this.Np)}qp(e){var s,r;this.Np!==null&&this.Np.W_().p(this),this.Np=e,this.Np!==null&&this.Np.W_().l(gh.prototype.Fp.bind(this),this,!0),this.Up(),this.Qd.Yp().indexOf(this)===this.Qd.Yp().length-1?(this.Pp=(s=this.Pp)!==null&&s!==void 0?s:new w1(this.Wp,this.Qd),this.Pp.bt()):((r=this.Pp)===null||r===void 0||r.if(),this.Pp=null)}$v(){return this.Qd}lp(){return this.$p}Up(){if(this.Np!==null&&(this.Zp(),this.$i().wt().length!==0)){if(this.Cp!==null){const e=this.Np.R_();this.Cp.Gi(ee(e))}if(this.Tp!==null){const e=this.Np.D_();this.Tp.Gi(ee(e))}}}Xp(){this.Cp!==null&&this.Cp.bt(),this.Tp!==null&&this.Tp.bt()}M_(){return this.Np!==null?this.Np.M_():0}x_(e){this.Np&&this.Np.x_(e)}Qf(e){if(!this.Np)return;this.Kp();const s=e.localX,r=e.localY;this.Gp(s,r,e)}bv(e){this.Kp(),this.Jp(),this.Gp(e.localX,e.localY,e)}tv(e){var s;if(!this.Np)return;this.Kp();const r=e.localX,i=e.localY;this.Gp(r,i,e);const a=this.wr(r,i);this.Qd.Qp((s=a==null?void 0:a.Lv)!==null&&s!==void 0?s:null),this.$i().jc(a&&{Hc:a.Hc,Iv:a.Iv})}dv(e){this.Np!==null&&(this.Kp(),this.tm(e))}qf(e){this.Np!==null&&this.im(this.Op,e)}jf(e){this.qf(e)}av(e){this.Kp(),this.nm(e),this.Gp(e.localX,e.localY,e)}cv(e){this.Np!==null&&(this.Kp(),this.Ap=!1,this.sm(e))}uv(e){this.Np!==null&&this.tm(e)}Rv(e){if(this.Ap=!0,this.Ip===null){const s={x:e.localX,y:e.localY};this.rm(s,s,e)}}Pv(e){this.Np!==null&&(this.Kp(),this.Np.$t().jc(null),this.hm())}lm(){return this.Vp}am(){return this.Op}xv(){this.Bp=1,this.$i().Un()}Sv(e,s){if(!this.Qd.W().handleScale.pinch)return;const r=5*(s-this.Bp);this.Bp=s,this.$i().Qc(e.nt,r)}pv(e){this.Ap=!1,this.zp=this.Ip!==null,this.Jp();const s=this.$i().Zc();this.Ip!==null&&s.yt()&&(this.Lp={x:s.Yt(),y:s.Zt()},this.Ip={x:e.localX,y:e.localY})}hv(e){if(this.Np===null)return;const s=e.localX,r=e.localY;if(this.Ip===null)this.nm(e);else{this.zp=!1;const i=ee(this.Lp),a=i.x+(s-this.Ip.x),l=i.y+(r-this.Ip.y);this.Gp(a,l,e)}}_v(e){this.$v().W().trackingMode.exitMode===0&&(this.zp=!0),this.om(),this.sm(e)}wr(e,s){const r=this.Np;return r===null?null:function(i,a,l){const o=i.Uo(),c=function(d,m,u){var h,x;let y,f;for(const b of d){const v=(x=(h=b.va)===null||h===void 0?void 0:h.call(b,m,u))!==null&&x!==void 0?x:[];for(const S of v)w=S.zOrder,(!(p=y==null?void 0:y.zOrder)||w==="top"&&p!=="top"||w==="normal"&&p==="bottom")&&(y=S,f=b)}var w,p;return y&&f?{zv:y,Hc:f}:null}(o,a,l);if((c==null?void 0:c.zv.zOrder)==="top")return nl(c);for(const d of o){if(c&&c.Hc===d&&c.zv.zOrder!=="bottom"&&!c.zv.isBackground)return nl(c);const m=S1(d.Pn(i),a,l);if(m!==null)return{Hc:d,Bv:m.Bv,Iv:m.Iv};if(c&&c.Hc===d&&c.zv.zOrder!=="bottom"&&c.zv.isBackground)return nl(c)}return c!=null&&c.zv?nl(c):null}(r,e,s)}_m(e,s){ee(s==="left"?this.Cp:this.Tp).cp(Re({width:e,height:this.Ev.height}))}um(){return this.Ev}cp(e){On(this.Ev,e)||(this.Ev=e,this.jv=!0,this.Gv.resizeCanvasElement(e),this.Jv.resizeCanvasElement(e),this.jv=!1,this.Wp.style.width=e.width+"px",this.Wp.style.height=e.height+"px")}dm(){const e=ee(this.Np);e.P_(e.R_()),e.P_(e.D_());for(const s of e.Ba())if(e.vr(s)){const r=s.Dt();r!==null&&e.P_(r),s.Vn()}}xp(){return this.Gv.bitmapSize}Sp(e,s,r){const i=this.xp();i.width>0&&i.height>0&&e.drawImage(this.Gv.canvasElement,s,r)}vp(e){if(e===0||this.Np===null)return;if(e>1&&this.dm(),this.Cp!==null&&this.Cp.vp(e),this.Tp!==null&&this.Tp.vp(e),e!==1){this.Gv.applySuggestedBitmapSize();const r=qn(this.Gv);r!==null&&(r.useBitmapCoordinateSpace(i=>{this.mp(i)}),this.Np&&(this.fm(r,C1),this.vm(r),this.pm(r),this.fm(r,rl),this.fm(r,E1)))}this.Jv.applySuggestedBitmapSize();const s=qn(this.Jv);s!==null&&(s.useBitmapCoordinateSpace(({context:r,bitmapSize:i})=>{r.clearRect(0,0,i.width,i.height)}),this.bm(s),this.fm(s,T1))}wm(){return this.Cp}gm(){return this.Tp}bp(e,s){this.fm(e,s)}Fp(){this.Np!==null&&this.Np.W_().p(this),this.Np=null}tm(e){this.im(this.Vp,e)}im(e,s){const r=s.localX,i=s.localY;e.M()&&e.m(this.$i().St().Nu(r),{x:r,y:i},s)}mp({context:e,bitmapSize:s}){const{width:r,height:i}=s,a=this.$i(),l=a.q(),o=a.bd();l===o?Ao(e,0,0,r,i,o):Sg(e,0,0,r,i,l,o)}vm(e){const s=ee(this.Np).j_().qh().gt();s!==null&&s.X(e,!1)}pm(e){const s=this.$i().Yc();this.Mm(e,rl,Hd,s),this.Mm(e,rl,kl,s)}bm(e){this.Mm(e,rl,kl,this.$i().Zc())}fm(e,s){const r=ee(this.Np).Uo();for(const i of r)this.Mm(e,s,Hd,i);for(const i of r)this.Mm(e,s,kl,i)}Mm(e,s,r,i){const a=ee(this.Np),l=a.$t().Wc(),o=l!==null&&l.Hc===i,c=l!==null&&o&&l.Iv!==void 0?l.Iv.Mr:void 0;Kd(s,d=>r(d,e,o,c),i,a)}Zp(){if(this.Np===null)return;const e=this.Qd,s=this.Np.R_().W().visible,r=this.Np.D_().W().visible;s||this.Cp===null||(this.jp.removeChild(this.Cp.lp()),this.Cp.S(),this.Cp=null),r||this.Tp===null||(this.Hp.removeChild(this.Tp.lp()),this.Tp.S(),this.Tp=null);const i=e.$t().ud();s&&this.Cp===null&&(this.Cp=new Yp(this,e.W(),i,"left"),this.jp.appendChild(this.Cp.lp())),r&&this.Tp===null&&(this.Tp=new Yp(this,e.W(),i,"right"),this.Hp.appendChild(this.Tp.lp()))}xm(e){return e.Dv&&this.Ap||this.Ip!==null}Sm(e){return Math.max(0,Math.min(e,this.Ev.width-1))}km(e){return Math.max(0,Math.min(e,this.Ev.height-1))}Gp(e,s,r){this.$i().ld(this.Sm(e),this.km(s),r,ee(this.Np))}hm(){this.$i().od()}om(){this.zp&&(this.Ip=null,this.hm())}rm(e,s,r){this.Ip=e,this.zp=!1,this.Gp(s.x,s.y,r);const i=this.$i().Zc();this.Lp={x:i.Yt(),y:i.Zt()}}$i(){return this.Qd.$t()}sm(e){if(!this.Dp)return;const s=this.$i(),r=this.fp();if(s.z_(r,r.vn()),this.Rp=null,this.Dp=!1,s.ed(),this.Ep!==null){const i=performance.now(),a=s.St();this.Ep.Vr(a.Hu(),i),this.Ep.Qu(i)||s.Zn(this.Ep)}}Kp(){this.Ip=null}Jp(){if(this.Np){if(this.$i().Un(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)ee(document.activeElement).blur();else{const e=document.getSelection();e!==null&&e.removeAllRanges()}!this.Np.vn().Ni()&&this.$i().St().Ni()}}nm(e){if(this.Np===null)return;const s=this.$i(),r=s.St();if(r.Ni())return;const i=this.Qd.W(),a=i.handleScroll,l=i.kineticScroll;if((!a.pressedMouseMove||e.Dv)&&(!a.horzTouchDrag&&!a.vertTouchDrag||!e.Dv))return;const o=this.Np.vn(),c=performance.now();if(this.Rp!==null||this.xm(e)||(this.Rp={x:e.clientX,y:e.clientY,Od:c,ym:e.localX,Cm:e.localY}),this.Rp!==null&&!this.Dp&&(this.Rp.x!==e.clientX||this.Rp.y!==e.clientY)){if(e.Dv&&l.touch||!e.Dv&&l.mouse){const d=r.le();this.Ep=new j1(.2/d,7/d,.997,15/d),this.Ep.Yd(r.Hu(),this.Rp.Od)}else this.Ep=null;o.Ni()||s.A_(this.Np,o,e.localY),s.nd(e.localX),this.Dp=!0}this.Dp&&(o.Ni()||s.I_(this.Np,o,e.localY),s.sd(e.localX),this.Ep!==null&&this.Ep.Yd(r.Hu(),c))}}class Qp{constructor(e,s,r,i,a){this.ft=!0,this.Ev=Re({width:0,height:0}),this.Hv=()=>this.vp(3),this.qv=e==="left",this.Oc=r.ud,this.cn=s,this.Tm=i,this.Pm=a,this.Kv=document.createElement("div"),this.Kv.style.width="25px",this.Kv.style.height="100%",this.Kv.style.overflow="hidden",this.Gv=Kn(this.Kv,Re({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.Hv)}S(){this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.Hv),Yn(this.Gv.canvasElement),this.Gv.dispose()}lp(){return this.Kv}um(){return this.Ev}cp(e){On(this.Ev,e)||(this.Ev=e,this.Gv.resizeCanvasElement(e),this.Kv.style.width=`${e.width}px`,this.Kv.style.height=`${e.height}px`,this.ft=!0)}vp(e){if(e<3&&!this.ft||this.Ev.width===0||this.Ev.height===0)return;this.ft=!1,this.Gv.applySuggestedBitmapSize();const s=qn(this.Gv);s!==null&&s.useBitmapCoordinateSpace(r=>{this.mp(r),this.Ie(r)})}xp(){return this.Gv.bitmapSize}Sp(e,s,r){const i=this.xp();i.width>0&&i.height>0&&e.drawImage(this.Gv.canvasElement,s,r)}Ie({context:e,bitmapSize:s,horizontalPixelRatio:r,verticalPixelRatio:i}){if(!this.Tm())return;e.fillStyle=this.cn.timeScale.borderColor;const a=Math.floor(this.Oc.W().C*r),l=Math.floor(this.Oc.W().C*i),o=this.qv?s.width-a:0;e.fillRect(o,0,a,l)}mp({context:e,bitmapSize:s}){Ao(e,0,0,s.width,s.height,this.Pm())}}function yh(t){return e=>{var s,r;return(r=(s=e.fa)===null||s===void 0?void 0:s.call(e,t))!==null&&r!==void 0?r:[]}}const P1=yh("normal"),L1=yh("top"),_1=yh("bottom");class M1{constructor(e,s){this.Rm=null,this.Dm=null,this.k=null,this.Vm=!1,this.Ev=Re({width:0,height:0}),this.Om=new Ve,this.Fv=new ga(5),this.jv=!1,this.Hv=()=>{this.jv||this.Qd.$t().Uh()},this.Uv=()=>{this.jv||this.Qd.$t().Uh()},this.Qd=e,this.q_=s,this.cn=e.W().layout,this.Xd=document.createElement("tr"),this.Bm=document.createElement("td"),this.Bm.style.padding="0",this.Am=document.createElement("td"),this.Am.style.padding="0",this.Kv=document.createElement("td"),this.Kv.style.height="25px",this.Kv.style.padding="0",this.Im=document.createElement("div"),this.Im.style.width="100%",this.Im.style.height="100%",this.Im.style.position="relative",this.Im.style.overflow="hidden",this.Kv.appendChild(this.Im),this.Gv=Kn(this.Im,Re({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.Hv);const r=this.Gv.canvasElement;r.style.position="absolute",r.style.zIndex="1",r.style.left="0",r.style.top="0",this.Jv=Kn(this.Im,Re({width:16,height:16})),this.Jv.subscribeSuggestedBitmapSizeChanged(this.Uv);const i=this.Jv.canvasElement;i.style.position="absolute",i.style.zIndex="2",i.style.left="0",i.style.top="0",this.Xd.appendChild(this.Bm),this.Xd.appendChild(this.Kv),this.Xd.appendChild(this.Am),this.zm(),this.Qd.$t().g_().l(this.zm.bind(this),this),this.hp=new fh(this.Jv.canvasElement,this,{ev:()=>!0,rv:()=>!this.Qd.W().handleScroll.horzTouchDrag})}S(){this.hp.S(),this.Rm!==null&&this.Rm.S(),this.Dm!==null&&this.Dm.S(),this.Jv.unsubscribeSuggestedBitmapSizeChanged(this.Uv),Yn(this.Jv.canvasElement),this.Jv.dispose(),this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.Hv),Yn(this.Gv.canvasElement),this.Gv.dispose()}lp(){return this.Xd}Lm(){return this.Rm}Em(){return this.Dm}bv(e){if(this.Vm)return;this.Vm=!0;const s=this.Qd.$t();!s.St().Ni()&&this.Qd.W().handleScale.axisPressedMouseMove.time&&s.Jc(e.localX)}pv(e){this.bv(e)}wv(){const e=this.Qd.$t();!e.St().Ni()&&this.Vm&&(this.Vm=!1,this.Qd.W().handleScale.axisPressedMouseMove.time&&e.hd())}av(e){const s=this.Qd.$t();!s.St().Ni()&&this.Qd.W().handleScale.axisPressedMouseMove.time&&s.rd(e.localX)}hv(e){this.av(e)}cv(){this.Vm=!1;const e=this.Qd.$t();e.St().Ni()&&!this.Qd.W().handleScale.axisPressedMouseMove.time||e.hd()}_v(){this.cv()}qf(){this.Qd.W().handleScale.axisDoubleClickReset.time&&this.Qd.$t().Kn()}jf(){this.qf()}Qf(){this.Qd.$t().W().handleScale.axisPressedMouseMove.time&&this.kp(1)}Pv(){this.kp(0)}um(){return this.Ev}Nm(){return this.Om}Fm(e,s,r){On(this.Ev,e)||(this.Ev=e,this.jv=!0,this.Gv.resizeCanvasElement(e),this.Jv.resizeCanvasElement(e),this.jv=!1,this.Kv.style.width=`${e.width}px`,this.Kv.style.height=`${e.height}px`,this.Om.m(e)),this.Rm!==null&&this.Rm.cp(Re({width:s,height:e.height})),this.Dm!==null&&this.Dm.cp(Re({width:r,height:e.height}))}Wm(){const e=this.jm();return Math.ceil(e.C+e.T+e.P+e.L+e.B+e.Hm)}bt(){this.Qd.$t().St().Ha()}xp(){return this.Gv.bitmapSize}Sp(e,s,r){const i=this.xp();i.width>0&&i.height>0&&e.drawImage(this.Gv.canvasElement,s,r)}vp(e){if(e===0)return;if(e!==1){this.Gv.applySuggestedBitmapSize();const r=qn(this.Gv);r!==null&&(r.useBitmapCoordinateSpace(i=>{this.mp(i),this.Ie(i),this.$m(r,_1)}),this.wp(r),this.$m(r,P1)),this.Rm!==null&&this.Rm.vp(e),this.Dm!==null&&this.Dm.vp(e)}this.Jv.applySuggestedBitmapSize();const s=qn(this.Jv);s!==null&&(s.useBitmapCoordinateSpace(({context:r,bitmapSize:i})=>{r.clearRect(0,0,i.width,i.height)}),this.Um([...this.Qd.$t().wt(),this.Qd.$t().Zc()],s),this.$m(s,L1))}$m(e,s){const r=this.Qd.$t().wt();for(const i of r)Kd(s,a=>Hd(a,e,!1,void 0),i,void 0);for(const i of r)Kd(s,a=>kl(a,e,!1,void 0),i,void 0)}mp({context:e,bitmapSize:s}){Ao(e,0,0,s.width,s.height,this.Qd.$t().bd())}Ie({context:e,bitmapSize:s,verticalPixelRatio:r}){if(this.Qd.W().timeScale.borderVisible){e.fillStyle=this.qm();const i=Math.max(1,Math.floor(this.jm().C*r));e.fillRect(0,0,s.width,i)}}wp(e){const s=this.Qd.$t().St(),r=s.Ha();if(!r||r.length===0)return;const i=this.q_.maxTickMarkWeight(r),a=this.jm(),l=s.W();l.borderVisible&&l.ticksVisible&&e.useBitmapCoordinateSpace(({context:o,horizontalPixelRatio:c,verticalPixelRatio:d})=>{o.strokeStyle=this.qm(),o.fillStyle=this.qm();const m=Math.max(1,Math.floor(c)),u=Math.floor(.5*c);o.beginPath();const h=Math.round(a.T*d);for(let x=r.length;x--;){const y=Math.round(r[x].coord*c);o.rect(y-u,0,m,h)}o.fill()}),e.useMediaCoordinateSpace(({context:o})=>{const c=a.C+a.T+a.L+a.P/2;o.textAlign="center",o.textBaseline="middle",o.fillStyle=this.$(),o.font=this._p();for(const d of r)if(d.weight<i){const m=d.needAlignCoordinate?this.Ym(o,d.coord,d.label):d.coord;o.fillText(d.label,m,c)}this.Qd.W().timeScale.allowBoldLabels&&(o.font=this.Zm());for(const d of r)if(d.weight>=i){const m=d.needAlignCoordinate?this.Ym(o,d.coord,d.label):d.coord;o.fillText(d.label,m,c)}})}Ym(e,s,r){const i=this.Fv.xi(e,r),a=i/2,l=Math.floor(s-a)+.5;return l<0?s+=Math.abs(0-l):l+i>this.Ev.width&&(s-=Math.abs(this.Ev.width-(l+i))),s}Um(e,s){const r=this.jm();for(const i of e)for(const a of i.Qi())a.gt().X(s,r)}qm(){return this.Qd.W().timeScale.borderColor}$(){return this.cn.textColor}j(){return this.cn.fontSize}_p(){return Or(this.j(),this.cn.fontFamily)}Zm(){return Or(this.j(),this.cn.fontFamily,"bold")}jm(){this.k===null&&(this.k={C:1,N:NaN,L:NaN,B:NaN,ji:NaN,T:5,P:NaN,R:"",Wi:new ga,Hm:0});const e=this.k,s=this._p();if(e.R!==s){const r=this.j();e.P=r,e.R=s,e.L=3*r/12,e.B=3*r/12,e.ji=9*r/12,e.N=0,e.Hm=4*r/12,e.Wi.nr()}return this.k}kp(e){this.Kv.style.cursor=e===1?"ew-resize":"default"}zm(){const e=this.Qd.$t(),s=e.W();s.leftPriceScale.visible||this.Rm===null||(this.Bm.removeChild(this.Rm.lp()),this.Rm.S(),this.Rm=null),s.rightPriceScale.visible||this.Dm===null||(this.Am.removeChild(this.Dm.lp()),this.Dm.S(),this.Dm=null);const r={ud:this.Qd.$t().ud()},i=()=>s.leftPriceScale.borderVisible&&e.St().W().borderVisible,a=()=>e.bd();s.leftPriceScale.visible&&this.Rm===null&&(this.Rm=new Qp("left",s,r,i,a),this.Bm.appendChild(this.Rm.lp())),s.rightPriceScale.visible&&this.Dm===null&&(this.Dm=new Qp("right",s,r,i,a),this.Am.appendChild(this.Dm.lp()))}}const R1=!!Ir&&!!navigator.userAgentData&&navigator.userAgentData.brands.some(t=>t.brand.includes("Chromium"))&&!!Ir&&(!((Rc=navigator==null?void 0:navigator.userAgentData)===null||Rc===void 0)&&Rc.platform?navigator.userAgentData.platform==="Windows":navigator.userAgent.toLowerCase().indexOf("win")>=0);var Rc;class A1{constructor(e,s,r){var i;this.Xm=[],this.Km=0,this.ho=0,this.__=0,this.Gm=0,this.Jm=0,this.Qm=null,this.tb=!1,this.Vp=new Ve,this.Op=new Ve,this.Rc=new Ve,this.ib=null,this.nb=null,this.Jd=e,this.cn=s,this.q_=r,this.Xd=document.createElement("div"),this.Xd.classList.add("tv-lightweight-charts"),this.Xd.style.overflow="hidden",this.Xd.style.direction="ltr",this.Xd.style.width="100%",this.Xd.style.height="100%",(i=this.Xd).style.userSelect="none",i.style.webkitUserSelect="none",i.style.msUserSelect="none",i.style.MozUserSelect="none",i.style.webkitTapHighlightColor="transparent",this.sb=document.createElement("table"),this.sb.setAttribute("cellspacing","0"),this.Xd.appendChild(this.sb),this.eb=this.rb.bind(this),Ac(this.cn)&&this.hb(!0),this.$i=new g1(this.Vc.bind(this),this.cn,r),this.$t().Xc().l(this.lb.bind(this),this),this.ab=new M1(this,this.q_),this.sb.appendChild(this.ab.lp());const a=s.autoSize&&this.ob();let l=this.cn.width,o=this.cn.height;if(a||l===0||o===0){const c=e.getBoundingClientRect();l=l||c.width,o=o||c.height}this._b(l,o),this.ub(),e.appendChild(this.Xd),this.cb(),this.$i.St().ec().l(this.$i.Kl.bind(this.$i),this),this.$i.g_().l(this.$i.Kl.bind(this.$i),this)}$t(){return this.$i}W(){return this.cn}Yp(){return this.Xm}fb(){return this.ab}S(){this.hb(!1),this.Km!==0&&window.cancelAnimationFrame(this.Km),this.$i.Xc().p(this),this.$i.St().ec().p(this),this.$i.g_().p(this),this.$i.S();for(const e of this.Xm)this.sb.removeChild(e.lp()),e.lm().p(this),e.am().p(this),e.S();this.Xm=[],ee(this.ab).S(),this.Xd.parentElement!==null&&this.Xd.parentElement.removeChild(this.Xd),this.Rc.S(),this.Vp.S(),this.Op.S(),this.pb()}_b(e,s,r=!1){if(this.ho===s&&this.__===e)return;const i=function(o){const c=Math.floor(o.width),d=Math.floor(o.height);return Re({width:c-c%2,height:d-d%2})}(Re({width:e,height:s}));this.ho=i.height,this.__=i.width;const a=this.ho+"px",l=this.__+"px";ee(this.Xd).style.height=a,ee(this.Xd).style.width=l,this.sb.style.height=a,this.sb.style.width=l,r?this.mb(rt.es(),performance.now()):this.$i.Kl()}vp(e){e===void 0&&(e=rt.es());for(let s=0;s<this.Xm.length;s++)this.Xm[s].vp(e.Hn(s).Fn);this.cn.timeScale.visible&&this.ab.vp(e.jn())}$h(e){const s=Ac(this.cn);this.$i.$h(e);const r=Ac(this.cn);r!==s&&this.hb(r),this.cb(),this.bb(e)}lm(){return this.Vp}am(){return this.Op}Xc(){return this.Rc}wb(){this.Qm!==null&&(this.mb(this.Qm,performance.now()),this.Qm=null);const e=this.gb(null),s=document.createElement("canvas");s.width=e.width,s.height=e.height;const r=ee(s.getContext("2d"));return this.gb(r),s}Mb(e){return e==="left"&&!this.xb()||e==="right"&&!this.Sb()||this.Xm.length===0?0:ee(e==="left"?this.Xm[0].wm():this.Xm[0].gm()).dp()}kb(){return this.cn.autoSize&&this.ib!==null}yb(){return this.Xd}Qp(e){this.nb=e,this.nb?this.yb().style.setProperty("cursor",e):this.yb().style.removeProperty("cursor")}Cb(){return this.nb}Tb(){return yt(this.Xm[0]).um()}bb(e){(e.autoSize!==void 0||!this.ib||e.width===void 0&&e.height===void 0)&&(e.autoSize&&!this.ib&&this.ob(),e.autoSize===!1&&this.ib!==null&&this.pb(),e.autoSize||e.width===void 0&&e.height===void 0||this._b(e.width||this.__,e.height||this.ho))}gb(e){let s=0,r=0;const i=this.Xm[0],a=(o,c)=>{let d=0;for(let m=0;m<this.Xm.length;m++){const u=this.Xm[m],h=ee(o==="left"?u.wm():u.gm()),x=h.xp();e!==null&&h.Sp(e,c,d),d+=x.height}};this.xb()&&(a("left",0),s+=ee(i.wm()).xp().width);for(let o=0;o<this.Xm.length;o++){const c=this.Xm[o],d=c.xp();e!==null&&c.Sp(e,s,r),r+=d.height}s+=i.xp().width,this.Sb()&&(a("right",s),s+=ee(i.gm()).xp().width);const l=(o,c,d)=>{ee(o==="left"?this.ab.Lm():this.ab.Em()).Sp(ee(e),c,d)};if(this.cn.timeScale.visible){const o=this.ab.xp();if(e!==null){let c=0;this.xb()&&(l("left",c,r),c=ee(i.wm()).xp().width),this.ab.Sp(e,c,r),c+=o.width,this.Sb()&&l("right",c,r)}r+=o.height}return Re({width:s,height:r})}Pb(){let e=0,s=0,r=0;for(const y of this.Xm)this.xb()&&(s=Math.max(s,ee(y.wm()).op(),this.cn.leftPriceScale.minimumWidth)),this.Sb()&&(r=Math.max(r,ee(y.gm()).op(),this.cn.rightPriceScale.minimumWidth)),e+=y.M_();s=qd(s),r=qd(r);const i=this.__,a=this.ho,l=Math.max(i-s-r,0),o=this.cn.timeScale.visible;let c=o?Math.max(this.ab.Wm(),this.cn.timeScale.minimumHeight):0;var d;c=(d=c)+d%2;const m=0+c,u=a<m?0:a-m,h=u/e;let x=0;for(let y=0;y<this.Xm.length;++y){const f=this.Xm[y];f.qp(this.$i.qc()[y]);let w=0,p=0;p=y===this.Xm.length-1?u-x:Math.round(f.M_()*h),w=Math.max(p,2),x+=w,f.cp(Re({width:l,height:w})),this.xb()&&f._m(s,"left"),this.Sb()&&f._m(r,"right"),f.fp()&&this.$i.Kc(f.fp(),w)}this.ab.Fm(Re({width:o?l:0,height:c}),o?s:0,o?r:0),this.$i.S_(l),this.Gm!==s&&(this.Gm=s),this.Jm!==r&&(this.Jm=r)}hb(e){e?this.Xd.addEventListener("wheel",this.eb,{passive:!1}):this.Xd.removeEventListener("wheel",this.eb)}Rb(e){switch(e.deltaMode){case e.DOM_DELTA_PAGE:return 120;case e.DOM_DELTA_LINE:return 32}return R1?1/window.devicePixelRatio:1}rb(e){if(!(e.deltaX!==0&&this.cn.handleScroll.mouseWheel||e.deltaY!==0&&this.cn.handleScale.mouseWheel))return;const s=this.Rb(e),r=s*e.deltaX/100,i=-s*e.deltaY/100;if(e.cancelable&&e.preventDefault(),i!==0&&this.cn.handleScale.mouseWheel){const a=Math.sign(i)*Math.min(1,Math.abs(i)),l=e.clientX-this.Xd.getBoundingClientRect().left;this.$t().Qc(l,a)}r!==0&&this.cn.handleScroll.mouseWheel&&this.$t().td(-80*r)}mb(e,s){var r;const i=e.jn();i===3&&this.Db(),i!==3&&i!==2||(this.Vb(e),this.Ob(e,s),this.ab.bt(),this.Xm.forEach(a=>{a.Xp()}),((r=this.Qm)===null||r===void 0?void 0:r.jn())===3&&(this.Qm.ts(e),this.Db(),this.Vb(this.Qm),this.Ob(this.Qm,s),e=this.Qm,this.Qm=null)),this.vp(e)}Ob(e,s){for(const r of e.Qn())this.ns(r,s)}Vb(e){const s=this.$i.qc();for(let r=0;r<s.length;r++)e.Hn(r).Wn&&s[r].N_()}ns(e,s){const r=this.$i.St();switch(e.qn){case 0:r.hc();break;case 1:r.lc(e.Vt);break;case 2:r.Gn(e.Vt);break;case 3:r.Jn(e.Vt);break;case 4:r.qu();break;case 5:e.Vt.Qu(s)||r.Jn(e.Vt.tc(s))}}Vc(e){this.Qm!==null?this.Qm.ts(e):this.Qm=e,this.tb||(this.tb=!0,this.Km=window.requestAnimationFrame(s=>{if(this.tb=!1,this.Km=0,this.Qm!==null){const r=this.Qm;this.Qm=null,this.mb(r,s);for(const i of r.Qn())if(i.qn===5&&!i.Vt.Qu(s)){this.$t().Zn(i.Vt);break}}}))}Db(){this.ub()}ub(){const e=this.$i.qc(),s=e.length,r=this.Xm.length;for(let i=s;i<r;i++){const a=yt(this.Xm.pop());this.sb.removeChild(a.lp()),a.lm().p(this),a.am().p(this),a.S()}for(let i=r;i<s;i++){const a=new gh(this,e[i]);a.lm().l(this.Bb.bind(this),this),a.am().l(this.Ab.bind(this),this),this.Xm.push(a),this.sb.insertBefore(a.lp(),this.ab.lp())}for(let i=0;i<s;i++){const a=e[i],l=this.Xm[i];l.fp()!==a?l.qp(a):l.Up()}this.cb(),this.Pb()}Ib(e,s,r){var i;const a=new Map;e!==null&&this.$i.wt().forEach(m=>{const u=m.In().ll(e);u!==null&&a.set(m,u)});let l;if(e!==null){const m=(i=this.$i.St().Ui(e))===null||i===void 0?void 0:i.originalTime;m!==void 0&&(l=m)}const o=this.$t().Wc(),c=o!==null&&o.Hc instanceof ph?o.Hc:void 0,d=o!==null&&o.Iv!==void 0?o.Iv.gr:void 0;return{zb:l,ee:e??void 0,Lb:s??void 0,Eb:c,Nb:a,Fb:d,Wb:r??void 0}}Bb(e,s,r){this.Vp.m(()=>this.Ib(e,s,r))}Ab(e,s,r){this.Op.m(()=>this.Ib(e,s,r))}lb(e,s,r){this.Rc.m(()=>this.Ib(e,s,r))}cb(){const e=this.cn.timeScale.visible?"":"none";this.ab.lp().style.display=e}xb(){return this.Xm[0].fp().R_().W().visible}Sb(){return this.Xm[0].fp().D_().W().visible}ob(){return"ResizeObserver"in window&&(this.ib=new ResizeObserver(e=>{const s=e.find(r=>r.target===this.Jd);s&&this._b(s.contentRect.width,s.contentRect.height)}),this.ib.observe(this.Jd,{box:"border-box"}),!0)}pb(){this.ib!==null&&this.ib.disconnect(),this.ib=null}}function Ac(t){return!!(t.handleScroll.mouseWheel||t.handleScale.mouseWheel)}function z1(t){return function(e){return e.open!==void 0}(t)||function(e){return e.value!==void 0}(t)}function Vg(t,e){var s={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(s[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function"){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(s[r[i]]=t[r[i]])}return s}function Xp(t,e,s,r){const i=s.value,a={ee:e,ot:t,Vt:[i,i,i,i],zb:r};return s.color!==void 0&&(a.V=s.color),a}function O1(t,e,s,r){const i=s.value,a={ee:e,ot:t,Vt:[i,i,i,i],zb:r};return s.lineColor!==void 0&&(a.lt=s.lineColor),s.topColor!==void 0&&(a.Ps=s.topColor),s.bottomColor!==void 0&&(a.Rs=s.bottomColor),a}function I1(t,e,s,r){const i=s.value,a={ee:e,ot:t,Vt:[i,i,i,i],zb:r};return s.topLineColor!==void 0&&(a.Re=s.topLineColor),s.bottomLineColor!==void 0&&(a.De=s.bottomLineColor),s.topFillColor1!==void 0&&(a.ke=s.topFillColor1),s.topFillColor2!==void 0&&(a.ye=s.topFillColor2),s.bottomFillColor1!==void 0&&(a.Ce=s.bottomFillColor1),s.bottomFillColor2!==void 0&&(a.Te=s.bottomFillColor2),a}function $1(t,e,s,r){const i={ee:e,ot:t,Vt:[s.open,s.high,s.low,s.close],zb:r};return s.color!==void 0&&(i.V=s.color),i}function B1(t,e,s,r){const i={ee:e,ot:t,Vt:[s.open,s.high,s.low,s.close],zb:r};return s.color!==void 0&&(i.V=s.color),s.borderColor!==void 0&&(i.Ot=s.borderColor),s.wickColor!==void 0&&(i.Xh=s.wickColor),i}function D1(t,e,s,r,i){const a=yt(i)(s),l=Math.max(...a),o=Math.min(...a),c=a[a.length-1],d=[c,l,o,c],m=s,{time:u,color:h}=m;return{ee:e,ot:t,Vt:d,zb:r,$e:Vg(m,["time","color"]),V:h}}function il(t){return t.Vt!==void 0}function Gp(t,e){return e.customValues!==void 0&&(t.jb=e.customValues),t}function Sn(t){return(e,s,r,i,a,l)=>function(o,c){return c?c(o):(d=o).open===void 0&&d.value===void 0;var d}(r,l)?Gp({ot:e,ee:s,zb:i},r):Gp(t(e,s,r,i,a),r)}function Jp(t){return{Candlestick:Sn(B1),Bar:Sn($1),Area:Sn(O1),Baseline:Sn(I1),Histogram:Sn(Xp),Line:Sn(Xp),Custom:Sn(D1)}[t]}function Zp(t){return{ee:0,Hb:new Map,la:t}}function ex(t,e){if(t!==void 0&&t.length!==0)return{$b:e.key(t[0].ot),Ub:e.key(t[t.length-1].ot)}}function tx(t){let e;return t.forEach(s=>{e===void 0&&(e=s.zb)}),yt(e)}class F1{constructor(e){this.qb=new Map,this.Yb=new Map,this.Zb=new Map,this.Xb=[],this.q_=e}S(){this.qb.clear(),this.Yb.clear(),this.Zb.clear(),this.Xb=[]}Kb(e,s){let r=this.qb.size!==0,i=!1;const a=this.Yb.get(e);if(a!==void 0)if(this.Yb.size===1)r=!1,i=!0,this.qb.clear();else for(const c of this.Xb)c.pointData.Hb.delete(e)&&(i=!0);let l=[];if(s.length!==0){const c=s.map(x=>x.time),d=this.q_.createConverterToInternalObj(s),m=Jp(e.Qh()),u=e.Ca(),h=e.Ta();l=s.map((x,y)=>{const f=d(x.time),w=this.q_.key(f);let p=this.qb.get(w);p===void 0&&(p=Zp(f),this.qb.set(w,p),i=!0);const b=m(f,p.ee,x,c[y],u,h);return p.Hb.set(e,b),b})}r&&this.Gb(),this.Jb(e,l);let o=-1;if(i){const c=[];this.qb.forEach(d=>{c.push({timeWeight:0,time:d.la,pointData:d,originalTime:tx(d.Hb)})}),c.sort((d,m)=>this.q_.key(d.time)-this.q_.key(m.time)),o=this.Qb(c)}return this.tw(e,o,function(c,d,m){const u=ex(c,m),h=ex(d,m);if(u!==void 0&&h!==void 0)return{ta:u.Ub>=h.Ub&&u.$b>=h.$b}}(this.Yb.get(e),a,this.q_))}vd(e){return this.Kb(e,[])}iw(e,s){const r=s;(function(f){f.zb===void 0&&(f.zb=f.time)})(r),this.q_.preprocessData(s);const i=this.q_.createConverterToInternalObj([s])(s.time),a=this.Zb.get(e);if(a!==void 0&&this.q_.key(i)<this.q_.key(a))throw new Error(`Cannot update oldest data, last time=${a}, new time=${i}`);let l=this.qb.get(this.q_.key(i));const o=l===void 0;l===void 0&&(l=Zp(i),this.qb.set(this.q_.key(i),l));const c=Jp(e.Qh()),d=e.Ca(),m=e.Ta(),u=c(i,l.ee,s,r.zb,d,m);l.Hb.set(e,u),this.nw(e,u);const h={ta:il(u)};if(!o)return this.tw(e,-1,h);const x={timeWeight:0,time:l.la,pointData:l,originalTime:tx(l.Hb)},y=Pa(this.Xb,this.q_.key(x.time),(f,w)=>this.q_.key(f.time)<w);this.Xb.splice(y,0,x);for(let f=y;f<this.Xb.length;++f)zc(this.Xb[f].pointData,f);return this.q_.fillWeightsForPoints(this.Xb,y),this.tw(e,y,h)}nw(e,s){let r=this.Yb.get(e);r===void 0&&(r=[],this.Yb.set(e,r));const i=r.length!==0?r[r.length-1]:null;i===null||this.q_.key(s.ot)>this.q_.key(i.ot)?il(s)&&r.push(s):il(s)?r[r.length-1]=s:r.splice(-1,1),this.Zb.set(e,s.ot)}Jb(e,s){s.length!==0?(this.Yb.set(e,s.filter(il)),this.Zb.set(e,s[s.length-1].ot)):(this.Yb.delete(e),this.Zb.delete(e))}Gb(){for(const e of this.Xb)e.pointData.Hb.size===0&&this.qb.delete(this.q_.key(e.time))}Qb(e){let s=-1;for(let r=0;r<this.Xb.length&&r<e.length;++r){const i=this.Xb[r],a=e[r];if(this.q_.key(i.time)!==this.q_.key(a.time)){s=r;break}a.timeWeight=i.timeWeight,zc(a.pointData,r)}if(s===-1&&this.Xb.length!==e.length&&(s=Math.min(this.Xb.length,e.length)),s===-1)return-1;for(let r=s;r<e.length;++r)zc(e[r].pointData,r);return this.q_.fillWeightsForPoints(e,s),this.Xb=e,s}sw(){if(this.Yb.size===0)return null;let e=0;return this.Yb.forEach(s=>{s.length!==0&&(e=Math.max(e,s[s.length-1].ee))}),e}tw(e,s,r){const i={ew:new Map,St:{Eu:this.sw()}};if(s!==-1)this.Yb.forEach((a,l)=>{i.ew.set(l,{$e:a,rw:l===e?r:void 0})}),this.Yb.has(e)||i.ew.set(e,{$e:[],rw:r}),i.St.hw=this.Xb,i.St.lw=s;else{const a=this.Yb.get(e);i.ew.set(e,{$e:a||[],rw:r})}return i}}function zc(t,e){t.ee=e,t.Hb.forEach(s=>{s.ee=e})}function bh(t){const e={value:t.Vt[3],time:t.zb};return t.jb!==void 0&&(e.customValues=t.jb),e}function sx(t){const e=bh(t);return t.V!==void 0&&(e.color=t.V),e}function U1(t){const e=bh(t);return t.lt!==void 0&&(e.lineColor=t.lt),t.Ps!==void 0&&(e.topColor=t.Ps),t.Rs!==void 0&&(e.bottomColor=t.Rs),e}function W1(t){const e=bh(t);return t.Re!==void 0&&(e.topLineColor=t.Re),t.De!==void 0&&(e.bottomLineColor=t.De),t.ke!==void 0&&(e.topFillColor1=t.ke),t.ye!==void 0&&(e.topFillColor2=t.ye),t.Ce!==void 0&&(e.bottomFillColor1=t.Ce),t.Te!==void 0&&(e.bottomFillColor2=t.Te),e}function qg(t){const e={open:t.Vt[0],high:t.Vt[1],low:t.Vt[2],close:t.Vt[3],time:t.zb};return t.jb!==void 0&&(e.customValues=t.jb),e}function V1(t){const e=qg(t);return t.V!==void 0&&(e.color=t.V),e}function q1(t){const e=qg(t),{V:s,Ot:r,Xh:i}=t;return s!==void 0&&(e.color=s),r!==void 0&&(e.borderColor=r),i!==void 0&&(e.wickColor=i),e}function Yd(t){return{Area:U1,Line:sx,Baseline:W1,Histogram:sx,Bar:V1,Candlestick:q1,Custom:H1}[t]}function H1(t){const e=t.zb;return Object.assign(Object.assign({},t.$e),{time:e})}const K1={vertLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},horzLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},mode:1},Y1={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},Q1={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:12,fontFamily:oh,attributionLogo:!0},Oc={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!1,scaleMargins:{bottom:.1,top:.2},minimumWidth:0},X1={rightOffset:0,barSpacing:6,minBarSpacing:.5,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,allowShiftVisibleRangeOnWhitespaceReplacement:!1,ticksVisible:!1,uniformDistribution:!1,minimumHeight:0,allowBoldLabels:!0},G1={color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,fontFamily:oh,fontStyle:"",text:"",horzAlign:"center",vertAlign:"center"};function nx(){return{width:0,height:0,autoSize:!1,layout:Q1,crosshair:K1,grid:Y1,overlayPriceScales:Object.assign({},Oc),leftPriceScale:Object.assign(Object.assign({},Oc),{visible:!1}),rightPriceScale:Object.assign(Object.assign({},Oc),{visible:!0}),timeScale:X1,watermark:G1,localization:{locale:Ir?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:{time:!0,price:!0},mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}}}class J1{constructor(e,s){this.aw=e,this.ow=s}applyOptions(e){this.aw.$t().$c(this.ow,e)}options(){return this.Li().W()}width(){return Oo(this.ow)?this.aw.Mb(this.ow):0}Li(){return ee(this.aw.$t().Uc(this.ow)).Dt}}function rx(t,e,s){const r=Vg(t,["time","originalTime"]),i=Object.assign({time:e},r);return s!==void 0&&(i.originalTime=s),i}const Z1={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",axisLabelColor:"",axisLabelTextColor:""};class e2{constructor(e){this.Nh=e}applyOptions(e){this.Nh.$h(e)}options(){return this.Nh.W()}_w(){return this.Nh}}class t2{constructor(e,s,r,i,a){this.uw=new Ve,this.Es=e,this.cw=s,this.dw=r,this.q_=a,this.fw=i}S(){this.uw.S()}priceFormatter(){return this.Es.ba()}priceToCoordinate(e){const s=this.Es.Ct();return s===null?null:this.Es.Dt().Rt(e,s.Vt)}coordinateToPrice(e){const s=this.Es.Ct();return s===null?null:this.Es.Dt().pn(e,s.Vt)}barsInLogicalRange(e){if(e===null)return null;const s=new wr(new Ki(e.from,e.to)).lu(),r=this.Es.In();if(r.Ni())return null;const i=r.ll(s.Os(),1),a=r.ll(s.ui(),-1),l=ee(r.el()),o=ee(r.An());if(i!==null&&a!==null&&i.ee>a.ee)return{barsBefore:e.from-l,barsAfter:o-e.to};const c={barsBefore:i===null||i.ee===l?e.from-l:i.ee-l,barsAfter:a===null||a.ee===o?o-e.to:o-a.ee};return i!==null&&a!==null&&(c.from=i.zb,c.to=a.zb),c}setData(e){this.q_,this.Es.Qh(),this.cw.pw(this.Es,e),this.mw("full")}update(e){this.Es.Qh(),this.cw.bw(this.Es,e),this.mw("update")}dataByIndex(e,s){const r=this.Es.In().ll(e,s);return r===null?null:Yd(this.seriesType())(r)}data(){const e=Yd(this.seriesType());return this.Es.In().ne().map(s=>e(s))}subscribeDataChanged(e){this.uw.l(e)}unsubscribeDataChanged(e){this.uw.v(e)}setMarkers(e){this.q_;const s=e.map(r=>rx(r,this.q_.convertHorzItemToInternal(r.time),r.time));this.Es.na(s)}markers(){return this.Es.sa().map(e=>rx(e,e.originalTime,void 0))}applyOptions(e){this.Es.$h(e)}options(){return ws(this.Es.W())}priceScale(){return this.dw.priceScale(this.Es.Dt().Pa())}createPriceLine(e){const s=ns(ws(Z1),e),r=this.Es.ea(s);return new e2(r)}removePriceLine(e){this.Es.ra(e._w())}seriesType(){return this.Es.Qh()}attachPrimitive(e){this.Es.ka(e),e.attached&&e.attached({chart:this.fw,series:this,requestUpdate:()=>this.Es.$t().Kl()})}detachPrimitive(e){this.Es.ya(e),e.detached&&e.detached()}mw(e){this.uw.M()&&this.uw.m(e)}}class s2{constructor(e,s,r){this.ww=new Ve,this.mu=new Ve,this.Om=new Ve,this.$i=e,this.yl=e.St(),this.ab=s,this.yl.nc().l(this.gw.bind(this)),this.yl.sc().l(this.Mw.bind(this)),this.ab.Nm().l(this.xw.bind(this)),this.q_=r}S(){this.yl.nc().p(this),this.yl.sc().p(this),this.ab.Nm().p(this),this.ww.S(),this.mu.S(),this.Om.S()}scrollPosition(){return this.yl.Hu()}scrollToPosition(e,s){s?this.yl.Ju(e,1e3):this.$i.Jn(e)}scrollToRealTime(){this.yl.Gu()}getVisibleRange(){const e=this.yl.Vu();return e===null?null:{from:e.from.originalTime,to:e.to.originalTime}}setVisibleRange(e){const s={from:this.q_.convertHorzItemToInternal(e.from),to:this.q_.convertHorzItemToInternal(e.to)},r=this.yl.Iu(s);this.$i.pd(r)}getVisibleLogicalRange(){const e=this.yl.Du();return e===null?null:{from:e.Os(),to:e.ui()}}setVisibleLogicalRange(e){fn(e.from<=e.to,"The from index cannot be after the to index."),this.$i.pd(e)}resetTimeScale(){this.$i.Kn()}fitContent(){this.$i.hc()}logicalToCoordinate(e){const s=this.$i.St();return s.Ni()?null:s.It(e)}coordinateToLogical(e){return this.yl.Ni()?null:this.yl.Nu(e)}timeToCoordinate(e){const s=this.q_.convertHorzItemToInternal(e),r=this.yl.Va(s,!1);return r===null?null:this.yl.It(r)}coordinateToTime(e){const s=this.$i.St(),r=s.Nu(e),i=s.Ui(r);return i===null?null:i.originalTime}width(){return this.ab.um().width}height(){return this.ab.um().height}subscribeVisibleTimeRangeChange(e){this.ww.l(e)}unsubscribeVisibleTimeRangeChange(e){this.ww.v(e)}subscribeVisibleLogicalRangeChange(e){this.mu.l(e)}unsubscribeVisibleLogicalRangeChange(e){this.mu.v(e)}subscribeSizeChange(e){this.Om.l(e)}unsubscribeSizeChange(e){this.Om.v(e)}applyOptions(e){this.yl.$h(e)}options(){return Object.assign(Object.assign({},ws(this.yl.W())),{barSpacing:this.yl.le()})}gw(){this.ww.M()&&this.ww.m(this.getVisibleRange())}Mw(){this.mu.M()&&this.mu.m(this.getVisibleLogicalRange())}xw(e){this.Om.m(e.width,e.height)}}function n2(t){if(t===void 0||t.type==="custom")return;const e=t;e.minMove!==void 0&&e.precision===void 0&&(e.precision=function(s){if(s>=1)return 0;let r=0;for(;r<8;r++){const i=Math.round(s);if(Math.abs(i-s)<1e-8)return r;s*=10}return r}(e.minMove))}function ix(t){return function(e){if(Xa(e.handleScale)){const r=e.handleScale;e.handleScale={axisDoubleClickReset:{time:r,price:r},axisPressedMouseMove:{time:r,price:r},mouseWheel:r,pinch:r}}else if(e.handleScale!==void 0){const{axisPressedMouseMove:r,axisDoubleClickReset:i}=e.handleScale;Xa(r)&&(e.handleScale.axisPressedMouseMove={time:r,price:r}),Xa(i)&&(e.handleScale.axisDoubleClickReset={time:i,price:i})}const s=e.handleScroll;Xa(s)&&(e.handleScroll={horzTouchDrag:s,vertTouchDrag:s,mouseWheel:s,pressedMouseMove:s})}(t),t}class r2{constructor(e,s,r){this.Sw=new Map,this.kw=new Map,this.yw=new Ve,this.Cw=new Ve,this.Tw=new Ve,this.Pw=new F1(s);const i=r===void 0?ws(nx()):ns(ws(nx()),ix(r));this.q_=s,this.aw=new A1(e,i,s),this.aw.lm().l(l=>{this.yw.M()&&this.yw.m(this.Rw(l()))},this),this.aw.am().l(l=>{this.Cw.M()&&this.Cw.m(this.Rw(l()))},this),this.aw.Xc().l(l=>{this.Tw.M()&&this.Tw.m(this.Rw(l()))},this);const a=this.aw.$t();this.Dw=new s2(a,this.aw.fb(),this.q_)}remove(){this.aw.lm().p(this),this.aw.am().p(this),this.aw.Xc().p(this),this.Dw.S(),this.aw.S(),this.Sw.clear(),this.kw.clear(),this.yw.S(),this.Cw.S(),this.Tw.S(),this.Pw.S()}resize(e,s,r){this.autoSizeActive()||this.aw._b(e,s,r)}addCustomSeries(e,s){const r=mr(e),i=Object.assign(Object.assign({},vg),r.defaultOptions());return this.Vw("Custom",i,s,r)}addAreaSeries(e){return this.Vw("Area",Fk,e)}addBaselineSeries(e){return this.Vw("Baseline",Uk,e)}addBarSeries(e){return this.Vw("Bar",Bk,e)}addCandlestickSeries(e={}){return function(s){s.borderColor!==void 0&&(s.borderUpColor=s.borderColor,s.borderDownColor=s.borderColor),s.wickColor!==void 0&&(s.wickUpColor=s.wickColor,s.wickDownColor=s.wickColor)}(e),this.Vw("Candlestick",$k,e)}addHistogramSeries(e){return this.Vw("Histogram",Wk,e)}addLineSeries(e){return this.Vw("Line",Dk,e)}removeSeries(e){const s=yt(this.Sw.get(e)),r=this.Pw.vd(s);this.aw.$t().vd(s),this.Ow(r),this.Sw.delete(e),this.kw.delete(s)}pw(e,s){this.Ow(this.Pw.Kb(e,s))}bw(e,s){this.Ow(this.Pw.iw(e,s))}subscribeClick(e){this.yw.l(e)}unsubscribeClick(e){this.yw.v(e)}subscribeCrosshairMove(e){this.Tw.l(e)}unsubscribeCrosshairMove(e){this.Tw.v(e)}subscribeDblClick(e){this.Cw.l(e)}unsubscribeDblClick(e){this.Cw.v(e)}priceScale(e){return new J1(this.aw,e)}timeScale(){return this.Dw}applyOptions(e){this.aw.$h(ix(e))}options(){return this.aw.W()}takeScreenshot(){return this.aw.wb()}autoSizeActive(){return this.aw.kb()}chartElement(){return this.aw.yb()}paneSize(){const e=this.aw.Tb();return{height:e.height,width:e.width}}setCrosshairPosition(e,s,r){const i=this.Sw.get(r);if(i===void 0)return;const a=this.aw.$t().dr(i);a!==null&&this.aw.$t().ad(e,s,a)}clearCrosshairPosition(){this.aw.$t().od(!0)}Vw(e,s,r={},i){n2(r.priceFormat);const a=ns(ws(Ng),ws(s),r),l=this.aw.$t().dd(e,a,i),o=new t2(l,this,this,this,this.q_);return this.Sw.set(o,l),this.kw.set(l,o),o}Ow(e){const s=this.aw.$t();s._d(e.St.Eu,e.St.hw,e.St.lw),e.ew.forEach((r,i)=>i.J(r.$e,r.rw)),s.Wu()}Bw(e){return yt(this.kw.get(e))}Rw(e){const s=new Map;e.Nb.forEach((i,a)=>{const l=a.Qh(),o=Yd(l)(i);if(l!=="Custom")fn(z1(o));else{const c=a.Ta();fn(!c||c(o)===!1)}s.set(this.Bw(a),o)});const r=e.Eb!==void 0&&this.kw.has(e.Eb)?this.Bw(e.Eb):void 0;return{time:e.zb,logical:e.ee,point:e.Lb,hoveredSeries:r,hoveredObjectId:e.Fb,seriesData:s,sourceEvent:e.Wb}}}function i2(t,e,s){let r;if(Ta(t)){const a=document.getElementById(t);fn(a!==null,`Cannot find element in DOM with id=${t}`),r=a}else r=t;const i=new r2(r,e,s);return e.setOptions(i.options()),i}function Hg(t,e){return i2(t,new Vp,Vp.Id(e))}Object.assign(Object.assign({},Ng),vg);const ys=Object.create(null);ys.open="0";ys.close="1";ys.ping="2";ys.pong="3";ys.message="4";ys.upgrade="5";ys.noop="6";const Sl=Object.create(null);Object.keys(ys).forEach(t=>{Sl[ys[t]]=t});const Qd={type:"error",data:"parser error"},Kg=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Yg=typeof ArrayBuffer=="function",Qg=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,vh=({type:t,data:e},s,r)=>Kg&&e instanceof Blob?s?r(e):ax(e,r):Yg&&(e instanceof ArrayBuffer||Qg(e))?s?r(e):ax(new Blob([e]),r):r(ys[t]+(e||"")),ax=(t,e)=>{const s=new FileReader;return s.onload=function(){const r=s.result.split(",")[1];e("b"+(r||""))},s.readAsDataURL(t)};function lx(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let Ic;function a2(t,e){if(Kg&&t.data instanceof Blob)return t.data.arrayBuffer().then(lx).then(e);if(Yg&&(t.data instanceof ArrayBuffer||Qg(t.data)))return e(lx(t.data));vh(t,!1,s=>{Ic||(Ic=new TextEncoder),e(Ic.encode(s))})}const ox="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ai=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<ox.length;t++)Ai[ox.charCodeAt(t)]=t;const l2=t=>{let e=t.length*.75,s=t.length,r,i=0,a,l,o,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const d=new ArrayBuffer(e),m=new Uint8Array(d);for(r=0;r<s;r+=4)a=Ai[t.charCodeAt(r)],l=Ai[t.charCodeAt(r+1)],o=Ai[t.charCodeAt(r+2)],c=Ai[t.charCodeAt(r+3)],m[i++]=a<<2|l>>4,m[i++]=(l&15)<<4|o>>2,m[i++]=(o&3)<<6|c&63;return d},o2=typeof ArrayBuffer=="function",Nh=(t,e)=>{if(typeof t!="string")return{type:"message",data:Xg(t,e)};const s=t.charAt(0);return s==="b"?{type:"message",data:c2(t.substring(1),e)}:Sl[s]?t.length>1?{type:Sl[s],data:t.substring(1)}:{type:Sl[s]}:Qd},c2=(t,e)=>{if(o2){const s=l2(t);return Xg(s,e)}else return{base64:!0,data:t}},Xg=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},Gg="",d2=(t,e)=>{const s=t.length,r=new Array(s);let i=0;t.forEach((a,l)=>{vh(a,!1,o=>{r[l]=o,++i===s&&e(r.join(Gg))})})},u2=(t,e)=>{const s=t.split(Gg),r=[];for(let i=0;i<s.length;i++){const a=Nh(s[i],e);if(r.push(a),a.type==="error")break}return r};function h2(){return new TransformStream({transform(t,e){a2(t,s=>{const r=s.length;let i;if(r<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,r);else if(r<65536){i=new Uint8Array(3);const a=new DataView(i.buffer);a.setUint8(0,126),a.setUint16(1,r)}else{i=new Uint8Array(9);const a=new DataView(i.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(r))}t.data&&typeof t.data!="string"&&(i[0]|=128),e.enqueue(i),e.enqueue(s)})}})}let $c;function al(t){return t.reduce((e,s)=>e+s.length,0)}function ll(t,e){if(t[0].length===e)return t.shift();const s=new Uint8Array(e);let r=0;for(let i=0;i<e;i++)s[i]=t[0][r++],r===t[0].length&&(t.shift(),r=0);return t.length&&r<t[0].length&&(t[0]=t[0].slice(r)),s}function m2(t,e){$c||($c=new TextDecoder);const s=[];let r=0,i=-1,a=!1;return new TransformStream({transform(l,o){for(s.push(l);;){if(r===0){if(al(s)<1)break;const c=ll(s,1);a=(c[0]&128)===128,i=c[0]&127,i<126?r=3:i===126?r=1:r=2}else if(r===1){if(al(s)<2)break;const c=ll(s,2);i=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),r=3}else if(r===2){if(al(s)<8)break;const c=ll(s,8),d=new DataView(c.buffer,c.byteOffset,c.length),m=d.getUint32(0);if(m>Math.pow(2,21)-1){o.enqueue(Qd);break}i=m*Math.pow(2,32)+d.getUint32(4),r=3}else{if(al(s)<i)break;const c=ll(s,i);o.enqueue(Nh(a?c:$c.decode(c),e)),r=0}if(i===0||i>t){o.enqueue(Qd);break}}}})}const Jg=4;function Ke(t){if(t)return p2(t)}function p2(t){for(var e in Ke.prototype)t[e]=Ke.prototype[e];return t}Ke.prototype.on=Ke.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};Ke.prototype.once=function(t,e){function s(){this.off(t,s),e.apply(this,arguments)}return s.fn=e,this.on(t,s),this};Ke.prototype.off=Ke.prototype.removeListener=Ke.prototype.removeAllListeners=Ke.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var s=this._callbacks["$"+t];if(!s)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var r,i=0;i<s.length;i++)if(r=s[i],r===e||r.fn===e){s.splice(i,1);break}return s.length===0&&delete this._callbacks["$"+t],this};Ke.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),s=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(s){s=s.slice(0);for(var r=0,i=s.length;r<i;++r)s[r].apply(this,e)}return this};Ke.prototype.emitReserved=Ke.prototype.emit;Ke.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};Ke.prototype.hasListeners=function(t){return!!this.listeners(t).length};const Bo=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,s)=>s(e,0),Dt=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),x2="arraybuffer";function Zg(t,...e){return e.reduce((s,r)=>(t.hasOwnProperty(r)&&(s[r]=t[r]),s),{})}const f2=Dt.setTimeout,g2=Dt.clearTimeout;function Do(t,e){e.useNativeTimers?(t.setTimeoutFn=f2.bind(Dt),t.clearTimeoutFn=g2.bind(Dt)):(t.setTimeoutFn=Dt.setTimeout.bind(Dt),t.clearTimeoutFn=Dt.clearTimeout.bind(Dt))}const y2=1.33;function b2(t){return typeof t=="string"?v2(t):Math.ceil((t.byteLength||t.size)*y2)}function v2(t){let e=0,s=0;for(let r=0,i=t.length;r<i;r++)e=t.charCodeAt(r),e<128?s+=1:e<2048?s+=2:e<55296||e>=57344?s+=3:(r++,s+=4);return s}function ey(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function N2(t){let e="";for(let s in t)t.hasOwnProperty(s)&&(e.length&&(e+="&"),e+=encodeURIComponent(s)+"="+encodeURIComponent(t[s]));return e}function j2(t){let e={},s=t.split("&");for(let r=0,i=s.length;r<i;r++){let a=s[r].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e}class w2 extends Error{constructor(e,s,r){super(e),this.description=s,this.context=r,this.type="TransportError"}}class jh extends Ke{constructor(e){super(),this.writable=!1,Do(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,s,r){return super.emitReserved("error",new w2(e,s,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const s=Nh(e,this.socket.binaryType);this.onPacket(s)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,s={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(s)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const s=N2(e);return s.length?"?"+s:""}}class k2 extends jh{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const s=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||s()})),this.writable||(r++,this.once("drain",function(){--r||s()}))}else s()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const s=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};u2(e,this.socket.binaryType).forEach(s),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,d2(e,s=>{this.doWrite(s,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",s=this.query||{};return this.opts.timestampRequests!==!1&&(s[this.opts.timestampParam]=ey()),!this.supportsBinary&&!s.sid&&(s.b64=1),this.createUri(e,s)}}let ty=!1;try{ty=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const S2=ty;function C2(){}class E2 extends k2{constructor(e){if(super(e),typeof location<"u"){const s=location.protocol==="https:";let r=location.port;r||(r=s?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||r!==e.port}}doWrite(e,s){const r=this.request({method:"POST",data:e});r.on("success",s),r.on("error",(i,a)=>{this.onError("xhr post error",i,a)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(s,r)=>{this.onError("xhr poll error",s,r)}),this.pollXhr=e}}class fs extends Ke{constructor(e,s,r){super(),this.createRequest=e,Do(this,r),this._opts=r,this._method=r.method||"GET",this._uri=s,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var e;const s=Zg(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");s.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(s);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&r.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var i;r.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=fs.requestsCount++,fs.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=C2,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete fs.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}fs.requestsCount=0;fs.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",cx);else if(typeof addEventListener=="function"){const t="onpagehide"in Dt?"pagehide":"unload";addEventListener(t,cx,!1)}}function cx(){for(let t in fs.requests)fs.requests.hasOwnProperty(t)&&fs.requests[t].abort()}const T2=function(){const t=sy({xdomain:!1});return t&&t.responseType!==null}();class P2 extends E2{constructor(e){super(e);const s=e&&e.forceBase64;this.supportsBinary=T2&&!s}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new fs(sy,this.uri(),e)}}function sy(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||S2))return new XMLHttpRequest}catch{}if(!e)try{return new Dt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const ny=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class L2 extends jh{get name(){return"websocket"}doOpen(){const e=this.uri(),s=this.opts.protocols,r=ny?{}:Zg(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,s,r)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let s=0;s<e.length;s++){const r=e[s],i=s===e.length-1;vh(r,this.supportsBinary,a=>{try{this.doWrite(r,a)}catch{}i&&Bo(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",s=this.query||{};return this.opts.timestampRequests&&(s[this.opts.timestampParam]=ey()),this.supportsBinary||(s.b64=1),this.createUri(e,s)}}const Bc=Dt.WebSocket||Dt.MozWebSocket;class _2 extends L2{createSocket(e,s,r){return ny?new Bc(e,s,r):s?new Bc(e,s):new Bc(e)}doWrite(e,s){this.ws.send(s)}}class M2 extends jh{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const s=m2(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=e.readable.pipeThrough(s).getReader(),i=h2();i.readable.pipeTo(e.writable),this._writer=i.writable.getWriter();const a=()=>{r.read().then(({done:o,value:c})=>{o||(this.onPacket(c),a())}).catch(o=>{})};a();const l={type:"open"};this.query.sid&&(l.data=`{"sid":"${this.query.sid}"}`),this._writer.write(l).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let s=0;s<e.length;s++){const r=e[s],i=s===e.length-1;this._writer.write(r).then(()=>{i&&Bo(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const R2={websocket:_2,webtransport:M2,polling:P2},A2=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,z2=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Xd(t){if(t.length>8e3)throw"URI too long";const e=t,s=t.indexOf("["),r=t.indexOf("]");s!=-1&&r!=-1&&(t=t.substring(0,s)+t.substring(s,r).replace(/:/g,";")+t.substring(r,t.length));let i=A2.exec(t||""),a={},l=14;for(;l--;)a[z2[l]]=i[l]||"";return s!=-1&&r!=-1&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=O2(a,a.path),a.queryKey=I2(a,a.query),a}function O2(t,e){const s=/\/{2,9}/g,r=e.replace(s,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&r.splice(0,1),e.slice(-1)=="/"&&r.splice(r.length-1,1),r}function I2(t,e){const s={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,i,a){i&&(s[i]=a)}),s}const Gd=typeof addEventListener=="function"&&typeof removeEventListener=="function",Cl=[];Gd&&addEventListener("offline",()=>{Cl.forEach(t=>t())},!1);class mn extends Ke{constructor(e,s){if(super(),this.binaryType=x2,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(s=e,e=null),e){const r=Xd(e);s.hostname=r.host,s.secure=r.protocol==="https"||r.protocol==="wss",s.port=r.port,r.query&&(s.query=r.query)}else s.host&&(s.hostname=Xd(s.host).host);Do(this,s),this.secure=s.secure!=null?s.secure:typeof location<"u"&&location.protocol==="https:",s.hostname&&!s.port&&(s.port=this.secure?"443":"80"),this.hostname=s.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=s.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},s.transports.forEach(r=>{const i=r.prototype.name;this.transports.push(i),this._transportsByName[i]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},s),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=j2(this.opts.query)),Gd&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Cl.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const s=Object.assign({},this.opts.query);s.EIO=Jg,s.transport=e,this.id&&(s.sid=this.id);const r=Object.assign({},this.opts,{query:s,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&mn.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const s=this.createTransport(e);s.open(),this.setTransport(s)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",s=>this._onClose("transport close",s))}onOpen(){this.readyState="open",mn.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const s=new Error("server error");s.code=e.data,this._onError(s);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let s=1;for(let r=0;r<this.writeBuffer.length;r++){const i=this.writeBuffer[r].data;if(i&&(s+=b2(i)),r>0&&s>this._maxPayload)return this.writeBuffer.slice(0,r);s+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Bo(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,s,r){return this._sendPacket("message",e,s,r),this}send(e,s,r){return this._sendPacket("message",e,s,r),this}_sendPacket(e,s,r,i){if(typeof s=="function"&&(i=s,s=void 0),typeof r=="function"&&(i=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const a={type:e,data:s,options:r};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},s=()=>{this.off("upgrade",s),this.off("upgradeError",s),e()},r=()=>{this.once("upgrade",s),this.once("upgradeError",s)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}_onError(e){if(mn.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,s){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Gd&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=Cl.indexOf(this._offlineEventListener);r!==-1&&Cl.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,s),this.writeBuffer=[],this._prevBufferLen=0}}}mn.protocol=Jg;class $2 extends mn{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let s=this.createTransport(e),r=!1;mn.priorWebsocketSuccess=!1;const i=()=>{r||(s.send([{type:"ping",data:"probe"}]),s.once("packet",u=>{if(!r)if(u.type==="pong"&&u.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",s),!s)return;mn.priorWebsocketSuccess=s.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(m(),this.setTransport(s),s.send([{type:"upgrade"}]),this.emitReserved("upgrade",s),s=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=s.name,this.emitReserved("upgradeError",h)}}))};function a(){r||(r=!0,m(),s.close(),s=null)}const l=u=>{const h=new Error("probe error: "+u);h.transport=s.name,a(),this.emitReserved("upgradeError",h)};function o(){l("transport closed")}function c(){l("socket closed")}function d(u){s&&u.name!==s.name&&a()}const m=()=>{s.removeListener("open",i),s.removeListener("error",l),s.removeListener("close",o),this.off("close",c),this.off("upgrading",d)};s.once("open",i),s.once("error",l),s.once("close",o),this.once("close",c),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{r||s.open()},200):s.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const s=[];for(let r=0;r<e.length;r++)~this.transports.indexOf(e[r])&&s.push(e[r]);return s}}let B2=class extends $2{constructor(e,s={}){const r=typeof e=="object"?e:s;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(i=>R2[i]).filter(i=>!!i)),super(e,r)}};function D2(t,e="",s){let r=t;s=s||typeof location<"u"&&location,t==null&&(t=s.protocol+"//"+s.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=s.protocol+t:t=s.host+t),/^(https?|wss?):\/\//.test(t)||(typeof s<"u"?t=s.protocol+"//"+t:t="https://"+t),r=Xd(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const a=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+a+":"+r.port+e,r.href=r.protocol+"://"+a+(s&&s.port===r.port?"":":"+r.port),r}const F2=typeof ArrayBuffer=="function",U2=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,ry=Object.prototype.toString,W2=typeof Blob=="function"||typeof Blob<"u"&&ry.call(Blob)==="[object BlobConstructor]",V2=typeof File=="function"||typeof File<"u"&&ry.call(File)==="[object FileConstructor]";function wh(t){return F2&&(t instanceof ArrayBuffer||U2(t))||W2&&t instanceof Blob||V2&&t instanceof File}function El(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let s=0,r=t.length;s<r;s++)if(El(t[s]))return!0;return!1}if(wh(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return El(t.toJSON(),!0);for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&El(t[s]))return!0;return!1}function q2(t){const e=[],s=t.data,r=t;return r.data=Jd(s,e),r.attachments=e.length,{packet:r,buffers:e}}function Jd(t,e){if(!t)return t;if(wh(t)){const s={_placeholder:!0,num:e.length};return e.push(t),s}else if(Array.isArray(t)){const s=new Array(t.length);for(let r=0;r<t.length;r++)s[r]=Jd(t[r],e);return s}else if(typeof t=="object"&&!(t instanceof Date)){const s={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(s[r]=Jd(t[r],e));return s}return t}function H2(t,e){return t.data=Zd(t.data,e),delete t.attachments,t}function Zd(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let s=0;s<t.length;s++)t[s]=Zd(t[s],e);else if(typeof t=="object")for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(t[s]=Zd(t[s],e));return t}const iy=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],K2=5;var xe;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(xe||(xe={}));class Y2{constructor(e){this.replacer=e}encode(e){return(e.type===xe.EVENT||e.type===xe.ACK)&&El(e)?this.encodeAsBinary({type:e.type===xe.EVENT?xe.BINARY_EVENT:xe.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let s=""+e.type;return(e.type===xe.BINARY_EVENT||e.type===xe.BINARY_ACK)&&(s+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(s+=e.nsp+","),e.id!=null&&(s+=e.id),e.data!=null&&(s+=JSON.stringify(e.data,this.replacer)),s}encodeAsBinary(e){const s=q2(e),r=this.encodeAsString(s.packet),i=s.buffers;return i.unshift(r),i}}class kh extends Ke{constructor(e){super(),this.reviver=e}add(e){let s;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");s=this.decodeString(e);const r=s.type===xe.BINARY_EVENT;r||s.type===xe.BINARY_ACK?(s.type=r?xe.EVENT:xe.ACK,this.reconstructor=new Q2(s),s.attachments===0&&super.emitReserved("decoded",s)):super.emitReserved("decoded",s)}else if(wh(e)||e.base64)if(this.reconstructor)s=this.reconstructor.takeBinaryData(e),s&&(this.reconstructor=null,super.emitReserved("decoded",s));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let s=0;const r={type:Number(e.charAt(0))};if(xe[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===xe.BINARY_EVENT||r.type===xe.BINARY_ACK){const a=s+1;for(;e.charAt(++s)!=="-"&&s!=e.length;);const l=e.substring(a,s);if(l!=Number(l)||e.charAt(s)!=="-")throw new Error("Illegal attachments");r.attachments=Number(l)}if(e.charAt(s+1)==="/"){const a=s+1;for(;++s&&!(e.charAt(s)===","||s===e.length););r.nsp=e.substring(a,s)}else r.nsp="/";const i=e.charAt(s+1);if(i!==""&&Number(i)==i){const a=s+1;for(;++s;){const l=e.charAt(s);if(l==null||Number(l)!=l){--s;break}if(s===e.length)break}r.id=Number(e.substring(a,s+1))}if(e.charAt(++s)){const a=this.tryParse(e.substr(s));if(kh.isPayloadValid(r.type,a))r.data=a;else throw new Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,s){switch(e){case xe.CONNECT:return co(s);case xe.DISCONNECT:return s===void 0;case xe.CONNECT_ERROR:return typeof s=="string"||co(s);case xe.EVENT:case xe.BINARY_EVENT:return Array.isArray(s)&&(typeof s[0]=="number"||typeof s[0]=="string"&&iy.indexOf(s[0])===-1);case xe.ACK:case xe.BINARY_ACK:return Array.isArray(s)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Q2{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const s=H2(this.reconPack,this.buffers);return this.finishedReconstruction(),s}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function X2(t){return typeof t=="string"}const G2=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};function J2(t){return t===void 0||G2(t)}function co(t){return Object.prototype.toString.call(t)==="[object Object]"}function Z2(t,e){switch(t){case xe.CONNECT:return e===void 0||co(e);case xe.DISCONNECT:return e===void 0;case xe.EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&iy.indexOf(e[0])===-1);case xe.ACK:return Array.isArray(e);case xe.CONNECT_ERROR:return typeof e=="string"||co(e);default:return!1}}function e4(t){return X2(t.nsp)&&J2(t.id)&&Z2(t.type,t.data)}const t4=Object.freeze(Object.defineProperty({__proto__:null,Decoder:kh,Encoder:Y2,get PacketType(){return xe},isPacketValid:e4,protocol:K2},Symbol.toStringTag,{value:"Module"}));function Gt(t,e,s){return t.on(e,s),function(){t.off(e,s)}}const s4=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class ay extends Ke{constructor(e,s,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=s,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Gt(e,"open",this.onopen.bind(this)),Gt(e,"packet",this.onpacket.bind(this)),Gt(e,"error",this.onerror.bind(this)),Gt(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...s){var r,i,a;if(s4.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(s.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(s),this;const l={type:xe.EVENT,data:s};if(l.options={},l.options.compress=this.flags.compress!==!1,typeof s[s.length-1]=="function"){const m=this.ids++,u=s.pop();this._registerAckCallback(m,u),l.id=m}const o=(i=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||i===void 0?void 0:i.writable,c=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!o||(c?(this.notifyOutgoingListeners(l),this.packet(l)):this.sendBuffer.push(l)),this.flags={},this}_registerAckCallback(e,s){var r;const i=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(i===void 0){this.acks[e]=s;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===e&&this.sendBuffer.splice(o,1);s.call(this,new Error("operation has timed out"))},i),l=(...o)=>{this.io.clearTimeoutFn(a),s.apply(this,o)};l.withError=!0,this.acks[e]=l}emitWithAck(e,...s){return new Promise((r,i)=>{const a=(l,o)=>l?i(l):r(o);a.withError=!0,s.push(a),this.emit(e,...s)})}_addToQueue(e){let s;typeof e[e.length-1]=="function"&&(s=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...a)=>(this._queue[0],i!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),s&&s(i)):(this._queue.shift(),s&&s(null,...a)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const s=this._queue[0];s.pending&&!e||(s.pending=!0,s.tryCount++,this.flags=s.flags,this.emit.apply(this,s.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:xe.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,s){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,s),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(r=>String(r.id)===e)){const r=this.acks[e];delete this.acks[e],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case xe.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case xe.EVENT:case xe.BINARY_EVENT:this.onevent(e);break;case xe.ACK:case xe.BINARY_ACK:this.onack(e);break;case xe.DISCONNECT:this.ondisconnect();break;case xe.CONNECT_ERROR:this.destroy();const r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r);break}}onevent(e){const s=e.data||[];e.id!=null&&s.push(this.ack(e.id)),this.connected?this.emitEvent(s):this.receiveBuffer.push(Object.freeze(s))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const s=this._anyListeners.slice();for(const r of s)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const s=this;let r=!1;return function(...i){r||(r=!0,s.packet({type:xe.ACK,id:e,data:i}))}}onack(e){const s=this.acks[e.id];typeof s=="function"&&(delete this.acks[e.id],s.withError&&e.data.unshift(null),s.apply(this,e.data))}onconnect(e,s){this.id=e,this.recovered=s&&this._pid===s,this._pid=s,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:xe.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const s=this._anyListeners;for(let r=0;r<s.length;r++)if(e===s[r])return s.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const s=this._anyOutgoingListeners;for(let r=0;r<s.length;r++)if(e===s[r])return s.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const s=this._anyOutgoingListeners.slice();for(const r of s)r.apply(this,e.data)}}}function qr(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}qr.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),s=Math.floor(e*this.jitter*t);t=Math.floor(e*10)&1?t+s:t-s}return Math.min(t,this.max)|0};qr.prototype.reset=function(){this.attempts=0};qr.prototype.setMin=function(t){this.ms=t};qr.prototype.setMax=function(t){this.max=t};qr.prototype.setJitter=function(t){this.jitter=t};class eu extends Ke{constructor(e,s){var r;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(s=e,e=void 0),s=s||{},s.path=s.path||"/socket.io",this.opts=s,Do(this,s),this.reconnection(s.reconnection!==!1),this.reconnectionAttempts(s.reconnectionAttempts||1/0),this.reconnectionDelay(s.reconnectionDelay||1e3),this.reconnectionDelayMax(s.reconnectionDelayMax||5e3),this.randomizationFactor((r=s.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new qr({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(s.timeout==null?2e4:s.timeout),this._readyState="closed",this.uri=e;const i=s.parser||t4;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=s.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var s;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(s=this.backoff)===null||s===void 0||s.setMin(e),this)}randomizationFactor(e){var s;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(s=this.backoff)===null||s===void 0||s.setJitter(e),this)}reconnectionDelayMax(e){var s;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(s=this.backoff)===null||s===void 0||s.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new B2(this.uri,this.opts);const s=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const i=Gt(s,"open",function(){r.onopen(),e&&e()}),a=o=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",o),e?e(o):this.maybeReconnectOnOpen()},l=Gt(s,"error",a);if(this._timeout!==!1){const o=this._timeout,c=this.setTimeoutFn(()=>{i(),a(new Error("timeout")),s.close()},o);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(i),this.subs.push(l),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Gt(e,"ping",this.onping.bind(this)),Gt(e,"data",this.ondata.bind(this)),Gt(e,"error",this.onerror.bind(this)),Gt(e,"close",this.onclose.bind(this)),Gt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(s){this.onclose("parse error",s)}}ondecoded(e){Bo(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,s){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new ay(this,e,s),this.nsps[e]=r),r}_destroy(e){const s=Object.keys(this.nsps);for(const r of s)if(this.nsps[r].active)return;this._close()}_packet(e){const s=this.encoder.encode(e);for(let r=0;r<s.length;r++)this.engine.write(s[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,s){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,s),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const s=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},s);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Pi={};function Tl(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const s=D2(t,e.path||"/socket.io"),r=s.source,i=s.id,a=s.path,l=Pi[i]&&a in Pi[i].nsps,o=e.forceNew||e["force new connection"]||e.multiplex===!1||l;let c;return o?c=new eu(r,e):(Pi[i]||(Pi[i]=new eu(r,e)),c=Pi[i]),s.query&&!e.query&&(e.query=s.queryKey),c.socket(s.path,e)}Object.assign(Tl,{Manager:eu,Socket:ay,io:Tl,connect:Tl});const n4=()=>{var ge,ke,pe,De,qe,Je,oe;const{user:t,logoutUser:e}=we(),s=rs(),[r,i]=g.useState(null),[a,l]=g.useState(null),[o,c]=g.useState("positions"),[d,m]=g.useState(!0),[u,h]=g.useState("quotes"),[x,y]=g.useState(!1),[f,w]=g.useState("buy"),[p,b]=g.useState(!1),[v,S]=g.useState(null),[N,k]=g.useState(!1),[j,E]=g.useState(!1),[_,M]=g.useState(!1),[V,B]=g.useState({}),[R,O]=g.useState({}),[P,W]=g.useState(0),[D,T]=g.useState("NSE"),[L,F]=g.useState(83.5),C=()=>W(ue=>ue+1);g.useEffect(()=>{const ue=async()=>{try{const{data:Ne}=await I.get("/api/exchange-rate/usdinr").catch(()=>({data:{rate:83.5}}));Ne!=null&&Ne.rate&&F(Ne.rate)}catch{}};ue();const Ce=setInterval(ue,3e5);return()=>clearInterval(Ce)},[]);const H=ue=>(ue/L).toFixed(2),J=D==="Crypto";g.useEffect(()=>{const Ce=Tl("https://thefx.live");return Ce.on("connect",()=>{console.log("Socket.IO connected for real-time ticks")}),Ce.on("market_tick",Ne=>{O(Te=>({...Te,...Ne}));const Ee=Object.values(Ne).find(Te=>Te.symbol==="NIFTY 50"||Te.symbol==="NIFTY"),Le=Object.values(Ne).find(Te=>Te.symbol==="NIFTY BANK"||Te.symbol==="BANKNIFTY"),lt=Object.values(Ne).find(Te=>Te.symbol==="NIFTY FIN SERVICE"||Te.symbol==="FINNIFTY");(Ee||Le||lt)&&B(Te=>({nifty:Ee||Te.nifty,banknifty:Le||Te.banknifty,finnifty:lt||Te.finnifty}))}),Ce.on("crypto_tick",Ne=>{O(Ee=>({...Ee,...Ne}))}),()=>Ce.disconnect()},[]),g.useEffect(()=>{U(),ce();const ue=setInterval(ce,3e3);return()=>clearInterval(ue)},[]);const ce=async()=>{try{const{data:ue}=await I.get("/api/zerodha/market-data");if(ue&&Object.keys(ue).length>0){console.log(`Received ${Object.keys(ue).length} market data entries`),O(Le=>({...Le,...ue}));const Ce=Object.values(ue).find(Le=>Le.symbol==="NIFTY 50"||Le.symbol==="NIFTY"),Ne=Object.values(ue).find(Le=>Le.symbol==="NIFTY BANK"||Le.symbol==="BANKNIFTY"),Ee=Object.values(ue).find(Le=>Le.symbol==="NIFTY FIN SERVICE"||Le.symbol==="FINNIFTY");B({nifty:Ce||null,banknifty:Ne||null,finnifty:Ee||null})}}catch{}},U=async()=>{try{const{data:ue}=await I.get("/api/user/wallet",{headers:{Authorization:`Bearer ${t.token}`}});l(ue)}catch(ue){console.error("Error fetching wallet:",ue)}},le=()=>{e(),s("/login")},G=(ue,Ce=null)=>{Ce&&i(Ce),w(ue),y(!0)},Q=(ue,Ce)=>{S(Ce),w(ue)};return n.jsxs("div",{className:"h-screen bg-dark-900 flex flex-col overflow-hidden",children:[n.jsxs("header",{className:"bg-dark-800 border-b border-dark-600 px-4 py-2 hidden md:flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-6",children:[n.jsxs("button",{onClick:()=>s("/user/home"),className:"flex items-center gap-2 bg-dark-700 hover:bg-dark-600 px-3 py-1.5 rounded-lg transition-colors",children:[n.jsx(no,{size:18,className:"text-green-400"}),n.jsx("span",{className:"text-sm font-medium",children:"Home"})]}),n.jsxs("button",{onClick:()=>s("/user/orders"),className:"flex items-center gap-2 bg-dark-700 hover:bg-dark-600 px-3 py-1.5 rounded-lg transition-colors",children:[n.jsx(ww,{size:18,className:"text-blue-400"}),n.jsx("span",{className:"text-sm font-medium",children:"Orders"})]}),n.jsxs("div",{className:"hidden lg:flex items-center gap-6 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-400",children:"NIFTY"}),V.nifty?n.jsxs("span",{className:`ml-2 ${V.nifty.change>=0?"text-green-400":"text-red-400"}`,children:[(ge=V.nifty.ltp)==null?void 0:ge.toLocaleString(),n.jsxs("span",{className:"text-xs ml-1",children:["(",V.nifty.change>=0?"+":"",V.nifty.changePercent,"%)"]})]}):n.jsx("span",{className:"ml-2 text-gray-500",children:"--"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-400",children:"BANKNIFTY"}),V.banknifty?n.jsxs("span",{className:`ml-2 ${V.banknifty.change>=0?"text-green-400":"text-red-400"}`,children:[(ke=V.banknifty.ltp)==null?void 0:ke.toLocaleString(),n.jsxs("span",{className:"text-xs ml-1",children:["(",V.banknifty.change>=0?"+":"",V.banknifty.changePercent,"%)"]})]}):n.jsx("span",{className:"ml-2 text-gray-500",children:"--"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-400",children:"FINNIFTY"}),V.finnifty?n.jsxs("span",{className:`ml-2 ${V.finnifty.change>=0?"text-green-400":"text-red-400"}`,children:[(pe=V.finnifty.ltp)==null?void 0:pe.toLocaleString(),n.jsxs("span",{className:"text-xs ml-1",children:["(",V.finnifty.change>=0?"+":"",V.finnifty.changePercent,"%)"]})]}):n.jsx("span",{className:"ml-2 text-gray-500",children:"--"})]})]})]}),n.jsx("div",{className:"flex-1 max-w-md mx-4",children:n.jsxs("div",{className:"relative",children:[n.jsx(Jn,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),n.jsx("input",{type:"text",placeholder:"Search Instruments",className:"w-full bg-dark-700 border border-dark-600 rounded-lg pl-10 pr-4 py-1.5 text-sm focus:outline-none focus:border-green-500"})]})}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2 bg-dark-700 px-3 py-1.5 rounded-lg",children:[n.jsx(Ge,{size:18,className:J?"text-orange-400":"text-green-400"}),J?n.jsxs("span",{className:"text-orange-400 font-medium",children:["$",H((a==null?void 0:a.tradingBalance)||((De=a==null?void 0:a.wallet)==null?void 0:De.tradingBalance)||0)]}):n.jsxs("span",{className:"text-green-400 font-medium",children:["",((a==null?void 0:a.tradingBalance)||((qe=a==null?void 0:a.wallet)==null?void 0:qe.tradingBalance)||0).toLocaleString()]})]}),n.jsxs("div",{className:"hidden sm:flex items-center gap-2 text-sm",children:[n.jsx(ao,{size:18,className:"text-gray-400"}),n.jsx("span",{children:t==null?void 0:t.username})]})]})]}),n.jsxs("header",{className:"bg-dark-800 border-b border-dark-600 px-4 py-3 flex md:hidden items-center justify-between",children:[n.jsxs("button",{onClick:()=>s("/user/home"),className:"flex items-center gap-2 bg-dark-700 hover:bg-dark-600 px-3 py-1.5 rounded-lg transition-colors",children:[n.jsx(no,{size:18,className:"text-green-400"}),n.jsx("span",{className:"text-sm font-medium",children:"Home"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"flex items-center gap-2 bg-dark-700 px-3 py-1.5 rounded-lg",children:[n.jsx(Ge,{size:16,className:J?"text-orange-400":"text-green-400"}),J?n.jsxs("span",{className:"text-orange-400 font-medium text-sm",children:["$",H((a==null?void 0:a.tradingBalance)||((Je=a==null?void 0:a.wallet)==null?void 0:Je.tradingBalance)||0)]}):n.jsxs("span",{className:"text-green-400 font-medium text-sm",children:["",((a==null?void 0:a.tradingBalance)||((oe=a==null?void 0:a.wallet)==null?void 0:oe.tradingBalance)||0).toLocaleString()]})]}),n.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[n.jsx(ao,{size:16,className:"text-gray-400"}),n.jsx("span",{className:"text-gray-400",children:t==null?void 0:t.username})]})]})]}),!1,n.jsxs("div",{className:"flex-1 hidden md:flex overflow-hidden",children:[n.jsx("div",{className:"flex-shrink-0 w-64",children:n.jsx(r4,{selectedInstrument:r,onSelectInstrument:i,onBuySell:Q,user:t,marketData:R,onSegmentChange:T})}),n.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[n.jsx(a4,{selectedInstrument:r,marketData:R,sidebarOpen:!!v}),n.jsx(l4,{activeTab:o,setActiveTab:c,walletData:a,user:t,marketData:R,refreshKey:P,selectedInstrument:r,onRefreshPositions:C})]}),n.jsx("div",{className:`flex-shrink-0 overflow-hidden transition-all duration-200 ease-out ${v?"w-72":"w-0"}`,children:v&&n.jsx("div",{className:"w-72 h-full",children:n.jsx(o4,{instrument:v,orderType:f,setOrderType:w,walletData:a,onClose:()=>S(null),user:t,marketData:R,onRefreshWallet:U,onRefreshPositions:C})})})]}),n.jsxs("div",{className:"flex-1 flex flex-col md:hidden overflow-hidden pb-16",children:[u==="quotes"&&n.jsx(c4,{selectedInstrument:r,onSelectInstrument:ue=>{i(ue),h("chart")},onBuySell:G,user:t,marketData:R,onSegmentChange:T}),u==="chart"&&n.jsx(d4,{selectedInstrument:r,onBuySell:G,onBack:()=>h("quotes"),marketData:R}),u==="positions"&&n.jsx(ux,{activeTab:"positions",user:t,marketData:R}),u==="history"&&n.jsx(ux,{activeTab:"history",user:t,marketData:R}),u==="profile"&&n.jsx(h4,{user:t,walletData:a,onLogout:le})]}),n.jsxs("nav",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-dark-800 border-t border-dark-600 flex items-center justify-around py-2 z-40",children:[n.jsxs("button",{onClick:()=>h("quotes"),className:`flex flex-col items-center p-2 ${u==="quotes"?"text-green-400":"text-gray-400"}`,children:[n.jsx(Pw,{size:20}),n.jsx("span",{className:"text-xs mt-1",children:"Quotes"})]}),n.jsxs("button",{onClick:()=>h("chart"),className:`flex flex-col items-center p-2 ${u==="chart"?"text-green-400":"text-gray-400"}`,children:[n.jsx(ah,{size:20}),n.jsx("span",{className:"text-xs mt-1",children:"Chart"})]}),n.jsxs("button",{onClick:()=>G("buy"),className:"flex flex-col items-center p-2 bg-green-600 rounded-full -mt-4 px-4",children:[n.jsx(gs,{size:24}),n.jsx("span",{className:"text-xs mt-1",children:"Trade"})]}),n.jsxs("button",{onClick:()=>h("positions"),className:`flex flex-col items-center p-2 ${u==="positions"?"text-green-400":"text-gray-400"}`,children:[n.jsx(Ge,{size:20}),n.jsx("span",{className:"text-xs mt-1",children:"Positions"})]}),n.jsxs("button",{onClick:()=>s("/user/orders"),className:"flex flex-col items-center p-2 text-gray-400",children:[n.jsx(hg,{size:20}),n.jsx("span",{className:"text-xs mt-1",children:"Orders"})]})]}),x&&n.jsx(f4,{instrument:r,orderType:f,setOrderType:w,onClose:()=>y(!1),walletData:a,user:t,marketData:R,onRefreshWallet:U,onRefreshPositions:C}),N&&n.jsx(x4,{onClose:()=>k(!1),walletData:a,user:t,onRefresh:U}),j&&n.jsx(p4,{onClose:()=>E(!1),user:t}),_&&n.jsx(m4,{onClose:()=>M(!1),user:t})]})},r4=({selectedInstrument:t,onSelectInstrument:e,onBuySell:s,user:r,marketData:i={},onSegmentChange:a})=>{const[l,o]=g.useState(""),[c,d]=g.useState(""),[m,u]=g.useState("NSE"),h=C=>{u(C),a&&a(C)},[x,y]=g.useState(()=>{const C=localStorage.getItem("ntrader_watchlist");return C?JSON.parse(C):["NIFTY 50","NIFTY BANK","SBIN","RELIANCE"]}),[f,w]=g.useState({}),[p,b]=g.useState([]),[v,S]=g.useState(!0),[N,k]=g.useState([]),[j,E]=g.useState(!1),_=g.useRef(null),M=[{id:"NSE",label:"NSE",color:"bg-green-600"},{id:"NSE_FO",label:"NSE F&O",color:"bg-dark-600"},{id:"MCX",label:"MCX",color:"bg-dark-600"},{id:"BSE_FO",label:"BSE F&O",color:"bg-dark-600"},{id:"Currency",label:"Currency",color:"bg-dark-600"},{id:"Crypto",label:"Crypto",color:"bg-dark-600"}],V={connected:Object.keys(i).length>0,lastUpdate:Object.keys(i).length>0?new Date:null};g.useEffect(()=>{const C=setTimeout(()=>{d(l)},150);return()=>clearTimeout(C)},[l]),g.useEffect(()=>{if(c.length>=1){E(!0);const C=c.toLowerCase(),H=p.filter(J=>{var ce,U,le;return((ce=J.symbol)==null?void 0:ce.toLowerCase().includes(C))||((U=J.name)==null?void 0:U.toLowerCase().includes(C))||((le=J.category)==null?void 0:le.toLowerCase().includes(C))}).slice(0,50);k(H),E(!1)}else k([])},[c,p]),g.useEffect(()=>{B()},[r==null?void 0:r.token]);const B=async()=>{try{S(!0);const C=r!=null&&r.token?"/api/instruments/user":"/api/instruments/public",H=r!=null&&r.token?{Authorization:`Bearer ${r.token}`}:{},{data:J}=await I.get(C,{headers:H});b(J||[])}catch(C){console.error("Error fetching instruments:",C);try{const{data:H}=await I.get("/api/instruments/public");b(H||[])}catch(H){console.error("Fallback also failed:",H)}}finally{S(!1)}};g.useEffect(()=>{R();const C=setInterval(R,5e3);return()=>clearInterval(C)},[]);const R=async()=>{try{const{data:C}=await I.get("/api/binance/prices");w(C)}catch{}};g.useEffect(()=>{localStorage.setItem("ntrader_watchlist",JSON.stringify(x))},[x]);const O=(C,H,J)=>{if(J!=null&&J.isDemo){const ce=(Math.random()-.5)*.02*J.mockPrice;return{ltp:J.mockPrice+ce,change:J.mockChange,changePercent:J.mockChange}}return H&&f[H]?f[H]:C&&i[C]?i[C]:{ltp:0,change:0,changePercent:0}},P=C=>{x.includes(C)||y([...x,C])},W=C=>{y(x.filter(H=>H!==C))},D=C=>x.includes(C),T=()=>p.length>0?p.map(C=>({...C,symbol:C.symbol,name:C.name,exchange:C.exchange,token:C.token,segment:C.segment,instrumentType:C.instrumentType,category:C.category,lotSize:C.lotSize||1})):[],F=(()=>{const C=T(),H=l.toLowerCase();let J=C;switch(H&&(J=C.filter(ce=>{var U,le;return((U=ce.symbol)==null?void 0:U.toLowerCase().includes(H))||((le=ce.name)==null?void 0:le.toLowerCase().includes(H))})),m){case"NSE":return J.filter(U=>U.exchange==="NSE"&&(U.instrumentType==="INDEX"||U.instrumentType==="STOCK"||U.segment==="EQUITY")||U.category==="INDICES"||U.category==="STOCKS");case"NSE_FO":return J.filter(U=>(U.exchange==="NFO"||U.segment==="FNO"||U.segment==="NFO")&&(U.instrumentType==="FUTURES"||U.instrumentType==="OPTIONS"));case"MCX":return J.filter(U=>U.exchange==="MCX"||U.segment==="MCX"||U.category==="MCX");case"BSE_FO":return J.filter(U=>U.exchange==="BFO"||U.segment==="BFO"||U.exchange==="BSE");case"Currency":return J.filter(U=>U.exchange==="CDS"||U.segment==="CURRENCY"||U.category==="CURRENCY");case"Crypto":const ce=J.filter(U=>U.isCrypto||U.segment==="CRYPTO"||U.category==="CRYPTO");if(Object.keys(f).length>0){const U=Object.values(f).map(le=>({symbol:le.symbol,name:le.pair,exchange:"BINANCE",token:le.pair,pair:le.pair,segment:"CRYPTO",category:"CRYPTO",instrumentType:"CRYPTO",isCrypto:!0,ltp:le.ltp,change:le.change,changePercent:le.changePercent}));return[...ce,...U.filter(le=>!H||le.symbol.toLowerCase().includes(H)||le.name.toLowerCase().includes(H))]}return ce;default:return J}})();return n.jsxs("aside",{className:"w-full h-full bg-dark-800 border-r border-dark-600 flex flex-col",children:[n.jsxs("div",{className:"px-3 py-2 border-b border-dark-600 flex items-center justify-between text-xs",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${V.connected?"bg-green-500 animate-pulse":"bg-red-500"}`}),n.jsx("span",{className:V.connected?"text-green-400":"text-red-400",children:V.connected?"Live":"Offline"})]}),V.connected&&V.lastUpdate&&n.jsx("span",{className:"text-gray-500",children:new Date(V.lastUpdate).toLocaleTimeString()})]}),n.jsx("div",{className:"flex flex-wrap gap-1 p-2 border-b border-dark-600",children:M.map(C=>n.jsx("button",{onClick:()=>h(C.id),className:`px-3 py-1.5 text-xs font-medium rounded transition ${m===C.id?"bg-green-600 text-white":"bg-dark-700 text-gray-400 hover:bg-dark-600 hover:text-white"}`,children:C.label},C.id))}),n.jsx("div",{className:"p-2 border-b border-dark-600",children:n.jsxs("div",{className:"relative",children:[n.jsx(Jn,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),n.jsx("input",{ref:_,type:"text",placeholder:"Search symbols...",value:l,onChange:C=>o(C.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded pl-9 pr-8 py-2 text-sm focus:outline-none focus:border-green-500"}),l&&n.jsx("button",{onClick:()=>{var C;o(""),(C=_.current)==null||C.focus()},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white",children:n.jsx(ve,{size:14})})]})}),n.jsx("div",{className:"flex-1 overflow-y-auto",children:v?n.jsxs("div",{className:"p-4 text-center text-gray-400",children:[n.jsx(fe,{className:"animate-spin inline mr-2",size:16}),"Loading instruments..."]}):F.length===0?n.jsxs("div",{className:"p-4 text-center text-gray-500 text-sm",children:[n.jsx("p",{children:"No instruments found"}),n.jsx("p",{className:"mt-2 text-xs",children:m==="Crypto"?"Loading crypto from Binance...":"Try a different segment or search"})]}):F.map(C=>{const H=C.isCrypto?C:O(C.token,C.pair,C);return n.jsx(i4,{instrument:{...C,ltp:H.ltp||C.ltp||0,change:H.change||C.change||0,changePercent:H.changePercent||C.changePercent||0},isSelected:(t==null?void 0:t.symbol)===C.symbol,onSelect:()=>e({...C,ltp:H.ltp||C.ltp||0}),onBuySell:s,inWatchlist:D(C.symbol),onAddToWatchlist:()=>P(C.symbol),onRemoveFromWatchlist:()=>W(C.symbol),isCrypto:C.isCrypto,isDemo:C.isDemo},C._id||C.pair||`${C.exchange}-${C.symbol}`)})})]})},i4=({instrument:t,isSelected:e,onSelect:s,isCall:r,isPut:i,isFuture:a,isCrypto:l,isDemo:o,onBuySell:c,inWatchlist:d,onRemoveFromWatchlist:m,onAddToWatchlist:u})=>{const h=()=>o?"text-purple-400":l?"text-orange-400":r||t.optionType==="CE"?"text-green-400":i||t.optionType==="PE"?"text-red-400":a||t.instrumentType==="FUTURES"?"text-yellow-400":"text-white",x=w=>!w||w<=0?"-":l||t.isCrypto?`$${w.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`:w.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),y=parseFloat(t.changePercent)||0,f=y>=0;return n.jsxs("div",{onClick:s,className:`flex items-center justify-between px-3 py-2.5 cursor-pointer border-b border-dark-700 ${e?"bg-green-600/20 border-l-2 border-l-green-500":"hover:bg-dark-750"}`,children:[n.jsxs("div",{className:"flex-1 min-w-0 mr-2",children:[n.jsx("div",{className:`font-bold text-sm uppercase ${e?"text-green-400":h()}`,children:t.symbol}),n.jsx("div",{className:"text-xs text-gray-500 truncate",children:t.name||t.symbol})]}),n.jsxs("div",{className:"text-right flex-shrink-0 mr-2",children:[n.jsx("div",{className:"text-sm font-medium text-gray-300",children:x(t.ltp)||"-"}),n.jsx("div",{className:`text-xs font-medium ${f?"text-green-500":"text-red-500"}`,children:y!==0?`${f?"+":""}${y.toFixed(2)}%`:"+0.00%"})]}),n.jsxs("div",{className:"flex items-center gap-1",onClick:w=>w.stopPropagation(),children:[n.jsx("button",{onClick:()=>c("sell",t),className:"w-7 h-7 rounded-full bg-red-600 hover:bg-red-700 flex items-center justify-center text-xs font-bold transition-colors",title:"Sell",children:"S"}),n.jsx("button",{onClick:()=>c("buy",t),className:"w-7 h-7 rounded-full bg-green-600 hover:bg-green-700 flex items-center justify-center text-xs font-bold transition-colors",title:"Buy",children:"B"})]})]})},a4=({selectedInstrument:t,marketData:e,sidebarOpen:s})=>{var S,N,k,j,E;const r=g.useRef(null),i=g.useRef(null),a=g.useRef(null),l=g.useRef(null),[o,c]=g.useState("FIFTEEN_MINUTE"),[d,m]=g.useState(!1),[u,h]=g.useState(null),x=g.useRef(null);g.useEffect(()=>{if(i.current&&r.current){i.current.applyOptions({width:r.current.clientWidth,height:r.current.clientHeight});const _=setTimeout(()=>{i.current&&r.current&&i.current.applyOptions({width:r.current.clientWidth,height:r.current.clientHeight})},250);return()=>clearTimeout(_)}},[s]),g.useEffect(()=>{const _=(t==null?void 0:t.isCrypto)||(t==null?void 0:t.exchange)==="BINANCE";let M=null;if(t!=null&&t.token&&e[t.token]?M=e[t.token]:_&&(t!=null&&t.pair)&&e[t.pair]?M=e[t.pair]:t!=null&&t.symbol&&e[t.symbol]&&(M=e[t.symbol]),M&&(h({ltp:M.ltp,open:M.open,high:M.high,low:M.low,close:M.close,change:M.change,changePercent:M.changePercent}),a.current&&x.current&&M.ltp)){const V=Math.floor(Date.now()/1e3),B=y(o),R=Math.floor(V/B)*B;if(x.current.time===R){const O={time:R,open:x.current.open,high:Math.max(x.current.high,M.ltp),low:Math.min(x.current.low,M.ltp),close:M.ltp};x.current=O,a.current.update(O)}else{const O={time:R,open:M.ltp,high:M.ltp,low:M.ltp,close:M.ltp};x.current=O,a.current.update(O)}}},[t==null?void 0:t.token,e,o]);const y=_=>({ONE_MINUTE:60,FIVE_MINUTE:300,FIFTEEN_MINUTE:900,THIRTY_MINUTE:1800,ONE_HOUR:3600,ONE_DAY:86400})[_]||900,f=_=>({ONE_MINUTE:"1m",FIVE_MINUTE:"5m",FIFTEEN_MINUTE:"15m",THIRTY_MINUTE:"30m",ONE_HOUR:"1h",ONE_DAY:"1d"})[_]||"15m",w=_=>{const M=[],V=Math.floor(Date.now()/1e3);for(let B=500;B>=0;B--){const R=V-B*900,O=_*.02,P=_+(Math.random()-.5)*O,W=P+(Math.random()-.5)*O,D=Math.max(P,W)+Math.random()*O*.5,T=Math.min(P,W)-Math.random()*O*.5;M.push({time:R,open:P,high:D,low:T,close:W,volume:Math.random()*1e5})}return M},p=async(_,M)=>{if(!_)return null;try{if(m(!0),_.isDemo)return w(_.mockPrice||1e3);if(_.isCrypto||_.exchange==="BINANCE"){const B=f(M),{data:R}=await I.get(`/api/binance/candles/${_.pair||_.symbol}`,{params:{interval:B,limit:500}});return R}if(!_.token)return hx();try{const{data:B}=await I.get(`/api/zerodha/historical/${_.token}`,{params:{interval:M}});if(B&&B.length>0)return B}catch{console.log("Zerodha historical not available, using sample data")}const V=_.ltp||100;return w(V)}catch(V){return console.error("Failed to fetch candle data:",V),hx()}finally{m(!1)}},b=async()=>{if(t)try{if(t.isDemo){const M=(Math.random()-.5)*.02*t.mockPrice;h({ltp:t.mockPrice+M,open:t.mockPrice*.99,high:t.mockPrice*1.02,low:t.mockPrice*.98,close:t.mockPrice,change:t.mockChange,changePercent:t.mockChange});return}if(t.isCrypto||t.exchange==="BINANCE"){const{data:M}=await I.get(`/api/binance/price/${t.pair||t.symbol}`);h(M);return}if(!t.token)return;const{data:_}=await I.get("/api/zerodha/market-data");_[t.token]&&h(_[t.token])}catch(_){console.error("Failed to fetch live price:",_)}};g.useEffect(()=>{if(!t||!r.current||i.current)return;const _=setTimeout(()=>{if(!r.current||i.current)return;const M=r.current.clientWidth||800,V=r.current.clientHeight||400,B=Hg(r.current,{width:M,height:V,layout:{background:{color:"#111111"},textColor:"#d1d5db"},grid:{vertLines:{color:"#1f1f1f"},horzLines:{color:"#1f1f1f"}},crosshair:{mode:1},rightPriceScale:{borderColor:"#2a2a2a"},timeScale:{borderColor:"#2a2a2a",timeVisible:!0,secondsVisible:!1}});i.current=B,a.current=B.addCandlestickSeries({upColor:"#22c55e",downColor:"#ef4444",borderDownColor:"#ef4444",borderUpColor:"#22c55e",wickDownColor:"#ef4444",wickUpColor:"#22c55e"}),l.current=B.addHistogramSeries({color:"#26a69a",priceFormat:{type:"volume"},priceScaleId:""}),B.priceScale("").applyOptions({scaleMargins:{top:.8,bottom:0}});const R=()=>{r.current&&i.current&&i.current.applyOptions({width:r.current.clientWidth,height:r.current.clientHeight})};window.addEventListener("resize",R),setTimeout(R,100)},100);return()=>{clearTimeout(_)}},[t]),g.useEffect(()=>()=>{i.current&&(i.current.remove(),i.current=null)},[]),g.useEffect(()=>{(async()=>{var B;if(!t||!a.current)return;const V=await p(t,o);if(V&&V.length>0){a.current.setData(V);const R=V.map(O=>({time:O.time,value:O.volume||Math.random()*1e6,color:O.close>=O.open?"#22c55e80":"#ef444480"}));l.current.setData(R),(B=i.current)==null||B.timeScale().fitContent()}})(),b();const M=setInterval(b,5e3);return()=>clearInterval(M)},[t,o]);const v=[{label:"1m",value:"ONE_MINUTE"},{label:"5m",value:"FIVE_MINUTE"},{label:"15m",value:"FIFTEEN_MINUTE"},{label:"30m",value:"THIRTY_MINUTE"},{label:"1h",value:"ONE_HOUR"},{label:"1D",value:"ONE_DAY"}];return n.jsxs("div",{className:"flex-1 flex flex-col bg-dark-800",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-dark-600",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"font-medium",children:"Chart"}),d&&n.jsx(fe,{size:14,className:"animate-spin text-green-400"})]}),t&&n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("span",{className:`font-medium ${t.isDemo?"text-purple-400":t.isCrypto?"text-orange-400":"text-green-400"}`,children:[t.symbol,t.isDemo&&n.jsx("span",{className:"ml-1 text-xs bg-purple-600 px-1 rounded",children:"DEMO"})]}),n.jsx("span",{className:"text-gray-400 text-sm",children:t.exchange}),u&&n.jsxs(n.Fragment,{children:[n.jsxs("span",{className:`font-mono font-bold ${u.change>=0?"text-green-400":"text-red-400"}`,children:[t.isCrypto?"$":"",(S=u.ltp)==null?void 0:S.toLocaleString(void 0,t.isCrypto?{minimumFractionDigits:2,maximumFractionDigits:2}:{})]}),n.jsxs("span",{className:`text-sm ${u.change>=0?"text-green-400":"text-red-400"}`,children:[u.change>=0?"+":"",u.changePercent,"%"]})]})]})]}),t&&u&&n.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-400",children:[n.jsxs("span",{children:["O: ",t.isCrypto?"$":"",(N=u.open)==null?void 0:N.toLocaleString()]}),n.jsxs("span",{children:["H: ",t.isCrypto?"$":"",(k=u.high)==null?void 0:k.toLocaleString()]}),n.jsxs("span",{children:["L: ",t.isCrypto?"$":"",(j=u.low)==null?void 0:j.toLocaleString()]}),n.jsxs("span",{children:["C: ",t.isCrypto?"$":"",(E=u.close)==null?void 0:E.toLocaleString()]})]})]}),n.jsx("div",{className:"flex-1 relative min-h-[300px]",children:t?n.jsx("div",{ref:r,className:"absolute inset-0"}):n.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-gray-400",children:[n.jsx(ah,{size:48,className:"mb-4 opacity-30"}),n.jsx("p",{children:"Select an instrument to view chart"})]})}),t&&n.jsx("div",{className:"flex items-center gap-2 px-4 py-2 border-t border-dark-600 text-sm",children:v.map(_=>n.jsx("button",{onClick:()=>c(_.value),className:`px-3 py-1 rounded ${o===_.value?"bg-green-600 text-white":"hover:bg-dark-600 text-gray-400 hover:text-white"}`,children:_.label},_.value))})]})},l4=({activeTab:t,setActiveTab:e,walletData:s,user:r,marketData:i,refreshKey:a,selectedInstrument:l,onRefreshPositions:o})=>{var D;const[c,d]=g.useState([]),[m,u]=g.useState([]),[h,x]=g.useState([]),[y,f]=g.useState(!1),[w,p]=g.useState(0),[b,v]=g.useState("1"),[S,N]=g.useState(!1),[k,j]=g.useState("");g.useEffect(()=>{if(r!=null&&r.token){E();const T=setInterval(E,2e3);return()=>clearInterval(T)}},[r==null?void 0:r.token,a]);const E=async()=>{try{const T={Authorization:`Bearer ${r.token}`},[L,F,C]=await Promise.all([I.get("/api/trading/positions?status=OPEN",{headers:T}),I.get("/api/trading/pending-orders",{headers:T}),I.get("/api/trading/history",{headers:T})]);d(L.data||[]),u(F.data||[]),x(C.data||[]);const H=(L.data||[]).reduce((J,ce)=>J+(ce.unrealizedPnL||0),0);p(H)}catch(T){console.error("Error fetching positions:",T)}},_=async(T,L)=>{var F,C;try{f(!0);const H=i[L==null?void 0:L.token]||{},J=H.bid||H.ltp||(L==null?void 0:L.currentPrice),ce=H.ask||H.ltp||(L==null?void 0:L.currentPrice);await I.post(`/api/trading/close/${T}`,{bidPrice:J,askPrice:ce},{headers:{Authorization:`Bearer ${r.token}`}}),E()}catch(H){alert(((C=(F=H.response)==null?void 0:F.data)==null?void 0:C.message)||"Error closing position")}finally{f(!1)}},M=async()=>{var L,F;const T=c.filter(C=>{const H=W(C)||C.currentPrice||C.entryPrice;return(C.side==="BUY"?(H-C.entryPrice)*C.quantity:(C.entryPrice-H)*C.quantity)>0});if(T.length===0){alert("No positions in profit to close");return}if(confirm(`Close ${T.length} position(s) in profit?`)){f(!0);try{for(const C of T){const H=i[C==null?void 0:C.token]||{};await I.post(`/api/trading/close/${C._id}`,{bidPrice:H.bid||H.ltp||(C==null?void 0:C.currentPrice),askPrice:H.ask||H.ltp||(C==null?void 0:C.currentPrice)},{headers:{Authorization:`Bearer ${r.token}`}})}E()}catch(C){alert(((F=(L=C.response)==null?void 0:L.data)==null?void 0:F.message)||"Error closing positions")}finally{f(!1)}}},V=async()=>{var L,F;const T=c.filter(C=>{const H=W(C)||C.currentPrice||C.entryPrice;return(C.side==="BUY"?(H-C.entryPrice)*C.quantity:(C.entryPrice-H)*C.quantity)<0});if(T.length===0){alert("No positions in loss to close");return}if(confirm(`Close ${T.length} position(s) in loss?`)){f(!0);try{for(const C of T){const H=i[C==null?void 0:C.token]||{};await I.post(`/api/trading/close/${C._id}`,{bidPrice:H.bid||H.ltp||(C==null?void 0:C.currentPrice),askPrice:H.ask||H.ltp||(C==null?void 0:C.currentPrice)},{headers:{Authorization:`Bearer ${r.token}`}})}E()}catch(C){alert(((F=(L=C.response)==null?void 0:L.data)==null?void 0:F.message)||"Error closing positions")}finally{f(!1)}}},B=async()=>{var T,L;if(c.length===0){alert("No positions to close");return}if(confirm(`Close ALL ${c.length} position(s)?`)){f(!0);try{for(const F of c){const C=i[F==null?void 0:F.token]||{};await I.post(`/api/trading/close/${F._id}`,{bidPrice:C.bid||C.ltp||(F==null?void 0:F.currentPrice),askPrice:C.ask||C.ltp||(F==null?void 0:F.currentPrice)},{headers:{Authorization:`Bearer ${r.token}`}})}E()}catch(F){alert(((L=(T=F.response)==null?void 0:T.data)==null?void 0:L.message)||"Error closing positions")}finally{f(!1)}}},R=async T=>{var L,F;try{await I.post(`/api/trading/cancel/${T}`,{},{headers:{Authorization:`Bearer ${r.token}`}}),E()}catch(C){alert(((F=(L=C.response)==null?void 0:L.data)==null?void 0:F.message)||"Error cancelling order")}},O=async T=>{var F,C;const L=parseFloat(b);if(!(!l||isNaN(L)||L<=0)){N(!0),j("");try{const H=i[l.token]||{},J=H.ltp||l.ltp||0,ce=H.bid||J,U=H.ask||J,le=l.isCrypto||l.segment==="CRYPTO"||l.exchange==="BINANCE";await I.post("/api/trading/order",{symbol:l.symbol,token:l.token,pair:l.pair,isCrypto:le,exchange:l.exchange||(le?"BINANCE":"NSE"),segment:le?"CRYPTO":l.segment||"FNO",instrumentType:le?"CRYPTO":l.instrumentType||"FUTURES",side:T.toUpperCase(),quantity:L,lots:L,lotSize:1,price:J,orderType:"MARKET",productType:"MIS",bidPrice:ce,askPrice:U,leverage:1},{headers:{Authorization:`Bearer ${r.token}`}}),E(),o&&o()}catch(H){j(((C=(F=H.response)==null?void 0:F.data)==null?void 0:C.message)||"Trade failed"),setTimeout(()=>j(""),3e3)}finally{N(!1)}}},P=[{id:"positions",label:"Positions",count:c.length},{id:"pending",label:"Pending",count:m.length},{id:"history",label:"History",count:h.length}],W=T=>{const L=T.token,F=T.symbol,C=T.side;let H=null;if(L&&(i!=null&&i[L]))H=i[L];else if(F&&(i!=null&&i[F]))H=i[F];else for(const[J,ce]of Object.entries(i||{}))if(ce.symbol===F){H=ce;break}return H?C==="BUY"?H.bid||H.ltp||H.last_price||0:H.ask||H.ltp||H.last_price||0:0};return n.jsxs("div",{className:"h-48 bg-dark-800 border-t border-dark-600 flex flex-col",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 border-b border-dark-600",children:[n.jsx("div",{className:"flex",children:P.map(T=>n.jsxs("button",{onClick:()=>e(T.id),className:`px-4 py-2 text-sm border-b-2 transition ${t===T.id?"border-green-500 text-green-400":"border-transparent text-gray-400 hover:text-white"}`,children:[T.label," (",T.count,")"]},T.id))}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:`text-xs font-medium ${l?"text-green-400":"text-gray-500"}`,children:(l==null?void 0:l.symbol)||"No Symbol"}),n.jsxs("span",{className:"text-xs text-gray-400",children:["",(l&&(((D=i[l.token])==null?void 0:D.ltp)||l.ltp)||0).toLocaleString()]}),n.jsx("button",{onClick:()=>O("sell"),disabled:S||!l,className:"w-8 h-8 rounded-full bg-red-600 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center text-xs font-bold transition-colors",title:l?"Sell":"Select an instrument first",children:"S"}),n.jsx("input",{type:"text",value:b,onChange:T=>{const L=T.target.value;(L===""||/^\d*\.?\d*$/.test(L))&&v(L)},onBlur:T=>{const L=parseFloat(T.target.value);(isNaN(L)||L<=0)&&v("1")},placeholder:"Qty",className:"w-16 h-8 bg-dark-700 rounded text-center text-sm focus:outline-none focus:ring-1 focus:ring-green-500"}),n.jsx("button",{onClick:()=>O("buy"),disabled:S||!l,className:"w-8 h-8 rounded-full bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center text-xs font-bold transition-colors",title:l?"Buy":"Select an instrument first",children:"B"}),k&&n.jsx("span",{className:"text-xs text-red-400",children:k})]}),n.jsxs("div",{className:"text-sm",children:[n.jsx("span",{className:"text-gray-400",children:"P/L: "}),n.jsxs("span",{className:`font-medium ${w>=0?"text-green-400":"text-red-400"}`,children:[w>=0?"+":"","",w.toFixed(2)]})]}),t==="positions"&&c.length>0&&n.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[n.jsx("button",{onClick:V,disabled:y,className:"px-2 py-1 bg-orange-600 hover:bg-orange-700 disabled:opacity-50 rounded text-xs font-medium",title:"Close all positions in loss",children:"Close Loss"}),n.jsx("button",{onClick:M,disabled:y,className:"px-2 py-1 bg-green-600 hover:bg-green-700 disabled:opacity-50 rounded text-xs font-medium",title:"Close all positions in profit",children:"Close Profit"}),n.jsx("button",{onClick:B,disabled:y,className:"px-2 py-1 bg-red-600 hover:bg-red-700 disabled:opacity-50 rounded text-xs font-medium",title:"Close all positions",children:"Close All"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-9 gap-2 px-4 py-2 text-xs text-gray-400 border-b border-dark-700",children:[n.jsx("div",{children:"User ID"}),n.jsx("div",{children:"Symbol"}),n.jsx("div",{children:"Side"}),n.jsx("div",{className:"text-right",children:"Qty"}),n.jsx("div",{className:"text-right",children:"Entry"}),n.jsx("div",{className:"text-right",children:"LTP"}),n.jsx("div",{className:"text-right",children:"Charges"}),n.jsx("div",{className:"text-right",children:"P&L"}),n.jsx("div",{className:"text-center",children:"Action"})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto",children:[t==="positions"&&c.length===0&&n.jsx("div",{className:"flex items-center justify-center h-full text-gray-400 text-sm",children:"No open positions"}),t==="positions"&&c.map(T=>{var J;const L=W(T)||T.currentPrice||T.entryPrice,F=T.side==="BUY"?(L-T.entryPrice)*T.quantity:(T.entryPrice-L)*T.quantity,C=T.isCrypto||T.segment==="CRYPTO"||T.exchange==="BINANCE",H=C?"$":"";return n.jsxs("div",{className:"grid grid-cols-9 gap-2 px-4 py-2 text-sm border-b border-dark-700 hover:bg-dark-700",children:[n.jsx("div",{className:"truncate text-purple-400 font-mono text-xs",children:T.userId||(r==null?void 0:r.userId)||"-"}),n.jsx("div",{className:`truncate font-medium ${C?"text-orange-400":""}`,children:T.symbol}),n.jsx("div",{className:T.side==="BUY"?"text-green-400":"text-red-400",children:T.side}),n.jsx("div",{className:"text-right",children:T.quantity}),n.jsxs("div",{className:"text-right",children:[H,(J=T.entryPrice)==null?void 0:J.toFixed(2)]}),n.jsxs("div",{className:"text-right",children:[H,L==null?void 0:L.toFixed(2)]}),n.jsxs("div",{className:"text-right text-yellow-400",title:`Spread: ${T.spread||0} pts, Comm: ${H}${T.commission||0}`,children:[H,(T.commission||0).toFixed(2)]}),n.jsxs("div",{className:`text-right font-medium ${F>=0?"text-green-400":"text-red-400"}`,children:[F>=0?"+":"",H,F.toFixed(2)]}),n.jsx("div",{className:"text-center",children:n.jsx("button",{onClick:()=>_(T._id,T),disabled:y,className:"px-2 py-1 bg-red-600 hover:bg-red-700 rounded text-xs",children:"Close"})})]},T._id)}),t==="pending"&&m.length===0&&n.jsx("div",{className:"flex items-center justify-center h-full text-gray-400 text-sm",children:"No pending orders"}),t==="pending"&&m.map(T=>{var C;const L=T.isCrypto||T.segment==="CRYPTO"||T.exchange==="BINANCE",F=L?"$":"";return n.jsxs("div",{className:"grid grid-cols-9 gap-2 px-4 py-2 text-sm border-b border-dark-700 hover:bg-dark-700",children:[n.jsx("div",{className:"truncate text-purple-400 font-mono text-xs",children:T.userId||(r==null?void 0:r.userId)||"-"}),n.jsx("div",{className:`truncate font-medium ${L?"text-orange-400":""}`,children:T.symbol}),n.jsx("div",{className:T.side==="BUY"?"text-green-400":"text-red-400",children:T.side}),n.jsx("div",{className:"text-right",children:T.quantity}),n.jsxs("div",{className:"text-right",children:[F,((C=T.limitPrice)==null?void 0:C.toFixed(2))||"-"]}),n.jsx("div",{className:"text-right",children:"-"}),n.jsxs("div",{className:"text-right text-yellow-400",children:[F,(T.commission||0).toFixed(2)]}),n.jsx("div",{className:"text-right text-gray-400",children:T.orderType}),n.jsx("div",{className:"text-center",children:n.jsx("button",{onClick:()=>R(T._id),className:"px-2 py-1 bg-yellow-600 hover:bg-yellow-700 rounded text-xs",children:"Cancel"})})]},T._id)}),t==="history"&&h.length===0&&n.jsx("div",{className:"flex items-center justify-center h-full text-gray-400 text-sm",children:"No trade history"}),t==="history"&&h.map(T=>{var C,H;const L=T.isCrypto||T.segment==="CRYPTO"||T.exchange==="BINANCE",F=L?"$":"";return n.jsxs("div",{className:"grid grid-cols-9 gap-2 px-4 py-2 text-sm border-b border-dark-700 hover:bg-dark-700",children:[n.jsx("div",{className:"truncate text-purple-400 font-mono text-xs",children:T.userId||(r==null?void 0:r.userId)||"-"}),n.jsx("div",{className:`truncate font-medium ${L?"text-orange-400":""}`,children:T.symbol}),n.jsx("div",{className:T.side==="BUY"?"text-green-400":"text-red-400",children:T.side}),n.jsx("div",{className:"text-right",children:T.quantity}),n.jsxs("div",{className:"text-right",children:[F,(C=T.entryPrice)==null?void 0:C.toFixed(2)]}),n.jsxs("div",{className:"text-right",children:[F,((H=T.exitPrice)==null?void 0:H.toFixed(2))||"-"]}),n.jsxs("div",{className:"text-right text-yellow-400",children:[F,(T.commission||0).toFixed(2)]}),n.jsxs("div",{className:`text-right font-medium ${(T.realizedPnL||0)>=0?"text-green-400":"text-red-400"}`,children:[(T.realizedPnL||0)>=0?"+":"",F,(T.realizedPnL||0).toFixed(2)]}),n.jsx("div",{className:"text-center text-xs text-gray-400",children:T.closeReason||"CLOSED"})]},T._id)})]})]})},o4=({instrument:t,orderType:e,setOrderType:s,walletData:r,onClose:i,user:a,marketData:l={},onRefreshWallet:o,onRefreshPositions:c})=>{var de,ot;const[d,m]=g.useState(((de=t==null?void 0:t.defaultQty)==null?void 0:de.toString())||"1"),[u,h]=g.useState(""),[x,y]=g.useState(""),[f,w]=g.useState(""),[p,b]=g.useState(""),[v,S]=g.useState("MIS"),[N,k]=g.useState("MARKET"),[j,E]=g.useState(1),[_,M]=g.useState([1,2,5,10]),[V,B]=g.useState(null),[R,O]=g.useState({open:!0}),[P,W]=g.useState(!1),[D,T]=g.useState(""),[L,F]=g.useState(""),[C,H]=g.useState(83.5),J=(t==null?void 0:t.isCrypto)||(t==null?void 0:t.segment)==="CRYPTO"||(t==null?void 0:t.exchange)==="BINANCE",ce=l[t==null?void 0:t.token]||{},U=J?(t==null?void 0:t.ltp)||0:ce.ltp||(t==null?void 0:t.ltp)||0,le=J?U:ce.bid||U,G=J?U:ce.ask||U,Q=J?"$":"",ge=ae=>!ae||!C?"0.00":(ae/C).toFixed(2);g.useEffect(()=>{J&&(async()=>{try{const{data:_e}=await I.get("/api/exchange-rate/usdinr");_e.rate&&H(_e.rate)}catch{console.log("Using default USD rate")}})()},[J]),g.useEffect(()=>{const ae=async()=>{try{if(J){O({open:!0,reason:"Crypto markets are 24/7"});const _e=await I.get("/api/trading/leverages",{headers:{Authorization:`Bearer ${a==null?void 0:a.token}`}});M(_e.data.leverages||[1,2,5,10])}else{const[_e,tt]=await Promise.all([I.get("/api/trading/leverages",{headers:{Authorization:`Bearer ${a==null?void 0:a.token}`}}),I.get("/api/trading/market-status",{params:{exchange:(t==null?void 0:t.exchange)||"NSE"}})]);M(_e.data.leverages||[1,2,5,10]),O(tt.data)}}catch(_e){console.error("Error fetching settings:",_e)}};a!=null&&a.token&&ae()},[a==null?void 0:a.token,t==null?void 0:t.exchange,J]),g.useEffect(()=>{U&&(h(U.toString()),y(U.toString()))},[t==null?void 0:t.token]);const ke=(t==null?void 0:t.segment)==="EQUITY"&&(t==null?void 0:t.instrumentType)==="STOCK";t==null||t.instrumentType;const pe=(t==null?void 0:t.instrumentType)==="FUTURES",De=(t==null?void 0:t.instrumentType)==="OPTIONS",qe=(t==null?void 0:t.optionType)==="CE",Je=(t==null?void 0:t.optionType)==="PE",oe=pe||De,Ce=(()=>{var _e;if(t!=null&&t.lotSize&&t.lotSize>1)return t.lotSize;const ae=((_e=t==null?void 0:t.category)==null?void 0:_e.toUpperCase())||"";return ae.includes("NIFTY")&&!ae.includes("BANK")&&!ae.includes("FIN")&&!ae.includes("MID")?25:ae.includes("BANKNIFTY")?15:ae.includes("FINNIFTY")?25:ae.includes("MIDCPNIFTY")?50:ae.includes("SENSEX")?10:1})(),Ne=oe?parseInt(d||0)*Ce:parseInt(d||0);g.useEffect(()=>{const _e=setTimeout(async()=>{if(!(!t||!d||!u))try{const{data:tt}=await I.post("/api/trading/margin-preview",{symbol:t.symbol,exchange:t.exchange,segment:t.segment,instrumentType:t.instrumentType,optionType:t.optionType||null,strikePrice:t.strike||null,category:t.category,productType:v,side:e.toUpperCase(),quantity:Ne,lots:parseInt(d),lotSize:Ce,price:parseFloat(u),leverage:j},{headers:{Authorization:`Bearer ${a==null?void 0:a.token}`}});B(tt)}catch(tt){console.error("Margin preview error:",tt)}},300);return()=>clearTimeout(_e)},[t,d,u,v,e,a,Ne,Ce,j]);const Ee=async()=>{var ae,_e,tt,qt,Ht;if(N==="MARKET"&&!R.open){T(R.reason||"Market is closed");return}if(V&&!V.canPlace){T(`Insufficient funds. Need ${(ae=V.shortfall)==null?void 0:ae.toLocaleString()} more`);return}W(!0),T(""),F("");try{const xt={symbol:t.symbol,token:t.token,pair:t.pair,isCrypto:J,exchange:t.exchange||(J?"BINANCE":"NSE"),segment:J?"CRYPTO":t.segment||(t.exchange==="MCX"?"MCX":"FNO"),instrumentType:J?"CRYPTO":t.instrumentType||"FUTURES",optionType:t.optionType||null,strike:t.strike||null,expiry:t.expiry||null,category:t.category,productType:v,orderType:N,side:e.toUpperCase(),quantity:Ne,lots:parseInt(d),lotSize:Ce,price:parseFloat(u),bidPrice:le,askPrice:G,leverage:j,stopLoss:f?parseFloat(f):null,target:p?parseFloat(p):null};console.log("Placing order:",xt),N==="LIMIT"&&(xt.limitPrice=parseFloat(x)),(N==="SL"||N==="SL-M")&&(xt.triggerPrice=parseFloat(x));const{data:Kt}=await I.post("/api/trading/order",xt,{headers:{Authorization:`Bearer ${a==null?void 0:a.token}`}}),ls=((_e=Kt.trade)==null?void 0:_e.status)==="PENDING"?`Order placed! Waiting for price to reach ${Q}${x}`:`Order executed! Margin: ${(tt=Kt.marginBlocked)==null?void 0:tt.toLocaleString()}`;F(ls),o&&o(),c&&c(),setTimeout(()=>{F(""),i()},2e3)}catch(xt){T(((Ht=(qt=xt.response)==null?void 0:qt.data)==null?void 0:Ht.message)||"Failed to place order")}finally{W(!1)}},Le=()=>J?[{value:"MIS",label:"Spot",desc:"Crypto spot trading"}]:ke?[{value:"CNC",label:"CNC (Delivery)",desc:"Hold for days/months"},{value:"MIS",label:"MIS (Intraday)",desc:"Square off same day"}]:pe||De?[{value:"MIS",label:"MIS (Intraday)",desc:"Square off same day"},{value:"NRML",label:"NRML (Carry Forward)",desc:"Hold till expiry"}]:[{value:"MIS",label:"MIS",desc:"Intraday"}],lt=()=>ke?"EQUITY":pe?"FUTURES":De?qe?"CALL OPTION (CE)":"PUT OPTION (PE)":"UNKNOWN",Te=()=>{if(J)return e==="buy"?" Buy crypto - Profit if price goes UP":" Sell crypto - Profit if price goes DOWN";if(ke)return e==="buy"?v==="CNC"?"Buy & hold shares in DEMAT":"Buy intraday, auto square-off at 3:15 PM":v==="MIS"?"Short sell intraday only":"Sell from holdings";if(pe)return e==="buy"?"Profit if price goes UP":"Profit if price goes DOWN";if(De){if(qe)return e==="buy"?"Bullish: Profit if price goes UP":"Bearish/Neutral: Collect premium";if(Je)return e==="buy"?"Bearish: Profit if price goes DOWN":"Bullish/Neutral: Collect premium"}return""};return n.jsxs("aside",{className:"w-full h-full bg-dark-800 border-l border-dark-600 flex flex-col overflow-hidden",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-dark-600",children:[n.jsxs("div",{children:[n.jsx("div",{className:`font-bold ${J?"text-orange-400":qe?"text-green-400":Je?"text-red-400":pe?"text-yellow-400":""}`,children:t==null?void 0:t.symbol}),n.jsxs("div",{className:"text-xs text-gray-400",children:[t==null?void 0:t.exchange,"  ",J?"CRYPTO":lt()]})]}),n.jsx("button",{onClick:i,className:"text-gray-400 hover:text-white",children:n.jsx(ve,{size:20})})]}),n.jsxs("div",{className:"flex border-b border-dark-600",children:[n.jsxs("button",{onClick:()=>s("sell"),className:`flex-1 py-2 font-semibold transition ${e==="sell"?"bg-red-600 text-white":"bg-dark-700 text-gray-400"}`,children:[n.jsx("div",{className:"text-xs opacity-70",children:J?"Price":"Bid"}),n.jsxs("div",{className:"text-lg",children:[Q,(le==null?void 0:le.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))||"--"]}),n.jsx("div",{className:"text-xs",children:"SELL"})]}),n.jsxs("button",{onClick:()=>s("buy"),className:`flex-1 py-2 font-semibold transition ${e==="buy"?"bg-green-600 text-white":"bg-dark-700 text-gray-400"}`,children:[n.jsx("div",{className:"text-xs opacity-70",children:J?"Price":"Ask"}),n.jsxs("div",{className:"text-lg",children:[Q,(G==null?void 0:G.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))||"--"]}),n.jsx("div",{className:"text-xs",children:"BUY"})]})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[n.jsx("div",{className:`text-xs p-2 rounded ${e==="buy"?"bg-blue-900/30 text-blue-300":"bg-red-900/30 text-red-300"}`,children:Te()}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-2",children:"Product Type"}),n.jsx("div",{className:"space-y-2",children:Le().map(ae=>n.jsxs("button",{onClick:()=>S(ae.value),className:`w-full text-left px-3 py-2 rounded border transition ${v===ae.value?"border-green-500 bg-green-500/10":"border-dark-600 hover:border-dark-500"}`,children:[n.jsx("div",{className:"font-medium text-sm",children:ae.label}),n.jsx("div",{className:"text-xs text-gray-500",children:ae.desc})]},ae.value))})]}),!R.open&&N==="MARKET"&&n.jsxs("div",{className:"bg-yellow-900/30 border border-yellow-500 text-yellow-300 px-3 py-2 rounded text-sm",children:[" ",R.reason||"Market is closed",". Use LIMIT order instead."]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-2",children:"Order Type"}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:["MARKET","LIMIT","SL","SL-M"].map(ae=>n.jsx("button",{onClick:()=>k(ae),disabled:ae==="MARKET"&&!R.open,className:`px-3 py-2 rounded text-sm transition ${N===ae?"bg-green-600 text-white":ae==="MARKET"&&!R.open?"bg-dark-700 text-gray-600 cursor-not-allowed":"bg-dark-700 text-gray-400 hover:bg-dark-600"}`,children:ae},ae))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-2",children:"Leverage (Buying Power)"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:_.map(ae=>n.jsxs("button",{onClick:()=>E(ae),className:`px-3 py-1.5 rounded text-sm transition ${j===ae?"bg-purple-600 text-white":"bg-dark-700 text-gray-400 hover:bg-dark-600"}`,children:[ae,"x"]},ae))}),j>1&&n.jsxs("div",{className:"text-xs text-purple-400 mt-1",children:[j,"x leverage = ",j,"x buying power, ",j,"x risk"]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-xs text-gray-400 mb-2",children:[oe?"Lots":"Quantity"," ",oe&&n.jsxs("span",{className:"text-yellow-400",children:["(1 Lot = ",Ce," qty)"]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>m(Math.max(1,parseInt(d||1)-1).toString()),className:"w-10 h-10 bg-dark-600 hover:bg-dark-500 rounded text-xl font-bold",children:"-"}),n.jsx("input",{type:"number",value:d,onChange:ae=>m(ae.target.value),className:"flex-1 bg-dark-700 border border-dark-600 rounded px-3 py-2 text-center text-lg font-bold focus:outline-none focus:border-green-500",min:"1"}),n.jsx("button",{onClick:()=>m((parseInt(d||1)+1).toString()),className:"w-10 h-10 bg-dark-600 hover:bg-dark-500 rounded text-xl font-bold",children:"+"})]}),oe&&n.jsxs("div",{className:"flex justify-between text-xs mt-2",children:[n.jsxs("span",{className:"text-gray-500",children:["Total Qty: ",n.jsx("span",{className:"text-white font-medium",children:Ne})]}),n.jsxs("span",{className:"text-gray-500",children:["Value: ",n.jsxs("span",{className:"text-white",children:[Q,(Ne*parseFloat(u||0)).toLocaleString()]})]})]}),oe&&n.jsx("div",{className:"flex gap-1 mt-2",children:[1,2,5,10,20].map(ae=>n.jsxs("button",{onClick:()=>m(ae.toString()),className:`flex-1 py-1 text-xs rounded ${d===ae.toString()?"bg-green-600":"bg-dark-600 hover:bg-dark-500"}`,children:[ae,"L"]},ae))})]}),(N==="LIMIT"||N==="SL")&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-2",children:N==="LIMIT"?"Limit Price":"Trigger Price"}),n.jsx("input",{type:"number",value:x,onChange:ae=>y(ae.target.value),placeholder:N==="LIMIT"?"Enter limit price":"Enter trigger price",className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 focus:outline-none focus:border-green-500"}),n.jsx("div",{className:"text-xs text-gray-500 mt-1",children:N==="LIMIT"?`Order executes when price ${e==="buy"?"falls to":"rises to"} ${Q}${x||"..."}`:`Order triggers when price ${e==="buy"?"rises to":"falls to"} ${Q}${x||"..."}`})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-2",children:"Stop Loss (Optional)"}),n.jsx("input",{type:"number",value:f,onChange:ae=>w(ae.target.value),placeholder:"SL Price",className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 text-sm focus:outline-none focus:border-red-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-2",children:"Target (Optional)"}),n.jsx("input",{type:"number",value:p,onChange:ae=>b(ae.target.value),placeholder:"Target Price",className:"w-full bg-dark-700 border border-dark-600 rounded px-3 py-2 text-sm focus:outline-none focus:border-green-500"})]})]}),(f||p)&&n.jsxs("div",{className:"text-xs text-gray-500",children:[f&&n.jsxs("span",{className:"text-red-400",children:["SL: ",Q,f]}),f&&p&&" | ",p&&n.jsxs("span",{className:"text-green-400",children:["Target: ",Q,p]})," - Auto exit when price hits"]}),D&&n.jsx("div",{className:"bg-red-900/30 border border-red-500 text-red-300 px-3 py-2 rounded text-sm",children:D}),L&&n.jsx("div",{className:"bg-green-900/30 border border-green-500 text-green-300 px-3 py-2 rounded text-sm",children:L}),n.jsxs("div",{className:"bg-dark-700 rounded p-3 space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-400",children:"Available Balance"}),n.jsx("span",{className:"text-green-400",children:J?`$${ge((V==null?void 0:V.availableBalance)||(r==null?void 0:r.availableMargin)||0)}`:`${((V==null?void 0:V.availableBalance)||(r==null?void 0:r.availableMargin)||0).toLocaleString()}`})]}),j>1&&n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-400",children:"Effective Buying Power"}),n.jsx("span",{className:"text-purple-400",children:J?`$${ge(((V==null?void 0:V.availableBalance)||0)*j)}`:`${(((V==null?void 0:V.availableBalance)||0)*j).toLocaleString()}`})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-400",children:"Required Margin"}),n.jsx("span",{className:(V==null?void 0:V.canPlace)===!1?"text-red-400":"",children:J?`$${ge((V==null?void 0:V.marginRequired)||0)}`:`${((ot=V==null?void 0:V.marginRequired)==null?void 0:ot.toLocaleString())||"--"}`})]}),V&&!V.canPlace&&n.jsxs("div",{className:"text-xs text-red-400 mt-2",children:[" ",V.reason]}),De&&e==="sell"&&n.jsx("div",{className:"text-xs text-yellow-400 mt-2",children:" Option selling requires higher margin (SPAN + Exposure)"})]})]}),n.jsxs("div",{className:"p-4 border-t border-dark-600",children:[n.jsx("button",{onClick:Ee,disabled:P||V&&!V.canPlace,className:`w-full py-3 rounded-lg font-semibold transition ${e==="buy"?"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-800":"bg-red-600 hover:bg-red-700 disabled:bg-red-800"} disabled:opacity-50 disabled:cursor-not-allowed`,children:P?"Placing Order...":`${e==="buy"?"BUY":"SELL"} ${t==null?void 0:t.symbol}`}),n.jsxs("div",{className:"text-center text-xs text-gray-500 mt-2",children:[v,"  ",N]})]})]})},c4=({selectedInstrument:t,onSelectInstrument:e,onBuySell:s,user:r,marketData:i={},onSegmentChange:a})=>{const[l,o]=g.useState([]),[c,d]=g.useState(""),[m,u]=g.useState(""),[h,x]=g.useState([]),[y,f]=g.useState(!0),[w,p]=g.useState([]),[b,v]=g.useState("NSE"),[S,N]=g.useState({}),k=g.useRef(null),j=O=>{v(O),a&&a(O)},E=[{id:"NSE",label:"NSE"},{id:"NSE_FO",label:"F&O"},{id:"MCX",label:"MCX"},{id:"Crypto",label:"Crypto"}];g.useEffect(()=>{const O=setTimeout(()=>{u(c)},150);return()=>clearTimeout(O)},[c]),g.useEffect(()=>{if(m.length>=1){const O=m.toLowerCase(),P=h.filter(W=>{var D,T,L;return((D=W.symbol)==null?void 0:D.toLowerCase().includes(O))||((T=W.name)==null?void 0:T.toLowerCase().includes(O))||((L=W.category)==null?void 0:L.toLowerCase().includes(O))}).slice(0,50);p(P)}else p([])},[m,h]),g.useEffect(()=>{_()},[r==null?void 0:r.token]);const _=async()=>{try{f(!0);const O=r!=null&&r.token?"/api/instruments/user":"/api/instruments/public",P=r!=null&&r.token?{Authorization:`Bearer ${r.token}`}:{},{data:W}=await I.get(O,{headers:P});x(W||[])}catch{try{const{data:P}=await I.get("/api/instruments/public");x(P||[])}catch(P){console.error("Error fetching instruments:",P)}}finally{f(!1)}};g.useEffect(()=>{const O=async()=>{try{const{data:W}=await I.get("/api/binance/prices");N(W||{})}catch{}};O();const P=setInterval(O,5e3);return()=>clearInterval(P)},[]);const V=(()=>{const O=c.toLowerCase();let P=h;switch(O&&(P=h.filter(W=>{var D,T;return((D=W.symbol)==null?void 0:D.toLowerCase().includes(O))||((T=W.name)==null?void 0:T.toLowerCase().includes(O))})),b){case"NSE":return P.filter(D=>D.exchange==="NSE"&&(D.instrumentType==="INDEX"||D.instrumentType==="STOCK"||D.segment==="EQUITY")||D.category==="INDICES"||D.category==="STOCKS");case"NSE_FO":return P.filter(D=>(D.exchange==="NFO"||D.segment==="FNO"||D.segment==="NFO")&&(D.instrumentType==="FUTURES"||D.instrumentType==="OPTIONS"));case"MCX":return P.filter(D=>D.exchange==="MCX"||D.segment==="MCX"||D.category==="MCX");case"Crypto":const W=P.filter(D=>D.isCrypto||D.segment==="CRYPTO"||D.category==="CRYPTO");if(Object.keys(S).length>0){const D=Object.values(S).map(T=>({_id:T.pair,symbol:T.symbol,name:T.pair,exchange:"BINANCE",token:T.pair,pair:T.pair,segment:"CRYPTO",category:"CRYPTO",instrumentType:"CRYPTO",isCrypto:!0,ltp:T.ltp,change:T.change,changePercent:T.changePercent}));return[...W,...D.filter(T=>!O||T.symbol.toLowerCase().includes(O)||T.name.toLowerCase().includes(O))]}return W;default:return P}})(),B=V.reduce((O,P)=>{const W=P.category||"OTHER";return O[W]||(O[W]=[]),O[W].push(P),O},{});Object.keys(B).sort();const R=O=>{const P=i[O];return P?{ltp:P.ltp,change:P.change,changePercent:P.changePercent}:{ltp:0,change:0,changePercent:0}};return n.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[n.jsx("div",{className:"flex gap-1 p-2 bg-dark-800 border-b border-dark-600 overflow-x-auto",children:E.map(O=>n.jsx("button",{onClick:()=>j(O.id),className:`px-3 py-1.5 text-xs font-medium rounded whitespace-nowrap transition ${b===O.id?"bg-green-600 text-white":"bg-dark-700 text-gray-400 hover:bg-dark-600 hover:text-white"}`,children:O.label},O.id))}),n.jsx("div",{className:"p-3 bg-dark-800 border-b border-dark-600",children:n.jsxs("div",{className:"relative",children:[n.jsx(Jn,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),n.jsx("input",{ref:k,type:"text",placeholder:"Search NIFTY, BANKNIFTY...",value:c,onChange:O=>d(O.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg pl-10 pr-10 py-2 text-sm focus:outline-none focus:border-green-500"}),c&&n.jsx("button",{onClick:()=>{var O;d(""),(O=k.current)==null||O.focus()},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white",children:n.jsx(ve,{size:16})})]})}),c.length>=1&&n.jsx("div",{className:"flex-1 overflow-y-auto",children:w.length===0?n.jsxs("div",{className:"p-4 text-center text-gray-500 text-sm",children:['No instruments found for "',c,'"']}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"px-4 py-2 text-xs text-gray-500 bg-dark-700 sticky top-0",children:[w.length," results"]}),w.map(O=>{const P=R(O.token);return n.jsx(dx,{instrument:{...O,...P},isCall:O.optionType==="CE",isPut:O.optionType==="PE",isFuture:O.instrumentType==="FUTURES",isCrypto:O.isCrypto||O.segment==="CRYPTO"||O.exchange==="BINANCE",onSelect:()=>{e({...O,...P}),d("")},onBuy:()=>s("buy",{...O,...P}),onSell:()=>s("sell",{...O,...P})},O._id)})]})}),!c&&n.jsx("div",{className:"flex-1 overflow-y-auto",children:y?n.jsxs("div",{className:"p-4 text-center text-gray-400",children:[n.jsx(fe,{className:"animate-spin inline mr-2",size:16}),"Loading..."]}):V.length===0?n.jsxs("div",{className:"p-4 text-center text-gray-500 text-sm",children:[n.jsx("p",{children:"No instruments found"}),n.jsx("p",{className:"mt-2 text-xs",children:b==="Crypto"?"Loading crypto from Binance...":"Try a different segment or search"})]}):V.map(O=>{const P=O.isCrypto?O:R(O.token);return n.jsx(dx,{instrument:{...O,ltp:P.ltp||O.ltp||0,change:P.change||O.change||0,changePercent:P.changePercent||O.changePercent||0},isCall:O.optionType==="CE",isPut:O.optionType==="PE",isFuture:O.instrumentType==="FUTURES",isCrypto:O.isCrypto||O.segment==="CRYPTO"||O.exchange==="BINANCE",onSelect:()=>e({...O,ltp:P.ltp||O.ltp||0}),onBuy:()=>s("buy",{...O,ltp:P.ltp||O.ltp||0}),onSell:()=>s("sell",{...O,ltp:P.ltp||O.ltp||0})},O._id||O.pair||`${O.exchange}-${O.symbol}`)})})]})},dx=({instrument:t,isCall:e,isPut:s,isFuture:r,isCrypto:i,onSelect:a,onBuy:l,onSell:o})=>{const c=t.ltp||0,d=t.change||0,m=t.changePercent||0,u=i||t.isCrypto||t.segment==="CRYPTO"||t.exchange==="BINANCE",h=()=>u?"text-orange-400":e||t.optionType==="CE"?"text-green-400":s||t.optionType==="PE"?"text-red-400":r||t.instrumentType==="FUTURES"?"text-yellow-400":"text-white",x=y=>!y||y<=0?"--":u?`$${y.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`:`${y.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`;return n.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-dark-700",children:[n.jsxs("div",{className:"flex-1",onClick:a,children:[n.jsx("div",{className:`font-medium text-sm ${h()}`,children:t.symbol}),n.jsxs("div",{className:"text-xs text-gray-500",children:[t.exchange," ",t.strike?` ${t.strike}`:""]})]}),n.jsxs("div",{className:"text-right mr-3",onClick:a,children:[n.jsx("div",{className:`font-mono text-sm ${d>=0?"text-green-400":"text-red-400"}`,children:x(c)}),n.jsx("div",{className:`text-xs ${d>=0?"text-green-400":"text-red-400"}`,children:m?`${d>=0?"+":""}${parseFloat(m).toFixed(2)}%`:"--"})]}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx("button",{onClick:o,className:"px-3 py-1.5 text-xs bg-red-600 hover:bg-red-700 rounded font-medium",children:"S"}),n.jsx("button",{onClick:l,className:"px-3 py-1.5 text-xs bg-green-600 hover:bg-green-700 rounded font-medium",children:"B"})]})]})},d4=({selectedInstrument:t,onBuySell:e,onBack:s,marketData:r={}})=>{var d;const i=g.useRef(null),a=g.useRef(null),l=g.useRef(null),o=g.useRef(null),c=t!=null&&t.token&&r[t.token]?r[t.token]:null;return g.useEffect(()=>{if(!i.current||!t)return;const m=Hg(i.current,{layout:{background:{color:"#111111"},textColor:"#d1d5db"},grid:{vertLines:{color:"#1f1f1f"},horzLines:{color:"#1f1f1f"}},rightPriceScale:{borderColor:"#2a2a2a"},timeScale:{borderColor:"#2a2a2a",timeVisible:!0}});a.current=m;const u=m.addCandlestickSeries({upColor:"#22c55e",downColor:"#ef4444",borderDownColor:"#ef4444",borderUpColor:"#22c55e",wickDownColor:"#ef4444",wickUpColor:"#22c55e"});l.current=u;const h=t.ltp||100,x=[],y=Math.floor(Date.now()/1e3);for(let w=100;w>=0;w--){const p=y-w*900,b=h*.01,v=h+(Math.random()-.5)*b,S=v+(Math.random()-.5)*b,N=Math.max(v,S)+Math.random()*b*.3,k=Math.min(v,S)-Math.random()*b*.3;x.push({time:p,open:v,high:N,low:k,close:S})}u.setData(x),o.current=x[x.length-1];const f=()=>{i.current&&m.applyOptions({width:i.current.clientWidth,height:i.current.clientHeight})};return window.addEventListener("resize",f),f(),()=>{window.removeEventListener("resize",f),m.remove()}},[t]),g.useEffect(()=>{if(l.current&&o.current&&(c!=null&&c.ltp))try{const m=Math.floor(Date.now()/1e3),u=Math.floor(m/900)*900,h=typeof o.current.time=="number"?o.current.time:Math.floor(Date.now()/1e3);if(u>=h)if(h===u){const x={time:u,open:o.current.open,high:Math.max(o.current.high,c.ltp),low:Math.min(o.current.low,c.ltp),close:c.ltp};o.current=x,l.current.update(x)}else{const x={time:u,open:c.ltp,high:c.ltp,low:c.ltp,close:c.ltp};o.current=x,l.current.update(x)}}catch(m){console.warn("Chart update error:",m.message)}},[c]),n.jsxs("div",{className:"flex-1 flex flex-col bg-dark-800",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-dark-600",children:[n.jsx("button",{onClick:s,className:"text-gray-400",children:n.jsx(Tn,{size:20,className:"rotate-180"})}),t?n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"font-medium text-green-400",children:t.symbol}),n.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs",children:[n.jsx("span",{className:"text-gray-400",children:t.exchange}),c&&n.jsxs(n.Fragment,{children:[n.jsxs("span",{className:`font-mono font-bold ${c.change>=0?"text-green-400":"text-red-400"}`,children:["",(d=c.ltp)==null?void 0:d.toLocaleString()]}),n.jsxs("span",{className:`${c.change>=0?"text-green-400":"text-red-400"}`,children:[c.change>=0?"+":"",parseFloat(c.changePercent||0).toFixed(2),"%"]})]})]})]}):n.jsx("span",{className:"text-gray-400",children:"Select Instrument"}),n.jsx("div",{className:"w-5"})]}),n.jsx("div",{className:"flex-1 relative min-h-[250px]",children:t?n.jsx("div",{ref:i,className:"absolute inset-0"}):n.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-gray-400",children:[n.jsx(fe,{size:40,className:"mb-4 opacity-30"}),n.jsx("p",{className:"text-sm",children:"Select an instrument"})]})}),t&&n.jsx("div",{className:"flex items-center justify-center gap-2 px-4 py-2 border-t border-dark-600",children:["1m","5m","15m","1h","1d"].map(m=>n.jsx("button",{className:"px-3 py-1 text-sm text-gray-400 hover:bg-dark-600 rounded",children:m},m))}),t&&n.jsxs("div",{className:"flex gap-3 p-4 border-t border-dark-600",children:[n.jsx("button",{onClick:()=>e("sell",t),className:"flex-1 py-3 bg-red-600 hover:bg-red-700 rounded-lg font-semibold",children:"SELL"}),n.jsx("button",{onClick:()=>e("buy",t),className:"flex-1 py-3 bg-blue-600 hover:bg-blue-700 rounded-lg font-semibold",children:"BUY"})]})]})},ux=({activeTab:t,user:e,marketData:s})=>{const[r,i]=g.useState(t),[a,l]=g.useState([]),[o,c]=g.useState([]),[d,m]=g.useState([]),[u,h]=g.useState(!1);g.useEffect(()=>{if(e!=null&&e.token){x();const p=setInterval(x,5e3);return()=>clearInterval(p)}},[e==null?void 0:e.token,r]);const x=async()=>{try{const p={Authorization:`Bearer ${e.token}`};if(r==="positions"){const{data:b}=await I.get("/api/trading/positions?status=OPEN",{headers:p});l(b||[])}else if(r==="pending"){const{data:b}=await I.get("/api/trading/pending-orders",{headers:p});c(b||[])}else{const{data:b}=await I.get("/api/trading/history",{headers:p});m(b||[])}}catch(p){console.error("Error:",p)}},y=async(p,b)=>{var v,S;try{h(!0);const N=s[b==null?void 0:b.token]||{},k=N.bid||N.ltp||(b==null?void 0:b.currentPrice),j=N.ask||N.ltp||(b==null?void 0:b.currentPrice);await I.post(`/api/trading/close/${p}`,{bidPrice:k,askPrice:j},{headers:{Authorization:`Bearer ${e.token}`}}),x()}catch(N){alert(((S=(v=N.response)==null?void 0:v.data)==null?void 0:S.message)||"Error")}finally{h(!1)}},f=p=>{const b=p.token,v=p.symbol,S=p.side;let N=null;if(b&&(s!=null&&s[b]))N=s[b];else if(v&&(s!=null&&s[v]))N=s[v];else for(const[k,j]of Object.entries(s||{}))if(j.symbol===v){N=j;break}return N?S==="BUY"?N.bid||N.ltp||N.last_price||0:N.ask||N.ltp||N.last_price||0:0},w=r==="positions"?a:r==="pending"?o:d;return n.jsxs("div",{className:"flex-1 flex flex-col bg-dark-800",children:[n.jsx("div",{className:"flex border-b border-dark-600",children:["positions","pending","history"].map(p=>n.jsxs("button",{onClick:()=>i(p),className:`flex-1 py-3 text-sm capitalize ${r===p?"text-green-400 border-b-2 border-green-500":"text-gray-400"}`,children:[p," (",p==="positions"?a.length:p==="pending"?o.length:d.length,")"]},p))}),n.jsx("div",{className:"flex-1 overflow-y-auto",children:w.length===0?n.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-400 h-full",children:n.jsxs("div",{className:"text-center py-8",children:[n.jsx(Ge,{size:48,className:"mx-auto mb-4 opacity-30"}),n.jsxs("p",{children:["No ",r==="positions"?"open positions":r==="pending"?"pending orders":"trade history"]})]})}):n.jsx("div",{className:"divide-y divide-dark-700",children:w.map(p=>{var S,N;const b=f(p)||p.currentPrice||p.entryPrice,v=p.side==="BUY"?(b-p.entryPrice)*p.quantity:(p.entryPrice-b)*p.quantity;return n.jsxs("div",{className:"p-3",children:[n.jsxs("div",{className:"flex justify-between items-start mb-2",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:p.symbol}),n.jsxs("div",{className:`text-xs ${p.side==="BUY"?"text-green-400":"text-red-400"}`,children:[p.side,"  ",p.quantity," qty"]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:`font-medium ${(r==="history"?p.realizedPnL:v)>=0?"text-green-400":"text-red-400"}`,children:[(r==="history"?p.realizedPnL:v)>=0?"+":"","",(S=r==="history"?p.realizedPnL:v)==null?void 0:S.toFixed(2)]}),n.jsxs("div",{className:"text-xs text-gray-400",children:["Entry: ",(N=p.entryPrice)==null?void 0:N.toFixed(2)]})]})]}),n.jsxs("div",{className:"flex justify-between items-center text-xs",children:[n.jsxs("div",{className:"text-yellow-400",children:["Spread: ",p.spread||0," pts | Comm: ",(p.commission||0).toFixed(2)]}),r==="positions"&&n.jsx("button",{onClick:()=>y(p._id,p),disabled:u,className:"px-3 py-1 bg-red-600 rounded text-white",children:"Close"})]})]},p._id)})})})]})},u4=({user:t})=>{const[e,s]=g.useState([]),[r,i]=g.useState(!0);g.useEffect(()=>{a();const o=setInterval(a,5e3);return()=>clearInterval(o)},[t==null?void 0:t.token]);const a=async()=>{try{const o={Authorization:`Bearer ${t.token}`},[c,d]=await Promise.all([I.get("/api/trading/history?limit=20",{headers:o}),I.get("/api/user-funds/my-requests",{headers:o}).catch(()=>({data:[]}))]),m=(c.data||[]).map(h=>{var x;return{id:h._id,type:"trade",title:`${h.side} ${h.symbol}`,message:`${h.quantity} qty @ ${(x=h.entryPrice)==null?void 0:x.toLocaleString()}`,pnl:h.realizedPnL||0,status:h.closeReason||"CLOSED",time:new Date(h.closedAt||h.createdAt),icon:h.realizedPnL>=0?"":""}}),u=(d.data||[]).map(h=>{var x;return{id:h._id,type:"fund",title:h.type==="DEPOSIT"?"Deposit Request":"Withdrawal Request",message:`${(x=h.amount)==null?void 0:x.toLocaleString()}`,status:h.status,time:new Date(h.updatedAt||h.createdAt),icon:h.type==="DEPOSIT"?"":""}});s([...m,...u].sort((h,x)=>x.time-h.time))}catch(o){console.error("Error fetching notifications:",o)}finally{i(!1)}},l=o=>{const c=Date.now()-o,d=Math.floor(c/6e4);if(d<60)return`${d}m ago`;const m=Math.floor(c/36e5);return m<24?`${m}h ago`:o.toLocaleDateString()};return r?n.jsx("div",{className:"flex-1 flex items-center justify-center",children:n.jsx(fe,{size:24,className:"animate-spin text-gray-400"})}):n.jsx("div",{className:"flex-1 overflow-y-auto",children:e.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-gray-400",children:[n.jsx(so,{size:48,className:"mb-4 opacity-30"}),n.jsx("p",{children:"No notifications"})]}):n.jsx("div",{className:"divide-y divide-dark-700",children:e.map(o=>n.jsx("div",{className:"p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("span",{className:"text-xl",children:o.icon}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("p",{className:"font-medium text-sm",children:o.title}),n.jsx("span",{className:"text-xs text-gray-500",children:l(o.time)})]}),n.jsx("p",{className:"text-sm text-gray-400",children:o.message}),o.type==="trade"?n.jsxs("span",{className:`text-sm ${o.pnl>=0?"text-green-400":"text-red-400"}`,children:["P&L: ",o.pnl>=0?"+":"","",o.pnl.toFixed(2)]}):n.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${o.status==="APPROVED"?"text-green-400 bg-green-900/30":o.status==="REJECTED"?"text-red-400 bg-red-900/30":"text-yellow-400 bg-yellow-900/30"}`,children:o.status})]})]})},o.id))})})},h4=({user:t,walletData:e,onLogout:s})=>{var h,x,y;const[r,i]=g.useState("menu"),[a,l]=g.useState([]),[o,c]=g.useState([]),[d,m]=g.useState(!1);g.useEffect(()=>{if(r==="history"){u();const f=setInterval(u,2e3);return()=>clearInterval(f)}},[r,t==null?void 0:t.token]);const u=async()=>{try{m(!0);const f={Authorization:`Bearer ${t.token}`},[w,p]=await Promise.all([I.get("/api/trading/history",{headers:f}),I.get("/api/user-funds/my-requests",{headers:f}).catch(()=>({data:[]}))]);c(w.data||[]),l(p.data||[])}catch(f){console.error("Error fetching history:",f)}finally{m(!1)}};return r==="history"?n.jsxs("div",{className:"flex-1 flex flex-col bg-dark-800",children:[n.jsxs("div",{className:"flex items-center gap-3 p-4 border-b border-dark-600",children:[n.jsx("button",{onClick:()=>i("menu"),className:"text-gray-400",children:n.jsx(Tn,{size:20,className:"rotate-180"})}),n.jsx("h2",{className:"font-bold",children:"Transaction History"})]}),n.jsx("div",{className:"flex-1 overflow-y-auto",children:d&&o.length===0?n.jsx("div",{className:"flex items-center justify-center h-32",children:n.jsx(fe,{size:24,className:"animate-spin text-gray-400"})}):n.jsxs(n.Fragment,{children:[a.length>0&&n.jsxs("div",{className:"p-4 border-b border-dark-600",children:[n.jsx("h3",{className:"text-sm text-gray-400 mb-3",children:"Fund Requests"}),a.slice(0,5).map(f=>{var w;return n.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-dark-700 last:border-0",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-sm",children:f.type}),n.jsx("p",{className:"text-xs text-gray-400",children:new Date(f.createdAt).toLocaleDateString()})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("p",{className:`font-medium ${f.type==="DEPOSIT"?"text-green-400":"text-red-400"}`,children:[f.type==="DEPOSIT"?"+":"-","",(w=f.amount)==null?void 0:w.toLocaleString()]}),n.jsx("p",{className:`text-xs ${f.status==="APPROVED"?"text-green-400":f.status==="REJECTED"?"text-red-400":"text-yellow-400"}`,children:f.status})]})]},f._id)})]}),n.jsxs("div",{className:"p-4",children:[n.jsx("h3",{className:"text-sm text-gray-400 mb-3",children:"Trade History"}),o.length===0?n.jsx("p",{className:"text-center text-gray-500 py-8",children:"No trade history"}):o.slice(0,20).map(f=>n.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-dark-700 last:border-0",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-sm",children:f.symbol}),n.jsxs("p",{className:"text-xs text-gray-400",children:[f.side,"  ",f.quantity," qty  ",new Date(f.closedAt||f.createdAt).toLocaleDateString()]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("p",{className:`font-medium ${(f.realizedPnL||0)>=0?"text-green-400":"text-red-400"}`,children:[(f.realizedPnL||0)>=0?"+":"","",(f.realizedPnL||0).toFixed(2)]}),n.jsx("p",{className:"text-xs text-gray-400",children:f.closeReason||"CLOSED"})]})]},f._id))]})]})})]}):r==="notifications"?n.jsxs("div",{className:"flex-1 flex flex-col bg-dark-800",children:[n.jsxs("div",{className:"flex items-center gap-3 p-4 border-b border-dark-600",children:[n.jsx("button",{onClick:()=>i("menu"),className:"text-gray-400",children:n.jsx(Tn,{size:20,className:"rotate-180"})}),n.jsx("h2",{className:"font-bold",children:"Notifications"})]}),n.jsx(u4,{user:t})]}):r==="settings"?n.jsxs("div",{className:"flex-1 flex flex-col bg-dark-800",children:[n.jsxs("div",{className:"flex items-center gap-3 p-4 border-b border-dark-600",children:[n.jsx("button",{onClick:()=>i("menu"),className:"text-gray-400",children:n.jsx(Tn,{size:20,className:"rotate-180"})}),n.jsx("h2",{className:"font-bold",children:"Settings"})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[n.jsxs("div",{className:"bg-dark-700 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium mb-3",children:"Account Info"}),n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Username"}),n.jsx("span",{children:t==null?void 0:t.username})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Email"}),n.jsx("span",{children:t==null?void 0:t.email})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"User ID"}),n.jsx("span",{className:"font-mono text-xs",children:t==null?void 0:t.userId})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Admin Code"}),n.jsx("span",{className:"font-mono text-xs",children:t==null?void 0:t.adminCode})]})]})]}),n.jsxs("div",{className:"bg-dark-700 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium mb-3",children:"Trading Settings"}),n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Trading Status"}),n.jsx("span",{className:(t==null?void 0:t.tradingStatus)==="ACTIVE"?"text-green-400":"text-red-400",children:(t==null?void 0:t.tradingStatus)||"ACTIVE"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Account Status"}),n.jsx("span",{className:t!=null&&t.isActive?"text-green-400":"text-red-400",children:t!=null&&t.isActive?"Active":"Inactive"})]})]})]}),n.jsxs("div",{className:"bg-dark-700 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium mb-3",children:"App Info"}),n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Version"}),n.jsx("span",{children:"1.0.0"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Platform"}),n.jsx("span",{children:"Web"})]})]})]})]})]}):n.jsxs("div",{className:"flex-1 flex flex-col bg-dark-800",children:[n.jsxs("div",{className:"p-6 text-center border-b border-dark-600",children:[n.jsx("div",{className:"w-20 h-20 bg-green-600 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(jw,{size:48})}),n.jsx("h2",{className:"text-xl font-bold",children:(t==null?void 0:t.fullName)||(t==null?void 0:t.username)}),n.jsxs("p",{className:"text-gray-400 text-sm",children:["@",t==null?void 0:t.username]})]}),n.jsx("div",{className:"p-4 border-b border-dark-600",children:n.jsxs("div",{className:"bg-dark-700 rounded-xl p-4",children:[n.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Trading Balance"}),n.jsxs("p",{className:"text-2xl font-bold text-green-400",children:["",((e==null?void 0:e.tradingBalance)||((h=e==null?void 0:e.wallet)==null?void 0:h.tradingBalance)||0).toLocaleString()]}),n.jsxs("div",{className:"flex justify-between mt-2 text-sm",children:[n.jsx("span",{className:"text-gray-400",children:"Available Margin"}),n.jsxs("span",{className:"text-green-400",children:["",((x=e==null?void 0:e.availableMargin)==null?void 0:x.toLocaleString())||"0.00"]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-400",children:"Used Margin"}),n.jsxs("span",{className:"text-yellow-400",children:["",((y=e==null?void 0:e.usedMargin)==null?void 0:y.toLocaleString())||"0.00"]})]})]})}),n.jsxs("div",{className:"flex-1 p-4",children:[n.jsxs("button",{onClick:()=>i("settings"),className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-dark-700 rounded-lg text-left",children:[n.jsx(ts,{size:20,className:"text-gray-400"}),n.jsx("span",{children:"Settings"}),n.jsx(Tn,{size:16,className:"ml-auto text-gray-500"})]}),n.jsxs("button",{onClick:()=>i("notifications"),className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-dark-700 rounded-lg text-left",children:[n.jsx(so,{size:20,className:"text-gray-400"}),n.jsx("span",{children:"Notifications"}),n.jsx(Tn,{size:16,className:"ml-auto text-gray-500"})]}),n.jsxs("button",{onClick:()=>i("history"),className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-dark-700 rounded-lg text-left",children:[n.jsx(hg,{size:20,className:"text-gray-400"}),n.jsx("span",{children:"Transaction History"}),n.jsx(Tn,{size:16,className:"ml-auto text-gray-500"})]})]}),n.jsx("div",{className:"p-4 border-t border-dark-600",children:n.jsxs("button",{onClick:s,className:"w-full flex items-center justify-center gap-2 py-3 bg-red-600 hover:bg-red-700 rounded-lg font-medium",children:[n.jsx(jr,{size:20}),"Logout"]})})]})},m4=({onClose:t,user:e})=>{const[s,r]=g.useState([]),[i,a]=g.useState(!0),[l,o]=g.useState("all");g.useEffect(()=>{c();const x=setInterval(c,5e3);return()=>clearInterval(x)},[e==null?void 0:e.token]);const c=async()=>{try{const x={Authorization:`Bearer ${e.token}`},[y,f,w]=await Promise.all([I.get("/api/trading/history?limit=20",{headers:x}),I.get("/api/user-funds/my-requests",{headers:x}).catch(()=>({data:[]})),I.get("/api/notifications/user",{headers:x}).catch(()=>({data:[]}))]),p=(y.data||[]).map(N=>{var k,j;return{id:N._id,type:"trade",title:`${N.side} ${N.symbol}`,message:`${N.quantity} qty @ ${(k=N.entryPrice)==null?void 0:k.toLocaleString()}  ${(j=N.exitPrice)==null?void 0:j.toLocaleString()}`,pnl:N.realizedPnL||0,status:N.closeReason||"CLOSED",time:new Date(N.closedAt||N.createdAt),icon:N.realizedPnL>=0?"":""}}),b=(f.data||[]).map(N=>{var k;return{id:N._id,type:"fund",title:N.type==="DEPOSIT"?"Deposit Request":"Withdrawal Request",message:`${(k=N.amount)==null?void 0:k.toLocaleString()}`,status:N.status,time:new Date(N.updatedAt||N.createdAt),icon:N.type==="DEPOSIT"?"":"",isDeposit:N.type==="DEPOSIT"}}),v=(w.data||[]).map(N=>({id:N._id,type:"announcement",title:N.title,subject:N.subject,message:N.description,image:N.image,time:new Date(N.createdAt),icon:"",isRead:N.isRead})),S=[...p,...b,...v].sort((N,k)=>k.time-N.time);r(S)}catch(x){console.error("Error fetching notifications:",x)}finally{a(!1)}},d=async x=>{try{await I.put(`/api/notifications/${x}/read`,{},{headers:{Authorization:`Bearer ${e.token}`}}),r(y=>y.map(f=>f.id===x?{...f,isRead:!0}:f))}catch(y){console.error("Error marking notification as read:",y)}},m=s.filter(x=>l==="all"?!0:l==="trades"?x.type==="trade":l==="funds"?x.type==="fund":l==="announcements"?x.type==="announcement":!0),u=x=>{switch(x){case"APPROVED":return"text-green-400";case"REJECTED":return"text-red-400";case"PENDING":return"text-yellow-400";case"MANUAL":case"CLOSED":return"text-gray-400";case"SL_HIT":return"text-red-400";case"TARGET_HIT":return"text-green-400";default:return"text-gray-400"}},h=x=>{const f=new Date-x,w=Math.floor(f/6e4),p=Math.floor(f/36e5),b=Math.floor(f/864e5);return w<1?"Just now":w<60?`${w}m ago`:p<24?`${p}h ago`:b<7?`${b}d ago`:x.toLocaleDateString()};return n.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-dark-800 rounded-xl w-full max-w-md max-h-[90vh] overflow-hidden",children:[n.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-dark-600",children:[n.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[n.jsx(so,{size:20})," Notifications"]}),n.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white",children:n.jsx(ve,{size:24})})]}),n.jsx("div",{className:"flex border-b border-dark-600",children:[{id:"all",label:"All"},{id:"announcements",label:"Announcements"},{id:"trades",label:"Trades"},{id:"funds",label:"Funds"}].map(x=>n.jsx("button",{onClick:()=>o(x.id),className:`flex-1 py-2 text-sm font-medium ${l===x.id?"text-green-400 border-b-2 border-green-400":"text-gray-400"}`,children:x.label},x.id))}),n.jsx("div",{className:"overflow-y-auto max-h-[60vh]",children:i?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(fe,{size:24,className:"animate-spin text-gray-400"})}):m.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-gray-400",children:[n.jsx(so,{size:48,className:"mb-4 opacity-30"}),n.jsx("p",{children:"No notifications"})]}):n.jsx("div",{className:"divide-y divide-dark-700",children:m.map(x=>n.jsx("div",{className:`p-4 hover:bg-dark-700/50 ${x.type==="announcement"&&!x.isRead?"bg-orange-900/10 border-l-2 border-orange-500":""}`,onClick:()=>x.type==="announcement"&&!x.isRead&&d(x.id),children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("span",{className:"text-2xl",children:x.icon}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("p",{className:`font-medium text-sm ${x.type==="announcement"&&!x.isRead?"text-orange-400":""}`,children:x.title}),n.jsx("span",{className:"text-xs text-gray-500",children:h(x.time)})]}),x.type==="announcement"&&x.subject&&n.jsx("p",{className:"text-sm text-gray-300 mt-0.5 font-medium",children:x.subject}),n.jsx("p",{className:"text-sm text-gray-400 mt-0.5",children:x.message}),x.type==="announcement"&&x.image&&n.jsx("img",{src:x.image,alt:"Notification",className:"mt-2 rounded-lg max-h-32 object-cover"}),n.jsxs("div",{className:"flex items-center justify-between mt-1",children:[x.type==="trade"?n.jsxs("span",{className:`text-sm font-medium ${x.pnl>=0?"text-green-400":"text-red-400"}`,children:["P&L: ",x.pnl>=0?"+":"","",x.pnl.toFixed(2)]}):x.type==="fund"?n.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${u(x.status)} bg-dark-600`,children:x.status}):x.type==="announcement"?n.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${x.isRead?"text-gray-500 bg-dark-600":"text-orange-400 bg-orange-900/30"}`,children:x.isRead?"Read":"New"}):null,x.type==="trade"&&n.jsx("span",{className:`text-xs ${u(x.status)}`,children:x.status})]})]})]})},x.id))})})]})})},p4=({onClose:t,user:e})=>{const[s,r]=g.useState("account"),[i,a]=g.useState(""),[l,o]=g.useState(""),[c,d]=g.useState(""),[m,u]=g.useState(!1),[h,x]=g.useState(null),y=async()=>{var f,w;if(!i||!l||!c){x({type:"error",text:"Please fill all fields"});return}if(l!==c){x({type:"error",text:"New passwords do not match"});return}if(l.length<6){x({type:"error",text:"Password must be at least 6 characters"});return}try{u(!0),await I.post("/api/user/change-password",{oldPassword:i,newPassword:l},{headers:{Authorization:`Bearer ${e.token}`}}),x({type:"success",text:"Password changed successfully!"}),a(""),o(""),d("")}catch(p){x({type:"error",text:((w=(f=p.response)==null?void 0:f.data)==null?void 0:w.message)||"Failed to change password"})}finally{u(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-dark-800 rounded-xl w-full max-w-md max-h-[90vh] overflow-hidden",children:[n.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-dark-600",children:[n.jsx("h2",{className:"text-lg font-bold",children:"Settings"}),n.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white",children:n.jsx(ve,{size:24})})]}),n.jsxs("div",{className:"flex border-b border-dark-600",children:[n.jsx("button",{onClick:()=>r("account"),className:`flex-1 py-3 text-sm font-medium ${s==="account"?"text-green-400 border-b-2 border-green-400":"text-gray-400"}`,children:"Account"}),n.jsx("button",{onClick:()=>r("password"),className:`flex-1 py-3 text-sm font-medium ${s==="password"?"text-green-400 border-b-2 border-green-400":"text-gray-400"}`,children:"Change Password"})]}),n.jsxs("div",{className:"p-4 overflow-y-auto max-h-[60vh]",children:[s==="account"&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-dark-700 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium mb-3",children:"Account Information"}),n.jsxs("div",{className:"space-y-3 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Username"}),n.jsx("span",{children:e==null?void 0:e.username})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Full Name"}),n.jsx("span",{children:(e==null?void 0:e.fullName)||"-"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Email"}),n.jsx("span",{children:(e==null?void 0:e.email)||"-"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Phone"}),n.jsx("span",{children:(e==null?void 0:e.phone)||"-"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"User ID"}),n.jsx("span",{className:"font-mono text-xs",children:e==null?void 0:e.userId})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Admin Code"}),n.jsx("span",{className:"font-mono text-xs",children:e==null?void 0:e.adminCode})]})]})]}),n.jsxs("div",{className:"bg-dark-700 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium mb-3",children:"Trading Status"}),n.jsxs("div",{className:"space-y-3 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Status"}),n.jsx("span",{className:(e==null?void 0:e.tradingStatus)==="ACTIVE"?"text-green-400":"text-red-400",children:(e==null?void 0:e.tradingStatus)||"ACTIVE"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Account"}),n.jsx("span",{className:(e==null?void 0:e.isActive)!==!1?"text-green-400":"text-red-400",children:(e==null?void 0:e.isActive)!==!1?"Active":"Inactive"})]})]})]})]}),s==="password"&&n.jsxs("div",{className:"space-y-4",children:[h&&n.jsx("div",{className:`p-3 rounded-lg text-sm ${h.type==="error"?"bg-red-900/50 text-red-400":"bg-green-900/50 text-green-400"}`,children:h.text}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Current Password"}),n.jsx("input",{type:"password",value:i,onChange:f=>a(f.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-3 py-2 focus:outline-none focus:border-green-500",placeholder:"Enter current password"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"New Password"}),n.jsx("input",{type:"password",value:l,onChange:f=>o(f.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-3 py-2 focus:outline-none focus:border-green-500",placeholder:"Enter new password (min 6 chars)"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Confirm New Password"}),n.jsx("input",{type:"password",value:c,onChange:f=>d(f.target.value),className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-3 py-2 focus:outline-none focus:border-green-500",placeholder:"Confirm new password"})]}),n.jsx("button",{onClick:y,disabled:m,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-gray-600 py-3 rounded-lg font-medium transition",children:m?"Changing...":"Change Password"})]})]})]})})},x4=({onClose:t,walletData:e,user:s,onRefresh:r})=>{var _,M,V,B;const[i,a]=g.useState("deposit"),[l,o]=g.useState(""),[c,d]=g.useState(""),[m,u]=g.useState(""),[h,x]=g.useState(!1),[y,f]=g.useState(null),[w,p]=g.useState(null),[b,v]=g.useState(null);g.useEffect(()=>{S()},[]);const S=async()=>{try{const{data:R}=await I.get("/api/user-funds/admin-bank-accounts",{headers:{Authorization:`Bearer ${s.token}`}}),O=R.find(W=>W.type==="BANK"&&W.isPrimary)||R.find(W=>W.type==="BANK"),P=R.find(W=>W.type==="UPI"&&W.isPrimary)||R.find(W=>W.type==="UPI");v({bankName:(O==null?void 0:O.bankName)||"Not configured",accountName:(O==null?void 0:O.holderName)||"Not configured",accountNumber:(O==null?void 0:O.accountNumber)||"Not configured",ifscCode:(O==null?void 0:O.ifsc)||"Not configured",upiId:(P==null?void 0:P.upiId)||"Not configured",upiName:(P==null?void 0:P.holderName)||"Not configured"})}catch(R){console.error("Error fetching bank details:",R);try{const{data:O}=await I.get("/api/user/bank-details",{headers:{Authorization:`Bearer ${s.token}`}});v(O)}catch{v({bankName:"Not configured",accountName:"Contact your admin",accountNumber:"",ifscCode:"",upiId:""})}}},N=(R,O)=>{navigator.clipboard.writeText(R),p(O),setTimeout(()=>p(null),2e3)},k=async()=>{var R,O;if(!l||parseFloat(l)<=0){f({type:"error",text:"Please enter a valid amount"});return}if(!c){f({type:"error",text:"Please enter UTR/Transaction ID"});return}x(!0);try{await I.post("/api/user/deposit-request",{amount:parseFloat(l),utrNumber:c,paymentMethod:"BANK"},{headers:{Authorization:`Bearer ${s.token}`}}),f({type:"success",text:"Deposit request submitted! It will be verified shortly."}),o(""),d(""),r&&r()}catch(P){f({type:"error",text:((O=(R=P.response)==null?void 0:R.data)==null?void 0:O.message)||"Failed to submit deposit request"})}finally{x(!1)}},j=async()=>{var R,O,P;if(!l||parseFloat(l)<=0){f({type:"error",text:"Please enter a valid amount"});return}if(parseFloat(l)>(((R=e==null?void 0:e.wallet)==null?void 0:R.balance)||0)){f({type:"error",text:"Insufficient balance"});return}x(!0);try{await I.post("/api/user/withdraw-request",{amount:parseFloat(l),accountDetails:m},{headers:{Authorization:`Bearer ${s.token}`}}),f({type:"success",text:"Withdrawal request submitted! It will be processed shortly."}),o(""),u(""),r&&r()}catch(W){f({type:"error",text:((P=(O=W.response)==null?void 0:O.data)==null?void 0:P.message)||"Failed to submit withdrawal request"})}finally{x(!1)}},E=[500,1e3,2e3,5e3,1e4,25e3];return n.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-end md:items-center justify-center z-50",children:n.jsxs("div",{className:"bg-dark-800 w-full md:w-[480px] md:rounded-xl rounded-t-xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-dark-600",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Ge,{className:"text-green-400",size:24}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-lg",children:"Wallet"}),n.jsxs("p",{className:"text-sm text-gray-400",children:["Balance: ",n.jsxs("span",{className:"text-green-400 font-medium",children:["",((M=(_=e==null?void 0:e.wallet)==null?void 0:_.balance)==null?void 0:M.toLocaleString())||"0"]})]})]})]}),n.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white p-1",children:n.jsx(ve,{size:24})})]}),n.jsxs("div",{className:"flex border-b border-dark-600",children:[n.jsxs("button",{onClick:()=>{a("deposit"),f(null)},className:`flex-1 py-3 font-medium flex items-center justify-center gap-2 ${i==="deposit"?"text-green-400 border-b-2 border-green-400":"text-gray-400 hover:text-white"}`,children:[n.jsx(Wn,{size:18}),"Deposit"]}),n.jsxs("button",{onClick:()=>{a("withdraw"),f(null)},className:`flex-1 py-3 font-medium flex items-center justify-center gap-2 ${i==="withdraw"?"text-red-400 border-b-2 border-red-400":"text-gray-400 hover:text-white"}`,children:[n.jsx(Vn,{size:18}),"Withdraw"]})]}),y&&n.jsx("div",{className:`mx-4 mt-4 p-3 rounded-lg text-sm ${y.type==="success"?"bg-green-900/50 text-green-400":"bg-red-900/50 text-red-400"}`,children:y.text}),i==="deposit"&&n.jsxs("div",{className:"p-4 space-y-4",children:[n.jsxs("div",{className:"bg-dark-700 rounded-lg p-4",children:[n.jsxs("h4",{className:"text-sm font-medium text-gray-400 mb-3 flex items-center gap-2",children:[n.jsx(Rr,{size:16}),"Transfer to Bank Account"]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-gray-400 text-sm",children:"Bank Name"}),n.jsx("span",{className:"font-medium",children:(b==null?void 0:b.bankName)||"--"})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-gray-400 text-sm",children:"Account Name"}),n.jsx("span",{className:"font-medium",children:(b==null?void 0:b.accountName)||"--"})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-gray-400 text-sm",children:"Account Number"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"font-mono font-medium",children:(b==null?void 0:b.accountNumber)||"--"}),n.jsx("button",{onClick:()=>N(b==null?void 0:b.accountNumber,"account"),className:"text-gray-400 hover:text-white",children:w==="account"?n.jsx(gc,{size:14,className:"text-green-400"}):n.jsx(Nr,{size:14})})]})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-gray-400 text-sm",children:"IFSC Code"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"font-mono font-medium",children:(b==null?void 0:b.ifscCode)||"--"}),n.jsx("button",{onClick:()=>N(b==null?void 0:b.ifscCode,"ifsc"),className:"text-gray-400 hover:text-white",children:w==="ifsc"?n.jsx(gc,{size:14,className:"text-green-400"}):n.jsx(Nr,{size:14})})]})]})]})]}),n.jsxs("div",{className:"bg-dark-700 rounded-lg p-4",children:[n.jsxs("h4",{className:"text-sm font-medium text-gray-400 mb-3 flex items-center gap-2",children:[n.jsx(Ar,{size:16}),"Or Pay via UPI"]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"font-mono text-lg",children:(b==null?void 0:b.upiId)||"--"}),n.jsxs("button",{onClick:()=>N(b==null?void 0:b.upiId,"upi"),className:"px-3 py-1 bg-dark-600 hover:bg-dark-500 rounded text-sm flex items-center gap-1",children:[w==="upi"?n.jsx(gc,{size:14,className:"text-green-400"}):n.jsx(Nr,{size:14}),w==="upi"?"Copied!":"Copy"]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Amount ()"}),n.jsx("input",{type:"number",value:l,onChange:R=>o(R.target.value),placeholder:"Enter amount",className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-3 text-lg focus:outline-none focus:border-green-500"}),n.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:E.map(R=>n.jsxs("button",{onClick:()=>o(R.toString()),className:"px-3 py-1 bg-dark-700 hover:bg-dark-600 rounded text-sm",children:["",R.toLocaleString()]},R))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"UTR / Transaction ID"}),n.jsx("input",{type:"text",value:c,onChange:R=>d(R.target.value),placeholder:"Enter UTR or Transaction ID after payment",className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-3 focus:outline-none focus:border-green-500"})]}),n.jsxs("button",{onClick:k,disabled:h,className:"w-full py-3 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 rounded-lg font-semibold flex items-center justify-center gap-2",children:[h?n.jsx(fe,{size:18,className:"animate-spin"}):n.jsx(Wn,{size:18}),"Submit Deposit Request"]})]}),i==="withdraw"&&n.jsxs("div",{className:"p-4 space-y-4",children:[n.jsxs("div",{className:"bg-dark-700 rounded-lg p-4 text-center",children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Available for Withdrawal"}),n.jsxs("p",{className:"text-3xl font-bold text-green-400 mt-1",children:["",((B=(V=e==null?void 0:e.wallet)==null?void 0:V.balance)==null?void 0:B.toLocaleString())||"0"]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Withdrawal Amount ()"}),n.jsx("input",{type:"number",value:l,onChange:R=>o(R.target.value),placeholder:"Enter amount",className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-3 text-lg focus:outline-none focus:border-red-500"}),n.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[E.map(R=>n.jsxs("button",{onClick:()=>o(R.toString()),className:"px-3 py-1 bg-dark-700 hover:bg-dark-600 rounded text-sm",children:["",R.toLocaleString()]},R)),n.jsx("button",{onClick:()=>{var R;return o((((R=e==null?void 0:e.wallet)==null?void 0:R.balance)||0).toString())},className:"px-3 py-1 bg-dark-700 hover:bg-dark-600 rounded text-sm text-green-400",children:"Max"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Bank Account / UPI ID"}),n.jsx("textarea",{value:m,onChange:R=>u(R.target.value),placeholder:"Enter your bank account details or UPI ID",rows:3,className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-3 focus:outline-none focus:border-red-500 resize-none"})]}),n.jsxs("button",{onClick:j,disabled:h,className:"w-full py-3 bg-red-600 hover:bg-red-700 disabled:bg-gray-600 rounded-lg font-semibold flex items-center justify-center gap-2",children:[h?n.jsx(fe,{size:18,className:"animate-spin"}):n.jsx(Vn,{size:18}),"Submit Withdrawal Request"]}),n.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Withdrawals are processed within 24-48 hours"})]})]})})},f4=({instrument:t,orderType:e,setOrderType:s,onClose:r,walletData:i,user:a,marketData:l={},onRefreshWallet:o,onRefreshPositions:c})=>{var L;const[d,m]=g.useState("1"),[u,h]=g.useState(""),[x,y]=g.useState("MIS"),[f,w]=g.useState("MARKET"),[p,b]=g.useState(!1),[v,S]=g.useState(""),[N,k]=g.useState(""),j=(t==null?void 0:t.isCrypto)||(t==null?void 0:t.segment)==="CRYPTO"||(t==null?void 0:t.exchange)==="BINANCE",E=l[t==null?void 0:t.token]||{},_=j?(t==null?void 0:t.ltp)||0:E.ltp||(t==null?void 0:t.ltp)||0,M=j?_:E.bid||_,V=j?_:E.ask||_,B=(t==null?void 0:t.lotSize)||1,R=parseFloat(d||1)*B,O=_*R,P=(t==null?void 0:t.segment)==="FNO"||(t==null?void 0:t.instrumentType)==="OPTIONS"||(t==null?void 0:t.instrumentType)==="FUTURES",W=(t==null?void 0:t.segment)==="MCX"||(t==null?void 0:t.exchange)==="MCX",D=j?[{value:"MIS",label:"Spot",desc:"Crypto spot trading"}]:P||W?[{value:"MIS",label:"Intraday",desc:"Square off same day"},{value:"NRML",label:"Carry Forward",desc:"Hold overnight"}]:[{value:"MIS",label:"Intraday",desc:"Square off same day"},{value:"CNC",label:"Delivery",desc:"Hold in demat"}],T=async()=>{var F,C,H;if(!(a!=null&&a.token)){S("Please login to place orders");return}b(!0),S(""),k("");try{const J={symbol:t.symbol,token:t.token,pair:t.pair,isCrypto:j,exchange:t.exchange||(j?"BINANCE":"NSE"),segment:j?"CRYPTO":t.segment||(t.exchange==="MCX"?"MCX":"FNO"),instrumentType:j?"CRYPTO":t.instrumentType||"FUTURES",optionType:t.optionType||null,strike:t.strike||null,expiry:t.expiry||null,category:t.category,productType:x,orderType:f,side:e.toUpperCase(),quantity:R,lots:parseFloat(d),lotSize:B,price:_,bidPrice:M,askPrice:V,leverage:1};f==="LIMIT"&&(J.limitPrice=parseFloat(u)),console.log("Placing order:",J);const{data:ce}=await I.post("/api/trading/order",J,{headers:{Authorization:`Bearer ${a.token}`}}),U=ce.trade,le=j?"$":"",G=(U==null?void 0:U.status)==="PENDING"?` LIMIT ORDER PLACED - ${t.symbol} @ ${le}${u}`:` TRADE EXECUTED - ${U==null?void 0:U.side} ${t.symbol} @ ${le}${(F=U==null?void 0:U.entryPrice)==null?void 0:F.toLocaleString()} | Qty: ${U==null?void 0:U.quantity}`;k(G),o&&o(),c&&c(),setTimeout(()=>{k(""),r()},3e3)}catch(J){console.error("Order error:",J),S(((H=(C=J.response)==null?void 0:C.data)==null?void 0:H.message)||"Failed to place order")}finally{b(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-end md:items-center justify-center z-50",children:n.jsxs("div",{className:"bg-dark-800 w-full md:w-[420px] md:rounded-xl rounded-t-xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-dark-600",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-lg",children:(t==null?void 0:t.symbol)||"Select Instrument"}),n.jsxs("p",{className:"text-xs text-gray-400",children:[t==null?void 0:t.exchange,"  ",(t==null?void 0:t.segment)||"EQUITY",(t==null?void 0:t.instrumentType)==="OPTIONS"&&`  ${t==null?void 0:t.optionType}`]})]}),n.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white p-1",children:n.jsx(ve,{size:24})})]}),n.jsxs("div",{className:"flex p-3 gap-2",children:[n.jsxs("button",{onClick:()=>s("sell"),className:`flex-1 py-2 rounded-lg font-bold transition ${e==="sell"?"bg-red-600 text-white":"bg-dark-700 text-gray-400 hover:bg-dark-600"}`,children:[n.jsx("div",{className:"text-xs opacity-70",children:j?"Price":"Bid Price"}),n.jsxs("div",{className:"text-xl",children:[j?"$":"",(M==null?void 0:M.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))||"--"]}),n.jsx("div",{className:"text-sm",children:"SELL"})]}),n.jsxs("button",{onClick:()=>s("buy"),className:`flex-1 py-2 rounded-lg font-bold transition ${e==="buy"?"bg-green-600 text-white":"bg-dark-700 text-gray-400 hover:bg-dark-600"}`,children:[n.jsx("div",{className:"text-xs opacity-70",children:j?"Price":"Ask Price"}),n.jsxs("div",{className:"text-xl",children:[j?"$":"",(V==null?void 0:V.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))||"--"]}),n.jsx("div",{className:"text-sm",children:"BUY"})]})]}),n.jsxs("div",{className:"px-4 pb-3",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Product Type"}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:D.map(F=>n.jsxs("button",{onClick:()=>y(F.value),className:`p-3 rounded-lg border-2 text-left transition ${x===F.value?"border-green-500 bg-green-500/10":"border-dark-600 bg-dark-700 hover:border-dark-500"}`,children:[n.jsx("div",{className:"font-semibold text-sm",children:F.label}),n.jsx("div",{className:"text-xs text-gray-500",children:F.desc})]},F.value))})]}),n.jsxs("div",{className:"px-4 pb-3",children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Order Type"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>w("MARKET"),className:`flex-1 py-2 rounded-lg text-sm font-medium transition ${f==="MARKET"?"bg-purple-600 text-white":"bg-dark-700 text-gray-400 hover:bg-dark-600"}`,children:"Market"}),n.jsx("button",{onClick:()=>w("LIMIT"),className:`flex-1 py-2 rounded-lg text-sm font-medium transition ${f==="LIMIT"?"bg-purple-600 text-white":"bg-dark-700 text-gray-400 hover:bg-dark-600"}`,children:"Limit"})]})]}),n.jsxs("div",{className:"p-4 pt-0 space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm text-gray-400 mb-2",children:["Quantity ",B>1&&`(Lot Size: ${B})`]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>m(Math.max(1,parseInt(d)-1).toString()),className:"px-4 py-3 bg-dark-700 rounded-lg hover:bg-dark-600 font-bold",children:""}),n.jsx("input",{type:"number",value:d,onChange:F=>m(F.target.value),className:"flex-1 bg-dark-700 border border-dark-600 rounded-lg px-4 py-3 text-center text-lg font-bold focus:outline-none focus:border-green-500",min:"1"}),n.jsx("button",{onClick:()=>m((parseInt(d)+1).toString()),className:"px-4 py-3 bg-dark-700 rounded-lg hover:bg-dark-600 font-bold",children:"+"})]})]}),f==="LIMIT"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Limit Price"}),n.jsx("input",{type:"number",value:u,onChange:F=>h(F.target.value),placeholder:"Enter price",className:"w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-3 focus:outline-none focus:border-green-500",step:"0.05"})]}),n.jsx("div",{className:"bg-dark-700 rounded-lg p-3",children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-gray-400 text-sm",children:"Last Traded Price"}),n.jsxs("span",{className:"text-xl font-bold",children:["",(_==null?void 0:_.toLocaleString())||"--"]})]})}),n.jsxs("div",{className:"bg-dark-700 rounded-lg p-3 space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-400",children:"Available Margin"}),n.jsxs("span",{className:"text-green-400 font-medium",children:["",((L=i==null?void 0:i.marginAvailable)==null?void 0:L.toLocaleString())||"0"]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-400",children:"Required Margin"}),n.jsxs("span",{className:"font-medium",children:["",(O*(W?.05:.15)/(x==="MIS"?2:1)).toLocaleString()]})]}),n.jsxs("div",{className:"flex justify-between text-sm border-t border-dark-600 pt-2",children:[n.jsx("span",{className:"text-gray-400",children:"Order Value"}),n.jsxs("span",{className:"font-medium",children:["",O.toLocaleString()]})]})]}),v&&n.jsx("div",{className:"bg-red-500/20 border border-red-500 text-red-400 px-3 py-2 rounded text-sm",children:v}),N&&n.jsx("div",{className:"bg-green-500/20 border border-green-500 text-green-400 px-3 py-2 rounded text-sm",children:N}),n.jsxs("button",{onClick:T,disabled:p,className:`w-full py-4 rounded-lg font-bold text-lg transition ${e==="buy"?"bg-green-600 hover:bg-green-700 disabled:bg-green-800":"bg-red-600 hover:bg-red-700 disabled:bg-red-800"}`,children:[p?"Placing Order...":`${e==="buy"?"BUY":"SELL"} ${t==null?void 0:t.symbol}`,n.jsxs("span",{className:"ml-2 text-sm opacity-80",children:["(",x==="MIS"?"Intraday":x==="NRML"?"Carry Forward":"Delivery",")"]})]}),n.jsx("p",{className:"text-xs text-gray-500 text-center",children:x==="MIS"?"Intraday position will be auto squared-off before market close":x==="NRML"?"Position will be carried forward to next trading day":"Shares will be delivered to your demat account (T+1)"})]})]})})};function hx(){const t=[],e=new Date;let s=984;for(let r=100;r>=0;r--){const i=new Date(e.getTime()-r*6e4),a=s+(Math.random()-.5)*2,l=a+(Math.random()-.5)*2,o=Math.max(a,l)+Math.random()*1,c=Math.min(a,l)-Math.random()*1;t.push({time:Math.floor(i.getTime()/1e3),open:a,high:o,low:c,close:l}),s=l}return t}const g4=({message:t,type:e="info",isVisible:s,onClose:r,duration:i=3e3})=>{if(g.useEffect(()=>{if(s&&i>0){const o=setTimeout(()=>{r()},i);return()=>clearTimeout(o)}},[s,i,r]),!s)return null;const a={success:n.jsx(cg,{size:20,className:"text-green-500"}),error:n.jsx(ag,{size:20,className:"text-red-500"}),warning:n.jsx(gw,{size:20,className:"text-orange-500"}),info:n.jsx(Tw,{size:20,className:"text-blue-500"})},l={success:"bg-green-500/10 border-green-500/30",error:"bg-red-500/10 border-red-500/30",warning:"bg-orange-500/10 border-orange-500/30",info:"bg-blue-500/10 border-blue-500/30"};return n.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 z-[9999] animate-ios-slide-down",children:n.jsxs("div",{className:`
        flex items-center gap-3 px-5 py-3.5
        backdrop-blur-xl bg-black/80 
        rounded-2xl border ${l[e]}
        shadow-2xl shadow-black/50
        min-w-[280px] max-w-[90vw]
      `,children:[a[e],n.jsx("span",{className:"text-white text-sm font-medium flex-1",children:t}),n.jsx("button",{onClick:r,className:"p-1 hover:bg-white/10 rounded-full transition-colors",children:n.jsx(ve,{size:16,className:"text-gray-400"})})]})})},y4=({isOpen:t,onClose:e,onConfirm:s,title:r,message:i,confirmText:a="Confirm",cancelText:l="Cancel",confirmColor:o="red",loading:c=!1})=>{if(!t)return null;const d={red:"text-red-500 hover:bg-red-500/10",green:"text-green-500 hover:bg-green-500/10",blue:"text-blue-500 hover:bg-blue-500/10",orange:"text-orange-500 hover:bg-orange-500/10"};return n.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-end sm:items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm animate-ios-fade-in",onClick:e}),n.jsxs("div",{className:"relative w-full sm:w-auto sm:min-w-[320px] sm:max-w-[400px] p-4 animate-ios-slide-up",children:[n.jsxs("div",{className:"bg-[#2c2c2e]/95 backdrop-blur-xl rounded-2xl overflow-hidden mb-2",children:[n.jsxs("div",{className:"px-4 py-4 text-center border-b border-white/10",children:[n.jsx("h3",{className:"text-white font-semibold text-lg",children:r}),i&&n.jsx("p",{className:"text-gray-400 text-sm mt-1",children:i})]}),n.jsx("button",{onClick:s,disabled:c,className:`
              w-full py-4 text-center font-semibold text-lg
              ${d[o]}
              transition-colors disabled:opacity-50
              active:bg-white/5
            `,children:c?n.jsxs("span",{className:"flex items-center justify-center gap-2",children:[n.jsx("div",{className:"w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin"}),"Processing..."]}):a})]}),n.jsx("button",{onClick:e,disabled:c,className:`\r
            w-full py-4 text-center font-semibold text-lg\r
            bg-[#2c2c2e]/95 backdrop-blur-xl rounded-2xl\r
            text-blue-500 hover:bg-white/5\r
            transition-colors disabled:opacity-50\r
            active:bg-white/5\r
          `,children:l})]})]})},b4=()=>{const[t,e]=g.useState({isVisible:!1,message:"",type:"info"});return{toast:t,showToast:(i,a="info")=>{e({isVisible:!0,message:i,type:a})},hideToast:()=>{e(i=>({...i,isVisible:!1}))}}},v4=()=>{const[t,e]=g.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{},confirmText:"Confirm",confirmColor:"red"});return{confirm:t,showConfirm:({title:i,message:a,onConfirm:l,confirmText:o="Confirm",confirmColor:c="red"})=>{e({isOpen:!0,title:i,message:a,onConfirm:l,confirmText:o,confirmColor:c})},hideConfirm:()=>{e(i=>({...i,isOpen:!1}))}}},N4=()=>{const t=rs(),[e,s]=g.useState(null),[r,i]=g.useState("positions"),[a,l]=g.useState([]),[o,c]=g.useState([]),[d,m]=g.useState([]),[u,h]=g.useState([]),[x,y]=g.useState(!1),[f,w]=g.useState(null),[p,b]=g.useState("all"),[v,S]=g.useState(""),[N,k]=g.useState(""),[j,E]=g.useState({totalPnL:0,winRate:0,totalTrades:0}),{toast:_,showToast:M,hideToast:V}=b4(),{confirm:B,showConfirm:R,hideConfirm:O}=v4(),[P,W]=g.useState(!1);g.useEffect(()=>{const Q=localStorage.getItem("user");Q?s(JSON.parse(Q)):t("/user/login")},[t]),g.useEffect(()=>{e!=null&&e.token&&T()},[e==null?void 0:e.token,p,v,N]);const D=()=>{const Q=new Date;let ge=null,ke=new Date;switch(p){case"today":ge=new Date(Q.setHours(0,0,0,0));break;case"week":ge=new Date(Q.setDate(Q.getDate()-7));break;case"month":ge=new Date(Q.setMonth(Q.getMonth()-1));break;case"custom":ge=v?new Date(v):null,ke=N?new Date(N):new Date;break;default:ge=null}return{fromDate:ge,toDate:ke}},T=async()=>{try{y(!0);const Q={Authorization:`Bearer ${e.token}`},{fromDate:ge,toDate:ke}=D();let pe={};ge&&(pe.fromDate=ge.toISOString()),ke&&(pe.toDate=ke.toISOString());const[De,qe,Je]=await Promise.all([I.get("/api/trading/positions?status=OPEN",{headers:Q}),I.get("/api/trading/history",{headers:Q,params:pe}),I.get("/api/trading/pending-orders",{headers:Q})]),oe=De.data||[],ue=qe.data||[],Ce=Je.data||[],Ne=de=>ge?de.filter(ot=>{const ae=new Date(ot.createdAt||ot.openedAt);return ae>=ge&&ae<=ke}):de;l(Ne(oe)),c(Ne(ue.filter(de=>de.status==="CLOSED"))),m(Ne(ue.filter(de=>de.status==="CANCELLED"))),h(Ne(Ce));const Ee=ue.filter(de=>de.status==="CLOSED"),Le=Ee.reduce((de,ot)=>de+(ot.realizedPnL||ot.pnl||0),0),lt=Ee.filter(de=>(de.realizedPnL||de.pnl||0)>0).length,Te=Ee.length>0?(lt/Ee.length*100).toFixed(1):0;E({totalPnL:Le,winRate:Te,totalTrades:Ee.length,wins:lt,losses:Ee.length-lt})}catch(Q){console.error("Error fetching orders:",Q),M("Failed to fetch orders","error")}finally{y(!1)}},L=Q=>{R({title:"Close Position",message:`Close ${Q.side} ${Q.quantity} ${Q.symbol}?`,confirmText:"Close Trade",confirmColor:"red",onConfirm:()=>F(Q)})},F=async Q=>{var ge,ke;try{W(!0);const pe={Authorization:`Bearer ${e.token}`};await I.post(`/api/trading/close/${Q._id}`,{bidPrice:Q.currentPrice,askPrice:Q.currentPrice},{headers:pe}),O(),M("Position closed successfully","success"),T()}catch(pe){console.error("Error closing position:",pe),M(((ke=(ge=pe.response)==null?void 0:ge.data)==null?void 0:ke.message)||"Failed to close position","error")}finally{W(!1)}},C=Q=>{R({title:"Cancel Order",message:`Cancel ${Q.side} order for ${Q.symbol}?`,confirmText:"Cancel Order",confirmColor:"orange",onConfirm:()=>H(Q)})},H=async Q=>{var ge,ke;try{W(!0);const pe={Authorization:`Bearer ${e.token}`};await I.delete(`/api/trading/pending-orders/${Q._id}`,{headers:pe}),O(),M("Order cancelled successfully","success"),T()}catch(pe){console.error("Error cancelling order:",pe),M(((ke=(ge=pe.response)==null?void 0:ge.data)==null?void 0:ke.message)||"Failed to cancel order","error")}finally{W(!1)}},J=[{id:"positions",label:"Open Positions",count:a.length,icon:gs,color:"text-blue-400"},{id:"pending",label:"Pending Orders",count:u.length,icon:dg,color:"text-yellow-400"},{id:"closed",label:"Closed Trades",count:o.length,icon:cg,color:"text-green-400"},{id:"cancelled",label:"Cancelled",count:d.length,icon:lp,color:"text-red-400"}],ce=[{id:"all",label:"All Time"},{id:"today",label:"Today"},{id:"week",label:"This Week"},{id:"month",label:"This Month"},{id:"custom",label:"Custom"}],U=Q=>Q?new Date(Q).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",le=()=>{switch(r){case"positions":return a;case"pending":return u;case"closed":return o;case"cancelled":return d;default:return[]}},G=()=>{const Q=le();if(Q.length===0)return;const ge=["Symbol","Side","Qty","Entry Price","Exit Price","P&L","Status","Date"],ke=Q.map(oe=>[oe.symbol,oe.side,oe.quantity||oe.lots,oe.entryPrice||oe.price,oe.exitPrice||"-",oe.realizedPnL||oe.pnl||oe.unrealizedPnL||0,oe.status,U(oe.createdAt||oe.openedAt)]),pe=[ge,...ke].map(oe=>oe.join(",")).join(`
`),De=new Blob([pe],{type:"text/csv"}),qe=window.URL.createObjectURL(De),Je=document.createElement("a");Je.href=qe,Je.download=`orders_${r}_${new Date().toISOString().split("T")[0]}.csv`,Je.click()};return e?n.jsxs("div",{className:"h-screen bg-[#000000] text-white flex flex-col overflow-hidden ios-safe-top",children:[n.jsx(g4,{message:_.message,type:_.type,isVisible:_.isVisible,onClose:V}),n.jsx(y4,{isOpen:B.isOpen,onClose:O,onConfirm:B.onConfirm,title:B.title,message:B.message,confirmText:B.confirmText,confirmColor:B.confirmColor,loading:P}),n.jsx("header",{className:"bg-[#1c1c1e]/95 backdrop-blur-xl border-b border-white/10 px-4 py-3 sticky top-0 z-50",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("button",{onClick:()=>t("/user/trader-room"),className:"flex items-center gap-2 text-blue-500 hover:text-blue-400 transition-colors active:scale-95",children:[n.jsx(lg,{size:20}),n.jsx("span",{className:"text-base font-medium hidden sm:inline",children:"Back"})]}),n.jsx("h1",{className:"text-lg font-semibold",children:"Orders & History"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:T,disabled:x,className:"p-2.5 bg-[#2c2c2e] hover:bg-[#3a3a3c] rounded-xl transition-all active:scale-95 disabled:opacity-50",children:n.jsx(fe,{size:18,className:x?"animate-spin":""})}),n.jsx("button",{onClick:G,className:"p-2.5 bg-green-500/20 text-green-500 hover:bg-green-500/30 rounded-xl transition-all active:scale-95",children:n.jsx(ug,{size:18})})]})]})}),n.jsx("div",{className:"bg-[#1c1c1e] px-4 py-3",children:n.jsxs("div",{className:"flex gap-3 overflow-x-auto ios-scroll pb-1",children:[n.jsxs("div",{className:"flex-shrink-0 bg-[#2c2c2e] rounded-2xl px-4 py-3 min-w-[120px]",children:[n.jsx("div",{className:"text-gray-400 text-xs mb-1",children:"Total P&L"}),n.jsxs("div",{className:`font-bold text-lg ${j.totalPnL>=0?"text-green-500":"text-red-500"}`,children:[j.totalPnL>=0?"+":"","",j.totalPnL.toLocaleString()]})]}),n.jsxs("div",{className:"flex-shrink-0 bg-[#2c2c2e] rounded-2xl px-4 py-3 min-w-[100px]",children:[n.jsx("div",{className:"text-gray-400 text-xs mb-1",children:"Win Rate"}),n.jsxs("div",{className:"font-bold text-lg text-blue-500",children:[j.winRate,"%"]})]}),n.jsxs("div",{className:"flex-shrink-0 bg-[#2c2c2e] rounded-2xl px-4 py-3 min-w-[100px]",children:[n.jsx("div",{className:"text-gray-400 text-xs mb-1",children:"Total Trades"}),n.jsx("div",{className:"font-bold text-lg text-white",children:j.totalTrades})]}),n.jsxs("div",{className:"flex-shrink-0 bg-[#2c2c2e] rounded-2xl px-4 py-3 min-w-[140px]",children:[n.jsx("div",{className:"text-gray-400 text-xs mb-1",children:"Win/Loss"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-green-500 font-bold",children:j.wins}),n.jsx("span",{className:"text-gray-500",children:"/"}),n.jsx("span",{className:"text-red-500 font-bold",children:j.losses})]})]})]})}),n.jsx("div",{className:"bg-[#1c1c1e] px-4 py-3 border-b border-white/5",children:n.jsxs("div",{className:"flex items-center gap-3 overflow-x-auto ios-scroll",children:[n.jsx(lh,{size:16,className:"text-gray-500 flex-shrink-0"}),n.jsx("div",{className:"flex gap-1 p-1 bg-[#2c2c2e] rounded-xl",children:ce.map(Q=>n.jsx("button",{onClick:()=>b(Q.id),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-all ${p===Q.id?"bg-[#3a3a3c] text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:Q.label},Q.id))}),p==="custom"&&n.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[n.jsx("input",{type:"date",value:v,onChange:Q=>S(Q.target.value),className:"bg-[#2c2c2e] border border-white/10 rounded-xl px-3 py-1.5 text-sm focus:outline-none focus:border-blue-500 transition-colors"}),n.jsx("span",{className:"text-gray-500",children:"to"}),n.jsx("input",{type:"date",value:N,onChange:Q=>k(Q.target.value),className:"bg-[#2c2c2e] border border-white/10 rounded-xl px-3 py-1.5 text-sm focus:outline-none focus:border-blue-500 transition-colors"})]})]})}),n.jsx("div",{className:"bg-[#1c1c1e] px-4 py-3",children:n.jsx("div",{className:"flex gap-1 p-1 bg-[#2c2c2e] rounded-xl overflow-x-auto ios-scroll",children:J.map(Q=>{const ge=Q.icon;return n.jsxs("button",{onClick:()=>i(Q.id),className:`flex items-center gap-2 px-4 py-2.5 rounded-xl transition-all flex-shrink-0 ${r===Q.id?"bg-[#3a3a3c] text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[n.jsx(ge,{size:16,className:r===Q.id?"text-white":Q.color}),n.jsx("span",{className:"font-medium text-sm hidden sm:inline",children:Q.label}),n.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${r===Q.id?"bg-white/20 text-white":"bg-white/10 text-gray-400"}`,children:Q.count})]},Q.id)})})}),n.jsx("div",{className:"flex-1 overflow-auto p-4 ios-scroll bg-[#000000]",children:x?n.jsx("div",{className:"flex items-center justify-center py-20",children:n.jsx("div",{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent rounded-full animate-spin"})}):le().length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[n.jsx("div",{className:"w-16 h-16 bg-[#2c2c2e] rounded-full flex items-center justify-center mb-4",children:n.jsx(ag,{size:32,className:"text-gray-500"})}),n.jsxs("p",{className:"text-gray-500 text-center",children:["No ",r==="positions"?"open positions":r==="pending"?"pending orders":r==="closed"?"closed trades":"cancelled orders"," found"]})]}):n.jsx("div",{className:"space-y-3",children:le().map((Q,ge)=>{const ke=Q.realizedPnL||Q.pnl||Q.unrealizedPnL||0,pe=ke>=0;return n.jsxs("div",{className:"bg-[#1c1c1e] rounded-2xl overflow-hidden active:scale-[0.98] transition-transform",children:[n.jsxs("div",{className:"px-4 py-3 flex items-center justify-between border-b border-white/5",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${Q.side==="BUY"?"bg-green-500/20":"bg-red-500/20"}`,children:Q.side==="BUY"?n.jsx(gs,{size:20,className:"text-green-500"}):n.jsx(fg,{size:20,className:"text-red-500"})}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold text-white",children:Q.symbol}),n.jsx("div",{className:"text-xs text-gray-500",children:Q.exchange||"FOREX"})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:`font-bold text-lg ${pe?"text-green-500":"text-red-500"}`,children:[pe?"+":"","",ke.toLocaleString()]}),n.jsx("div",{className:"text-xs text-gray-500",children:"P&L"})]})]}),n.jsx("div",{className:"px-4 py-3",children:n.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500 text-xs mb-1",children:"Side"}),n.jsx("span",{className:`inline-flex px-2 py-0.5 rounded-lg text-xs font-semibold ${Q.side==="BUY"?"bg-green-500/20 text-green-500":"bg-red-500/20 text-red-500"}`,children:Q.side})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500 text-xs mb-1",children:"Quantity"}),n.jsx("div",{className:"font-medium text-white",children:Q.quantity||Q.lots||1})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500 text-xs mb-1",children:"Entry"}),n.jsxs("div",{className:"font-medium text-white",children:["",(Q.entryPrice||Q.price||0).toLocaleString()]})]}),r==="closed"&&n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500 text-xs mb-1",children:"Exit"}),n.jsxs("div",{className:"font-medium text-white",children:["",(Q.exitPrice||0).toLocaleString()]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500 text-xs mb-1",children:"Status"}),n.jsx("span",{className:`inline-flex px-2 py-0.5 rounded-lg text-xs font-semibold ${Q.status==="OPEN"?"bg-blue-500/20 text-blue-500":Q.status==="CLOSED"?"bg-green-500/20 text-green-500":Q.status==="PENDING"?"bg-yellow-500/20 text-yellow-500":"bg-red-500/20 text-red-500"}`,children:Q.status})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500 text-xs mb-1",children:"Date"}),n.jsx("div",{className:"font-medium text-gray-400 text-xs",children:U(Q.createdAt||Q.openedAt)})]})]})}),r==="positions"&&n.jsx("div",{className:"px-4 py-3 border-t border-white/5",children:n.jsxs("button",{onClick:()=>L(Q),className:"w-full flex items-center justify-center gap-2 py-3 bg-red-500/10 hover:bg-red-500/20 text-red-500 rounded-xl font-semibold transition-all active:scale-95",children:[n.jsx(Ow,{size:18}),"Close Position"]})}),r==="pending"&&n.jsx("div",{className:"px-4 py-3 border-t border-white/5",children:n.jsxs("button",{onClick:()=>C(Q),className:"w-full flex items-center justify-center gap-2 py-3 bg-orange-500/10 hover:bg-orange-500/20 text-orange-500 rounded-xl font-semibold transition-all active:scale-95",children:[n.jsx(lp,{size:18}),"Cancel Order"]})})]},Q._id||ge)})})}),n.jsx("div",{className:"ios-safe-bottom bg-[#000000]"})]}):n.jsx("div",{className:"min-h-screen bg-dark-900 flex items-center justify-center",children:n.jsx(fe,{className:"animate-spin text-green-400",size:32})})},j4=()=>{const t=rs(),[e,s]=g.useState(null),[r,i]=g.useState("all"),[a,l]=g.useState([]),[o,c]=g.useState([]),[d,m]=g.useState([]),[u,h]=g.useState(!1),[x,y]=g.useState("all"),[f,w]=g.useState(""),[p,b]=g.useState("");g.useEffect(()=>{const P=localStorage.getItem("user");P?s(JSON.parse(P)):t("/user/login")},[t]),g.useEffect(()=>{e!=null&&e.token&&S()},[e==null?void 0:e.token,x,f,p]);const v=()=>{const P=new Date;let W=null,D=new Date;switch(x){case"today":W=new Date(P.setHours(0,0,0,0));break;case"week":W=new Date(P.setDate(P.getDate()-7));break;case"month":W=new Date(P.setMonth(P.getMonth()-1));break;case"custom":W=f?new Date(f):null,D=p?new Date(p):new Date;break;default:W=null}return{fromDate:W,toDate:D}},S=async()=>{try{h(!0);const P={Authorization:`Bearer ${e.token}`},[W,D,T]=await Promise.all([I.get("/api/user/funds/ledger?limit=100",{headers:P}),I.get("/api/user/funds/fund-requests",{headers:P}),I.get("/api/user/transactions",{headers:P}).catch(()=>({data:[]}))]),{fromDate:L,toDate:F}=v(),C=H=>L?H.filter(J=>{const ce=new Date(J.createdAt);return ce>=L&&ce<=F}):H;m(C(W.data||[])),c(C(D.data||[])),l(C(T.data||[]))}catch(P){console.error("Error fetching transactions:",P)}finally{h(!1)}},N=[{id:"all",label:"All",icon:Ge},{id:"deposits",label:"Deposits",icon:Wn},{id:"withdrawals",label:"Withdrawals",icon:Vn},{id:"transfers",label:"Internal Transfers",icon:ap},{id:"trading",label:"Trading P&L",icon:gs}],k=[{id:"all",label:"All Time"},{id:"today",label:"Today"},{id:"week",label:"This Week"},{id:"month",label:"This Month"},{id:"custom",label:"Custom"}],j=P=>P?new Date(P).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",E=()=>{let P=[];switch(d.forEach(W=>{P.push({...W,source:"ledger",displayType:W.reason||W.type,displayAmount:W.type==="CREDIT"?W.amount:-W.amount})}),o.forEach(W=>{W.status==="APPROVED"&&P.push({...W,source:"request",displayType:W.type,displayAmount:W.type==="DEPOSIT"?W.amount:-W.amount})}),P.sort((W,D)=>new Date(D.createdAt)-new Date(W.createdAt)),r){case"deposits":return P.filter(W=>W.displayType==="DEPOSIT"||W.reason==="DEPOSIT"||W.type==="CREDIT"&&W.reason!=="ADJUSTMENT");case"withdrawals":return P.filter(W=>W.displayType==="WITHDRAWAL"||W.reason==="WITHDRAWAL"||W.type==="DEBIT"&&W.reason!=="ADJUSTMENT");case"transfers":return P.filter(W=>{var D;return W.reason==="ADJUSTMENT"||((D=W.description)==null?void 0:D.includes("transfer"))});case"trading":return P.filter(W=>{var D,T;return W.reason==="TRADE"||W.reason==="COMMISSION"||((D=W.description)==null?void 0:D.includes("P&L"))||((T=W.description)==null?void 0:T.includes("trade"))});default:return P}},_=P=>P.displayType==="DEPOSIT"||P.reason==="DEPOSIT"?n.jsx(Wn,{size:16,className:"text-green-400"}):P.displayType==="WITHDRAWAL"||P.reason==="WITHDRAWAL"?n.jsx(Vn,{size:16,className:"text-red-400"}):P.reason==="ADJUSTMENT"?n.jsx(ap,{size:16,className:"text-blue-400"}):P.reason==="TRADE"||P.reason==="COMMISSION"?n.jsx(gs,{size:16,className:"text-purple-400"}):n.jsx(Ge,{size:16,className:"text-gray-400"}),M=P=>P.reason==="ADJUSTMENT"?"Internal Transfer":P.reason==="DEPOSIT"||P.displayType==="DEPOSIT"?"Deposit":P.reason==="WITHDRAWAL"||P.displayType==="WITHDRAWAL"?"Withdrawal":P.reason==="TRADE"?"Trade P&L":P.reason==="COMMISSION"?"Commission":P.displayType||P.type||"Transaction",V=()=>{const P=E();if(P.length===0)return;const W=["Date","Type","Description","Amount","Balance After"],D=P.map(H=>[j(H.createdAt),M(H),H.description||"-",H.displayAmount||H.amount,H.balanceAfter||"-"]),T=[W,...D].map(H=>H.join(",")).join(`
`),L=new Blob([T],{type:"text/csv"}),F=window.URL.createObjectURL(L),C=document.createElement("a");C.href=F,C.download=`transactions_${new Date().toISOString().split("T")[0]}.csv`,C.click()},B=E(),R=B.filter(P=>(P.displayAmount||0)>0).reduce((P,W)=>P+(W.displayAmount||0),0),O=B.filter(P=>(P.displayAmount||0)<0).reduce((P,W)=>P+Math.abs(W.displayAmount||0),0);return e?n.jsxs("div",{className:"h-screen bg-dark-900 text-white flex flex-col overflow-hidden",children:[n.jsx("header",{className:"bg-dark-800 border-b border-dark-600 px-4 py-3",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("button",{onClick:()=>t(-1),className:"flex items-center gap-2 bg-dark-700 hover:bg-dark-600 px-3 py-2 rounded-lg transition-colors",children:[n.jsx(lg,{size:18}),n.jsx("span",{className:"text-sm font-medium",children:"Back"})]}),n.jsx("h1",{className:"text-xl font-bold",children:"Transactions"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("button",{onClick:S,disabled:u,className:"flex items-center gap-2 bg-dark-700 hover:bg-dark-600 px-3 py-2 rounded-lg transition-colors",children:[n.jsx(fe,{size:16,className:u?"animate-spin":""}),n.jsx("span",{className:"text-sm hidden sm:inline",children:"Refresh"})]}),n.jsxs("button",{onClick:V,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 px-3 py-2 rounded-lg transition-colors",children:[n.jsx(ug,{size:16}),n.jsx("span",{className:"text-sm hidden sm:inline",children:"Export"})]})]})]})}),n.jsx("div",{className:"bg-dark-800 border-b border-dark-600 px-4 py-3",children:n.jsxs("div",{className:"flex items-center gap-6 flex-wrap",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-gray-400 text-sm",children:"Total Credits:"}),n.jsxs("span",{className:"font-bold text-green-400",children:["+",R.toLocaleString()]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-gray-400 text-sm",children:"Total Debits:"}),n.jsxs("span",{className:"font-bold text-red-400",children:["-",O.toLocaleString()]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-gray-400 text-sm",children:"Net:"}),n.jsxs("span",{className:`font-bold ${R-O>=0?"text-green-400":"text-red-400"}`,children:[R-O>=0?"+":"","",(R-O).toLocaleString()]})]})]})}),n.jsx("div",{className:"bg-dark-800 border-b border-dark-600 px-4 py-3",children:n.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(lh,{size:16,className:"text-gray-400"}),n.jsx("span",{className:"text-sm text-gray-400",children:"Filter:"})]}),n.jsx("div",{className:"flex gap-2 flex-wrap",children:k.map(P=>n.jsx("button",{onClick:()=>y(P.id),className:`px-3 py-1.5 rounded text-sm transition-colors ${x===P.id?"bg-green-600 text-white":"bg-dark-700 text-gray-400 hover:bg-dark-600"}`,children:P.label},P.id))}),x==="custom"&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"date",value:f,onChange:P=>w(P.target.value),className:"bg-dark-700 border border-dark-600 rounded px-3 py-1.5 text-sm focus:outline-none focus:border-green-500"}),n.jsx("span",{className:"text-gray-400",children:"to"}),n.jsx("input",{type:"date",value:p,onChange:P=>b(P.target.value),className:"bg-dark-700 border border-dark-600 rounded px-3 py-1.5 text-sm focus:outline-none focus:border-green-500"})]})]})}),n.jsx("div",{className:"bg-dark-800 border-b border-dark-600 px-4 overflow-x-auto",children:n.jsx("div",{className:"flex gap-1",children:N.map(P=>{const W=P.icon;return n.jsxs("button",{onClick:()=>i(P.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors whitespace-nowrap ${r===P.id?"border-green-500 text-white bg-dark-700":"border-transparent text-gray-400 hover:text-white hover:bg-dark-700"}`,children:[n.jsx(W,{size:16}),n.jsx("span",{className:"font-medium",children:P.label})]},P.id)})})}),n.jsx("div",{className:"flex-1 overflow-auto p-4",children:u?n.jsx("div",{className:"flex items-center justify-center py-20",children:n.jsx(fe,{className:"animate-spin text-green-400",size:32})}):n.jsx("div",{className:"bg-dark-800 rounded-xl overflow-hidden",children:n.jsx("div",{className:"divide-y divide-dark-600",children:B.length===0?n.jsxs("div",{className:"px-4 py-12 text-center text-gray-500",children:[n.jsx(Ge,{size:32,className:"mx-auto mb-2 opacity-50"}),"No transactions found"]}):B.map((P,W)=>{var D;return n.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-dark-700 transition-colors",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-dark-600 flex items-center justify-center",children:_(P)}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:M(P)}),n.jsx("div",{className:"text-xs text-gray-500",children:P.description||j(P.createdAt)})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:`font-bold ${(P.displayAmount||0)>=0?"text-green-400":"text-red-400"}`,children:[(P.displayAmount||0)>=0?"+":"","",Math.abs(P.displayAmount||P.amount||0).toLocaleString()]}),P.balanceAfter!==void 0&&n.jsxs("div",{className:"text-xs text-gray-500",children:["Bal: ",(D=P.balanceAfter)==null?void 0:D.toLocaleString()]})]})]},P._id||W)})})})})]}):n.jsx("div",{className:"min-h-screen bg-dark-900 flex items-center justify-center",children:n.jsx(fe,{className:"animate-spin text-green-400",size:32})})},w4=()=>n.jsxs("div",{className:"min-h-screen bg-dark-900 flex flex-col",children:[n.jsxs("header",{className:"flex items-center justify-between px-8 py-4 border-b border-dark-600 bg-dark-800/50 backdrop-blur-sm fixed w-full z-50",children:[n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("span",{className:"text-xl font-bold",children:"THEFX"})}),n.jsxs("div",{className:"flex gap-4",children:[n.jsx(ze,{to:"/login",className:"px-4 py-2 text-gray-300 hover:text-white transition",children:"Login"}),n.jsx(ze,{to:"/login?register=true",className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg transition",children:"Create Account"})]})]}),n.jsx("main",{className:"flex-1 pt-20",children:n.jsxs("div",{className:"relative overflow-hidden",children:[n.jsxs("div",{className:"absolute inset-0",children:[n.jsx("div",{className:"absolute top-20 left-1/4 w-96 h-96 bg-green-500/10 rounded-full blur-3xl"}),n.jsx("div",{className:"absolute bottom-20 right-1/4 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl"})]}),n.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center px-8 py-20",children:[n.jsx("h1",{className:"text-5xl md:text-6xl font-bold mb-6 text-center bg-gradient-to-r from-white to-gray-400 bg-clip-text text-transparent",children:"Professional Trading Platform"}),n.jsx("p",{className:"text-xl text-gray-400 mb-10 text-center max-w-2xl",children:"Trade NSE, BSE, MCX with advanced charting, real-time data, and powerful tools"}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-16",children:[n.jsxs(ze,{to:"/login?register=true",className:"flex items-center justify-center gap-2 px-8 py-4 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 rounded-xl font-semibold transition shadow-lg shadow-green-500/25",children:["Create Account",n.jsx(og,{size:18})]}),n.jsx(ze,{to:"/login",className:"flex items-center justify-center gap-2 px-8 py-4 bg-dark-700 hover:bg-dark-600 border border-dark-500 rounded-xl font-semibold transition",children:"Already have an account? Login"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 max-w-6xl w-full",children:[n.jsxs("div",{className:"bg-dark-800/50 backdrop-blur-sm border border-dark-600 p-6 rounded-xl hover:border-green-500/50 transition",children:[n.jsx(yg,{className:"w-10 h-10 text-yellow-500 mb-4"}),n.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Fast Execution"}),n.jsx("p",{className:"text-gray-400 text-sm",children:"Lightning fast order execution with minimal latency"})]}),n.jsxs("div",{className:"bg-dark-800/50 backdrop-blur-sm border border-dark-600 p-6 rounded-xl hover:border-green-500/50 transition",children:[n.jsx(mg,{className:"w-10 h-10 text-green-500 mb-4"}),n.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Advanced Charts"}),n.jsx("p",{className:"text-gray-400 text-sm",children:"TradingView powered charts with all indicators"})]}),n.jsxs("div",{className:"bg-dark-800/50 backdrop-blur-sm border border-dark-600 p-6 rounded-xl hover:border-green-500/50 transition",children:[n.jsx(ma,{className:"w-10 h-10 text-blue-500 mb-4"}),n.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Secure Trading"}),n.jsx("p",{className:"text-gray-400 text-sm",children:"Bank-grade security for your funds and data"})]}),n.jsxs("div",{className:"bg-dark-800/50 backdrop-blur-sm border border-dark-600 p-6 rounded-xl hover:border-green-500/50 transition",children:[n.jsx(Mr,{className:"w-10 h-10 text-purple-500 mb-4"}),n.jsx("h3",{className:"text-lg font-semibold mb-2",children:"All Segments"}),n.jsx("p",{className:"text-gray-400 text-sm",children:"NSE, BSE, MCX - Equity, F&O, Commodities"})]})]}),n.jsxs("div",{className:"mt-16 text-center",children:[n.jsx("p",{className:"text-gray-500 mb-4",children:"Supported Exchanges"}),n.jsx("div",{className:"flex flex-wrap justify-center gap-6",children:["NSE Equity","BSE Equity","NSE F&O","BSE F&O","MCX"].map(t=>n.jsx("span",{className:"px-4 py-2 bg-dark-700 rounded-lg text-sm text-gray-300",children:t},t))})]})]})]})}),n.jsxs("footer",{className:"text-center py-6 text-gray-500 border-t border-dark-600 bg-dark-800/50",children:[n.jsx("p",{children:" 2024 THEFX. All rights reserved."}),n.jsxs("div",{className:"flex justify-center gap-6 mt-2 text-sm",children:[n.jsx(ze,{to:"/login",className:"hover:text-green-400 transition",children:"Login"}),n.jsx("span",{className:"hover:text-gray-400 transition cursor-default",children:"Terms"}),n.jsx("span",{className:"hover:text-gray-400 transition cursor-default",children:"Privacy"})]})]})]});class k4 extends iu.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,s){console.error("React Error:",e,s)}render(){var e;return this.state.hasError?n.jsxs("div",{style:{padding:"20px",color:"white",background:"#1a1a1a",minHeight:"100vh"},children:[n.jsx("h1",{children:"Something went wrong"}),n.jsx("pre",{style:{color:"red"},children:(e=this.state.error)==null?void 0:e.toString()})]}):this.props.children}}const S4=({children:t})=>{const{admin:e,loading:s}=we();return s?n.jsx("div",{className:"flex items-center justify-center h-screen bg-dark-900",children:"Loading..."}):e?t:n.jsx(eo,{to:"/admin/login"})},ol=({children:t})=>{const{user:e,loading:s}=we();return s?n.jsx("div",{className:"flex items-center justify-center h-screen bg-dark-900",children:"Loading..."}):e?t:n.jsx(eo,{to:"/login"})};function C4(){return n.jsx(k4,{children:n.jsx(pw,{children:n.jsx(AN,{children:n.jsxs(th,{children:[n.jsx(ye,{path:"/",element:n.jsx(w4,{})}),n.jsx(ye,{path:"/login",element:n.jsx(yk,{})}),n.jsx(ye,{path:"/admin/login",element:n.jsx($w,{})}),n.jsx(ye,{path:"/admin/*",element:n.jsx(S4,{children:n.jsx(Bw,{})})}),n.jsx(ye,{path:"/user/trader-room",element:n.jsx(ol,{children:n.jsx(n4,{})})}),n.jsx(ye,{path:"/user/orders",element:n.jsx(ol,{children:n.jsx(N4,{})})}),n.jsx(ye,{path:"/user/transactions",element:n.jsx(ol,{children:n.jsx(j4,{})})}),n.jsx(ye,{path:"/user/*",element:n.jsx(ol,{children:n.jsx(Lk,{})})}),n.jsx(ye,{path:"/dashboard",element:n.jsx(eo,{to:"/user/home",replace:!0})}),n.jsx(ye,{path:"/dashboard/*",element:n.jsx(eo,{to:"/user/home",replace:!0})})]})})})})}Dc.createRoot(document.getElementById("root")).render(n.jsx(iu.StrictMode,{children:n.jsx(C4,{})}));
